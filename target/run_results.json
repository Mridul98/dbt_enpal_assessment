{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-02-05T21:25:54.648385Z", "invocation_id": "2aa14978-55ec-4755-aec9-a34268a62a38", "invocation_started_at": "2026-02-05T21:25:53.700859Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.098640Z", "completed_at": "2026-02-05T21:25:54.101873Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.102026Z", "completed_at": "2026-02-05T21:25:54.191345Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09314203262329102, "adapter_response": {"_message": "MERGE 4579", "code": "MERGE", "rows_affected": 4579}, "message": "MERGE 4579", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_activities", "compiled": true, "compiled_code": "\n\nSELECT\n  activity_id      AS deal_activity_id,\n  type             AS deal_activity_type,\n  assigned_to_user AS deal_activity_assigned_to_user,\n  deal_id,\n  done             AS is_deal_activity_done,\n  due_to           AS deal_activity_due_to\nFROM \"postgres\".\"public\".\"activity\"", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_activities\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.193335Z", "completed_at": "2026-02-05T21:25:54.195050Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.195160Z", "completed_at": "2026-02-05T21:25:54.271813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07894182205200195, "adapter_response": {"_message": "MERGE 15406", "code": "MERGE", "rows_affected": 15406}, "message": "MERGE 15406", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_changes", "compiled": true, "compiled_code": "\nWITH marked_deal_changes AS (\n  SELECT\n    deal_id,\n    change_time,\n    changed_field_key,\n    new_value,\n    CASE\n      WHEN changed_field_key = 'stage_id' THEN new_value::INT\n    END AS stage_id,\n    CASE\n      WHEN changed_field_key = 'user_id' THEN new_value::INT\n    END AS user_id,\n    CASE\n      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP\n    END AS deal_created_at,\n    CASE\n      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT\n    END AS deal_lost_reason\n\n  FROM\n    \"postgres\".\"public\".\"deal_changes\"\n),\n\ngrouped_marked_deal_changes AS (\n  SELECT\n    deal_id,\n    change_time,\n    stage_id,\n    user_id,\n    deal_created_at,\n    deal_lost_reason,\n    SUM(CASE WHEN stage_id IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY deal_id ORDER BY change_time)         AS stage_id_change_count,\n    SUM(CASE WHEN user_id IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY deal_id ORDER BY change_time)          AS user_id_change_count,\n    SUM(CASE WHEN deal_created_at IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY deal_id ORDER BY change_time)  AS deal_created_at_change_count,\n    SUM(CASE WHEN deal_lost_reason IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY deal_id ORDER BY change_time) AS deal_lost_reason_change_count\n  FROM marked_deal_changes\n)\n\nSELECT\n  deal_id,\n  change_time,\n  FIRST_VALUE(stage_id) OVER (PARTITION BY deal_id, stage_id_change_count ORDER BY change_time)                 AS stage_id,\n  FIRST_VALUE(user_id) OVER (PARTITION BY deal_id, user_id_change_count ORDER BY change_time)                   AS user_id,\n  FIRST_VALUE(deal_created_at) OVER (PARTITION BY deal_id, deal_created_at_change_count ORDER BY change_time)   AS deal_created_at,\n  FIRST_VALUE(deal_lost_reason) OVER (PARTITION BY deal_id, deal_lost_reason_change_count ORDER BY change_time) AS deal_lost_reason\nFROM grouped_marked_deal_changes", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.273339Z", "completed_at": "2026-02-05T21:25:54.275102Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.275228Z", "completed_at": "2026-02-05T21:25:54.300849Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027968645095825195, "adapter_response": {"_message": "MERGE 5", "code": "MERGE", "rows_affected": 5}, "message": "MERGE 5", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_lost_reason", "compiled": true, "compiled_code": "\nSELECT\n  (array_elems ->> 'id')::INT     AS lost_reason_id,\n  (array_elems ->> 'label')::TEXT AS actual_lost_reason\nFROM public.fields,\n  LATERAL JSONB_ARRAY_ELEMENTS(field_value_options) AS array_elems\nWHERE field_key = 'lost_reason'", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_lost_reason\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.302291Z", "completed_at": "2026-02-05T21:25:54.303897Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.304028Z", "completed_at": "2026-02-05T21:25:54.330803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028970956802368164, "adapter_response": {"_message": "MERGE 1787", "code": "MERGE", "rows_affected": 1787}, "message": "MERGE 1787", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_users", "compiled": true, "compiled_code": "\n\nSELECT\n  id       AS deal_user_id,\n  name     AS deal_user_name,\n  email    AS deal_user_email,\n  modified AS deal_user_last_modified\nFROM \"postgres\".\"public\".\"users\"", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.332240Z", "completed_at": "2026-02-05T21:25:54.333482Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.333628Z", "completed_at": "2026-02-05T21:25:54.408944Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07714295387268066, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot", "compiled": true, "compiled_code": "select * from \"postgres\".\"public\".\"activity_types\"", "relation_name": "\"postgres\".\"pipedrive_snapshots\".\"deal_activity_types_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.410414Z", "completed_at": "2026-02-05T21:25:54.411350Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.411476Z", "completed_at": "2026-02-05T21:25:54.445684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03570985794067383, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "snapshot.enpal_assessment_project.deal_fields_snapshot", "compiled": true, "compiled_code": "select * from \"postgres\".\"public\".\"fields\"", "relation_name": "\"postgres\".\"pipedrive_snapshots\".\"deal_fields_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.447099Z", "completed_at": "2026-02-05T21:25:54.448088Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.448219Z", "completed_at": "2026-02-05T21:25:54.482172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035498857498168945, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "snapshot.enpal_assessment_project.deal_stages_snapshot", "compiled": true, "compiled_code": "select * from \"postgres\".\"public\".\"stages\"", "relation_name": "\"postgres\".\"pipedrive_snapshots\".\"deal_stages_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.483552Z", "completed_at": "2026-02-05T21:25:54.484559Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.484681Z", "completed_at": "2026-02-05T21:25:54.521042Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03791093826293945, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "snapshot.enpal_assessment_project.deal_users_snapshot", "compiled": true, "compiled_code": "select * from \"postgres\".\"public\".\"users\"", "relation_name": "\"postgres\".\"pipedrive_snapshots\".\"deal_users_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.522501Z", "completed_at": "2026-02-05T21:25:54.524214Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.524328Z", "completed_at": "2026-02-05T21:25:54.545320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02322697639465332, "adapter_response": {"_message": "MERGE 4", "code": "MERGE", "rows_affected": 4}, "message": "MERGE 4", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_activity_types", "compiled": true, "compiled_code": "\n\nSELECT\n  id     AS deal_activity_type_id,\n  name   AS deal_activity_type_name,\n  active AS is_deal_activity_type_active,\n  type   AS deal_activity_type\nFROM \"postgres\".\"pipedrive_snapshots\".\"deal_activity_types_snapshot\"\nWHERE dbt_valid_to IS NULL", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_activity_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.546535Z", "completed_at": "2026-02-05T21:25:54.547983Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.548090Z", "completed_at": "2026-02-05T21:25:54.569729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023586034774780273, "adapter_response": {"_message": "MERGE 4", "code": "MERGE", "rows_affected": 4}, "message": "MERGE 4", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_fields", "compiled": true, "compiled_code": "\n\nSELECT\n  id                  AS deal_field_id,\n  field_key           AS deal_field_key,\n  name                AS deal_field_name,\n  field_value_options AS deal_field_value_options\nFROM \"postgres\".\"pipedrive_snapshots\".\"deal_fields_snapshot\"\nWHERE dbt_valid_to IS NULL", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_fields\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.571027Z", "completed_at": "2026-02-05T21:25:54.574096Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.574213Z", "completed_at": "2026-02-05T21:25:54.595062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02443981170654297, "adapter_response": {"_message": "MERGE 0", "code": "MERGE", "rows_affected": 0}, "message": "MERGE 0", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_stages", "compiled": true, "compiled_code": "\n\nWITH new_deal_stages_data AS (\n  SELECT\n    stage_id   AS deal_stage_id,\n    stage_name AS deal_stage_name\n  FROM \"postgres\".\"pipedrive_snapshots\".\"deal_stages_snapshot\"\n  WHERE\n    dbt_valid_to IS NULL\n    AND stage_name IS NOT NULL\n)\n\nSELECT\n  new_deal_stages_data.deal_stage_id,\n  new_deal_stages_data.deal_stage_name\nFROM new_deal_stages_data\n\n\n\n  LEFT JOIN \"postgres\".\"public_pipedrive_staging\".\"stg_deal_stages\" AS existing_deal_stages_data\n    ON\n      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id\n  WHERE existing_deal_stages_data.deal_stage_name IS NULL\n\n", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:25:54.596464Z", "completed_at": "2026-02-05T21:25:54.597862Z"}, {"name": "execute", "started_at": "2026-02-05T21:25:54.597975Z", "completed_at": "2026-02-05T21:25:54.641363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04533576965332031, "adapter_response": {"_message": "MERGE 10916", "code": "MERGE", "rows_affected": 10916}, "message": "MERGE 10916", "failures": null, "unique_id": "model.enpal_assessment_project.int_monthly_deal_stage_progression", "compiled": true, "compiled_code": "\nwith deal_changes as (\n    select\n        deal_id,\n        change_time,\n        (date_trunc('month', change_time) + interval '1 month' - interval '1 day')::DATE AS change_month,\n        (extract('year' from change_time))::int AS change_year,\n        stage_id\n    from \"postgres\".\"public_pipedrive_staging\".\"stg_deal_changes\"\n    where stage_id is not null\n)\nselect \n    deal_changes.*,\n    stages.deal_stage_name\nfrom deal_changes\ninner join \"postgres\".\"public_pipedrive_staging\".\"stg_deal_stages\" as stages\n    on deal_changes.stage_id = stages.deal_stage_id", "relation_name": "\"postgres\".\"public\".\"int_monthly_deal_stage_progression\"", "batch_results": null}], "elapsed_time": 0.6984541416168213, "args": {"log_format_file": "debug", "static_parser": true, "printer_width": 80, "print": true, "export_saved_queries": false, "favor_state": false, "require_ref_searches_node_package_before_root": false, "project_dir": "/Users/macbook/dbt_enpal_assessment", "show_resource_report": false, "vars": {}, "source_freshness_run_project_hooks": true, "show_all_deprecations": false, "include_saved_query": false, "quiet": false, "indirect_selection": "eager", "state_modified_compare_vars": false, "introspect": true, "skip_nodes_if_on_run_start_fails": false, "log_file_max_bytes": 10485760, "profiles_dir": "/Users/macbook/dbt_enpal_assessment", "exclude": [], "defer": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_all_warnings_handled_by_warn_error": false, "select": [], "log_level": "info", "version_check": true, "invocation_command": "dbt build", "require_yaml_configuration_for_mf_time_spines": false, "show": false, "log_format": "default", "require_nested_cumulative_type_params": false, "populate_cache": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_unique_project_resource_names": false, "exclude_resource_types": [], "log_path": "/Users/macbook/dbt_enpal_assessment/logs", "send_anonymous_usage_stats": true, "use_fast_test_edges": false, "strict_mode": false, "require_generic_test_arguments_property": true, "empty": false, "partial_parse_file_diff": true, "state_modified_compare_more_unrendered_values": false, "write_json": true, "cache_selected_only": false, "use_colors": true, "validate_macro_args": false, "resource_types": [], "macro_debugging": false, "log_level_file": "debug", "require_resource_names_without_spaces": true, "which": "build", "use_colors_file": true, "upload_to_artifacts_ingest_api": false}}