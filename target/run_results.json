{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-02-06T15:27:42.687397Z", "invocation_id": "b264d725-2686-4fdd-bd19-e95f014aa6c6", "invocation_started_at": "2026-02-06T15:27:41.352022Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.121056Z", "completed_at": "2026-02-06T15:27:42.124609Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.124742Z", "completed_at": "2026-02-06T15:27:42.177251Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05663800239562988, "adapter_response": {"_message": "SELECT 4579", "code": "SELECT", "rows_affected": 4579}, "message": "SELECT 4579", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_activities", "compiled": true, "compiled_code": "\n\nSELECT\n  activity_id      AS deal_activity_id,\n  type             AS deal_activity_type,\n  assigned_to_user AS deal_activity_assigned_to_user,\n  deal_id,\n  done             AS is_deal_activity_done,\n  due_to           AS deal_activity_due_to\nFROM \"postgres\".\"public\".\"activity\"", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_activities\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.178986Z", "completed_at": "2026-02-06T15:27:42.180141Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.180252Z", "completed_at": "2026-02-06T15:27:42.248218Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06966280937194824, "adapter_response": {"_message": "SELECT 15406", "code": "SELECT", "rows_affected": 15406}, "message": "SELECT 15406", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_changes", "compiled": true, "compiled_code": "\nWITH marked_deal_changes AS (\n  SELECT\n    deal_id,\n    change_time,\n    changed_field_key,\n    new_value,\n    CASE\n      WHEN changed_field_key = 'stage_id' THEN new_value::INT\n    END AS stage_id,\n    CASE\n      WHEN changed_field_key = 'user_id' THEN new_value::INT\n    END AS user_id,\n    CASE\n      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP\n    END AS deal_created_at,\n    CASE\n      WHEN changed_field_key = 'lost_reason' THEN new_value::INT\n    END AS deal_lost_reason\n\n  FROM\n    \"postgres\".\"public\".\"deal_changes\"\n),\n\ngrouped_marked_deal_changes AS (\n  SELECT\n    deal_id,\n    change_time,\n    stage_id,\n    user_id,\n    deal_created_at,\n    deal_lost_reason,\n    SUM(CASE WHEN stage_id IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY deal_id ORDER BY change_time)         AS stage_id_change_count,\n    SUM(CASE WHEN user_id IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY deal_id ORDER BY change_time)          AS user_id_change_count,\n    SUM(CASE WHEN deal_created_at IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY deal_id ORDER BY change_time)  AS deal_created_at_change_count,\n    SUM(CASE WHEN deal_lost_reason IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY deal_id ORDER BY change_time) AS deal_lost_reason_change_count\n  FROM marked_deal_changes\n)\n\nSELECT\n  deal_id,\n  change_time,\n  FIRST_VALUE(stage_id) OVER (PARTITION BY deal_id, stage_id_change_count ORDER BY change_time)                 AS stage_id,\n  FIRST_VALUE(user_id) OVER (PARTITION BY deal_id, user_id_change_count ORDER BY change_time)                   AS user_id,\n  FIRST_VALUE(deal_created_at) OVER (PARTITION BY deal_id, deal_created_at_change_count ORDER BY change_time)   AS deal_created_at,\n  FIRST_VALUE(deal_lost_reason) OVER (PARTITION BY deal_id, deal_lost_reason_change_count ORDER BY change_time) AS deal_lost_reason_id\nFROM grouped_marked_deal_changes", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.249716Z", "completed_at": "2026-02-06T15:27:42.250996Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.251117Z", "completed_at": "2026-02-06T15:27:42.265655Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016386032104492188, "adapter_response": {"_message": "SELECT 5", "code": "SELECT", "rows_affected": 5}, "message": "SELECT 5", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_lost_reason", "compiled": true, "compiled_code": "\nSELECT\n  (array_elems ->> 'id')::INT     AS lost_reason_id,\n  (array_elems ->> 'label')::TEXT AS actual_lost_reason\nFROM public.fields,\n  LATERAL JSONB_ARRAY_ELEMENTS(field_value_options) AS array_elems\nWHERE field_key = 'lost_reason'", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_lost_reason\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.267085Z", "completed_at": "2026-02-06T15:27:42.268827Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.268959Z", "completed_at": "2026-02-06T15:27:42.289346Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022780895233154297, "adapter_response": {"_message": "SELECT 1787", "code": "SELECT", "rows_affected": 1787}, "message": "SELECT 1787", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_users", "compiled": true, "compiled_code": "\n\nSELECT\n  id       AS deal_user_id,\n  name     AS deal_user_name,\n  email    AS deal_user_email,\n  modified AS deal_user_last_modified\nFROM \"postgres\".\"public\".\"users\"", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.290761Z", "completed_at": "2026-02-06T15:27:42.291843Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.291970Z", "completed_at": "2026-02-06T15:27:42.365836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07549905776977539, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot", "compiled": true, "compiled_code": "select * from \"postgres\".\"public\".\"activity_types\"", "relation_name": "\"postgres\".\"pipedrive_snapshots\".\"deal_activity_types_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.367237Z", "completed_at": "2026-02-06T15:27:42.368211Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.368333Z", "completed_at": "2026-02-06T15:27:42.404110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03728795051574707, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "snapshot.enpal_assessment_project.deal_fields_snapshot", "compiled": true, "compiled_code": "select * from \"postgres\".\"public\".\"fields\"", "relation_name": "\"postgres\".\"pipedrive_snapshots\".\"deal_fields_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.405538Z", "completed_at": "2026-02-06T15:27:42.406497Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.406622Z", "completed_at": "2026-02-06T15:27:42.444954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039845943450927734, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "snapshot.enpal_assessment_project.deal_stages_snapshot", "compiled": true, "compiled_code": "select * from \"postgres\".\"public\".\"stages\"", "relation_name": "\"postgres\".\"pipedrive_snapshots\".\"deal_stages_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.446346Z", "completed_at": "2026-02-06T15:27:42.447351Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.447478Z", "completed_at": "2026-02-06T15:27:42.489505Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04362010955810547, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "snapshot.enpal_assessment_project.deal_users_snapshot", "compiled": true, "compiled_code": "select * from \"postgres\".\"public\".\"users\"", "relation_name": "\"postgres\".\"pipedrive_snapshots\".\"deal_users_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.490866Z", "completed_at": "2026-02-06T15:27:42.492362Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.492495Z", "completed_at": "2026-02-06T15:27:42.508715Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01826930046081543, "adapter_response": {"_message": "SELECT 4", "code": "SELECT", "rows_affected": 4}, "message": "SELECT 4", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_activity_types", "compiled": true, "compiled_code": "\n\nSELECT\n  id                              AS deal_activity_type_id,\n  name                            AS deal_activity_type_name,\n  case\n    when name = 'Sales Call 1' then '2.1'\n    when name = 'Sales Call 2' then '3.1'\n    else NULL\n  end                             AS deal_activity_type_stage,\n  COALESCE(active = 'Yes', FALSE) AS is_deal_activity_type_active,\n  type                            AS deal_activity_type\nFROM \"postgres\".\"pipedrive_snapshots\".\"deal_activity_types_snapshot\"\nWHERE dbt_valid_to IS NULL", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_activity_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.510112Z", "completed_at": "2026-02-06T15:27:42.512914Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.513024Z", "completed_at": "2026-02-06T15:27:42.531178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021480798721313477, "adapter_response": {"_message": "SELECT 4", "code": "SELECT", "rows_affected": 4}, "message": "SELECT 4", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_fields", "compiled": true, "compiled_code": "\n\nSELECT\n  id                  AS deal_field_id,\n  field_key           AS deal_field_key,\n  name                AS deal_field_name,\n  field_value_options AS deal_field_value_options\nFROM \"postgres\".\"pipedrive_snapshots\".\"deal_fields_snapshot\"\nWHERE dbt_valid_to IS NULL", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_fields\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.532443Z", "completed_at": "2026-02-06T15:27:42.534366Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.534473Z", "completed_at": "2026-02-06T15:27:42.551997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019948244094848633, "adapter_response": {"_message": "SELECT 9", "code": "SELECT", "rows_affected": 9}, "message": "SELECT 9", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_stages", "compiled": true, "compiled_code": "\n\nWITH new_deal_stages_data AS (\n  SELECT\n    stage_id   AS deal_stage_id,\n    stage_name AS deal_stage_name\n  FROM \"postgres\".\"pipedrive_snapshots\".\"deal_stages_snapshot\"\n  WHERE\n    dbt_valid_to IS NULL\n    AND stage_name IS NOT NULL\n)\n\nSELECT\n  new_deal_stages_data.deal_stage_id,\n  new_deal_stages_data.deal_stage_name\nFROM new_deal_stages_data\n\n", "relation_name": "\"postgres\".\"public_pipedrive_staging\".\"stg_deal_stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.553280Z", "completed_at": "2026-02-06T15:27:42.554462Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.554578Z", "completed_at": "2026-02-06T15:27:42.580444Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02756786346435547, "adapter_response": {"_message": "SELECT 3446", "code": "SELECT", "rows_affected": 3446}, "message": "SELECT 3446", "failures": null, "unique_id": "model.enpal_assessment_project.int_deal_activities", "compiled": true, "compiled_code": "SELECT \n    deal_activities.deal_activity_id,\n    deal_activities.deal_activity_type,\n    deal_activities.deal_activity_assigned_to_user,\n    deal_activities.deal_id,\n    deal_activities.is_deal_activity_done,\n    deal_activities.deal_activity_due_to,\n    activity_types.deal_activity_type_id,\n    activity_types.deal_activity_type_name,\n    activity_types.is_deal_activity_type_active,\n    activity_types.deal_activity_type_stage\n\nFROM \"postgres\".\"public_pipedrive_staging\".\"stg_deal_activities\" deal_activities\nINNER JOIN \"postgres\".\"public_pipedrive_staging\".\"stg_deal_activity_types\" activity_types\n    ON deal_activities.deal_activity_type = activity_types.deal_activity_type\nWHERE activity_types.is_deal_activity_type_active = TRUE", "relation_name": "\"postgres\".\"public_sales_analytics_intermediate\".\"int_deal_activities\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.581752Z", "completed_at": "2026-02-06T15:27:42.583177Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.583289Z", "completed_at": "2026-02-06T15:27:42.613846Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03254413604736328, "adapter_response": {"_message": "SELECT 8908", "code": "SELECT", "rows_affected": 8908}, "message": "SELECT 8908", "failures": null, "unique_id": "model.enpal_assessment_project.int_deal_stage_progression", "compiled": true, "compiled_code": "\nWITH deal_changes AS (\n  SELECT\n    deal_id,\n    change_time,\n    stage_id,\n    user_id\n\n  FROM \"postgres\".\"public_pipedrive_staging\".\"stg_deal_changes\"\n  WHERE stage_id IS NOT NULL\n),\ndistinct_deal_stage_entries AS (\n SELECT\n  deal_changes.*,\n  stages.deal_stage_name,\n  FIRST_VALUE(deal_changes.change_time) OVER (PARTITION BY deal_changes.deal_id, deal_changes.stage_id ORDER BY deal_changes.change_time) AS first_entry_date_for_stage\nFROM deal_changes\nINNER JOIN \"postgres\".\"public_pipedrive_staging\".\"stg_deal_stages\" AS stages\n  ON deal_changes.stage_id = stages.deal_stage_id\n\n)\nselect \n  distinct\n  deal_id,\n  stage_id,\n  user_id,\n  first_entry_date_for_stage,\n  deal_stage_name\nfrom distinct_deal_stage_entries", "relation_name": "\"postgres\".\"public_sales_analytics_intermediate\".\"int_deal_stage_progression\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.615364Z", "completed_at": "2026-02-06T15:27:42.616726Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.616837Z", "completed_at": "2026-02-06T15:27:42.637446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022505998611450195, "adapter_response": {"_message": "SELECT 10614", "code": "SELECT", "rows_affected": 10614}, "message": "SELECT 10614", "failures": null, "unique_id": "model.enpal_assessment_project.int_sales_funnel", "compiled": true, "compiled_code": "with deal_stages as (\n    select\n        deal_stage_progression.deal_id,\n        deal_stage_progression.deal_stage_name,\n        stages.deal_stage_id::text as funnel_step,\n        deal_stage_progression.first_entry_date_for_stage as first_entry_date\n    from \"postgres\".\"public_sales_analytics_intermediate\".\"int_deal_stage_progression\" deal_stage_progression\n    inner join \"postgres\".\"public_pipedrive_staging\".\"stg_deal_stages\" as stages\n        on deal_stage_progression.stage_id = stages.deal_stage_id\n),\ndeal_activities as (\n    select\n        deal_id,\n        deal_activity_type_name,\n        deal_activity_type_stage as funnel_step,\n        deal_activity_due_to as first_entry_date\n    from \"postgres\".\"public_sales_analytics_intermediate\".\"int_deal_activities\"\n    where is_deal_activity_done = True\n),\nsales_funnel as (\n    select distinct\n        deal_id,\n        deal_stage_name as funnel_stage_name,\n        funnel_step,\n        first_entry_date\n    from deal_stages\n    union all\n    select\n        deal_id,\n        deal_activity_type_name as funnel_stage_name,\n        funnel_step,\n        first_entry_date\n    from deal_activities\n)\nselect * from sales_funnel", "relation_name": "\"postgres\".\"public_sales_analytics_intermediate\".\"int_sales_funnel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.638871Z", "completed_at": "2026-02-06T15:27:42.640182Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.640307Z", "completed_at": "2026-02-06T15:27:42.666785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028326988220214844, "adapter_response": {"_message": "SELECT 137", "code": "SELECT", "rows_affected": 137}, "message": "SELECT 137", "failures": null, "unique_id": "model.enpal_assessment_project.int_sales_funnel_monthly", "compiled": true, "compiled_code": "WITH sales_funnel as (\n    SELECT\n        deal_id,\n        funnel_stage_name,\n        funnel_step,\n        (date_trunc('MONTH', first_entry_date) + interval '1 month' - interval '1 day')::date AS funnel_month\n    FROM \"postgres\".\"public_sales_analytics_intermediate\".\"int_sales_funnel\"\n)\n\nSELECT\n    funnel_month,\n    funnel_stage_name,\n    funnel_step,\n    COUNT(DISTINCT deal_id) AS deals_in_stage\nFROM sales_funnel\nGROUP BY\n    funnel_month,\n    funnel_stage_name,\n    funnel_step", "relation_name": "\"postgres\".\"public_sales_analytics_intermediate\".\"int_sales_funnel_monthly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T15:27:42.668315Z", "completed_at": "2026-02-06T15:27:42.669510Z"}, {"name": "execute", "started_at": "2026-02-06T15:27:42.669635Z", "completed_at": "2026-02-06T15:27:42.681228Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013390779495239258, "adapter_response": {"_message": "SELECT 128", "code": "SELECT", "rows_affected": 128}, "message": "SELECT 128", "failures": null, "unique_id": "model.enpal_assessment_project.rep_sales_funnel_monthly", "compiled": true, "compiled_code": "SELECT \n    funnel_month as \"month\",\n    funnel_stage_name as \"kpi_name\",\n    funnel_step as \"funnel_step\",\n    deals_in_stage as \"deals_count\"\n\nFROM \"postgres\".\"public_sales_analytics_intermediate\".\"int_sales_funnel_monthly\"\nWHERE funnel_step IN ('1', '2', '2.1', '3', '3.1', '4', '5', '6', '7', '8', '9', '10')", "relation_name": "\"postgres\".\"public_sales_analytics_reporting\".\"rep_sales_funnel_monthly\"", "batch_results": null}], "elapsed_time": 0.7054660320281982, "args": {"require_all_warnings_handled_by_warn_error": false, "exclude_resource_types": [], "state_modified_compare_more_unrendered_values": false, "favor_state": false, "log_level_file": "debug", "macro_debugging": false, "include_saved_query": false, "upload_to_artifacts_ingest_api": false, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors": true, "static_parser": true, "log_format_file": "debug", "partial_parse_file_diff": true, "source_freshness_run_project_hooks": true, "use_colors_file": true, "profiles_dir": "/Users/macbook/dbt_enpal_assessment", "version_check": true, "full_refresh": true, "require_resource_names_without_spaces": true, "invocation_command": "dbt build --full-refresh", "state_modified_compare_vars": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "select": [], "print": true, "write_json": true, "quiet": false, "vars": {}, "log_path": "/Users/macbook/dbt_enpal_assessment/logs", "empty": false, "validate_macro_args": false, "indirect_selection": "eager", "defer": false, "require_nested_cumulative_type_params": false, "log_format": "default", "partial_parse": true, "cache_selected_only": false, "exclude": [], "show_resource_report": false, "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "require_ref_searches_node_package_before_root": false, "require_generic_test_arguments_property": true, "populate_cache": true, "require_yaml_configuration_for_mf_time_spines": false, "project_dir": "/Users/macbook/dbt_enpal_assessment", "strict_mode": false, "introspect": true, "require_unique_project_resource_names": false, "show_all_deprecations": false, "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "export_saved_queries": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_fast_test_edges": false, "printer_width": 80, "show": false, "which": "build", "resource_types": []}}