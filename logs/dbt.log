[0m02:02:18.123037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b737750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7379d0>]}


============================== 02:02:18.125161 | fbaa62bc-2b74-45d1-ac26-364a8b324192 ==============================
[0m02:02:18.125161 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:02:18.125394 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default'}
[0m02:02:18.166343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbaa62bc-2b74-45d1-ac26-364a8b324192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa755b0>]}
[0m02:02:18.173143 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:02:18.173441 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:02:18.198808 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10465946, "process_in_blocks": "0", "process_kernel_time": 0.111962, "process_mem_max_rss": "115113984", "process_out_blocks": "0", "process_user_time": 0.670981}
[0m02:02:18.199073 [debug] [MainThread]: Command `dbt deps` succeeded at 02:02:18.199022 after 0.10 seconds
[0m02:02:18.199211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c08d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c1480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b5650>]}
[0m02:02:18.199337 [debug] [MainThread]: Flushing usage events
[0m02:02:19.440358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:21:58.851970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b333750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3339d0>]}


============================== 02:21:58.854288 | 620809eb-9c2b-4e34-a486-df229401acbd ==============================
[0m02:21:58.854288 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:21:58.854526 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'quiet': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'debug': 'False', 'empty': 'None', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False'}
[0m02:21:58.862677 [info ] [MainThread]: dbt version: 1.11.2
[0m02:21:58.862862 [info ] [MainThread]: python version: 3.13.12
[0m02:21:58.862964 [info ] [MainThread]: python path: /Users/macbook/dbt_enpal_assessment/dbt_venv/bin/python3.13
[0m02:21:58.863054 [info ] [MainThread]: os info: macOS-26.2-arm64-arm-64bit-Mach-O
[0m02:22:01.645426 [info ] [MainThread]: Using profiles dir at /Users/macbook/dbt_enpal_assessment
[0m02:22:01.645709 [info ] [MainThread]: Using profiles.yml file at /Users/macbook/dbt_enpal_assessment/profiles.yml
[0m02:22:01.645875 [info ] [MainThread]: Using dbt_project.yml file at /Users/macbook/dbt_enpal_assessment/dbt_project.yml
[0m02:22:01.646183 [info ] [MainThread]: adapter type: postgres
[0m02:22:01.646330 [info ] [MainThread]: adapter version: 1.10.0
[0m02:22:01.690251 [info ] [MainThread]: Configuration:
[0m02:22:01.690430 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:22:01.690524 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:22:01.690607 [info ] [MainThread]: Required dependencies:
[0m02:22:01.690748 [debug] [MainThread]: Executing "git --help"
[0m02:22:01.707557 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:22:01.707933 [debug] [MainThread]: STDERR: "b''"
[0m02:22:01.708068 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:22:01.708190 [info ] [MainThread]: Connection:
[0m02:22:01.708301 [info ] [MainThread]:   host: localhost
[0m02:22:01.708386 [info ] [MainThread]:   port: 5432
[0m02:22:01.708467 [info ] [MainThread]:   user: admin
[0m02:22:01.708543 [info ] [MainThread]:   database: postgres
[0m02:22:01.708619 [info ] [MainThread]:   schema: public
[0m02:22:01.708693 [info ] [MainThread]:   connect_timeout: 10
[0m02:22:01.708772 [info ] [MainThread]:   role: None
[0m02:22:01.708851 [info ] [MainThread]:   search_path: None
[0m02:22:01.708926 [info ] [MainThread]:   keepalives_idle: 0
[0m02:22:01.708997 [info ] [MainThread]:   sslmode: None
[0m02:22:01.709071 [info ] [MainThread]:   sslcert: None
[0m02:22:01.709142 [info ] [MainThread]:   sslkey: None
[0m02:22:01.709214 [info ] [MainThread]:   sslrootcert: None
[0m02:22:01.709285 [info ] [MainThread]:   application_name: dbt
[0m02:22:01.709356 [info ] [MainThread]:   retries: 1
[0m02:22:01.709611 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:22:01.738794 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m02:22:01.757121 [debug] [MainThread]: Using postgres connection "debug"
[0m02:22:01.757268 [debug] [MainThread]: On debug: select 1 as id
[0m02:22:01.757361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:22:01.784429 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m02:22:01.784846 [debug] [MainThread]: On debug: Close
[0m02:22:01.784964 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:22:01.785078 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:22:01.786686 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9633954, "process_in_blocks": "0", "process_kernel_time": 0.136352, "process_mem_max_rss": "133185536", "process_out_blocks": "0", "process_user_time": 0.566224}
[0m02:22:01.786854 [debug] [MainThread]: Command `dbt debug` succeeded at 02:22:01.786816 after 2.96 seconds
[0m02:22:01.786959 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:22:01.787072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c48c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ab890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c228270>]}
[0m02:22:01.787208 [debug] [MainThread]: Flushing usage events
[0m02:22:03.190836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:22:10.717701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a44590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cf9d0>]}


============================== 02:22:10.719328 | 5987269b-a1c1-4ea6-8f1c-860693be0f00 ==============================
[0m02:22:10.719328 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:22:10.719570 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'write_json': 'True'}
[0m02:22:10.763772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5987269b-a1c1-4ea6-8f1c-860693be0f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c095b0>]}
[0m02:22:10.769347 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:22:10.769897 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:22:10.770851 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.07796016, "process_in_blocks": "0", "process_kernel_time": 0.065033, "process_mem_max_rss": "114556928", "process_out_blocks": "0", "process_user_time": 0.492468}
[0m02:22:10.771023 [debug] [MainThread]: Command `dbt deps` succeeded at 02:22:10.770982 after 0.08 seconds
[0m02:22:10.771138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099548d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109955480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109945650>]}
[0m02:22:10.771247 [debug] [MainThread]: Flushing usage events
[0m02:22:12.101127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:22:26.975241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2df750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2df9d0>]}


============================== 02:22:26.976978 | b2bde7ce-e928-42dd-bfc3-0732c84c763e ==============================
[0m02:22:26.976978 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:22:26.977220 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False'}
[0m02:22:27.034092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2bde7ce-e928-42dd-bfc3-0732c84c763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6115b0>]}
[0m02:22:27.053433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2bde7ce-e928-42dd-bfc3-0732c84c763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b35e470>]}
[0m02:22:27.053933 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:22:27.086423 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:22:27.116352 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:22:27.116544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2bde7ce-e928-42dd-bfc3-0732c84c763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b359650>]}
[0m02:22:27.469599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2bde7ce-e928-42dd-bfc3-0732c84c763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab33e0>]}
[0m02:22:27.492833 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m02:22:27.493890 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:22:27.502130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2bde7ce-e928-42dd-bfc3-0732c84c763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c72d2b0>]}
[0m02:22:27.502293 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m02:22:27.502412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2bde7ce-e928-42dd-bfc3-0732c84c763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4082c0>]}
[0m02:22:27.503027 [info ] [MainThread]: 
[0m02:22:27.503145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:22:27.503232 [info ] [MainThread]: 
[0m02:22:27.503402 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:22:27.503702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:22:27.524822 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:22:27.524980 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:22:27.525069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:27.545351 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m02:22:27.545838 [debug] [ThreadPool]: On list_postgres: Close
[0m02:22:27.546072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m02:22:27.546206 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m02:22:27.547956 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m02:22:27.548051 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m02:22:27.548126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:22:27.555493 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m02:22:27.555821 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m02:22:27.555917 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m02:22:27.555998 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m02:22:27.556715 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m02:22:27.556808 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m02:22:27.557171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_pipedrive_analytics, now list_postgres_public_pipedrive_analytics)
[0m02:22:27.559116 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:22:27.559240 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:22:27.559334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:22:27.569026 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m02:22:27.569460 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:22:27.569801 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:22:27.571375 [debug] [MainThread]: Using postgres connection "master"
[0m02:22:27.571510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:22:27.571621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:22:27.582227 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m02:22:27.582629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2bde7ce-e928-42dd-bfc3-0732c84c763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c63b890>]}
[0m02:22:27.582786 [debug] [MainThread]: On master: ROLLBACK
[0m02:22:27.583165 [debug] [MainThread]: On master: COMMIT
[0m02:22:27.583257 [debug] [MainThread]: Using postgres connection "master"
[0m02:22:27.583337 [debug] [MainThread]: On master: COMMIT
[0m02:22:27.583837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:22:27.583923 [debug] [MainThread]: On master: Close
[0m02:22:27.584941 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m02:22:27.585119 [info ] [Thread-1 (]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m02:22:27.585274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m02:22:27.585385 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m02:22:27.588020 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m02:22:27.588271 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m02:22:27.604058 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m02:22:27.604369 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:22:27.604482 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m02:22:27.604575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:27.618796 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.014 seconds
[0m02:22:27.622436 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:22:27.622570 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m02:22:27.623092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:22:27.627927 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m02:22:27.628047 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:22:27.628144 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m02:22:27.630193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:22:27.632121 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m02:22:27.633659 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:22:27.633768 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m02:22:27.634566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:22:27.635370 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m02:22:27.636195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bde7ce-e928-42dd-bfc3-0732c84c763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c924cb0>]}
[0m02:22:27.636433 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.05s]
[0m02:22:27.636640 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m02:22:27.637089 [debug] [MainThread]: On master: COMMIT
[0m02:22:27.637195 [debug] [MainThread]: Using postgres connection "master"
[0m02:22:27.637276 [debug] [MainThread]: On master: COMMIT
[0m02:22:27.637350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:22:27.644935 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m02:22:27.645051 [debug] [MainThread]: On master: Close
[0m02:22:27.645177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:27.645260 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m02:22:27.645350 [info ] [MainThread]: 
[0m02:22:27.645457 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m02:22:27.645671 [debug] [MainThread]: Command end result
[0m02:22:27.653165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m02:22:27.653771 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:22:27.655670 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m02:22:27.655783 [info ] [MainThread]: 
[0m02:22:27.655911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:22:27.656000 [info ] [MainThread]: 
[0m02:22:27.656104 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:22:27.658144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7109616, "process_in_blocks": "0", "process_kernel_time": 0.117291, "process_mem_max_rss": "143687680", "process_out_blocks": "0", "process_user_time": 1.013082}
[0m02:22:27.658357 [debug] [MainThread]: Command `dbt run` succeeded at 02:22:27.658323 after 0.71 seconds
[0m02:22:27.658488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c727070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9b7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8f42d0>]}
[0m02:22:27.658608 [debug] [MainThread]: Flushing usage events
[0m02:22:28.995756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:21.252540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4957f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44bb10>]}


============================== 11:28:21.254977 | 76f9ecdd-be90-4d22-b6e9-14b88e4500e1 ==============================
[0m11:28:21.254977 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:28:21.255208 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select tag:pipedrive', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:21.366444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76f9ecdd-be90-4d22-b6e9-14b88e4500e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7369e0>]}
[0m11:28:21.385941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76f9ecdd-be90-4d22-b6e9-14b88e4500e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b29c0>]}
[0m11:28:21.386399 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:28:21.441241 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:28:21.470034 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:28:21.470238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76f9ecdd-be90-4d22-b6e9-14b88e4500e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ea750>]}
[0m11:28:21.823225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f9ecdd-be90-4d22-b6e9-14b88e4500e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a774410>]}
[0m11:28:21.844835 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:28:21.845580 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:28:21.855102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76f9ecdd-be90-4d22-b6e9-14b88e4500e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7e9e10>]}
[0m11:28:21.855283 [info ] [MainThread]: Found 3 models, 1 source, 464 macros
[0m11:28:21.855404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f9ecdd-be90-4d22-b6e9-14b88e4500e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3cbc70>]}
[0m11:28:21.855963 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:28:21.856157 [debug] [MainThread]: Command end result
[0m11:28:21.863707 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:28:21.864374 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:28:21.865497 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:28:21.892685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6669274, "process_in_blocks": "0", "process_kernel_time": 0.125903, "process_mem_max_rss": "131497984", "process_out_blocks": "0", "process_user_time": 0.951277}
[0m11:28:21.892879 [debug] [MainThread]: Command `dbt run` succeeded at 11:28:21.892842 after 0.67 seconds
[0m11:28:21.893017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1cfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c681390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c681440>]}
[0m11:28:21.893143 [debug] [MainThread]: Flushing usage events
[0m11:28:24.201317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:40.441201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f017f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebbb10>]}


============================== 11:28:40.442912 | 27b4da5c-31ba-4921-a724-6651cc8a46f2 ==============================
[0m11:28:40.442912 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:28:40.443161 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --select tag:pipedrive', 'no_print': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False'}
[0m11:28:40.497246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b4da5c-31ba-4921-a724-6651cc8a46f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a29e0>]}
[0m11:28:40.516857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27b4da5c-31ba-4921-a724-6651cc8a46f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1e9c0>]}
[0m11:28:40.517195 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:28:40.547044 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:28:40.582741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:28:40.582915 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:28:40.583003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:28:40.594535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27b4da5c-31ba-4921-a724-6651cc8a46f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af09150>]}
[0m11:28:40.618610 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:28:40.619407 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:28:40.629944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27b4da5c-31ba-4921-a724-6651cc8a46f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f299a0>]}
[0m11:28:40.630119 [info ] [MainThread]: Found 3 models, 1 source, 464 macros
[0m11:28:40.630745 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:28:40.631562 [debug] [MainThread]: Command end result
[0m11:28:40.638468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:28:40.639023 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:28:40.640084 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:28:40.641104 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.22367987, "process_in_blocks": "0", "process_kernel_time": 0.086403, "process_mem_max_rss": "127385600", "process_out_blocks": "0", "process_user_time": 0.625657}
[0m11:28:40.641257 [debug] [MainThread]: Command `dbt build` succeeded at 11:28:40.641228 after 0.22 seconds
[0m11:28:40.641375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad712b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f3ad0>]}
[0m11:28:40.641480 [debug] [MainThread]: Flushing usage events
[0m11:28:42.156340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:30:23.154592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4c97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d483890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d483b10>]}


============================== 11:30:23.156196 | aac06c2c-8f58-473a-b9fe-996075c5be5c ==============================
[0m11:30:23.156196 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:30:23.156443 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt build --select tag:pipedrive', 'target_path': 'None', 'static_parser': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'partial_parse': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'log_format': 'default'}
[0m11:30:23.209641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aac06c2c-8f58-473a-b9fe-996075c5be5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76a9e0>]}
[0m11:30:23.228530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aac06c2c-8f58-473a-b9fe-996075c5be5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3e69c0>]}
[0m11:30:23.228844 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:30:23.257999 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:30:23.287078 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:30:23.287297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aac06c2c-8f58-473a-b9fe-996075c5be5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d31e750>]}
[0m11:30:23.629741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.pipedrive
[0m11:30:23.633057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac06c2c-8f58-473a-b9fe-996075c5be5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a8410>]}
[0m11:30:23.656638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:30:23.657495 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:30:23.666415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac06c2c-8f58-473a-b9fe-996075c5be5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f6890>]}
[0m11:30:23.666602 [info ] [MainThread]: Found 3 models, 1 source, 464 macros
[0m11:30:23.666854 [warn ] [MainThread]: The selection criterion 'tag:pipedrive' does not match any enabled nodes
[0m11:30:23.667233 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:30:23.667419 [debug] [MainThread]: Command end result
[0m11:30:23.674890 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:30:23.675523 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:30:23.676558 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:30:23.677592 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.54640055, "process_in_blocks": "0", "process_kernel_time": 0.089677, "process_mem_max_rss": "133087232", "process_out_blocks": "0", "process_user_time": 0.947539}
[0m11:30:23.677751 [debug] [MainThread]: Command `dbt build` succeeded at 11:30:23.677719 after 0.55 seconds
[0m11:30:23.677871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e92fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d203a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ffe90>]}
[0m11:30:23.677991 [debug] [MainThread]: Flushing usage events
[0m11:30:25.749671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:03.528957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3dd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d397890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d397b10>]}


============================== 11:33:03.531081 | f07a33f7-9314-430c-a1f5-a721b8e7f367 ==============================
[0m11:33:03.531081 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:33:03.531314 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'empty': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt build --select tag:pipedrive', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_colors': 'True'}
[0m11:33:03.587524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f07a33f7-9314-430c-a1f5-a721b8e7f367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c67e9e0>]}
[0m11:33:03.605878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f07a33f7-9314-430c-a1f5-a721b8e7f367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2fa9c0>]}
[0m11:33:03.608467 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:33:03.640781 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:33:03.670276 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:33:03.670462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f07a33f7-9314-430c-a1f5-a721b8e7f367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d22e750>]}
[0m11:33:04.022425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.pipedrive
[0m11:33:04.025736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f07a33f7-9314-430c-a1f5-a721b8e7f367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6bc410>]}
[0m11:33:04.048217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:33:04.049173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:33:04.063039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f07a33f7-9314-430c-a1f5-a721b8e7f367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e75e890>]}
[0m11:33:04.063219 [info ] [MainThread]: Found 3 models, 1 source, 464 macros
[0m11:33:04.063461 [warn ] [MainThread]: The selection criterion 'tag:pipedrive' does not match any enabled nodes
[0m11:33:04.063860 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:33:04.064045 [debug] [MainThread]: Command end result
[0m11:33:04.071506 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:33:04.072264 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:33:04.073352 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:33:04.075112 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.57150006, "process_in_blocks": "0", "process_kernel_time": 0.113354, "process_mem_max_rss": "133152768", "process_out_blocks": "0", "process_user_time": 0.952481}
[0m11:33:04.075263 [debug] [MainThread]: Command `dbt build` succeeded at 11:33:04.075232 after 0.57 seconds
[0m11:33:04.075387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e797e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d117a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e65be90>]}
[0m11:33:04.075498 [debug] [MainThread]: Flushing usage events
[0m11:33:05.487815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:39.651755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1e57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d19b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d19bb10>]}


============================== 11:33:39.653905 | 6a985bde-b373-4e48-8ae8-c3e991c5dd30 ==============================
[0m11:33:39.653905 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:33:39.654135 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_deal_users', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs'}
[0m11:33:39.710168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a985bde-b373-4e48-8ae8-c3e991c5dd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4869e0>]}
[0m11:33:39.729174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a985bde-b373-4e48-8ae8-c3e991c5dd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1029c0>]}
[0m11:33:39.729704 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:33:39.761170 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:33:39.800133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:33:39.800289 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:33:39.800375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:33:39.802165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.pipedrive
[0m11:33:39.812168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a985bde-b373-4e48-8ae8-c3e991c5dd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f1150>]}
[0m11:33:39.835624 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:33:39.836329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:33:39.844896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a985bde-b373-4e48-8ae8-c3e991c5dd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2099a0>]}
[0m11:33:39.845062 [info ] [MainThread]: Found 3 models, 1 source, 464 macros
[0m11:33:39.845180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a985bde-b373-4e48-8ae8-c3e991c5dd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d17e890>]}
[0m11:33:39.845708 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:33:39.846378 [debug] [MainThread]: Command end result
[0m11:33:39.853483 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:33:39.854123 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:33:39.855306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:33:39.856602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.2302947, "process_in_blocks": "0", "process_kernel_time": 0.104696, "process_mem_max_rss": "126025728", "process_out_blocks": "0", "process_user_time": 0.623237}
[0m11:33:39.856766 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:39.856733 after 0.23 seconds
[0m11:33:39.856892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e347d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e32e690>]}
[0m11:33:39.857004 [debug] [MainThread]: Flushing usage events
[0m11:33:41.553800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:11.839855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c21d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d3b10>]}


============================== 11:35:11.842200 | 90399bce-b9d3-479b-b645-d21a033e2e3b ==============================
[0m11:35:11.842200 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:35:11.842460 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'invocation_command': 'dbt run --select stg_deal_users', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_colors': 'True'}
[0m11:35:11.906648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90399bce-b9d3-479b-b645-d21a033e2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4be9e0>]}
[0m11:35:11.925400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90399bce-b9d3-479b-b645-d21a033e2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13a9c0>]}
[0m11:35:11.927963 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:35:11.962229 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:35:12.001513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:12.001681 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:35:12.001767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:12.003670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.pipedrive
[0m11:35:12.013588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90399bce-b9d3-479b-b645-d21a033e2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e229150>]}
[0m11:35:12.037449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:35:12.038415 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:35:12.046866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90399bce-b9d3-479b-b645-d21a033e2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2419a0>]}
[0m11:35:12.047041 [info ] [MainThread]: Found 3 models, 1 source, 464 macros
[0m11:35:12.047154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90399bce-b9d3-479b-b645-d21a033e2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1b4f30>]}
[0m11:35:12.047682 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:35:12.048360 [debug] [MainThread]: Command end result
[0m11:35:12.055234 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:35:12.055719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:35:12.056747 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:35:12.058573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.24454395, "process_in_blocks": "0", "process_kernel_time": 0.096023, "process_mem_max_rss": "125960192", "process_out_blocks": "0", "process_user_time": 0.623118}
[0m11:35:12.058780 [debug] [MainThread]: Command `dbt run` succeeded at 11:35:12.058742 after 0.24 seconds
[0m11:35:12.058917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e383d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf57a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e36a690>]}
[0m11:35:12.059040 [debug] [MainThread]: Flushing usage events
[0m11:35:14.003735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:41.217536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1257f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0db890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0dbb10>]}


============================== 11:35:41.219116 | 401fcb56-e341-4170-9d2d-553b2a6432a6 ==============================
[0m11:35:41.219116 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:35:41.219352 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False', 'empty': 'False', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select stg_deal_users', 'use_colors': 'True', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True'}
[0m11:35:41.273185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '401fcb56-e341-4170-9d2d-553b2a6432a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c69e0>]}
[0m11:35:41.292333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '401fcb56-e341-4170-9d2d-553b2a6432a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0429c0>]}
[0m11:35:41.292671 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:35:41.322159 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:35:41.357399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:35:41.357649 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m11:35:41.357778 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m11:35:41.357893 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m11:35:41.419663 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['unique_key']: [Undefined, Undefined] is not valid under any of the given schemas
[0m11:35:41.420846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.22700417, "process_in_blocks": "0", "process_kernel_time": 0.0876, "process_mem_max_rss": "128335872", "process_out_blocks": "0", "process_user_time": 0.636374}
[0m11:35:41.421018 [debug] [MainThread]: Command `dbt run` failed at 11:35:41.420982 after 0.23 seconds
[0m11:35:41.421142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e085050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e084f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e21d040>]}
[0m11:35:41.421259 [debug] [MainThread]: Flushing usage events
[0m11:35:43.288697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:59.217189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ff890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ffb10>]}


============================== 11:35:59.218778 | be33338e-13ab-4862-8ff0-373ff7a1b73e ==============================
[0m11:35:59.218778 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:35:59.219015 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'no_print': 'None', 'empty': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --select stg_deal_users', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True'}
[0m11:35:59.273183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be33338e-13ab-4862-8ff0-373ff7a1b73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6ea9e0>]}
[0m11:35:59.292261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be33338e-13ab-4862-8ff0-373ff7a1b73e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3669c0>]}
[0m11:35:59.292619 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:35:59.322202 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:35:59.357151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:35:59.357380 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m11:35:59.357503 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m11:35:59.357612 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m11:35:59.416386 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_deal_stages' (models/staging/pipedrive/stg_deal_stages.sql) depends on a source named 'postgres_public.stages' which was not found
[0m11:35:59.417588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.22355258, "process_in_blocks": "0", "process_kernel_time": 0.090655, "process_mem_max_rss": "128073728", "process_out_blocks": "0", "process_user_time": 0.619909}
[0m11:35:59.417765 [debug] [MainThread]: Command `dbt run` failed at 11:35:59.417728 after 0.22 seconds
[0m11:35:59.417895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e455150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e455250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5e8140>]}
[0m11:35:59.418013 [debug] [MainThread]: Flushing usage events
[0m11:36:00.901714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:26.542099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5ff890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5ffb10>]}


============================== 11:36:26.543886 | ceb3c248-da57-47a3-b409-cfa5712ae1ce ==============================
[0m11:36:26.543886 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:36:26.544125 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'static_parser': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt run --select stg_deal_users', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80'}
[0m11:36:26.598391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceb3c248-da57-47a3-b409-cfa5712ae1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ea9e0>]}
[0m11:36:26.617591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceb3c248-da57-47a3-b409-cfa5712ae1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5669c0>]}
[0m11:36:26.617923 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:36:26.647443 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:36:26.683278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m11:36:26.683529 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/sources.yml
[0m11:36:26.683666 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m11:36:26.683783 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m11:36:26.683891 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m11:36:26.817772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.pipedrive
[0m11:36:26.821154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceb3c248-da57-47a3-b409-cfa5712ae1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5aa250>]}
[0m11:36:26.844293 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:36:26.845058 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:36:26.850099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceb3c248-da57-47a3-b409-cfa5712ae1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b66d9a0>]}
[0m11:36:26.850275 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:36:26.850397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb3c248-da57-47a3-b409-cfa5712ae1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3a8910>]}
[0m11:36:26.850982 [info ] [MainThread]: 
[0m11:36:26.851107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:26.851200 [info ] [MainThread]: 
[0m11:36:26.851367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:36:26.851669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:36:26.880754 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:36:26.880930 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:36:26.881027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:26.913514 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.032 seconds
[0m11:36:26.914115 [debug] [ThreadPool]: On list_postgres: Close
[0m11:36:26.915637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:36:26.917658 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:36:26.917768 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:36:26.917857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:26.930679 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m11:36:26.931123 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:36:26.931499 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:36:26.933243 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:26.933393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:36:26.933507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:26.946501 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m11:36:26.946879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb3c248-da57-47a3-b409-cfa5712ae1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cab5b20>]}
[0m11:36:26.947028 [debug] [MainThread]: On master: ROLLBACK
[0m11:36:26.947349 [debug] [MainThread]: On master: COMMIT
[0m11:36:26.947433 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:26.947509 [debug] [MainThread]: On master: COMMIT
[0m11:36:26.947981 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:26.948062 [debug] [MainThread]: On master: Close
[0m11:36:26.949470 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m11:36:26.949639 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public.stg_deal_users ....................... [RUN]
[0m11:36:26.949793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.enpal_assessment_project.stg_deal_users)
[0m11:36:26.949901 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m11:36:26.952700 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m11:36:26.953021 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m11:36:26.972483 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m11:36:26.972905 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:36:26.973023 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
  
    

  create  table "postgres"."public"."stg_deal_users"
  
  
    as
  
  (
    

select 
    id   as deal_user_id, 
    name as deal_user_name, 
    email as deal_user_email,
    modified as deal_user_last_modified
from "postgres"."public"."users"
  );
  
  
[0m11:36:26.973129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:26.993987 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.021 seconds
[0m11:36:27.000170 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:36:27.000317 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:36:27.000425 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:36:27.002368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:36:27.003083 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m11:36:27.004038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb3c248-da57-47a3-b409-cfa5712ae1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cabd250>]}
[0m11:36:27.004267 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public.stg_deal_users .................. [[32mSELECT 1787[0m in 0.05s]
[0m11:36:27.004464 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m11:36:27.004906 [debug] [MainThread]: On master: COMMIT
[0m11:36:27.005019 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:27.005102 [debug] [MainThread]: On master: COMMIT
[0m11:36:27.005173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:27.010785 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m11:36:27.010949 [debug] [MainThread]: On master: Close
[0m11:36:27.011110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:27.011206 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m11:36:27.011305 [info ] [MainThread]: 
[0m11:36:27.011409 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:36:27.011641 [debug] [MainThread]: Command end result
[0m11:36:27.020460 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:36:27.021097 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:36:27.023008 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:36:27.023102 [info ] [MainThread]: 
[0m11:36:27.023231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:27.023323 [info ] [MainThread]: 
[0m11:36:27.023427 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:36:27.024550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5067904, "process_in_blocks": "0", "process_kernel_time": 0.105942, "process_mem_max_rss": "145326080", "process_out_blocks": "0", "process_user_time": 0.810215}
[0m11:36:27.024688 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:27.024659 after 0.51 seconds
[0m11:36:27.024806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c877280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108383390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108383430>]}
[0m11:36:27.024911 [debug] [MainThread]: Flushing usage events
[0m11:36:28.651923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:02.811248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd47b10>]}


============================== 11:37:02.813496 | 9bb0c365-66fa-418b-bb77-01d5b04a5399 ==============================
[0m11:37:02.813496 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:37:02.813749 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:pipedrive', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m11:37:02.878319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bb0c365-66fa-418b-bb77-01d5b04a5399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02e9e0>]}
[0m11:37:02.897041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bb0c365-66fa-418b-bb77-01d5b04a5399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcaa9c0>]}
[0m11:37:02.897395 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:37:02.930329 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:37:02.971346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:02.971500 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:37:02.971589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:02.973443 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.pipedrive
[0m11:37:02.983650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bb0c365-66fa-418b-bb77-01d5b04a5399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd9d150>]}
[0m11:37:03.008355 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:37:03.009299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:37:03.023008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bb0c365-66fa-418b-bb77-01d5b04a5399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb19a0>]}
[0m11:37:03.023189 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:37:03.023451 [warn ] [MainThread]: The selection criterion 'tag:pipedrive' does not match any enabled nodes
[0m11:37:03.023883 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:37:03.024688 [debug] [MainThread]: Command end result
[0m11:37:03.032018 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:37:03.032538 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:37:03.033600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:37:03.035335 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.25062376, "process_in_blocks": "0", "process_kernel_time": 0.110465, "process_mem_max_rss": "127877120", "process_out_blocks": "0", "process_user_time": 0.613565}
[0m11:37:03.035537 [debug] [MainThread]: Command `dbt build` succeeded at 11:37:03.035498 after 0.25 seconds
[0m11:37:03.035679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd27e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbfd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d03ba00>]}
[0m11:37:03.035798 [debug] [MainThread]: Flushing usage events
[0m11:37:04.406756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:57.849899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeb97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be73890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be73b10>]}


============================== 11:39:57.852194 | 31929036-07b7-4731-840c-baa271ab5158 ==============================
[0m11:39:57.852194 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:39:57.852427 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select tag:pipedrive', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True', 'printer_width': '80', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m11:39:57.917961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31929036-07b7-4731-840c-baa271ab5158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1569e0>]}
[0m11:39:57.936797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31929036-07b7-4731-840c-baa271ab5158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd69c0>]}
[0m11:39:57.937142 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:39:57.970907 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:39:58.012342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:58.012495 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:39:58.012582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:58.014428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.pipedrive
[0m11:39:58.024092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31929036-07b7-4731-840c-baa271ab5158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec9150>]}
[0m11:39:58.048839 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:39:58.049811 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:39:58.063951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31929036-07b7-4731-840c-baa271ab5158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bedd9a0>]}
[0m11:39:58.064135 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:39:58.064406 [warn ] [MainThread]: The selection criterion 'tag:pipedrive' does not match any enabled nodes
[0m11:39:58.064838 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:39:58.065628 [debug] [MainThread]: Command end result
[0m11:39:58.073029 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:39:58.073620 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:39:58.074901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:39:58.076228 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.25213835, "process_in_blocks": "0", "process_kernel_time": 0.12253, "process_mem_max_rss": "127909888", "process_out_blocks": "0", "process_user_time": 0.625333}
[0m11:39:58.076437 [debug] [MainThread]: Command `dbt build` succeeded at 11:39:58.076398 after 0.25 seconds
[0m11:39:58.076573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be57e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd292b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d167a00>]}
[0m11:39:58.076686 [debug] [MainThread]: Flushing usage events
[0m11:39:59.801127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:03.425018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf957f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df43890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df43b10>]}


============================== 11:40:03.426609 | fdbc798b-cdad-43e2-8b0f-6bd70f7d06d8 ==============================
[0m11:40:03.426609 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:40:03.426848 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'empty': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m11:40:03.431383 [info ] [MainThread]: dbt version: 1.11.2
[0m11:40:03.431517 [info ] [MainThread]: python version: 3.13.12
[0m11:40:03.431658 [info ] [MainThread]: python path: /Users/macbook/dbt_enpal_assessment/dbt_venv/bin/python3.13
[0m11:40:03.431789 [info ] [MainThread]: os info: macOS-26.2-arm64-arm-64bit-Mach-O
[0m11:40:03.450194 [info ] [MainThread]: Using profiles dir at /Users/macbook/dbt_enpal_assessment
[0m11:40:03.450382 [info ] [MainThread]: Using profiles.yml file at /Users/macbook/dbt_enpal_assessment/profiles.yml
[0m11:40:03.450494 [info ] [MainThread]: Using dbt_project.yml file at /Users/macbook/dbt_enpal_assessment/dbt_project.yml
[0m11:40:03.450651 [info ] [MainThread]: adapter type: postgres
[0m11:40:03.450744 [info ] [MainThread]: adapter version: 1.10.0
[0m11:40:03.483739 [info ] [MainThread]: Configuration:
[0m11:40:03.483939 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:40:03.484044 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:40:03.484130 [info ] [MainThread]: Required dependencies:
[0m11:40:03.484272 [debug] [MainThread]: Executing "git --help"
[0m11:40:03.493708 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:40:03.494091 [debug] [MainThread]: STDERR: "b''"
[0m11:40:03.494212 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:40:03.494337 [info ] [MainThread]: Connection:
[0m11:40:03.494469 [info ] [MainThread]:   host: localhost
[0m11:40:03.494557 [info ] [MainThread]:   port: 5432
[0m11:40:03.494643 [info ] [MainThread]:   user: admin
[0m11:40:03.494724 [info ] [MainThread]:   database: postgres
[0m11:40:03.494808 [info ] [MainThread]:   schema: public
[0m11:40:03.494886 [info ] [MainThread]:   connect_timeout: 10
[0m11:40:03.494972 [info ] [MainThread]:   role: None
[0m11:40:03.495053 [info ] [MainThread]:   search_path: None
[0m11:40:03.495136 [info ] [MainThread]:   keepalives_idle: 0
[0m11:40:03.495222 [info ] [MainThread]:   sslmode: None
[0m11:40:03.495301 [info ] [MainThread]:   sslcert: None
[0m11:40:03.495384 [info ] [MainThread]:   sslkey: None
[0m11:40:03.495465 [info ] [MainThread]:   sslrootcert: None
[0m11:40:03.495547 [info ] [MainThread]:   application_name: dbt
[0m11:40:03.495629 [info ] [MainThread]:   retries: 1
[0m11:40:03.495855 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:40:03.523061 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:40:03.541541 [debug] [MainThread]: Using postgres connection "debug"
[0m11:40:03.541690 [debug] [MainThread]: On debug: select 1 as id
[0m11:40:03.541783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:03.569965 [debug] [MainThread]: SQL status: SELECT 1 in 0.028 seconds
[0m11:40:03.570402 [debug] [MainThread]: On debug: Close
[0m11:40:03.570521 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:40:03.570636 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:40:03.571663 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.17041305, "process_in_blocks": "0", "process_kernel_time": 0.098202, "process_mem_max_rss": "135528448", "process_out_blocks": "0", "process_user_time": 0.544829}
[0m11:40:03.571836 [debug] [MainThread]: Command `dbt debug` succeeded at 11:40:03.571798 after 0.17 seconds
[0m11:40:03.571941 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:40:03.572057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede5e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f114830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a0d10>]}
[0m11:40:03.572194 [debug] [MainThread]: Flushing usage events
[0m11:40:05.130748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:01.868298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddfb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddfbb10>]}


============================== 11:43:01.870518 | 94407c4f-bd39-4004-af2b-0dd739fc3c5d ==============================
[0m11:43:01.870518 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:43:01.870749 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'empty': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt build --select tag:pipedrive', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:01.936135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94407c4f-bd39-4004-af2b-0dd739fc3c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0e29e0>]}
[0m11:43:01.955519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94407c4f-bd39-4004-af2b-0dd739fc3c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd5e9c0>]}
[0m11:43:01.956069 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:43:01.989073 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:43:02.018192 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:43:02.018388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94407c4f-bd39-4004-af2b-0dd739fc3c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc97250>]}
[0m11:43:02.367893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94407c4f-bd39-4004-af2b-0dd739fc3c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc697c0>]}
[0m11:43:02.390229 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:43:02.391109 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:43:02.404937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94407c4f-bd39-4004-af2b-0dd739fc3c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f27db70>]}
[0m11:43:02.405110 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:43:02.405411 [warn ] [MainThread]: The selection criterion 'tag:pipedrive' does not match any enabled nodes
[0m11:43:02.405848 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:43:02.406038 [debug] [MainThread]: Command end result
[0m11:43:02.413823 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:43:02.414371 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:43:02.415350 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:43:02.416667 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.57322145, "process_in_blocks": "0", "process_kernel_time": 0.122189, "process_mem_max_rss": "133300224", "process_out_blocks": "0", "process_user_time": 0.941235}
[0m11:43:02.416816 [debug] [MainThread]: Command `dbt build` succeeded at 11:43:02.416786 after 0.57 seconds
[0m11:43:02.416928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db7ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f177b90>]}
[0m11:43:02.417028 [debug] [MainThread]: Flushing usage events
[0m11:43:04.019263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:33.582954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9617f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b91b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b91bb10>]}


============================== 11:43:33.584638 | 88532b14-644f-4090-b097-2df255c24444 ==============================
[0m11:43:33.584638 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:43:33.584885 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --select tag:pipedrive'}
[0m11:43:33.637900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac029e0>]}
[0m11:43:33.656875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b87e9c0>]}
[0m11:43:33.657171 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:43:33.686547 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:43:33.715807 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:43:33.716017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b7250>]}
[0m11:43:34.061304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7897c0>]}
[0m11:43:34.084045 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:43:34.084875 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:43:34.093796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd9db70>]}
[0m11:43:34.093978 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:43:34.094656 [info ] [MainThread]: 
[0m11:43:34.094778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:34.094867 [info ] [MainThread]: 
[0m11:43:34.095030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:34.096332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:43:34.118754 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:43:34.118899 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:43:34.118982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:34.147708 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m11:43:34.148173 [debug] [ThreadPool]: On list_postgres: Close
[0m11:43:34.148400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_staging)
[0m11:43:34.148533 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_staging"
"
[0m11:43:34.150310 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_staging"
[0m11:43:34.150412 [debug] [ThreadPool]: On create_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_staging"} */
create schema if not exists "public_pipedrive_staging"
[0m11:43:34.150503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:34.158268 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.008 seconds
[0m11:43:34.158571 [debug] [ThreadPool]: On create_postgres_public_pipedrive_staging: COMMIT
[0m11:43:34.158659 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_staging"
[0m11:43:34.158735 [debug] [ThreadPool]: On create_postgres_public_pipedrive_staging: COMMIT
[0m11:43:34.159499 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m11:43:34.159577 [debug] [ThreadPool]: On create_postgres_public_pipedrive_staging: Close
[0m11:43:34.159965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_pipedrive_staging, now list_postgres_public_pipedrive_staging)
[0m11:43:34.161868 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m11:43:34.161992 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m11:43:34.162087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:34.171101 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m11:43:34.171763 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m11:43:34.172202 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m11:43:34.173578 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:34.173709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:43:34.173824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:34.182922 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m11:43:34.183276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfabc70>]}
[0m11:43:34.183425 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:34.183729 [debug] [MainThread]: On master: COMMIT
[0m11:43:34.183812 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:34.183887 [debug] [MainThread]: On master: COMMIT
[0m11:43:34.184352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:43:34.184442 [debug] [MainThread]: On master: Close
[0m11:43:34.185459 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m11:43:34.185625 [info ] [Thread-1 (]: 1 of 3 START sql table model public_pipedrive_staging.stg_deal_fields .......... [RUN]
[0m11:43:34.185785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_fields)
[0m11:43:34.185894 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m11:43:34.188464 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:43:34.188732 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m11:43:34.202071 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:43:34.202403 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:43:34.202510 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    select id, field_key, name, field_value_options 
from "postgres"."public"."fields"
  );
  
[0m11:43:34.202609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:34.213361 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m11:43:34.216729 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:43:34.216844 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m11:43:34.218532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:43:34.223134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:43:34.223239 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:43:34.223328 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:43:34.224513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:34.226345 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m11:43:34.227937 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:43:34.228046 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m11:43:34.228573 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:43:34.229369 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m11:43:34.230067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd8f110>]}
[0m11:43:34.230282 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public_pipedrive_staging.stg_deal_fields ..... [[32mSELECT 4[0m in 0.04s]
[0m11:43:34.230491 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m11:43:34.230607 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m11:43:34.230790 [info ] [Thread-1 (]: 2 of 3 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m11:43:34.230977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m11:43:34.231094 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m11:43:34.232052 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:43:34.232271 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m11:43:34.243268 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:43:34.243588 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:43:34.243695 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages"
  
  
    as
  
  (
    

select 
    stage_id as deal_stage_id, 
    coalesce(stage_name,'') as deal_stage_name 
from "postgres"."public"."stages"
  );
  
  
[0m11:43:34.243793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:34.255103 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.011 seconds
[0m11:43:34.255652 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m11:43:34.255762 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:43:34.255854 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m11:43:34.256798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:34.257033 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m11:43:34.257205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdd64c0>]}
[0m11:43:34.257403 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.03s]
[0m11:43:34.257580 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m11:43:34.257700 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m11:43:34.257863 [info ] [Thread-1 (]: 3 of 3 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m11:43:34.257998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m11:43:34.258105 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m11:43:34.259091 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m11:43:34.259291 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m11:43:34.260493 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m11:43:34.260665 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:43:34.260761 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_users"
  
  
    as
  
  (
    

select 
    id   as deal_user_id, 
    name as deal_user_name, 
    email as deal_user_email,
    modified as deal_user_last_modified
from "postgres"."public"."users"
  );
  
  
[0m11:43:34.260853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:34.270501 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.010 seconds
[0m11:43:34.271033 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:43:34.271139 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:43:34.271231 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:43:34.272103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:34.272329 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m11:43:34.272499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88532b14-644f-4090-b097-2df255c24444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2340f0>]}
[0m11:43:34.272701 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mSELECT 1787[0m in 0.01s]
[0m11:43:34.272881 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m11:43:34.273453 [debug] [MainThread]: On master: COMMIT
[0m11:43:34.273565 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:34.273648 [debug] [MainThread]: On master: COMMIT
[0m11:43:34.273729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:34.280356 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m11:43:34.280503 [debug] [MainThread]: On master: Close
[0m11:43:34.280648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:34.280739 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m11:43:34.280858 [info ] [MainThread]: 
[0m11:43:34.280970 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m11:43:34.281281 [debug] [MainThread]: Command end result
[0m11:43:34.289132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:43:34.289784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:43:34.292152 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:43:34.292253 [info ] [MainThread]: 
[0m11:43:34.292373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:34.292466 [info ] [MainThread]: 
[0m11:43:34.292567 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:43:34.293729 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.734391, "process_in_blocks": "0", "process_kernel_time": 0.108438, "process_mem_max_rss": "148914176", "process_out_blocks": "0", "process_user_time": 1.041382}
[0m11:43:34.293893 [debug] [MainThread]: Command `dbt build` succeeded at 11:43:34.293856 after 0.73 seconds
[0m11:43:34.294015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccca950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd21250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94ab30>]}
[0m11:43:34.294130 [debug] [MainThread]: Flushing usage events
[0m11:43:35.822613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:47.398140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf197f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ded3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ded3b10>]}


============================== 11:45:47.399806 | cb3d37cd-1570-410d-b246-0637dd1dcb46 ==============================
[0m11:45:47.399806 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:45:47.400048 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'empty': 'False', 'no_print': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select tag:pipedrive', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'partial_parse': 'True', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False'}
[0m11:45:47.453960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb3d37cd-1570-410d-b246-0637dd1dcb46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ba9e0>]}
[0m11:45:47.472970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb3d37cd-1570-410d-b246-0637dd1dcb46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de369c0>]}
[0m11:45:47.473289 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:45:47.502350 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:45:47.537607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:47.537764 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:45:47.537847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:47.548964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb3d37cd-1570-410d-b246-0637dd1dcb46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed7d150>]}
[0m11:45:47.572988 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:45:47.573731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:45:47.582543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb3d37cd-1570-410d-b246-0637dd1dcb46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df3d9a0>]}
[0m11:45:47.582712 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:45:47.583513 [info ] [MainThread]: 
[0m11:45:47.583636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:47.583730 [info ] [MainThread]: 
[0m11:45:47.583907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:47.585203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:45:47.604214 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:45:47.604380 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:45:47.604472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:47.624024 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m11:45:47.624557 [debug] [ThreadPool]: On list_postgres: Close
[0m11:45:47.625031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m11:45:47.627054 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m11:45:47.627172 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m11:45:47.627265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:47.637118 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m11:45:47.637558 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m11:45:47.637917 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m11:45:47.639446 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:47.639576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:45:47.639689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:47.649492 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m11:45:47.649933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3d37cd-1570-410d-b246-0637dd1dcb46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee5de10>]}
[0m11:45:47.650103 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:47.650494 [debug] [MainThread]: On master: COMMIT
[0m11:45:47.650585 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:47.650667 [debug] [MainThread]: On master: COMMIT
[0m11:45:47.651253 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:45:47.651346 [debug] [MainThread]: On master: Close
[0m11:45:47.652111 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m11:45:47.652279 [info ] [Thread-1 (]: 1 of 3 START sql table model public_pipedrive_staging.stg_deal_fields .......... [RUN]
[0m11:45:47.652427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_fields)
[0m11:45:47.652538 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m11:45:47.655444 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:45:47.655740 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m11:45:47.670393 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:45:47.670730 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:45:47.670844 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    select id, field_key, name, field_value_options 
from "postgres"."public"."fields"
  );
  
[0m11:45:47.670950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:47.681459 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m11:45:47.684765 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:45:47.684889 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m11:45:47.685993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:45:47.707880 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:45:47.708053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m11:45:47.709183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:45:47.714712 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:45:47.714853 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:45:47.714952 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:45:47.716911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:45:47.718830 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m11:45:47.720466 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:45:47.720578 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m11:45:47.724813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:45:47.725610 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m11:45:47.726203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb3d37cd-1570-410d-b246-0637dd1dcb46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eff6680>]}
[0m11:45:47.726414 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public_pipedrive_staging.stg_deal_fields ..... [[32mSELECT 4[0m in 0.07s]
[0m11:45:47.726619 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m11:45:47.726736 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m11:45:47.726915 [info ] [Thread-1 (]: 2 of 3 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m11:45:47.727089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m11:45:47.727201 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m11:45:47.728147 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:45:47.728393 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m11:45:47.739340 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:45:47.739473 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp114547736911"
  
  
    as
  
  (
    

select 
    stage_id as deal_stage_id, 
    coalesce(stage_name,'') as deal_stage_name 
from "postgres"."public"."stages"
  );
  
  
[0m11:45:47.739574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:47.750994 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.011 seconds
[0m11:45:47.755346 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:45:47.755472 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp114547736911'
        
      order by ordinal_position

  
[0m11:45:47.765727 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m11:45:47.767564 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:45:47.767685 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:45:47.770413 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m11:45:47.773357 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:45:47.773480 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:45:47.775747 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m11:45:47.780767 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:45:47.781065 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:45:47.781180 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (stage_id, stage_name) in (
            select distinct stage_id, stage_name
            from "stg_deal_stages__dbt_tmp114547736911" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp114547736911"
    )
  
[0m11:45:47.782157 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "stage_id" does not exist
LINE 6:             select distinct stage_id, stage_name
                                    ^

[0m11:45:47.782261 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: ROLLBACK
[0m11:45:47.782696 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m11:45:47.787138 [debug] [Thread-1 (]: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "stage_id" does not exist
  LINE 6:             select distinct stage_id, stage_name
                                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m11:45:47.787316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb3d37cd-1570-410d-b246-0637dd1dcb46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef54590>]}
[0m11:45:47.787532 [error] [Thread-1 (]: 2 of 3 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_stages  [[31mERROR[0m in 0.06s]
[0m11:45:47.787731 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m11:45:47.787858 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m11:45:47.788030 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "stage_id" does not exist
  LINE 6:             select distinct stage_id, stage_name
                                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql.
[0m11:45:47.788191 [info ] [Thread-1 (]: 3 of 3 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m11:45:47.788491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m11:45:47.788647 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m11:45:47.789891 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m11:45:47.790113 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m11:45:47.791360 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:45:47.791484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp114547790798"
  
  
    as
  
  (
    

select 
    id   as deal_user_id, 
    name as deal_user_name, 
    email as deal_user_email,
    modified as deal_user_last_modified
from "postgres"."public"."users"
  );
  
  
[0m11:45:47.791595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:47.802746 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.011 seconds
[0m11:45:47.804072 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:45:47.804215 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp114547790798'
        
      order by ordinal_position

  
[0m11:45:47.810326 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m11:45:47.811318 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:45:47.811438 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:45:47.814294 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m11:45:47.815340 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:45:47.815462 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:45:47.818284 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m11:45:47.819191 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m11:45:47.819471 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:45:47.819583 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (user_id) in (
            select distinct user_id
            from "stg_deal_users__dbt_tmp114547790798" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp114547790798"
    )
  
[0m11:45:47.820164 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "user_id" does not exist
LINE 8:             select distinct user_id
                                    ^

[0m11:45:47.820318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: ROLLBACK
[0m11:45:47.820708 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m11:45:47.822278 [debug] [Thread-1 (]: Database Error in model stg_deal_users (models/staging/pipedrive/stg_deal_users.sql)
  column "user_id" does not exist
  LINE 8:             select distinct user_id
                                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_users.sql
[0m11:45:47.822472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb3d37cd-1570-410d-b246-0637dd1dcb46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efa1d30>]}
[0m11:45:47.822709 [error] [Thread-1 (]: 3 of 3 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_users  [[31mERROR[0m in 0.03s]
[0m11:45:47.822904 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m11:45:47.823079 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_users (models/staging/pipedrive/stg_deal_users.sql)
  column "user_id" does not exist
  LINE 8:             select distinct user_id
                                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_users.sql.
[0m11:45:47.823538 [debug] [MainThread]: On master: COMMIT
[0m11:45:47.823641 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:47.823725 [debug] [MainThread]: On master: COMMIT
[0m11:45:47.823807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:47.830870 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m11:45:47.831038 [debug] [MainThread]: On master: Close
[0m11:45:47.831198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:47.831287 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m11:45:47.831415 [info ] [MainThread]: 
[0m11:45:47.831529 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m11:45:47.831871 [debug] [MainThread]: Command end result
[0m11:45:47.839988 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:45:47.840738 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:45:47.843361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:45:47.843476 [info ] [MainThread]: 
[0m11:45:47.843597 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:45:47.843693 [info ] [MainThread]: 
[0m11:45:47.843818 [error] [MainThread]: [31mFailure in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)[0m
[0m11:45:47.843934 [error] [MainThread]:   Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "stage_id" does not exist
  LINE 6:             select distinct stage_id, stage_name
                                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m11:45:47.844048 [info ] [MainThread]: 
[0m11:45:47.844153 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m11:45:47.844238 [info ] [MainThread]: 
[0m11:45:47.844347 [error] [MainThread]: [31mFailure in model stg_deal_users (models/staging/pipedrive/stg_deal_users.sql)[0m
[0m11:45:47.844455 [error] [MainThread]:   Database Error in model stg_deal_users (models/staging/pipedrive/stg_deal_users.sql)
  column "user_id" does not exist
  LINE 8:             select distinct user_id
                                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_users.sql
[0m11:45:47.844537 [info ] [MainThread]: 
[0m11:45:47.844635 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_users.sql
[0m11:45:47.844724 [info ] [MainThread]: 
[0m11:45:47.844824 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m11:45:47.846049 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.47241226, "process_in_blocks": "0", "process_kernel_time": 0.114484, "process_mem_max_rss": "143982592", "process_out_blocks": "0", "process_user_time": 0.764806}
[0m11:45:47.846199 [debug] [MainThread]: Command `dbt build` failed at 11:45:47.846167 after 0.47 seconds
[0m11:45:47.846328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3fb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef9b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e59acd0>]}
[0m11:45:47.846451 [debug] [MainThread]: Flushing usage events
[0m11:45:49.389453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:31.081786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac617f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc1b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc1bb10>]}


============================== 11:46:31.083457 | 372b0ee4-1c07-4cc7-816a-b6eec6e4caf5 ==============================
[0m11:46:31.083457 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:46:31.083705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt build --select tag:pipedrive', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs'}
[0m11:46:31.137232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '372b0ee4-1c07-4cc7-816a-b6eec6e4caf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af029e0>]}
[0m11:46:31.156207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '372b0ee4-1c07-4cc7-816a-b6eec6e4caf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb7e9c0>]}
[0m11:46:31.156531 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:46:31.186294 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:46:31.221627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:46:31.221873 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m11:46:31.222004 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m11:46:31.301024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '372b0ee4-1c07-4cc7-816a-b6eec6e4caf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbc6550>]}
[0m11:46:31.325445 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:46:31.326165 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:46:31.356580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '372b0ee4-1c07-4cc7-816a-b6eec6e4caf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc859a0>]}
[0m11:46:31.356781 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:46:31.357564 [info ] [MainThread]: 
[0m11:46:31.357724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:31.357821 [info ] [MainThread]: 
[0m11:46:31.357988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:31.359294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:46:31.377778 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:46:31.377941 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:46:31.378035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:31.396510 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m11:46:31.396995 [debug] [ThreadPool]: On list_postgres: Close
[0m11:46:31.397451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m11:46:31.399474 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m11:46:31.399607 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m11:46:31.399713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:31.409713 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m11:46:31.410216 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m11:46:31.410605 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m11:46:31.412151 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:31.412284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:46:31.412393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:31.422474 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m11:46:31.422842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372b0ee4-1c07-4cc7-816a-b6eec6e4caf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdaaf90>]}
[0m11:46:31.422995 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:31.423372 [debug] [MainThread]: On master: COMMIT
[0m11:46:31.423457 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:31.423541 [debug] [MainThread]: On master: COMMIT
[0m11:46:31.424144 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:46:31.424240 [debug] [MainThread]: On master: Close
[0m11:46:31.425264 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m11:46:31.425429 [info ] [Thread-1 (]: 1 of 3 START sql table model public_pipedrive_staging.stg_deal_fields .......... [RUN]
[0m11:46:31.425578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_fields)
[0m11:46:31.425694 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m11:46:31.428285 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:31.428572 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m11:46:31.442118 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:31.442436 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:31.442546 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    select id, field_key, name, field_value_options 
from "postgres"."public"."fields"
  );
  
[0m11:46:31.442644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:31.453599 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m11:46:31.456787 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:31.456946 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m11:46:31.457604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:31.458630 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:31.458737 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m11:46:31.459237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:46:31.464541 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:46:31.464663 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:31.464759 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:46:31.465715 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:46:31.467638 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m11:46:31.469113 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:31.469221 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m11:46:31.471873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:46:31.472640 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m11:46:31.473192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372b0ee4-1c07-4cc7-816a-b6eec6e4caf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d291bf0>]}
[0m11:46:31.473396 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public_pipedrive_staging.stg_deal_fields ..... [[32mSELECT 4[0m in 0.05s]
[0m11:46:31.473603 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m11:46:31.473730 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m11:46:31.473906 [info ] [Thread-1 (]: 2 of 3 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m11:46:31.474073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m11:46:31.474182 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m11:46:31.475117 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:31.475322 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m11:46:31.485863 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:31.485997 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp114631483462"
  
  
    as
  
  (
    

select 
    stage_id as deal_stage_id, 
    coalesce(stage_name,'') as deal_stage_name 
from "postgres"."public"."stages"
  );
  
  
[0m11:46:31.486102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:31.496733 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.011 seconds
[0m11:46:31.501090 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:31.501222 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp114631483462'
        
      order by ordinal_position

  
[0m11:46:31.507731 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m11:46:31.509524 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:31.509637 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:31.512549 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m11:46:31.515292 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:31.515400 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:31.518522 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m11:46:31.523089 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:31.523369 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:31.523478 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (deal_stage_id, deal_stage_name) in (
            select distinct deal_stage_id, deal_stage_name
            from "stg_deal_stages__dbt_tmp114631483462" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp114631483462"
    )
  
[0m11:46:31.526290 [debug] [Thread-1 (]: SQL status: INSERT 0 9 in 0.003 seconds
[0m11:46:31.526770 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m11:46:31.526883 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:31.526976 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m11:46:31.528216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:46:31.528450 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m11:46:31.528639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372b0ee4-1c07-4cc7-816a-b6eec6e4caf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ced7650>]}
[0m11:46:31.528850 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mINSERT 0 9[0m in 0.05s]
[0m11:46:31.529041 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m11:46:31.529168 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m11:46:31.529339 [info ] [Thread-1 (]: 3 of 3 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m11:46:31.529474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m11:46:31.529584 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m11:46:31.532011 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m11:46:31.532234 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m11:46:31.533341 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:31.533447 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp114631532826"
  
  
    as
  
  (
    

select 
    id   as deal_user_id, 
    name as deal_user_name, 
    email as deal_user_email,
    modified as deal_user_last_modified
from "postgres"."public"."users"
  );
  
  
[0m11:46:31.533545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:31.542823 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.009 seconds
[0m11:46:31.544030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:31.544165 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp114631532826'
        
      order by ordinal_position

  
[0m11:46:31.550444 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m11:46:31.551421 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:31.551539 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:31.554820 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m11:46:31.555757 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:31.555867 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:31.557837 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m11:46:31.558777 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m11:46:31.559043 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:31.559155 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (deal_user_id) in (
            select distinct deal_user_id
            from "stg_deal_users__dbt_tmp114631532826" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp114631532826"
    )
  
[0m11:46:31.562783 [debug] [Thread-1 (]: SQL status: INSERT 0 1787 in 0.003 seconds
[0m11:46:31.563359 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:46:31.563493 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:31.563600 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:46:31.564814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:46:31.565082 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m11:46:31.565282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372b0ee4-1c07-4cc7-816a-b6eec6e4caf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce9a200>]}
[0m11:46:31.565506 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mINSERT 0 1787[0m in 0.04s]
[0m11:46:31.565698 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m11:46:31.566171 [debug] [MainThread]: On master: COMMIT
[0m11:46:31.566301 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:31.566395 [debug] [MainThread]: On master: COMMIT
[0m11:46:31.566478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:31.571645 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m11:46:31.571756 [debug] [MainThread]: On master: Close
[0m11:46:31.571883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:31.571968 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m11:46:31.572147 [info ] [MainThread]: 
[0m11:46:31.572278 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m11:46:31.572671 [debug] [MainThread]: Command end result
[0m11:46:31.580791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:46:31.581512 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:46:31.583584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:46:31.583696 [info ] [MainThread]: 
[0m11:46:31.583817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:31.583906 [info ] [MainThread]: 
[0m11:46:31.584021 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:46:31.585214 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.52696157, "process_in_blocks": "0", "process_kernel_time": 0.117398, "process_mem_max_rss": "145784832", "process_out_blocks": "0", "process_user_time": 0.81939}
[0m11:46:31.585364 [debug] [MainThread]: Command `dbt build` succeeded at 11:46:31.585334 after 0.53 seconds
[0m11:46:31.585479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1bb930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce682d0>]}
[0m11:46:31.585589 [debug] [MainThread]: Flushing usage events
[0m11:46:33.150664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:35.622672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe7b10>]}


============================== 11:46:35.624351 | 0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb ==============================
[0m11:46:35.624351 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:46:35.624598 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'invocation_command': 'dbt build --select tag:pipedrive', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'indirect_selection': 'eager'}
[0m11:46:35.678234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ce9e0>]}
[0m11:46:35.697500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4a9c0>]}
[0m11:46:35.697799 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:46:35.727890 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:46:35.762665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:35.762812 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:46:35.762898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:35.774263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b03d150>]}
[0m11:46:35.798524 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:46:35.799240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:46:35.807921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0519a0>]}
[0m11:46:35.808106 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:46:35.808942 [info ] [MainThread]: 
[0m11:46:35.809070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:35.809164 [info ] [MainThread]: 
[0m11:46:35.809335 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:35.810632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:46:35.827144 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:46:35.827323 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:46:35.827418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:35.845878 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m11:46:35.846377 [debug] [ThreadPool]: On list_postgres: Close
[0m11:46:35.846821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m11:46:35.848828 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m11:46:35.848957 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m11:46:35.849056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:35.858813 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m11:46:35.859220 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m11:46:35.859603 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m11:46:35.861059 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:35.861182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:46:35.861286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:35.871029 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m11:46:35.871434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b119e10>]}
[0m11:46:35.871588 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:35.871997 [debug] [MainThread]: On master: COMMIT
[0m11:46:35.872084 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:35.872161 [debug] [MainThread]: On master: COMMIT
[0m11:46:35.872771 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:46:35.872862 [debug] [MainThread]: On master: Close
[0m11:46:35.873640 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m11:46:35.873807 [info ] [Thread-1 (]: 1 of 3 START sql table model public_pipedrive_staging.stg_deal_fields .......... [RUN]
[0m11:46:35.873958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_fields)
[0m11:46:35.874068 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m11:46:35.876994 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:35.877264 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m11:46:35.892778 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:35.893125 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:35.893241 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    select id, field_key, name, field_value_options 
from "postgres"."public"."fields"
  );
  
[0m11:46:35.893343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:35.905316 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.012 seconds
[0m11:46:35.908486 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:35.908592 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m11:46:35.909220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:35.931862 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:35.932037 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m11:46:35.933121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:35.938571 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:46:35.938711 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:35.938836 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:46:35.940670 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:46:35.942613 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m11:46:35.944256 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:35.944369 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m11:46:35.947175 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:46:35.947979 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m11:46:35.948561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2aa680>]}
[0m11:46:35.948772 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public_pipedrive_staging.stg_deal_fields ..... [[32mSELECT 4[0m in 0.07s]
[0m11:46:35.948968 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m11:46:35.949103 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m11:46:35.949289 [info ] [Thread-1 (]: 2 of 3 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m11:46:35.949478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m11:46:35.949601 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m11:46:35.950558 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:35.950802 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m11:46:35.961946 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:35.962085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp114635959430"
  
  
    as
  
  (
    

select 
    stage_id as deal_stage_id, 
    coalesce(stage_name,'') as deal_stage_name 
from "postgres"."public"."stages"
  );
  
  
[0m11:46:35.962184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:35.974115 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.012 seconds
[0m11:46:35.978457 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:35.978591 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp114635959430'
        
      order by ordinal_position

  
[0m11:46:35.985798 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m11:46:35.987619 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:35.987741 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:35.990443 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m11:46:35.993408 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:35.993534 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:35.995844 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m11:46:36.000958 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:36.001244 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:36.001361 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (deal_stage_id, deal_stage_name) in (
            select distinct deal_stage_id, deal_stage_name
            from "stg_deal_stages__dbt_tmp114635959430" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp114635959430"
    )
  
[0m11:46:36.003315 [debug] [Thread-1 (]: SQL status: INSERT 0 9 in 0.002 seconds
[0m11:46:36.003776 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m11:46:36.003883 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:36.003978 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m11:46:36.005230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:46:36.005477 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m11:46:36.005667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b214590>]}
[0m11:46:36.005874 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mINSERT 0 9[0m in 0.06s]
[0m11:46:36.006062 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m11:46:36.006187 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m11:46:36.006378 [info ] [Thread-1 (]: 3 of 3 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m11:46:36.006534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m11:46:36.006648 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m11:46:36.007796 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m11:46:36.008003 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m11:46:36.009178 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:36.009292 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp114636008639"
  
  
    as
  
  (
    

select 
    id   as deal_user_id, 
    name as deal_user_name, 
    email as deal_user_email,
    modified as deal_user_last_modified
from "postgres"."public"."users"
  );
  
  
[0m11:46:36.009394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:36.019396 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.010 seconds
[0m11:46:36.020510 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:36.020638 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp114636008639'
        
      order by ordinal_position

  
[0m11:46:36.026275 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m11:46:36.027262 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:36.027383 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:36.030300 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m11:46:36.031248 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:36.031510 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:36.034387 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m11:46:36.035034 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m11:46:36.035300 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:36.035414 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (deal_user_id) in (
            select distinct deal_user_id
            from "stg_deal_users__dbt_tmp114636008639" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp114636008639"
    )
  
[0m11:46:36.040295 [debug] [Thread-1 (]: SQL status: INSERT 0 1787 in 0.005 seconds
[0m11:46:36.040823 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:46:36.040935 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:36.041049 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:46:36.042744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:46:36.042974 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m11:46:36.043158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bdd57ac-e18b-42e2-9f5e-46f2fa9ecbbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2610d0>]}
[0m11:46:36.043370 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mINSERT 0 1787[0m in 0.04s]
[0m11:46:36.043551 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m11:46:36.043989 [debug] [MainThread]: On master: COMMIT
[0m11:46:36.044100 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:36.044190 [debug] [MainThread]: On master: COMMIT
[0m11:46:36.044271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:36.051689 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m11:46:36.051795 [debug] [MainThread]: On master: Close
[0m11:46:36.051919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:36.052004 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m11:46:36.052120 [info ] [MainThread]: 
[0m11:46:36.052224 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m11:46:36.052531 [debug] [MainThread]: Command end result
[0m11:46:36.061005 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:46:36.061741 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:46:36.063955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:46:36.064064 [info ] [MainThread]: 
[0m11:46:36.064191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:36.064279 [info ] [MainThread]: 
[0m11:46:36.064395 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:46:36.065573 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.46646014, "process_in_blocks": "0", "process_kernel_time": 0.100854, "process_mem_max_rss": "143376384", "process_out_blocks": "0", "process_user_time": 0.75705}
[0m11:46:36.065717 [debug] [MainThread]: Command `dbt build` succeeded at 11:46:36.065688 after 0.47 seconds
[0m11:46:36.065831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b25bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789b4d0>]}
[0m11:46:36.065955 [debug] [MainThread]: Flushing usage events
[0m11:46:37.618995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:52.329070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088357f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ef890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097efb10>]}


============================== 11:46:52.330689 | 6fd1d8e1-5e3a-4aef-9484-fb8da0091688 ==============================
[0m11:46:52.330689 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:46:52.330932 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select tag:pipedrive', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'False', 'introspect': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80'}
[0m11:46:52.383475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fd1d8e1-5e3a-4aef-9484-fb8da0091688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad69e0>]}
[0m11:46:52.402154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fd1d8e1-5e3a-4aef-9484-fb8da0091688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097529c0>]}
[0m11:46:52.402479 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:46:52.431818 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:46:52.466574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:52.466739 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:46:52.466830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:52.478206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fd1d8e1-5e3a-4aef-9484-fb8da0091688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a799150>]}
[0m11:46:52.502466 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:46:52.503205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:46:52.511953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fd1d8e1-5e3a-4aef-9484-fb8da0091688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098599a0>]}
[0m11:46:52.512124 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m11:46:52.512933 [info ] [MainThread]: 
[0m11:46:52.513049 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:52.513137 [info ] [MainThread]: 
[0m11:46:52.513314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:52.514610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:46:52.530909 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:46:52.531073 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:46:52.531167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:52.553260 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.022 seconds
[0m11:46:52.553797 [debug] [ThreadPool]: On list_postgres: Close
[0m11:46:52.554246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m11:46:52.556240 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m11:46:52.556352 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m11:46:52.556439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:52.566693 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m11:46:52.567182 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m11:46:52.567601 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m11:46:52.569223 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:52.569364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:46:52.569474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:52.579999 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m11:46:52.580392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd1d8e1-5e3a-4aef-9484-fb8da0091688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a885e10>]}
[0m11:46:52.580541 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:52.580945 [debug] [MainThread]: On master: COMMIT
[0m11:46:52.581034 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:52.581109 [debug] [MainThread]: On master: COMMIT
[0m11:46:52.581725 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:46:52.581811 [debug] [MainThread]: On master: Close
[0m11:46:52.582552 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m11:46:52.582726 [info ] [Thread-1 (]: 1 of 3 START sql table model public_pipedrive_staging.stg_deal_fields .......... [RUN]
[0m11:46:52.582874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_fields)
[0m11:46:52.582983 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m11:46:52.585977 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:52.586268 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m11:46:52.601526 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:52.601868 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:52.601980 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    select id, field_key, name, field_value_options 
from "postgres"."public"."fields"
  );
  
[0m11:46:52.602080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:52.612250 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m11:46:52.615514 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:52.615640 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m11:46:52.616254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:52.639400 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:52.639586 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m11:46:52.641202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:52.646703 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:46:52.646840 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:52.646939 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m11:46:52.649109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:46:52.651000 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m11:46:52.652646 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m11:46:52.652759 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m11:46:52.656020 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:46:52.656837 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m11:46:52.657429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fd1d8e1-5e3a-4aef-9484-fb8da0091688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa06680>]}
[0m11:46:52.657640 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public_pipedrive_staging.stg_deal_fields ..... [[32mSELECT 4[0m in 0.07s]
[0m11:46:52.657845 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m11:46:52.657960 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m11:46:52.658141 [info ] [Thread-1 (]: 2 of 3 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m11:46:52.658316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m11:46:52.658425 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m11:46:52.659369 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:52.659599 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m11:46:52.670614 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:52.670776 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp114652668111"
  
  
    as
  
  (
    

select 
    stage_id as deal_stage_id, 
    coalesce(stage_name,'') as deal_stage_name 
from "postgres"."public"."stages"
  );
  
  
[0m11:46:52.670883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:52.682224 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.011 seconds
[0m11:46:52.686551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:52.686682 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp114652668111'
        
      order by ordinal_position

  
[0m11:46:52.693790 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m11:46:52.695583 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:52.695712 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:52.698549 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m11:46:52.701543 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:52.701663 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:52.703965 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m11:46:52.709019 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:52.709314 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:52.709431 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (deal_stage_id, deal_stage_name) in (
            select distinct deal_stage_id, deal_stage_name
            from "stg_deal_stages__dbt_tmp114652668111" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp114652668111"
    )
  
[0m11:46:52.710949 [debug] [Thread-1 (]: SQL status: INSERT 0 9 in 0.001 seconds
[0m11:46:52.711381 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m11:46:52.711526 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m11:46:52.711616 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m11:46:52.712664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:46:52.712911 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m11:46:52.713102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fd1d8e1-5e3a-4aef-9484-fb8da0091688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a970350>]}
[0m11:46:52.713313 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mINSERT 0 9[0m in 0.05s]
[0m11:46:52.713503 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m11:46:52.713628 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m11:46:52.713797 [info ] [Thread-1 (]: 3 of 3 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m11:46:52.713928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m11:46:52.714036 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m11:46:52.715167 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m11:46:52.715378 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m11:46:52.716594 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:52.716711 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp114652716042"
  
  
    as
  
  (
    

select 
    id   as deal_user_id, 
    name as deal_user_name, 
    email as deal_user_email,
    modified as deal_user_last_modified
from "postgres"."public"."users"
  );
  
  
[0m11:46:52.716814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:52.726224 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.009 seconds
[0m11:46:52.727426 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:52.727552 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp114652716042'
        
      order by ordinal_position

  
[0m11:46:52.733715 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m11:46:52.734635 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:52.734749 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:52.737628 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m11:46:52.738567 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:52.738827 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m11:46:52.740824 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m11:46:52.741486 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m11:46:52.741764 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:52.741877 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (deal_user_id) in (
            select distinct deal_user_id
            from "stg_deal_users__dbt_tmp114652716042" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp114652716042"
    )
  
[0m11:46:52.744716 [debug] [Thread-1 (]: SQL status: INSERT 0 1787 in 0.003 seconds
[0m11:46:52.745250 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:46:52.745377 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m11:46:52.745479 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m11:46:52.746122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:46:52.746402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m11:46:52.746606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fd1d8e1-5e3a-4aef-9484-fb8da0091688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bc890>]}
[0m11:46:52.746828 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mINSERT 0 1787[0m in 0.03s]
[0m11:46:52.747009 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m11:46:52.747467 [debug] [MainThread]: On master: COMMIT
[0m11:46:52.747579 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:52.747670 [debug] [MainThread]: On master: COMMIT
[0m11:46:52.747750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:52.752050 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m11:46:52.752174 [debug] [MainThread]: On master: Close
[0m11:46:52.752307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:52.752391 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m11:46:52.752513 [info ] [MainThread]: 
[0m11:46:52.752618 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m11:46:52.752960 [debug] [MainThread]: Command end result
[0m11:46:52.761356 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m11:46:52.762072 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:46:52.764279 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m11:46:52.764387 [info ] [MainThread]: 
[0m11:46:52.764511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:52.764598 [info ] [MainThread]: 
[0m11:46:52.764702 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:46:52.765919 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.46073654, "process_in_blocks": "0", "process_kernel_time": 0.099897, "process_mem_max_rss": "143360000", "process_out_blocks": "0", "process_user_time": 0.759614}
[0m11:46:52.766094 [debug] [MainThread]: Command `dbt build` succeeded at 11:46:52.766055 after 0.46 seconds
[0m11:46:52.766229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae12490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070974d0>]}
[0m11:46:52.766351 [debug] [MainThread]: Flushing usage events
[0m11:46:54.322708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:07.811818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac2d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe7b10>]}


============================== 12:29:07.814090 | a8cc3dad-175f-454f-939f-0dbc5f27c055 ==============================
[0m12:29:07.814090 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:29:07.814325 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'empty': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select tag:pipedrive', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m12:29:07.886973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8cc3dad-175f-454f-939f-0dbc5f27c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aece9e0>]}
[0m12:29:07.906076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8cc3dad-175f-454f-939f-0dbc5f27c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb4a9c0>]}
[0m12:29:07.906514 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:29:07.938844 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:29:07.981029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m12:29:07.981258 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m12:29:07.981390 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m12:29:07.981501 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m12:29:08.063019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8cc3dad-175f-454f-939f-0dbc5f27c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc3e650>]}
[0m12:29:08.087114 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:29:08.088021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:29:08.123662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8cc3dad-175f-454f-939f-0dbc5f27c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc519a0>]}
[0m12:29:08.123873 [info ] [MainThread]: Found 3 models, 6 sources, 464 macros
[0m12:29:08.124581 [info ] [MainThread]: 
[0m12:29:08.124715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:08.124811 [info ] [MainThread]: 
[0m12:29:08.124978 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:08.126280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:29:08.147648 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:29:08.147810 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:29:08.147902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:08.179055 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.031 seconds
[0m12:29:08.179586 [debug] [ThreadPool]: On list_postgres: Close
[0m12:29:08.180055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m12:29:08.182065 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m12:29:08.182175 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m12:29:08.182263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:08.191803 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m12:29:08.192259 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m12:29:08.192638 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m12:29:08.194133 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.194280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:29:08.194393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:08.203613 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m12:29:08.204006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8cc3dad-175f-454f-939f-0dbc5f27c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce1e7b0>]}
[0m12:29:08.204161 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:08.204541 [debug] [MainThread]: On master: COMMIT
[0m12:29:08.204626 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.204704 [debug] [MainThread]: On master: COMMIT
[0m12:29:08.205277 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:08.205366 [debug] [MainThread]: On master: Close
[0m12:29:08.206396 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m12:29:08.206562 [info ] [Thread-1 (]: 1 of 3 START sql table model public_pipedrive_staging.stg_deal_fields .......... [RUN]
[0m12:29:08.206710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_fields)
[0m12:29:08.206821 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m12:29:08.209401 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:29:08.209646 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m12:29:08.223380 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:29:08.223734 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:29:08.223865 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    SELECT
  id,
  field_key,
  name,
  field_value_options
FROM "postgres"."public"."fields"
  );
  
[0m12:29:08.223978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:08.232377 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:29:08.235605 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:29:08.235728 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m12:29:08.236282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:29:08.237315 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:29:08.237419 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m12:29:08.238042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:29:08.243136 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:29:08.243249 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:29:08.243339 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:29:08.244757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:29:08.246528 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m12:29:08.248114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:29:08.248222 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m12:29:08.251094 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:29:08.251863 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m12:29:08.252567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cc3dad-175f-454f-939f-0dbc5f27c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2f5b20>]}
[0m12:29:08.252771 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public_pipedrive_staging.stg_deal_fields ..... [[32mSELECT 4[0m in 0.05s]
[0m12:29:08.252957 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m12:29:08.253073 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m12:29:08.253273 [info ] [Thread-1 (]: 2 of 3 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m12:29:08.253466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m12:29:08.253579 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m12:29:08.254512 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:29:08.254719 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m12:29:08.265384 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:29:08.265523 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp122908262745"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m12:29:08.265630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:08.275666 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.010 seconds
[0m12:29:08.280213 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:29:08.280363 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp122908262745'
        
      order by ordinal_position

  
[0m12:29:08.287868 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m12:29:08.289672 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:29:08.289789 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:29:08.292564 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m12:29:08.295459 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:29:08.295566 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:29:08.298392 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m12:29:08.303343 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:29:08.303682 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:29:08.303805 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (deal_stage_id, deal_stage_name) in (
            select distinct deal_stage_id, deal_stage_name
            from "stg_deal_stages__dbt_tmp122908262745" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp122908262745"
    )
  
[0m12:29:08.305710 [debug] [Thread-1 (]: SQL status: INSERT 0 9 in 0.002 seconds
[0m12:29:08.306214 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:29:08.306326 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:29:08.306423 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:29:08.307499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:29:08.307745 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m12:29:08.307943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cc3dad-175f-454f-939f-0dbc5f27c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf534d0>]}
[0m12:29:08.308159 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mINSERT 0 9[0m in 0.05s]
[0m12:29:08.308350 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m12:29:08.308477 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m12:29:08.308650 [info ] [Thread-1 (]: 3 of 3 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m12:29:08.308786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m12:29:08.308895 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m12:29:08.311484 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m12:29:08.311726 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m12:29:08.312938 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:29:08.313049 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp122908312392"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m12:29:08.313145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:08.323072 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.010 seconds
[0m12:29:08.324394 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:29:08.324531 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp122908312392'
        
      order by ordinal_position

  
[0m12:29:08.331246 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m12:29:08.332219 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:29:08.332338 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:29:08.335445 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:29:08.336394 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:29:08.336516 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:29:08.338709 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m12:29:08.339606 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m12:29:08.339886 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:29:08.339998 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (deal_user_id) in (
            select distinct deal_user_id
            from "stg_deal_users__dbt_tmp122908312392" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp122908312392"
    )
  
[0m12:29:08.344050 [debug] [Thread-1 (]: SQL status: INSERT 0 1787 in 0.004 seconds
[0m12:29:08.344513 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:29:08.344625 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:29:08.344723 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:29:08.346331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:29:08.346566 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m12:29:08.346753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cc3dad-175f-454f-939f-0dbc5f27c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf228e0>]}
[0m12:29:08.346967 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mINSERT 0 1787[0m in 0.04s]
[0m12:29:08.347154 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m12:29:08.347601 [debug] [MainThread]: On master: COMMIT
[0m12:29:08.347720 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.347809 [debug] [MainThread]: On master: COMMIT
[0m12:29:08.347889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:08.354046 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m12:29:08.354201 [debug] [MainThread]: On master: Close
[0m12:29:08.354343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:08.354430 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m12:29:08.354544 [info ] [MainThread]: 
[0m12:29:08.354649 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:29:08.354982 [debug] [MainThread]: Command end result
[0m12:29:08.363256 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:29:08.363948 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:29:08.366336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m12:29:08.366435 [info ] [MainThread]: 
[0m12:29:08.366553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:08.366645 [info ] [MainThread]: 
[0m12:29:08.366749 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:29:08.368302 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.5823105, "process_in_blocks": "0", "process_kernel_time": 0.133902, "process_mem_max_rss": "145948672", "process_out_blocks": "0", "process_user_time": 0.836481}
[0m12:29:08.368453 [debug] [MainThread]: Command `dbt build` succeeded at 12:29:08.368422 after 0.58 seconds
[0m12:29:08.368567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2f2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c33f050>]}
[0m12:29:08.368679 [debug] [MainThread]: Flushing usage events
[0m12:29:09.889768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:58.716450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109593890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109593b10>]}


============================== 12:41:58.718839 | d8d0662a-adb9-40e5-afa4-fc58fe18de25 ==============================
[0m12:41:58.718839 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:41:58.719075 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --select tag:pipedrive', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'empty': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment'}
[0m12:41:58.786634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d0662a-adb9-40e5-afa4-fc58fe18de25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088769e0>]}
[0m12:41:58.805800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d0662a-adb9-40e5-afa4-fc58fe18de25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f29c0>]}
[0m12:41:58.806366 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:41:58.839043 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:41:58.880283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:41:58.880507 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m12:41:58.880643 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m12:41:58.940573 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_deal_activities' (models/staging/pipedrive/stg_deal_activities.sql) depends on a source named 'pipedrive.activity' which was not found
[0m12:41:58.942155 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.25136763, "process_in_blocks": "0", "process_kernel_time": 0.118701, "process_mem_max_rss": "128204800", "process_out_blocks": "0", "process_user_time": 0.628292}
[0m12:41:58.942337 [debug] [MainThread]: Command `dbt build` failed at 12:41:58.942301 after 0.25 seconds
[0m12:41:58.942469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5e6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d8aa0>]}
[0m12:41:58.942591 [debug] [MainThread]: Flushing usage events
[0m12:42:00.714391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:19.875354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de2f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de2fb10>]}


============================== 12:42:19.877592 | 922ceac0-93e3-412a-8d33-c640e02eaf0f ==============================
[0m12:42:19.877592 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:42:19.877821 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:pipedrive', 'empty': 'False', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True'}
[0m12:42:19.936083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1169e0>]}
[0m12:42:19.955414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd929c0>]}
[0m12:42:19.955882 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:42:19.990074 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:42:20.032200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:42:20.032437 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m12:42:20.032571 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m12:42:20.115320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee86550>]}
[0m12:42:20.141158 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:42:20.142325 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:42:20.181323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de999a0>]}
[0m12:42:20.181532 [info ] [MainThread]: Found 4 models, 6 sources, 464 macros
[0m12:42:20.182279 [info ] [MainThread]: 
[0m12:42:20.182419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:20.182512 [info ] [MainThread]: 
[0m12:42:20.182679 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:42:20.184145 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:42:20.206073 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:42:20.206256 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:42:20.206352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:20.248704 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.042 seconds
[0m12:42:20.249250 [debug] [ThreadPool]: On list_postgres: Close
[0m12:42:20.249784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m12:42:20.251912 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m12:42:20.252029 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m12:42:20.252123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:20.262949 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m12:42:20.263421 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m12:42:20.263816 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m12:42:20.265354 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:20.265502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:42:20.265611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:20.276798 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m12:42:20.277208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e58b850>]}
[0m12:42:20.277364 [debug] [MainThread]: On master: ROLLBACK
[0m12:42:20.277762 [debug] [MainThread]: On master: COMMIT
[0m12:42:20.277852 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:20.277929 [debug] [MainThread]: On master: COMMIT
[0m12:42:20.278441 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:20.278525 [debug] [MainThread]: On master: Close
[0m12:42:20.279907 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m12:42:20.280111 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m12:42:20.280283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m12:42:20.280399 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m12:42:20.283253 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:42:20.283523 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m12:42:20.303202 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:42:20.303581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:42:20.303709 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activities"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m12:42:20.303815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:20.317228 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m12:42:20.323368 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:42:20.323527 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:42:20.323635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:42:20.325228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:42:20.325952 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m12:42:20.326907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f550c80>]}
[0m12:42:20.327164 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mSELECT 4579[0m in 0.05s]
[0m12:42:20.327360 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m12:42:20.327494 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m12:42:20.327697 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m12:42:20.327836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_fields)
[0m12:42:20.327947 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m12:42:20.329520 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:42:20.329829 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m12:42:20.331819 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:42:20.331943 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp124220330552"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m12:42:20.332047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:20.339720 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:42:20.344982 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:42:20.345147 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp124220330552'
        
      order by ordinal_position

  
[0m12:42:20.352047 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m12:42:20.353930 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:42:20.354049 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:42:20.357391 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:42:20.360416 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:42:20.360537 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:42:20.364071 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:42:20.369191 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:42:20.369530 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:42:20.369645 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        where (deal_field_key) in (
            select distinct deal_field_key
            from "stg_deal_fields__dbt_tmp124220330552" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_fields" ("id", "field_key", "name", "field_value_options")
    (
        select "id", "field_key", "name", "field_value_options"
        from "stg_deal_fields__dbt_tmp124220330552"
    )
  
[0m12:42:20.371235 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "deal_field_key" does not exist
LINE 7:         where (deal_field_key) in (
                       ^

[0m12:42:20.371338 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: ROLLBACK
[0m12:42:20.371785 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m12:42:20.376399 [debug] [Thread-1 (]: Database Error in model stg_deal_fields (models/staging/pipedrive/stg_deal_fields.sql)
  column "deal_field_key" does not exist
  LINE 7:         where (deal_field_key) in (
                         ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_fields.sql
[0m12:42:20.376580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f19b410>]}
[0m12:42:20.376800 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_fields  [[31mERROR[0m in 0.05s]
[0m12:42:20.377002 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m12:42:20.377131 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m12:42:20.377319 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_fields' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_fields (models/staging/pipedrive/stg_deal_fields.sql)
  column "deal_field_key" does not exist
  LINE 7:         where (deal_field_key) in (
                         ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_fields.sql.
[0m12:42:20.377473 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m12:42:20.377796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m12:42:20.377920 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m12:42:20.378900 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:42:20.379100 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m12:42:20.380407 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:42:20.380516 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp124220379888"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m12:42:20.380616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:20.390574 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.010 seconds
[0m12:42:20.391697 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:42:20.391830 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp124220379888'
        
      order by ordinal_position

  
[0m12:42:20.398616 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m12:42:20.399520 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:42:20.399649 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:42:20.402495 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m12:42:20.405224 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:42:20.405350 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:42:20.407827 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m12:42:20.408450 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:42:20.408749 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:42:20.409045 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (deal_stage_id, deal_stage_name) in (
            select distinct deal_stage_id, deal_stage_name
            from "stg_deal_stages__dbt_tmp124220379888" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp124220379888"
    )
  
[0m12:42:20.411073 [debug] [Thread-1 (]: SQL status: INSERT 0 9 in 0.002 seconds
[0m12:42:20.411517 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:42:20.411624 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:42:20.411721 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:42:20.412652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:42:20.412893 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m12:42:20.413075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1715a0>]}
[0m12:42:20.413285 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mINSERT 0 9[0m in 0.04s]
[0m12:42:20.413474 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m12:42:20.413597 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m12:42:20.413755 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m12:42:20.413883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m12:42:20.413993 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m12:42:20.415047 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m12:42:20.415253 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m12:42:20.416803 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:42:20.416953 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp124220416142"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m12:42:20.417072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:20.427165 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.010 seconds
[0m12:42:20.428304 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:42:20.428436 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp124220416142'
        
      order by ordinal_position

  
[0m12:42:20.433844 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:42:20.435098 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:42:20.435229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:42:20.436445 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:42:20.437411 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:42:20.437530 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:42:20.438527 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:42:20.439188 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m12:42:20.439498 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:42:20.439615 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (deal_user_id) in (
            select distinct deal_user_id
            from "stg_deal_users__dbt_tmp124220416142" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp124220416142"
    )
  
[0m12:42:20.442287 [debug] [Thread-1 (]: SQL status: INSERT 0 1787 in 0.003 seconds
[0m12:42:20.442820 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:42:20.442947 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:42:20.443049 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:42:20.443692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:42:20.443929 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m12:42:20.444120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '922ceac0-93e3-412a-8d33-c640e02eaf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5547d0>]}
[0m12:42:20.444347 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mINSERT 0 1787[0m in 0.03s]
[0m12:42:20.444532 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m12:42:20.445025 [debug] [MainThread]: On master: COMMIT
[0m12:42:20.445132 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:20.445216 [debug] [MainThread]: On master: COMMIT
[0m12:42:20.445298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:20.449733 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:42:20.449873 [debug] [MainThread]: On master: Close
[0m12:42:20.450024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:20.450128 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m12:42:20.450281 [info ] [MainThread]: 
[0m12:42:20.450447 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m12:42:20.450870 [debug] [MainThread]: Command end result
[0m12:42:20.459377 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:42:20.460126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:42:20.462445 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m12:42:20.462562 [info ] [MainThread]: 
[0m12:42:20.462681 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:20.462776 [info ] [MainThread]: 
[0m12:42:20.462903 [error] [MainThread]: [31mFailure in model stg_deal_fields (models/staging/pipedrive/stg_deal_fields.sql)[0m
[0m12:42:20.463018 [error] [MainThread]:   Database Error in model stg_deal_fields (models/staging/pipedrive/stg_deal_fields.sql)
  column "deal_field_key" does not exist
  LINE 7:         where (deal_field_key) in (
                         ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_fields.sql
[0m12:42:20.463104 [info ] [MainThread]: 
[0m12:42:20.463208 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_fields.sql
[0m12:42:20.463290 [info ] [MainThread]: 
[0m12:42:20.463392 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:42:20.465394 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.61671925, "process_in_blocks": "0", "process_kernel_time": 0.13056, "process_mem_max_rss": "146374656", "process_out_blocks": "0", "process_user_time": 0.857746}
[0m12:42:20.465544 [debug] [MainThread]: Command `dbt build` failed at 12:42:20.465514 after 0.62 seconds
[0m12:42:20.465673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd8450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f44c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5ad60>]}
[0m12:42:20.465792 [debug] [MainThread]: Flushing usage events
[0m12:42:21.855398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:16.444278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ff890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ffb10>]}


============================== 12:43:16.445985 | 68f4ced4-13c2-4ad2-8fd0-a397d4a217f3 ==============================
[0m12:43:16.445985 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:43:16.446230 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt build --select tag:pipedrive --full-refresh', 'write_json': 'True', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'target_path': 'None'}
[0m12:43:16.500454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6e69e0>]}
[0m12:43:16.519831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3629c0>]}
[0m12:43:16.520128 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:43:16.549770 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:43:16.584118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:16.584274 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:43:16.584354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:16.595012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e455150>]}
[0m12:43:16.618838 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:43:16.619593 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:43:16.628270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4699a0>]}
[0m12:43:16.628443 [info ] [MainThread]: Found 4 models, 6 sources, 464 macros
[0m12:43:16.629272 [info ] [MainThread]: 
[0m12:43:16.629391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:16.629480 [info ] [MainThread]: 
[0m12:43:16.629661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:16.630969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:43:16.647023 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:43:16.647178 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:43:16.647269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:16.666962 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.020 seconds
[0m12:43:16.667559 [debug] [ThreadPool]: On list_postgres: Close
[0m12:43:16.668067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m12:43:16.670044 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m12:43:16.670173 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m12:43:16.670268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:16.680231 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m12:43:16.680669 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m12:43:16.681042 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m12:43:16.682606 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:16.682738 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:43:16.682909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:16.692965 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:43:16.693361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e52fa10>]}
[0m12:43:16.693519 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:16.693853 [debug] [MainThread]: On master: COMMIT
[0m12:43:16.693937 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:16.694015 [debug] [MainThread]: On master: COMMIT
[0m12:43:16.694526 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:16.694611 [debug] [MainThread]: On master: Close
[0m12:43:16.695349 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m12:43:16.695518 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m12:43:16.695967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m12:43:16.696087 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m12:43:16.698945 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:16.699238 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m12:43:16.720134 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:16.720504 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:16.720625 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m12:43:16.720730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:16.733938 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m12:43:16.759537 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:16.759721 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities" rename to "stg_deal_activities__dbt_backup"
[0m12:43:16.761234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:16.762228 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:16.762346 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp" rename to "stg_deal_activities"
[0m12:43:16.763030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:16.768502 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:43:16.768646 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:16.768750 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:43:16.771926 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:16.773953 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup"
[0m12:43:16.775454 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:16.775574 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup" cascade
[0m12:43:16.778711 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:43:16.779530 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m12:43:16.780128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6c7110>]}
[0m12:43:16.780341 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mSELECT 4579[0m in 0.08s]
[0m12:43:16.780553 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m12:43:16.780671 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m12:43:16.780843 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m12:43:16.781002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_fields)
[0m12:43:16.781109 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m12:43:16.781990 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:16.782218 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m12:43:16.783589 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:16.783804 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:16.783909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m12:43:16.784008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:16.794776 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:43:16.795908 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:16.796017 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m12:43:16.796821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:16.797632 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:16.797733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m12:43:16.798199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:43:16.798638 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:43:16.798959 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:16.799059 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:43:16.800296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:43:16.800938 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m12:43:16.801133 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:16.801233 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m12:43:16.803017 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m12:43:16.803423 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m12:43:16.803598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e62d9d0>]}
[0m12:43:16.803793 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mSELECT 4[0m in 0.02s]
[0m12:43:16.803989 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m12:43:16.804102 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m12:43:16.804267 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m12:43:16.804421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m12:43:16.804527 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m12:43:16.805474 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:16.805708 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m12:43:16.807005 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:16.807188 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:16.807290 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m12:43:16.807387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:16.816498 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.009 seconds
[0m12:43:16.817608 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:16.817735 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m12:43:16.818493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:16.819377 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:16.819486 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m12:43:16.820029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:43:16.820649 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:43:16.820751 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:16.820843 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:43:16.821759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:43:16.822354 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m12:43:16.822542 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:16.822642 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m12:43:16.824817 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m12:43:16.825194 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m12:43:16.825374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6701b0>]}
[0m12:43:16.825574 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.02s]
[0m12:43:16.825765 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m12:43:16.825885 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m12:43:16.826066 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m12:43:16.826214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m12:43:16.826323 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m12:43:16.827325 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m12:43:16.827555 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m12:43:16.828885 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m12:43:16.829072 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:16.829173 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m12:43:16.829270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:16.840297 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.011 seconds
[0m12:43:16.841260 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:16.841366 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users" rename to "stg_deal_users__dbt_backup"
[0m12:43:16.842118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:16.843126 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:16.843229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" rename to "stg_deal_users"
[0m12:43:16.843812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:43:16.844259 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:43:16.844364 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:16.844458 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:43:16.845889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:43:16.846510 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup"
[0m12:43:16.846706 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:16.846807 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup" cascade
[0m12:43:16.848875 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m12:43:16.849244 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m12:43:16.849411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68f4ced4-13c2-4ad2-8fd0-a397d4a217f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b280f50>]}
[0m12:43:16.849646 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mSELECT 1787[0m in 0.02s]
[0m12:43:16.849844 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m12:43:16.850350 [debug] [MainThread]: On master: COMMIT
[0m12:43:16.850452 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:16.850537 [debug] [MainThread]: On master: COMMIT
[0m12:43:16.850613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:16.858060 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m12:43:16.858176 [debug] [MainThread]: On master: Close
[0m12:43:16.858299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:16.858379 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m12:43:16.858492 [info ] [MainThread]: 
[0m12:43:16.858600 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:43:16.858939 [debug] [MainThread]: Command end result
[0m12:43:16.867330 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:43:16.868199 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:43:16.870494 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m12:43:16.870599 [info ] [MainThread]: 
[0m12:43:16.870723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:16.870812 [info ] [MainThread]: 
[0m12:43:16.870915 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:43:16.872055 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.45128226, "process_in_blocks": "0", "process_kernel_time": 0.101594, "process_mem_max_rss": "143343616", "process_out_blocks": "0", "process_user_time": 0.754596}
[0m12:43:16.872205 [debug] [MainThread]: Command `dbt build` succeeded at 12:43:16.872174 after 0.45 seconds
[0m12:43:16.872321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbeb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e204cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d42ad60>]}
[0m12:43:16.872432 [debug] [MainThread]: Flushing usage events
[0m12:43:18.651719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:21.700968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c28d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d247890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d247b10>]}


============================== 12:43:21.702619 | f3e2da5b-13de-4c75-a12f-291349fcb12d ==============================
[0m12:43:21.702619 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:43:21.702857 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'fail_fast': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'False', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:pipedrive', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs'}
[0m12:43:21.756273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52e9e0>]}
[0m12:43:21.775668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1aa9c0>]}
[0m12:43:21.775993 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:43:21.805369 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:43:21.840225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:21.840416 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:43:21.840512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:21.852005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f1150>]}
[0m12:43:21.876517 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:43:21.877261 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:43:21.886069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b19a0>]}
[0m12:43:21.886259 [info ] [MainThread]: Found 4 models, 6 sources, 464 macros
[0m12:43:21.887099 [info ] [MainThread]: 
[0m12:43:21.887225 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:21.887318 [info ] [MainThread]: 
[0m12:43:21.887493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:21.888811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:43:21.904925 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:43:21.905091 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:43:21.905184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:21.924077 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.019 seconds
[0m12:43:21.924605 [debug] [ThreadPool]: On list_postgres: Close
[0m12:43:21.925079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m12:43:21.927089 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m12:43:21.927218 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m12:43:21.927321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:21.937672 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m12:43:21.938069 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m12:43:21.938448 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m12:43:21.939911 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:21.940029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:43:21.940132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:21.950368 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:43:21.950727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2dba10>]}
[0m12:43:21.950869 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:21.951326 [debug] [MainThread]: On master: COMMIT
[0m12:43:21.951411 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:21.951486 [debug] [MainThread]: On master: COMMIT
[0m12:43:21.952083 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:43:21.952164 [debug] [MainThread]: On master: Close
[0m12:43:21.952890 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m12:43:21.953057 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m12:43:21.953496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m12:43:21.953617 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m12:43:21.956376 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:21.956653 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m12:43:21.978046 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:21.978247 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp124321969417"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m12:43:21.978364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:21.990485 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.012 seconds
[0m12:43:22.017841 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:22.018031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp124321969417'
        
      order by ordinal_position

  
[0m12:43:22.026739 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m12:43:22.028553 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:22.028681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:22.031828 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m12:43:22.034948 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:22.035075 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:22.037874 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m12:43:22.043064 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:22.043371 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:22.043490 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        where (deal_activity_id, deal_id) in (
            select distinct deal_activity_id, deal_id
            from "stg_deal_activities__dbt_tmp124321969417" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_activities" ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    (
        select "deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to"
        from "stg_deal_activities__dbt_tmp124321969417"
    )
  
[0m12:43:22.054457 [debug] [Thread-1 (]: SQL status: INSERT 0 4579 in 0.011 seconds
[0m12:43:22.059360 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:43:22.059488 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:22.059591 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:43:22.062093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:43:22.062715 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m12:43:22.063328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e46b930>]}
[0m12:43:22.063559 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mINSERT 0 4579[0m in 0.11s]
[0m12:43:22.063763 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m12:43:22.063898 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m12:43:22.064099 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m12:43:22.064270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_fields)
[0m12:43:22.064385 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m12:43:22.065382 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:22.065607 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m12:43:22.066999 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:22.067120 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp124322066438"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m12:43:22.067229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:22.077496 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m12:43:22.078639 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:22.078769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp124322066438'
        
      order by ordinal_position

  
[0m12:43:22.083598 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:43:22.084847 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:22.084980 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:22.086277 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:43:22.087276 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:22.087393 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:22.088535 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:43:22.089267 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:22.089566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:22.089691 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        where (deal_field_key) in (
            select distinct deal_field_key
            from "stg_deal_fields__dbt_tmp124322066438" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_fields" ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    (
        select "deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options"
        from "stg_deal_fields__dbt_tmp124322066438"
    )
  
[0m12:43:22.090335 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.001 seconds
[0m12:43:22.090805 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:43:22.090915 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:22.091013 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:43:22.091435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m12:43:22.091671 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m12:43:22.091865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3c93d0>]}
[0m12:43:22.092082 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mINSERT 0 4[0m in 0.03s]
[0m12:43:22.092269 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m12:43:22.092393 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m12:43:22.092562 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m12:43:22.092699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m12:43:22.092811 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m12:43:22.093981 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:22.094225 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m12:43:22.095756 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:22.095873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp124322095180"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m12:43:22.095982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:22.102292 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m12:43:22.103429 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:22.103554 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp124322095180'
        
      order by ordinal_position

  
[0m12:43:22.108879 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m12:43:22.110229 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:22.110378 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:22.112186 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m12:43:22.113204 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:22.113329 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:22.114597 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m12:43:22.115236 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:22.115547 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:22.115664 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (deal_stage_id, deal_stage_name) in (
            select distinct deal_stage_id, deal_stage_name
            from "stg_deal_stages__dbt_tmp124322095180" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp124322095180"
    )
  
[0m12:43:22.116315 [debug] [Thread-1 (]: SQL status: INSERT 0 9 in 0.001 seconds
[0m12:43:22.116914 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:43:22.117044 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:22.117151 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:43:22.117659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m12:43:22.117983 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m12:43:22.118203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40d650>]}
[0m12:43:22.118451 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mINSERT 0 9[0m in 0.03s]
[0m12:43:22.118647 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m12:43:22.118781 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m12:43:22.118947 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m12:43:22.119086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m12:43:22.119198 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m12:43:22.120550 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m12:43:22.120809 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m12:43:22.122048 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:22.122166 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp124322121482"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m12:43:22.122269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:22.128072 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.006 seconds
[0m12:43:22.129296 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:22.129428 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp124322121482'
        
      order by ordinal_position

  
[0m12:43:22.132833 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:43:22.133895 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:22.134023 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:22.135376 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:43:22.136528 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:22.136656 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:22.137701 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:43:22.138553 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m12:43:22.138852 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:22.138970 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (deal_user_id) in (
            select distinct deal_user_id
            from "stg_deal_users__dbt_tmp124322121482" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp124322121482"
    )
  
[0m12:43:22.141507 [debug] [Thread-1 (]: SQL status: INSERT 0 1787 in 0.002 seconds
[0m12:43:22.141958 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:43:22.142065 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:22.142161 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:43:22.142986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:43:22.143227 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m12:43:22.143421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2da5b-13de-4c75-a12f-291349fcb12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e887110>]}
[0m12:43:22.143646 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mINSERT 0 1787[0m in 0.02s]
[0m12:43:22.143839 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m12:43:22.144296 [debug] [MainThread]: On master: COMMIT
[0m12:43:22.144396 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:22.144483 [debug] [MainThread]: On master: COMMIT
[0m12:43:22.144564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:22.148695 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:43:22.148810 [debug] [MainThread]: On master: Close
[0m12:43:22.148978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:22.149070 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m12:43:22.149277 [info ] [MainThread]: 
[0m12:43:22.149381 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m12:43:22.149735 [debug] [MainThread]: Command end result
[0m12:43:22.158036 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:43:22.158738 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:43:22.161068 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m12:43:22.161182 [info ] [MainThread]: 
[0m12:43:22.161311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:22.161407 [info ] [MainThread]: 
[0m12:43:22.161512 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:43:22.162722 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.48639703, "process_in_blocks": "0", "process_kernel_time": 0.103113, "process_mem_max_rss": "143507456", "process_out_blocks": "0", "process_user_time": 0.776444}
[0m12:43:22.162882 [debug] [MainThread]: Command `dbt build` succeeded at 12:43:22.162849 after 0.49 seconds
[0m12:43:22.163005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1af9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e69ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d276d60>]}
[0m12:43:22.163118 [debug] [MainThread]: Flushing usage events
[0m12:43:23.870584 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:26.201637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b68b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b68bb10>]}


============================== 12:43:26.203270 | 74b6d5fd-6ca2-4f81-beba-66c7bbb93f40 ==============================
[0m12:43:26.203270 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:43:26.203506 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt build --select tag:pipedrive', 'target_path': 'None'}
[0m12:43:26.257028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9729e0>]}
[0m12:43:26.275914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5ee9c0>]}
[0m12:43:26.276221 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:43:26.305381 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:43:26.339839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:26.339994 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:43:26.340078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:26.351386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c639150>]}
[0m12:43:26.374913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:43:26.375630 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:43:26.384351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f59a0>]}
[0m12:43:26.384528 [info ] [MainThread]: Found 4 models, 6 sources, 464 macros
[0m12:43:26.385346 [info ] [MainThread]: 
[0m12:43:26.385472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:26.385564 [info ] [MainThread]: 
[0m12:43:26.385733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:26.387060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:43:26.403519 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:43:26.403688 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:43:26.403777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:26.422841 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.019 seconds
[0m12:43:26.423398 [debug] [ThreadPool]: On list_postgres: Close
[0m12:43:26.423887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m12:43:26.425904 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m12:43:26.426031 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m12:43:26.426126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:26.436322 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m12:43:26.436727 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m12:43:26.437127 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m12:43:26.438594 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:26.438718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:43:26.438823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:26.448959 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:43:26.449331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c72ba10>]}
[0m12:43:26.449504 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:26.450072 [debug] [MainThread]: On master: COMMIT
[0m12:43:26.450158 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:26.450233 [debug] [MainThread]: On master: COMMIT
[0m12:43:26.450840 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:43:26.450926 [debug] [MainThread]: On master: Close
[0m12:43:26.451689 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m12:43:26.451860 [info ] [Thread-1 (]: 1 of 4 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m12:43:26.452317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m12:43:26.452433 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m12:43:26.455220 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:26.455495 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m12:43:26.476536 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:26.476739 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp124326468148"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m12:43:26.476849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:26.489087 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.012 seconds
[0m12:43:26.515913 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:26.516146 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp124326468148'
        
      order by ordinal_position

  
[0m12:43:26.525164 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m12:43:26.526941 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:26.527077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:26.530259 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m12:43:26.533584 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:26.533731 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:26.536837 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m12:43:26.542242 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:26.542593 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:26.542725 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        where (deal_activity_id, deal_id) in (
            select distinct deal_activity_id, deal_id
            from "stg_deal_activities__dbt_tmp124326468148" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_activities" ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    (
        select "deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to"
        from "stg_deal_activities__dbt_tmp124326468148"
    )
  
[0m12:43:26.553908 [debug] [Thread-1 (]: SQL status: INSERT 0 4579 in 0.011 seconds
[0m12:43:26.558909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:43:26.559039 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:43:26.559143 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:43:26.561463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:43:26.562096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m12:43:26.562714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8a7930>]}
[0m12:43:26.562950 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mINSERT 0 4579[0m in 0.11s]
[0m12:43:26.563155 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m12:43:26.563286 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m12:43:26.563479 [info ] [Thread-1 (]: 2 of 4 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m12:43:26.563645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_fields)
[0m12:43:26.563761 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m12:43:26.564726 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:26.564953 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m12:43:26.566381 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:26.566501 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp124326565776"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m12:43:26.566610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:26.577986 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:43:26.581061 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:26.581575 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp124326565776'
        
      order by ordinal_position

  
[0m12:43:26.588418 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:43:26.590758 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:26.590972 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:26.592809 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m12:43:26.594384 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:26.594568 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:26.597220 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m12:43:26.598751 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:26.599167 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:26.599294 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        where (deal_field_key) in (
            select distinct deal_field_key
            from "stg_deal_fields__dbt_tmp124326565776" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_fields" ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    (
        select "deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options"
        from "stg_deal_fields__dbt_tmp124326565776"
    )
  
[0m12:43:26.600355 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.001 seconds
[0m12:43:26.600881 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:43:26.600986 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:43:26.601076 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:43:26.601817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:43:26.602071 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m12:43:26.602281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c80d3d0>]}
[0m12:43:26.602505 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mINSERT 0 4[0m in 0.04s]
[0m12:43:26.602691 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m12:43:26.602815 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m12:43:26.602986 [info ] [Thread-1 (]: 3 of 4 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m12:43:26.603118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m12:43:26.603235 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m12:43:26.604388 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:26.604608 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m12:43:26.606021 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:26.606124 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp124326605521"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m12:43:26.606221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:26.612790 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m12:43:26.613863 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:26.613988 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp124326605521'
        
      order by ordinal_position

  
[0m12:43:26.616497 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m12:43:26.617812 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:26.617941 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:26.619289 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m12:43:26.620195 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:26.620318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:26.621922 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m12:43:26.622546 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:26.622817 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:26.622920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (deal_stage_id, deal_stage_name) in (
            select distinct deal_stage_id, deal_stage_name
            from "stg_deal_stages__dbt_tmp124326605521" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp124326605521"
    )
  
[0m12:43:26.623504 [debug] [Thread-1 (]: SQL status: INSERT 0 9 in 0.000 seconds
[0m12:43:26.623924 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:43:26.624025 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:43:26.624123 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:43:26.624667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m12:43:26.624908 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m12:43:26.625093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c855650>]}
[0m12:43:26.625288 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mINSERT 0 9[0m in 0.02s]
[0m12:43:26.625469 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m12:43:26.625589 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m12:43:26.625740 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m12:43:26.625867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m12:43:26.625975 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m12:43:26.627170 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m12:43:26.627387 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m12:43:26.628528 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:26.628633 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp124326627987"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m12:43:26.628725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:26.634067 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.005 seconds
[0m12:43:26.635532 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:26.635681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp124326627987'
        
      order by ordinal_position

  
[0m12:43:26.639104 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:43:26.640057 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:26.640170 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:26.642383 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m12:43:26.643356 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:26.643464 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:43:26.644780 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:43:26.645558 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m12:43:26.645834 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:26.645938 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (deal_user_id) in (
            select distinct deal_user_id
            from "stg_deal_users__dbt_tmp124326627987" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp124326627987"
    )
  
[0m12:43:26.649120 [debug] [Thread-1 (]: SQL status: INSERT 0 1787 in 0.003 seconds
[0m12:43:26.649657 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:43:26.649770 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:43:26.649868 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:43:26.650606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:43:26.650844 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m12:43:26.651034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b6d5fd-6ca2-4f81-beba-66c7bbb93f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cccb110>]}
[0m12:43:26.651263 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mINSERT 0 1787[0m in 0.03s]
[0m12:43:26.651456 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m12:43:26.651928 [debug] [MainThread]: On master: COMMIT
[0m12:43:26.652030 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:26.652115 [debug] [MainThread]: On master: COMMIT
[0m12:43:26.652195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:26.656339 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:43:26.656472 [debug] [MainThread]: On master: Close
[0m12:43:26.656609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:26.656697 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m12:43:26.656816 [info ] [MainThread]: 
[0m12:43:26.656932 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m12:43:26.657284 [debug] [MainThread]: Command end result
[0m12:43:26.664886 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:43:26.665558 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:43:26.668128 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m12:43:26.668268 [info ] [MainThread]: 
[0m12:43:26.668394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:26.668489 [info ] [MainThread]: 
[0m12:43:26.668607 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:43:26.669724 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.49222863, "process_in_blocks": "0", "process_kernel_time": 0.103926, "process_mem_max_rss": "143261696", "process_out_blocks": "0", "process_user_time": 0.770271}
[0m12:43:26.669862 [debug] [MainThread]: Command `dbt build` succeeded at 12:43:26.669833 after 0.49 seconds
[0m12:43:26.669976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cadfa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b6d60>]}
[0m12:43:26.670082 [debug] [MainThread]: Flushing usage events
[0m12:43:28.149079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:55.811936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109753890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109753b10>]}


============================== 12:52:55.813693 | eb0f9742-be54-4daa-a341-ebff21233583 ==============================
[0m12:52:55.813693 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:52:55.813925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False', 'debug': 'False', 'invocation_command': 'dbt build --select tag:pipedrive', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'no_print': 'None', 'use_colors': 'True'}
[0m12:52:55.867624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb0f9742-be54-4daa-a341-ebff21233583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3a9e0>]}
[0m12:52:55.886356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb0f9742-be54-4daa-a341-ebff21233583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b69c0>]}
[0m12:52:55.886652 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:52:55.916318 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:52:55.951386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:52:55.951605 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m12:52:56.009782 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_deal_activity_types' (models/staging/pipedrive/stg_deal_activity_types.sql) depends on a source named 'public_postgres.activity_types' which was not found
[0m12:52:56.011854 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.2247675, "process_in_blocks": "0", "process_kernel_time": 0.094025, "process_mem_max_rss": "127942656", "process_out_blocks": "0", "process_user_time": 0.625754}
[0m12:52:56.012035 [debug] [MainThread]: Command `dbt build` failed at 12:52:56.011999 after 0.22 seconds
[0m12:52:56.012170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ee750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a98c5f0>]}
[0m12:52:56.012296 [debug] [MainThread]: Flushing usage events
[0m12:52:57.916237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:26.990675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957bb10>]}


============================== 12:53:26.992328 | 8d79f94b-b063-4a9c-a483-c021995f9ca1 ==============================
[0m12:53:26.992328 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:53:26.992564 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'empty': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt build --select tag:pipedrive', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'printer_width': '80', 'partial_parse': 'True'}
[0m12:53:27.046222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d79f94b-b063-4a9c-a483-c021995f9ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088629e0>]}
[0m12:53:27.065517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d79f94b-b063-4a9c-a483-c021995f9ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094de9c0>]}
[0m12:53:27.065829 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:53:27.095548 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:53:27.130778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:53:27.131014 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m12:53:27.131141 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m12:53:27.190521 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_deal_activity_types' (models/staging/pipedrive/stg_deal_activity_types.sql) depends on a source named 'public_postgres.activity_types' which was not found
[0m12:53:27.191685 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.22504129, "process_in_blocks": "0", "process_kernel_time": 0.097143, "process_mem_max_rss": "128155648", "process_out_blocks": "0", "process_user_time": 0.636234}
[0m12:53:27.191862 [debug] [MainThread]: Command `dbt build` failed at 12:53:27.191824 after 0.23 seconds
[0m12:53:27.191991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109416750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a526450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a700c80>]}
[0m12:53:27.192109 [debug] [MainThread]: Flushing usage events
[0m12:53:28.865498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:52.979380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad517f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0bb10>]}


============================== 12:53:52.981779 | 6210fbb8-03ba-4bfc-bfba-4c6ee2298643 ==============================
[0m12:53:52.981779 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:53:52.982019 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'invocation_command': 'dbt build --select tag:pipedrive', 'log_format': 'default', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'quiet': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_colors': 'True', 'fail_fast': 'False'}
[0m12:53:53.049625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff29e0>]}
[0m12:53:53.068740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6e9c0>]}
[0m12:53:53.069303 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:53:53.105034 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:53:53.145185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:53:53.145405 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m12:53:53.225102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd62550>]}
[0m12:53:53.250166 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:53:53.251501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:53:53.290250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd759a0>]}
[0m12:53:53.290475 [info ] [MainThread]: Found 5 models, 6 sources, 464 macros
[0m12:53:53.291214 [info ] [MainThread]: 
[0m12:53:53.291338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:53.291428 [info ] [MainThread]: 
[0m12:53:53.291592 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:53.292971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:53:53.315218 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:53:53.315383 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:53:53.315474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:53.348224 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.033 seconds
[0m12:53:53.348825 [debug] [ThreadPool]: On list_postgres: Close
[0m12:53:53.349355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m12:53:53.351370 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m12:53:53.351487 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m12:53:53.351581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:53.362458 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m12:53:53.362930 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m12:53:53.363458 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m12:53:53.365054 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:53.365196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:53:53.365315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:53.376068 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m12:53:53.376455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c461550>]}
[0m12:53:53.376606 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:53.376950 [debug] [MainThread]: On master: COMMIT
[0m12:53:53.377040 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:53.377117 [debug] [MainThread]: On master: COMMIT
[0m12:53:53.377636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:53:53.377726 [debug] [MainThread]: On master: Close
[0m12:53:53.379177 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m12:53:53.379367 [info ] [Thread-1 (]: 1 of 5 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m12:53:53.379526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m12:53:53.379636 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m12:53:53.382387 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:53:53.382642 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m12:53:53.401739 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:53:53.401909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp125353393213"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m12:53:53.402013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:53.415009 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m12:53:53.419498 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:53:53.419625 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp125353393213'
        
      order by ordinal_position

  
[0m12:53:53.426783 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m12:53:53.428506 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:53:53.428628 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:53:53.431960 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m12:53:53.434946 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:53:53.435061 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:53:53.437425 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m12:53:53.442959 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m12:53:53.443292 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:53:53.443421 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        where (deal_activity_id, deal_id) in (
            select distinct deal_activity_id, deal_id
            from "stg_deal_activities__dbt_tmp125353393213" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_activities" ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    (
        select "deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to"
        from "stg_deal_activities__dbt_tmp125353393213"
    )
  
[0m12:53:53.453993 [debug] [Thread-1 (]: SQL status: INSERT 0 4579 in 0.010 seconds
[0m12:53:53.458935 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:53:53.459055 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m12:53:53.459155 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m12:53:53.462767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:53:53.463402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m12:53:53.464212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d456410>]}
[0m12:53:53.464450 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mINSERT 0 4579[0m in 0.08s]
[0m12:53:53.464646 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m12:53:53.464778 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m12:53:53.464958 [info ] [Thread-1 (]: 2 of 5 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m12:53:53.465102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_activity_types)
[0m12:53:53.465216 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m12:53:53.466255 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m12:53:53.466486 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m12:53:53.467896 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m12:53:53.468101 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m12:53:53.468216 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activity_types"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."public"."activity_types"
  );
  
  
[0m12:53:53.468327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:53.476170 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:53:53.478073 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m12:53:53.478195 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m12:53:53.478303 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m12:53:53.478769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m12:53:53.479144 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m12:53:53.479393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d077290>]}
[0m12:53:53.479645 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mSELECT 4[0m in 0.01s]
[0m12:53:53.479842 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m12:53:53.479973 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m12:53:53.480188 [info ] [Thread-1 (]: 3 of 5 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m12:53:53.480372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m12:53:53.480497 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m12:53:53.481622 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:53:53.481889 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m12:53:53.483325 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:53:53.483442 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp125353482769"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m12:53:53.483545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:53.492829 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m12:53:53.493816 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:53:53.493932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp125353482769'
        
      order by ordinal_position

  
[0m12:53:53.496748 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:53:53.497932 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:53:53.498060 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:53:53.499436 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:53:53.501977 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:53:53.502098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:53:53.504784 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:53:53.505435 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m12:53:53.505724 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:53:53.505834 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        where (deal_field_key) in (
            select distinct deal_field_key
            from "stg_deal_fields__dbt_tmp125353482769" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_fields" ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    (
        select "deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options"
        from "stg_deal_fields__dbt_tmp125353482769"
    )
  
[0m12:53:53.507719 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.002 seconds
[0m12:53:53.508146 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:53:53.508251 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m12:53:53.508346 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m12:53:53.509350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:53:53.509578 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m12:53:53.509763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d055b20>]}
[0m12:53:53.509972 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mINSERT 0 4[0m in 0.03s]
[0m12:53:53.510155 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m12:53:53.510276 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m12:53:53.510429 [info ] [Thread-1 (]: 4 of 5 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m12:53:53.510556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m12:53:53.510663 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m12:53:53.511690 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:53:53.511885 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m12:53:53.513401 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:53:53.513514 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp125353512792"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m12:53:53.513615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:53.520865 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.007 seconds
[0m12:53:53.521896 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:53:53.522028 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp125353512792'
        
      order by ordinal_position

  
[0m12:53:53.526158 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m12:53:53.527374 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:53:53.527502 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:53:53.528684 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m12:53:53.529693 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:53:53.529813 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:53:53.530990 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m12:53:53.531741 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m12:53:53.532051 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:53:53.532171 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
        delete from "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        where (deal_stage_id, deal_stage_name) in (
            select distinct deal_stage_id, deal_stage_name
            from "stg_deal_stages__dbt_tmp125353512792" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_stages" ("deal_stage_id", "deal_stage_name")
    (
        select "deal_stage_id", "deal_stage_name"
        from "stg_deal_stages__dbt_tmp125353512792"
    )
  
[0m12:53:53.532788 [debug] [Thread-1 (]: SQL status: INSERT 0 9 in 0.001 seconds
[0m12:53:53.533248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:53:53.533359 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m12:53:53.533458 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m12:53:53.533918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m12:53:53.534153 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m12:53:53.534349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d35de50>]}
[0m12:53:53.534577 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mINSERT 0 9[0m in 0.02s]
[0m12:53:53.534768 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m12:53:53.534893 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m12:53:53.535077 [info ] [Thread-1 (]: 5 of 5 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m12:53:53.535240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m12:53:53.535363 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m12:53:53.536514 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m12:53:53.536757 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m12:53:53.538262 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:53:53.538382 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp125353537692"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m12:53:53.538494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:53.546397 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.008 seconds
[0m12:53:53.547577 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:53:53.547733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp125353537692'
        
      order by ordinal_position

  
[0m12:53:53.552565 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:53:53.553838 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:53:53.553969 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:53:53.555777 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m12:53:53.556854 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:53:53.556989 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m12:53:53.558016 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m12:53:53.558689 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m12:53:53.558982 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:53:53.559100 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
        
        
        delete from "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        where (deal_user_id) in (
            select distinct deal_user_id
            from "stg_deal_users__dbt_tmp125353537692" as DBT_INTERNAL_SOURCE
        );

    

    insert into "postgres"."public_pipedrive_staging"."stg_deal_users" ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    (
        select "deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified"
        from "stg_deal_users__dbt_tmp125353537692"
    )
  
[0m12:53:53.560656 [debug] [Thread-1 (]: SQL status: INSERT 0 1787 in 0.001 seconds
[0m12:53:53.561115 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:53:53.561229 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m12:53:53.561329 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m12:53:53.562000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:53:53.562247 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m12:53:53.562557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6210fbb8-03ba-4bfc-bfba-4c6ee2298643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d32bed0>]}
[0m12:53:53.562832 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mINSERT 0 1787[0m in 0.03s]
[0m12:53:53.563049 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m12:53:53.563541 [debug] [MainThread]: On master: COMMIT
[0m12:53:53.563648 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:53.563740 [debug] [MainThread]: On master: COMMIT
[0m12:53:53.563828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:53.568458 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m12:53:53.568581 [debug] [MainThread]: On master: Close
[0m12:53:53.568726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:53.568817 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m12:53:53.568943 [info ] [MainThread]: 
[0m12:53:53.569056 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:53:53.569494 [debug] [MainThread]: Command end result
[0m12:53:53.578256 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m12:53:53.578934 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:53:53.581713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m12:53:53.581844 [info ] [MainThread]: 
[0m12:53:53.581981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:53.582079 [info ] [MainThread]: 
[0m12:53:53.582183 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:53:53.584202 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6326953, "process_in_blocks": "0", "process_kernel_time": 0.133192, "process_mem_max_rss": "145915904", "process_out_blocks": "0", "process_user_time": 0.859536}
[0m12:53:53.584372 [debug] [MainThread]: Command `dbt build` succeeded at 12:53:53.584338 after 0.63 seconds
[0m12:53:53.584498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd3ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d81be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb6d50>]}
[0m12:53:53.584617 [debug] [MainThread]: Flushing usage events
[0m12:53:55.465530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:57.871662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebbb10>]}


============================== 13:21:57.874108 | a99a57a2-3e13-4519-8eed-b2c3486ee9b2 ==============================
[0m13:21:57.874108 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:21:57.874345 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'printer_width': '80', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'invocation_command': 'dbt run --select stg_deal_changes', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None'}
[0m13:21:57.952263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a99a57a2-3e13-4519-8eed-b2c3486ee9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a69e0>]}
[0m13:21:57.971388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a99a57a2-3e13-4519-8eed-b2c3486ee9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e229c0>]}
[0m13:21:57.971869 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:21:58.005478 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:21:58.051542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:21:58.051794 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m13:21:58.113182 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_deal_changes (models/staging/pipedrive/stg_deal_changes.sql)
  expected token ',', got '='
    line 3
      --         materialized='incremental',
[0m13:21:58.114756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.26969734, "process_in_blocks": "0", "process_kernel_time": 0.123006, "process_mem_max_rss": "127434752", "process_out_blocks": "0", "process_user_time": 0.63423}
[0m13:21:58.114956 [debug] [MainThread]: Command `dbt run` failed at 13:21:58.114917 after 0.27 seconds
[0m13:21:58.115103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af1a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af19250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1009b0>]}
[0m13:21:58.115232 [debug] [MainThread]: Flushing usage events
[0m13:21:59.478080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:29.765059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f957f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4bb10>]}


============================== 13:23:29.766663 | 6cb34789-70c4-4f79-80d7-cf1370264540 ==============================
[0m13:23:29.766663 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:23:29.766901 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'target_path': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_deal_changes', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m13:23:29.821471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb34789-70c4-4f79-80d7-cf1370264540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092369e0>]}
[0m13:23:29.840929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cb34789-70c4-4f79-80d7-cf1370264540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb29c0>]}
[0m13:23:29.841251 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:23:29.871647 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:23:29.908251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:23:29.908483 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m13:23:29.989448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cb34789-70c4-4f79-80d7-cf1370264540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afaa650>]}
[0m13:23:30.014570 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:23:30.015655 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:23:30.047908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cb34789-70c4-4f79-80d7-cf1370264540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fbd9a0>]}
[0m13:23:30.048123 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:23:30.048258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb34789-70c4-4f79-80d7-cf1370264540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae06970>]}
[0m13:23:30.048916 [info ] [MainThread]: 
[0m13:23:30.049047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:23:30.049140 [info ] [MainThread]: 
[0m13:23:30.049314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:23:30.049613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:23:30.072167 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:23:30.072333 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:23:30.072426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:30.105105 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.033 seconds
[0m13:23:30.105698 [debug] [ThreadPool]: On list_postgres: Close
[0m13:23:30.107286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:23:30.109267 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:23:30.109385 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:23:30.109476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:30.120950 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m13:23:30.121395 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:23:30.121765 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:23:30.123550 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:30.123681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:23:30.123789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:30.134234 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:23:30.134614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb34789-70c4-4f79-80d7-cf1370264540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37e750>]}
[0m13:23:30.134776 [debug] [MainThread]: On master: ROLLBACK
[0m13:23:30.135185 [debug] [MainThread]: On master: COMMIT
[0m13:23:30.135270 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:30.135348 [debug] [MainThread]: On master: COMMIT
[0m13:23:30.135917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:23:30.136013 [debug] [MainThread]: On master: Close
[0m13:23:30.136742 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m13:23:30.136911 [info ] [Thread-1 (]: 1 of 1 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m13:23:30.137065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_changes)
[0m13:23:30.137173 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m13:23:30.139848 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:23:30.140130 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m13:23:30.153482 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:23:30.153781 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:23:30.154093 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m13:23:30.154232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:30.174181 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.020 seconds
[0m13:23:30.177704 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:23:30.177823 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m13:23:30.178591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:23:30.183746 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:23:30.183869 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:23:30.183968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:23:30.188067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:23:30.190046 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m13:23:30.191727 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:23:30.191886 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m13:23:30.192379 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:23:30.193283 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m13:23:30.194159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb34789-70c4-4f79-80d7-cf1370264540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4d8e90>]}
[0m13:23:30.194392 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.06s]
[0m13:23:30.194592 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m13:23:30.195097 [debug] [MainThread]: On master: COMMIT
[0m13:23:30.195234 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:30.195334 [debug] [MainThread]: On master: COMMIT
[0m13:23:30.195420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:30.202120 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:23:30.202257 [debug] [MainThread]: On master: Close
[0m13:23:30.202395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:30.202496 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_changes' was properly closed.
[0m13:23:30.202616 [info ] [MainThread]: 
[0m13:23:30.202761 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m13:23:30.203106 [debug] [MainThread]: Command end result
[0m13:23:30.211314 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:23:30.211985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:23:30.214190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:23:30.214284 [info ] [MainThread]: 
[0m13:23:30.214420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:30.214516 [info ] [MainThread]: 
[0m13:23:30.214623 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:23:30.215808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.47443184, "process_in_blocks": "0", "process_kernel_time": 0.115848, "process_mem_max_rss": "143867904", "process_out_blocks": "0", "process_user_time": 0.78239}
[0m13:23:30.215950 [debug] [MainThread]: Command `dbt run` succeeded at 13:23:30.215921 after 0.47 seconds
[0m13:23:30.216064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a767a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a767430>]}
[0m13:23:30.216168 [debug] [MainThread]: Flushing usage events
[0m13:23:31.714685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:15.664991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1817f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13bb10>]}


============================== 13:26:15.667350 | e1eb20f2-d1a0-4d2b-b6bd-ef71afc0557d ==============================
[0m13:26:15.667350 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:26:15.667583 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'empty': 'False', 'invocation_command': 'dbt build --select tag:pipedrive --full-refresh', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment'}
[0m13:26:15.735912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1eb20f2-d1a0-4d2b-b6bd-ef71afc0557d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4229e0>]}
[0m13:26:15.755338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1eb20f2-d1a0-4d2b-b6bd-ef71afc0557d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d09e9c0>]}
[0m13:26:15.755883 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:26:15.788936 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:26:15.830000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:26:15.830238 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m13:26:15.888201 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_deal_users (models/staging/pipedrive/stg_deal_users.sql)
  expected token ',', got 'merge_strategy'
    line 8
      merge_strategy='merge'
[0m13:26:15.889918 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.2500826, "process_in_blocks": "0", "process_kernel_time": 0.119105, "process_mem_max_rss": "127614976", "process_out_blocks": "0", "process_user_time": 0.632398}
[0m13:26:15.890156 [debug] [MainThread]: Command `dbt build` failed at 13:26:15.890111 after 0.25 seconds
[0m13:26:15.890321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2d47d0>]}
[0m13:26:15.890471 [debug] [MainThread]: Flushing usage events
[0m13:26:17.790412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:22.528121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109653890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109653b10>]}


============================== 13:26:22.529736 | 49d6b867-d00e-440e-b6a8-65610c182aa4 ==============================
[0m13:26:22.529736 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:26:22.529978 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt build --select tag:pipedrive --full-refresh', 'static_parser': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'printer_width': '80'}
[0m13:26:22.583421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893a9e0>]}
[0m13:26:22.602378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b69c0>]}
[0m13:26:22.602722 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:26:22.632315 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:26:22.668224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:26:22.668487 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m13:26:22.748789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6aa750>]}
[0m13:26:22.774357 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:26:22.775387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:26:22.812939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096bd9a0>]}
[0m13:26:22.813163 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:26:22.813911 [info ] [MainThread]: 
[0m13:26:22.814039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:22.814133 [info ] [MainThread]: 
[0m13:26:22.814304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:26:22.815671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:26:22.838095 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:26:22.838261 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:26:22.838354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:22.869642 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.031 seconds
[0m13:26:22.870232 [debug] [ThreadPool]: On list_postgres: Close
[0m13:26:22.870799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:26:22.872798 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:26:22.872915 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:26:22.873007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:22.883968 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m13:26:22.884423 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:26:22.884831 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:26:22.886629 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:22.886758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:26:22.886864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:22.897054 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:26:22.897695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dac750>]}
[0m13:26:22.897854 [debug] [MainThread]: On master: ROLLBACK
[0m13:26:22.898235 [debug] [MainThread]: On master: COMMIT
[0m13:26:22.898328 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:22.898403 [debug] [MainThread]: On master: COMMIT
[0m13:26:22.898978 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:26:22.899070 [debug] [MainThread]: On master: Close
[0m13:26:22.900199 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m13:26:22.900365 [info ] [Thread-1 (]: 1 of 6 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m13:26:22.900527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m13:26:22.900637 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m13:26:22.903440 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m13:26:22.903699 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m13:26:22.922640 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m13:26:22.922992 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m13:26:22.923109 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m13:26:22.923218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:22.936701 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m13:26:22.940162 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m13:26:22.940290 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities" rename to "stg_deal_activities__dbt_backup"
[0m13:26:22.940934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:26:22.941801 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m13:26:22.941907 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp" rename to "stg_deal_activities"
[0m13:26:22.942499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:26:22.947709 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m13:26:22.947834 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m13:26:22.947935 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m13:26:22.949885 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:26:22.951896 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup"
[0m13:26:22.953426 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m13:26:22.953607 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup" cascade
[0m13:26:22.955264 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:26:22.956117 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m13:26:22.956933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6a4e0>]}
[0m13:26:22.957150 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mSELECT 4579[0m in 0.06s]
[0m13:26:22.957358 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m13:26:22.957476 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m13:26:22.957647 [info ] [Thread-1 (]: 2 of 6 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m13:26:22.957806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_activity_types)
[0m13:26:22.957912 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m13:26:22.958831 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m13:26:22.959049 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m13:26:22.960427 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m13:26:22.960664 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m13:26:22.960780 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."public"."activity_types"
  );
  
  
[0m13:26:22.960897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:22.969774 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m13:26:22.971008 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m13:26:22.971135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types" rename to "stg_deal_activity_types__dbt_backup"
[0m13:26:22.971659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:26:22.972499 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m13:26:22.972612 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp" rename to "stg_deal_activity_types"
[0m13:26:22.973215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:26:22.973652 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m13:26:22.973748 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m13:26:22.973837 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m13:26:22.974819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:26:22.975582 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup"
[0m13:26:22.975766 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m13:26:22.975861 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup" cascade
[0m13:26:22.977215 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:26:22.977580 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m13:26:22.977762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9aed50>]}
[0m13:26:22.977960 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mSELECT 4[0m in 0.02s]
[0m13:26:22.978150 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m13:26:22.978259 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m13:26:22.978432 [info ] [Thread-1 (]: 3 of 6 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m13:26:22.978602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m13:26:22.978710 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m13:26:22.979580 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:26:22.979818 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m13:26:22.985612 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:26:22.985930 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:26:22.986051 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m13:26:22.986164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:23.003510 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.017 seconds
[0m13:26:23.004798 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:26:23.004932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m13:26:23.005564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:26:23.006488 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:26:23.006601 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m13:26:23.007018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:26:23.007470 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:26:23.007569 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:26:23.007657 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:26:23.009819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:26:23.010930 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m13:26:23.011155 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:26:23.011257 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m13:26:23.012710 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:26:23.013142 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m13:26:23.013333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9892e0>]}
[0m13:26:23.013536 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.03s]
[0m13:26:23.013715 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m13:26:23.013841 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m13:26:23.014028 [info ] [Thread-1 (]: 4 of 6 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m13:26:23.014201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m13:26:23.014313 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m13:26:23.015344 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m13:26:23.015612 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m13:26:23.016937 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m13:26:23.017146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m13:26:23.017258 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m13:26:23.017370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:23.025316 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m13:26:23.026618 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m13:26:23.026750 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m13:26:23.027465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:26:23.028339 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m13:26:23.028437 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m13:26:23.029030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:26:23.029798 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m13:26:23.029913 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m13:26:23.030008 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m13:26:23.031090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:26:23.031700 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m13:26:23.031893 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m13:26:23.031992 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m13:26:23.033570 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:26:23.033945 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m13:26:23.034120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad91bd0>]}
[0m13:26:23.034313 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mSELECT 4[0m in 0.02s]
[0m13:26:23.034489 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m13:26:23.034600 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:26:23.034769 [info ] [Thread-1 (]: 5 of 6 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:26:23.034916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m13:26:23.035066 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:26:23.036139 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:26:23.036382 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:26:23.037653 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:26:23.037837 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:26:23.037935 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m13:26:23.038030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:23.047004 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.009 seconds
[0m13:26:23.047991 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:26:23.048100 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m13:26:23.048556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:26:23.049328 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:26:23.049427 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m13:26:23.049833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:26:23.050457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:26:23.050564 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:26:23.050660 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:26:23.051620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:26:23.052251 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m13:26:23.052447 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:26:23.052548 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m13:26:23.053733 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:26:23.054136 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:26:23.054310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac7f3d0>]}
[0m13:26:23.054504 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.02s]
[0m13:26:23.054694 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:26:23.054805 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m13:26:23.054956 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m13:26:23.055091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m13:26:23.055190 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m13:26:23.056224 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m13:26:23.056440 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m13:26:23.057662 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m13:26:23.057840 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m13:26:23.057936 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m13:26:23.058030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:23.068558 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.011 seconds
[0m13:26:23.072689 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m13:26:23.072847 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    create  index if not exists
  "38b5c71a3576ed8505a4f71b47ca517d"
  on "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" using btree
  (deal_user_id)
  
[0m13:26:23.074687 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m13:26:23.075665 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m13:26:23.075767 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users" rename to "stg_deal_users__dbt_backup"
[0m13:26:23.076339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:26:23.077297 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m13:26:23.077402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" rename to "stg_deal_users"
[0m13:26:23.078192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:26:23.078619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m13:26:23.078719 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m13:26:23.078806 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m13:26:23.080299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:26:23.080878 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup"
[0m13:26:23.081059 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m13:26:23.081151 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup" cascade
[0m13:26:23.083286 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:26:23.083629 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m13:26:23.083792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d6b867-d00e-440e-b6a8-65610c182aa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf5160>]}
[0m13:26:23.083981 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mSELECT 1787[0m in 0.03s]
[0m13:26:23.084168 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m13:26:23.084617 [debug] [MainThread]: On master: COMMIT
[0m13:26:23.084762 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:23.084847 [debug] [MainThread]: On master: COMMIT
[0m13:26:23.084945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:23.091509 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:26:23.091615 [debug] [MainThread]: On master: Close
[0m13:26:23.091741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:23.091834 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_users' was properly closed.
[0m13:26:23.091956 [info ] [MainThread]: 
[0m13:26:23.092064 [info ] [MainThread]: Finished running 5 incremental models, 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m13:26:23.092476 [debug] [MainThread]: Command end result
[0m13:26:23.100404 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:26:23.101013 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:26:23.103343 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:26:23.103450 [info ] [MainThread]: 
[0m13:26:23.103565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:23.103657 [info ] [MainThread]: 
[0m13:26:23.103762 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m13:26:23.104962 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6003608, "process_in_blocks": "0", "process_kernel_time": 0.113946, "process_mem_max_rss": "146096128", "process_out_blocks": "0", "process_user_time": 0.854995}
[0m13:26:23.105126 [debug] [MainThread]: Command `dbt build` succeeded at 13:26:23.105093 after 0.60 seconds
[0m13:26:23.105252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108899eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8e390>]}
[0m13:26:23.105367 [debug] [MainThread]: Flushing usage events
[0m13:26:24.846623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:54.917520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dacf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dacfb10>]}


============================== 13:30:54.920039 | 6ea14d03-94a9-458b-a3dd-73dfe33268c9 ==============================
[0m13:30:54.920039 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:30:54.920284 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt build --select stg_deatl_stages', 'empty': 'False', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False'}
[0m13:30:54.998315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ea14d03-94a9-458b-a3dd-73dfe33268c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdb69e0>]}
[0m13:30:55.017326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ea14d03-94a9-458b-a3dd-73dfe33268c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da329c0>]}
[0m13:30:55.017798 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:30:55.051688 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:30:55.096396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:30:55.096639 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m13:30:55.096765 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m13:30:55.096877 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m13:30:55.096983 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m13:30:55.097088 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m13:30:55.160674 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  expected token ',', got 'indexes'
    line 5
      indexes=[
[0m13:30:55.162204 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.271407, "process_in_blocks": "0", "process_kernel_time": 0.123688, "process_mem_max_rss": "128155648", "process_out_blocks": "0", "process_user_time": 0.631741}
[0m13:30:55.162381 [debug] [MainThread]: Command `dbt build` failed at 13:30:55.162347 after 0.27 seconds
[0m13:30:55.162503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb22650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb21350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed20c80>]}
[0m13:30:55.162621 [debug] [MainThread]: Flushing usage events
[0m13:30:57.137589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:03.655305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccfb10>]}


============================== 13:31:03.656939 | e5cd3742-ddfb-47ad-9709-9de33831861f ==============================
[0m13:31:03.656939 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:31:03.657170 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt build --select stg_deatl_stages', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'False', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs'}
[0m13:31:03.711324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5cd3742-ddfb-47ad-9709-9de33831861f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfb69e0>]}
[0m13:31:03.731823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5cd3742-ddfb-47ad-9709-9de33831861f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc329c0>]}
[0m13:31:03.732238 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:31:03.762342 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:31:03.797746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:31:03.797997 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m13:31:03.798125 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m13:31:03.798239 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m13:31:03.798346 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m13:31:03.798451 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m13:31:03.856111 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  expected token ',', got 'indexes'
    line 5
      indexes=[
[0m13:31:03.857258 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.22603337, "process_in_blocks": "0", "process_kernel_time": 0.091754, "process_mem_max_rss": "127565824", "process_out_blocks": "0", "process_user_time": 0.63616}
[0m13:31:03.857436 [debug] [MainThread]: Command `dbt build` failed at 13:31:03.857402 after 0.23 seconds
[0m13:31:03.857571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed22650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed21350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed764e0>]}
[0m13:31:03.857688 [debug] [MainThread]: Flushing usage events
[0m13:31:05.295027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:11.634953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7797f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d733890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d733b10>]}


============================== 13:31:11.636852 | a147f86a-3af3-41fa-b3e5-be81ee22c572 ==============================
[0m13:31:11.636852 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:31:11.637094 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'invocation_command': 'dbt build --select stg_deatl_stages', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True'}
[0m13:31:11.692565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a147f86a-3af3-41fa-b3e5-be81ee22c572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca1a9e0>]}
[0m13:31:11.712196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a147f86a-3af3-41fa-b3e5-be81ee22c572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6969c0>]}
[0m13:31:11.712594 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:31:11.743251 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:31:11.778962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:31:11.779235 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_users.sql
[0m13:31:11.779373 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m13:31:11.779493 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m13:31:11.779604 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m13:31:11.779714 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m13:31:11.863407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a147f86a-3af3-41fa-b3e5-be81ee22c572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e782a50>]}
[0m13:31:11.889285 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:31:11.890405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:31:11.929373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a147f86a-3af3-41fa-b3e5-be81ee22c572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d79d9a0>]}
[0m13:31:11.929579 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:31:11.929878 [warn ] [MainThread]: The selection criterion 'stg_deatl_stages' does not match any enabled nodes
[0m13:31:11.930325 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:31:11.930527 [debug] [MainThread]: Command end result
[0m13:31:11.938482 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:31:11.939136 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:31:11.940402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:31:11.941454 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.33062005, "process_in_blocks": "0", "process_kernel_time": 0.093846, "process_mem_max_rss": "130531328", "process_out_blocks": "0", "process_user_time": 0.729348}
[0m13:31:11.941615 [debug] [MainThread]: Command `dbt build` succeeded at 13:31:11.941580 after 0.33 seconds
[0m13:31:11.941743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5442f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d717e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea87d40>]}
[0m13:31:11.941862 [debug] [MainThread]: Flushing usage events
[0m13:31:13.411466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:18.889676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c073890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c073b10>]}


============================== 13:31:18.891316 | ca106115-ed2d-48ed-9df1-d9bd09c6789f ==============================
[0m13:31:18.891316 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:31:18.891554 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --select stg_deal_stages', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m13:31:18.945879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca106115-ed2d-48ed-9df1-d9bd09c6789f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b35a9e0>]}
[0m13:31:18.965533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca106115-ed2d-48ed-9df1-d9bd09c6789f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfd69c0>]}
[0m13:31:18.965896 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:31:18.996161 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:31:19.032017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:19.032196 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:31:19.032283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:19.044049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca106115-ed2d-48ed-9df1-d9bd09c6789f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf19350>]}
[0m13:31:19.068960 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:31:19.069818 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:31:19.078726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca106115-ed2d-48ed-9df1-d9bd09c6789f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0dd9a0>]}
[0m13:31:19.078910 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:31:19.079551 [info ] [MainThread]: 
[0m13:31:19.079672 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:19.079762 [info ] [MainThread]: 
[0m13:31:19.079935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:19.080231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:31:19.103393 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:31:19.103629 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:31:19.103812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:19.136956 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.033 seconds
[0m13:31:19.137559 [debug] [ThreadPool]: On list_postgres: Close
[0m13:31:19.139161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:31:19.141195 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:31:19.141323 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:31:19.141416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:19.151840 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m13:31:19.152399 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:31:19.152725 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:31:19.154501 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:19.154627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:31:19.154734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:19.165576 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m13:31:19.165972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca106115-ed2d-48ed-9df1-d9bd09c6789f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d023930>]}
[0m13:31:19.166141 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:19.166504 [debug] [MainThread]: On master: COMMIT
[0m13:31:19.166594 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:19.166674 [debug] [MainThread]: On master: COMMIT
[0m13:31:19.167214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:19.167301 [debug] [MainThread]: On master: Close
[0m13:31:19.168689 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:31:19.168885 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:31:19.169049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:31:19.169185 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:31:19.172064 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:19.172436 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:31:19.193114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:19.193290 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp133119183833"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m13:31:19.193397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:19.204607 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.011 seconds
[0m13:31:19.232703 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:19.232898 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp133119183833'
        
      order by ordinal_position

  
[0m13:31:19.242752 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m13:31:19.244596 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:19.244725 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m13:31:19.247802 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m13:31:19.250789 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:19.250907 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m13:31:19.253166 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m13:31:19.261754 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:19.262036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:19.262152 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp133119183833" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_stage_name = DBT_INTERNAL_DEST.deal_stage_name
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m13:31:19.264786 [debug] [Thread-1 (]: SQL status: MERGE 9 in 0.002 seconds
[0m13:31:19.269435 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:31:19.269551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:19.269643 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:31:19.271899 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:31:19.272477 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:31:19.273194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca106115-ed2d-48ed-9df1-d9bd09c6789f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d54f5f0>]}
[0m13:31:19.273402 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 9[0m in 0.10s]
[0m13:31:19.273597 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:31:19.274029 [debug] [MainThread]: On master: COMMIT
[0m13:31:19.274133 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:19.274219 [debug] [MainThread]: On master: COMMIT
[0m13:31:19.274307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:19.281041 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:31:19.281163 [debug] [MainThread]: On master: Close
[0m13:31:19.281289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:19.281371 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:31:19.281458 [info ] [MainThread]: 
[0m13:31:19.281561 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:31:19.281774 [debug] [MainThread]: Command end result
[0m13:31:19.290279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:31:19.291046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:31:19.293100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:31:19.293207 [info ] [MainThread]: 
[0m13:31:19.293342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:19.293434 [info ] [MainThread]: 
[0m13:31:19.293541 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:31:19.294717 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.42911988, "process_in_blocks": "0", "process_kernel_time": 0.10718, "process_mem_max_rss": "142753792", "process_out_blocks": "0", "process_user_time": 0.743187}
[0m13:31:19.294859 [debug] [MainThread]: Command `dbt build` succeeded at 13:31:19.294828 after 0.43 seconds
[0m13:31:19.294974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdf3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d154470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d155390>]}
[0m13:31:19.295086 [debug] [MainThread]: Flushing usage events
[0m13:31:20.784640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:36.609377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d803890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d803b10>]}


============================== 13:31:36.611230 | a9fa2330-8143-4c92-9054-bc415d84a300 ==============================
[0m13:31:36.611230 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:31:36.611471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build --select stg_deal_stages', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'introspect': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'quiet': 'False'}
[0m13:31:36.665552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9fa2330-8143-4c92-9054-bc415d84a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caea9e0>]}
[0m13:31:36.684603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9fa2330-8143-4c92-9054-bc415d84a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7669c0>]}
[0m13:31:36.684923 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:31:36.715055 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:31:36.750367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:36.750530 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:31:36.750615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:36.762047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9fa2330-8143-4c92-9054-bc415d84a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ad350>]}
[0m13:31:36.786855 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:31:36.787583 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:31:36.796338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9fa2330-8143-4c92-9054-bc415d84a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86d9a0>]}
[0m13:31:36.796524 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:31:36.797157 [info ] [MainThread]: 
[0m13:31:36.797275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:36.797363 [info ] [MainThread]: 
[0m13:31:36.797532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:36.797834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:31:36.813685 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:31:36.813828 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:31:36.813920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:36.837201 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.023 seconds
[0m13:31:36.837778 [debug] [ThreadPool]: On list_postgres: Close
[0m13:31:36.839319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:31:36.841337 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:31:36.841470 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:31:36.841581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:36.852916 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m13:31:36.853414 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:31:36.853806 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:31:36.855610 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:36.855742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:31:36.855858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:36.866195 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:31:36.866626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9fa2330-8143-4c92-9054-bc415d84a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8b3930>]}
[0m13:31:36.866794 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:36.867129 [debug] [MainThread]: On master: COMMIT
[0m13:31:36.867223 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:36.867303 [debug] [MainThread]: On master: COMMIT
[0m13:31:36.867814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:36.867905 [debug] [MainThread]: On master: Close
[0m13:31:36.868950 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:31:36.869130 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:31:36.869286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:31:36.869399 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:31:36.872383 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:36.872672 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:31:36.893906 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:36.894077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp133136884528"
  
  
    as
  
  (
    

SELECT
  stage_id                 AS deal_stage_id,
  COALESCE(stage_name, '') AS deal_stage_name
FROM "postgres"."public"."stages"
  );
  
  
[0m13:31:36.894183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:36.905349 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.011 seconds
[0m13:31:36.932122 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:36.932314 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp133136884528'
        
      order by ordinal_position

  
[0m13:31:36.940902 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m13:31:36.942699 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:36.942825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m13:31:36.945673 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m13:31:36.948685 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:36.948812 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m13:31:36.951118 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m13:31:36.959040 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:36.959388 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:36.959515 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp133136884528" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_stage_name = DBT_INTERNAL_DEST.deal_stage_name
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m13:31:36.961026 [debug] [Thread-1 (]: SQL status: MERGE 9 in 0.001 seconds
[0m13:31:36.965656 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:31:36.965773 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:31:36.965869 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:31:36.967319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:31:36.967933 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:31:36.968489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9fa2330-8143-4c92-9054-bc415d84a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eddf5f0>]}
[0m13:31:36.968707 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 9[0m in 0.10s]
[0m13:31:36.968914 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:31:36.969361 [debug] [MainThread]: On master: COMMIT
[0m13:31:36.969473 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:36.969554 [debug] [MainThread]: On master: COMMIT
[0m13:31:36.969628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:36.976491 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:31:36.976604 [debug] [MainThread]: On master: Close
[0m13:31:36.976719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:36.976837 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:31:36.977033 [info ] [MainThread]: 
[0m13:31:36.977178 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m13:31:36.977435 [debug] [MainThread]: Command end result
[0m13:31:36.985184 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:31:36.985859 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:31:36.988191 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:31:36.988294 [info ] [MainThread]: 
[0m13:31:36.988423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:36.988529 [info ] [MainThread]: 
[0m13:31:36.988637 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:31:36.989785 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.40454817, "process_in_blocks": "0", "process_kernel_time": 0.099209, "process_mem_max_rss": "142819328", "process_out_blocks": "0", "process_user_time": 0.73454}
[0m13:31:36.989929 [debug] [MainThread]: Command `dbt build` succeeded at 13:31:36.989898 after 0.40 seconds
[0m13:31:36.990059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d583a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9e4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9e5390>]}
[0m13:31:36.990177 [debug] [MainThread]: Flushing usage events
[0m13:31:38.582084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:55.508356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9897f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b943890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b943b10>]}


============================== 13:45:55.510820 | bedb879b-486b-4451-a9bb-2a7b26edab67 ==============================
[0m13:45:55.510820 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:45:55.511054 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build --select stg_deal_stages', 'introspect': 'True', 'debug': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m13:45:55.589007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bedb879b-486b-4451-a9bb-2a7b26edab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac2a9e0>]}
[0m13:45:55.608505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bedb879b-486b-4451-a9bb-2a7b26edab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a69c0>]}
[0m13:45:55.608978 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:45:55.642116 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:45:55.687865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:45:55.688074 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/readme.md
[0m13:45:55.688200 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m13:45:55.772392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bedb879b-486b-4451-a9bb-2a7b26edab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ed150>]}
[0m13:45:55.798034 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:45:55.799124 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:45:55.836443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bedb879b-486b-4451-a9bb-2a7b26edab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9ad9a0>]}
[0m13:45:55.836652 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:45:55.837341 [info ] [MainThread]: 
[0m13:45:55.837474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:55.837568 [info ] [MainThread]: 
[0m13:45:55.837742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:55.838074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:45:55.860981 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:45:55.861167 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:45:55.861271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:55.894894 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.034 seconds
[0m13:45:55.895450 [debug] [ThreadPool]: On list_postgres: Close
[0m13:45:55.897050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:45:55.899130 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:45:55.899260 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:45:55.899357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:55.910042 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m13:45:55.910461 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:45:55.910828 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:45:55.912703 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:55.912838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:45:55.912951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:55.922214 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m13:45:55.922634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bedb879b-486b-4451-a9bb-2a7b26edab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cae2350>]}
[0m13:45:55.922806 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:55.923234 [debug] [MainThread]: On master: COMMIT
[0m13:45:55.923321 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:55.923398 [debug] [MainThread]: On master: COMMIT
[0m13:45:55.923929 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:45:55.924019 [debug] [MainThread]: On master: Close
[0m13:45:55.925014 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:45:55.925180 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:45:55.925335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:45:55.925445 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:45:55.929154 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:45:55.929528 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:45:55.948057 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:45:55.948312 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp134555940186"
  
  
    as
  
  (
    

SELECT
  md5(stage_id::text || stage_name::text) AS deal_stage_hash_id,
  stage_id                 AS deal_stage_id,
  stage_name               AS deal_stage_name
FROM "postgres"."public"."stages"
WHERE deal_stage_id IS NOT NULL

and deal_stage_hash_id NOT IN (SELECT DISTINCT deal_stage_hash_id FROM "postgres"."public_pipedrive_staging"."stg_deal_stages")

  );
  
  
[0m13:45:55.948472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:55.959357 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "deal_stage_id" does not exist
LINE 20: WHERE deal_stage_id IS NOT NULL
               ^

[0m13:45:55.959529 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:45:55.964889 [debug] [Thread-1 (]: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_id" does not exist
  LINE 20: WHERE deal_stage_id IS NOT NULL
                 ^
[0m13:45:55.965726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bedb879b-486b-4451-a9bb-2a7b26edab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfc8530>]}
[0m13:45:55.965990 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_stages  [[31mERROR[0m in 0.04s]
[0m13:45:55.966208 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:45:55.966377 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_id" does not exist
  LINE 20: WHERE deal_stage_id IS NOT NULL
                 ^.
[0m13:45:55.966915 [debug] [MainThread]: On master: COMMIT
[0m13:45:55.967034 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:55.967124 [debug] [MainThread]: On master: COMMIT
[0m13:45:55.967202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:55.974146 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:45:55.974256 [debug] [MainThread]: On master: Close
[0m13:45:55.974483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:55.974695 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:45:55.974818 [info ] [MainThread]: 
[0m13:45:55.974935 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m13:45:55.975179 [debug] [MainThread]: Command end result
[0m13:45:55.983362 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:45:55.984015 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:45:55.986001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:45:55.986093 [info ] [MainThread]: 
[0m13:45:55.986218 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:45:55.986312 [info ] [MainThread]: 
[0m13:45:55.986431 [error] [MainThread]: [31mFailure in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)[0m
[0m13:45:55.986539 [error] [MainThread]:   Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_id" does not exist
  LINE 20: WHERE deal_stage_id IS NOT NULL
                 ^
[0m13:45:55.986623 [info ] [MainThread]: 
[0m13:45:55.986720 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m13:45:55.986801 [info ] [MainThread]: 
[0m13:45:55.986894 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:45:55.988418 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.5061753, "process_in_blocks": "0", "process_kernel_time": 0.139923, "process_mem_max_rss": "145424384", "process_out_blocks": "0", "process_user_time": 0.778274}
[0m13:45:55.988553 [debug] [MainThread]: Command `dbt build` failed at 13:45:55.988525 after 0.51 seconds
[0m13:45:55.988665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd5de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd5ff0>]}
[0m13:45:55.988768 [debug] [MainThread]: Flushing usage events
[0m13:45:57.738548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:05.175015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109237890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109237b10>]}


============================== 13:46:05.176638 | bbf82c38-54ce-4b4b-8d79-277a6af5cdfa ==============================
[0m13:46:05.176638 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:46:05.176875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select stg_deal_stages --full-refresh', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'debug': 'False'}
[0m13:46:05.229976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbf82c38-54ce-4b4b-8d79-277a6af5cdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851e9e0>]}
[0m13:46:05.249011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbf82c38-54ce-4b4b-8d79-277a6af5cdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919a9c0>]}
[0m13:46:05.249348 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:46:05.279275 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:46:05.315038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:05.315197 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:46:05.315281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:05.326574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbf82c38-54ce-4b4b-8d79-277a6af5cdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a289350>]}
[0m13:46:05.351586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:46:05.352302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:46:05.361228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbf82c38-54ce-4b4b-8d79-277a6af5cdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a19a0>]}
[0m13:46:05.361406 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:46:05.362045 [info ] [MainThread]: 
[0m13:46:05.362168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:05.362259 [info ] [MainThread]: 
[0m13:46:05.362433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:05.362736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:46:05.378811 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:46:05.378978 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:46:05.379076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:05.399207 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.020 seconds
[0m13:46:05.399822 [debug] [ThreadPool]: On list_postgres: Close
[0m13:46:05.401413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:46:05.403412 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:46:05.403541 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:46:05.403643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:05.414439 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m13:46:05.414900 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:46:05.415295 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:46:05.416974 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:05.417104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:46:05.417213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:05.426815 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:46:05.427221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbf82c38-54ce-4b4b-8d79-277a6af5cdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a397930>]}
[0m13:46:05.427374 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:05.427750 [debug] [MainThread]: On master: COMMIT
[0m13:46:05.427838 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:05.427915 [debug] [MainThread]: On master: COMMIT
[0m13:46:05.428487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:46:05.428577 [debug] [MainThread]: On master: Close
[0m13:46:05.429590 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:46:05.429762 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:46:05.429920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:46:05.430029 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:46:05.435118 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:05.435426 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:46:05.455528 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:05.455860 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:05.455971 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  md5(stage_id::text || stage_name::text) AS deal_stage_hash_id,
  stage_id                 AS deal_stage_id,
  stage_name               AS deal_stage_name
FROM "postgres"."public"."stages"
WHERE deal_stage_id IS NOT NULL

  );
  
  
[0m13:46:05.456071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:05.466135 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "deal_stage_id" does not exist
LINE 20: WHERE deal_stage_id IS NOT NULL
               ^

[0m13:46:05.466257 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: ROLLBACK
[0m13:46:05.466893 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:46:05.468882 [debug] [Thread-1 (]: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_id" does not exist
  LINE 20: WHERE deal_stage_id IS NOT NULL
                 ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m13:46:05.469482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbf82c38-54ce-4b4b-8d79-277a6af5cdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c9160>]}
[0m13:46:05.469695 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_stages  [[31mERROR[0m in 0.04s]
[0m13:46:05.469911 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:46:05.470061 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_id" does not exist
  LINE 20: WHERE deal_stage_id IS NOT NULL
                 ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql.
[0m13:46:05.470569 [debug] [MainThread]: On master: COMMIT
[0m13:46:05.470665 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:05.470742 [debug] [MainThread]: On master: COMMIT
[0m13:46:05.470810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:05.477402 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:46:05.477499 [debug] [MainThread]: On master: Close
[0m13:46:05.477620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:05.477699 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:46:05.477793 [info ] [MainThread]: 
[0m13:46:05.477893 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m13:46:05.478103 [debug] [MainThread]: Command end result
[0m13:46:05.510533 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:46:05.511200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:46:05.513151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:46:05.513242 [info ] [MainThread]: 
[0m13:46:05.513365 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:46:05.513461 [info ] [MainThread]: 
[0m13:46:05.513581 [error] [MainThread]: [31mFailure in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)[0m
[0m13:46:05.513693 [error] [MainThread]:   Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_id" does not exist
  LINE 20: WHERE deal_stage_id IS NOT NULL
                 ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m13:46:05.513775 [info ] [MainThread]: 
[0m13:46:05.513872 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m13:46:05.513955 [info ] [MainThread]: 
[0m13:46:05.514049 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:46:05.515243 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.36358204, "process_in_blocks": "0", "process_kernel_time": 0.099564, "process_mem_max_rss": "142671872", "process_out_blocks": "0", "process_user_time": 0.720774}
[0m13:46:05.515499 [debug] [MainThread]: Command `dbt build` failed at 13:46:05.515443 after 0.36 seconds
[0m13:46:05.515662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c57b0>]}
[0m13:46:05.515794 [debug] [MainThread]: Flushing usage events
[0m13:46:07.010665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:32.238174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c7b10>]}


============================== 13:46:32.239837 | a46b48e5-c482-4631-9605-9c83a36c5995 ==============================
[0m13:46:32.239837 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:46:32.240079 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --select stg_deal_stages --full-refresh', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'warn_error': 'None'}
[0m13:46:32.293731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a46b48e5-c482-4631-9605-9c83a36c5995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4ae9e0>]}
[0m13:46:32.313046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a46b48e5-c482-4631-9605-9c83a36c5995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b12a9c0>]}
[0m13:46:32.313367 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:46:32.343087 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:46:32.378549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:32.378784 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m13:46:32.460235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a46b48e5-c482-4631-9605-9c83a36c5995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c21d150>]}
[0m13:46:32.485983 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:46:32.486756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:46:32.517921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a46b48e5-c482-4631-9605-9c83a36c5995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2319a0>]}
[0m13:46:32.518123 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:46:32.518811 [info ] [MainThread]: 
[0m13:46:32.518942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:32.519036 [info ] [MainThread]: 
[0m13:46:32.519207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:32.519530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:46:32.538462 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:46:32.538635 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:46:32.538733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:32.557126 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.018 seconds
[0m13:46:32.557731 [debug] [ThreadPool]: On list_postgres: Close
[0m13:46:32.559369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:46:32.561450 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:46:32.561581 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:46:32.561688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:32.572865 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m13:46:32.573340 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:46:32.573658 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:46:32.575563 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:32.575699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:46:32.575807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:32.585617 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:46:32.585998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a46b48e5-c482-4631-9605-9c83a36c5995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c412350>]}
[0m13:46:32.586152 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:32.586564 [debug] [MainThread]: On master: COMMIT
[0m13:46:32.586652 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:32.586729 [debug] [MainThread]: On master: COMMIT
[0m13:46:32.587317 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:46:32.587410 [debug] [MainThread]: On master: Close
[0m13:46:32.588200 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:46:32.588374 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:46:32.588530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:46:32.588637 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:46:32.592474 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:32.592733 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:46:32.611362 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:32.611732 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:32.611849 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  md5(stage_id::text || stage_name::text) AS deal_stage_hash_id,
  stage_id                 AS deal_stage_id,
  stage_name               AS deal_stage_name
FROM "postgres"."public"."stages"
WHERE stage_name IS NOT NULL

  );
  
  
[0m13:46:32.611955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:32.623468 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.011 seconds
[0m13:46:32.628297 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:32.628436 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "50b68d5505f934a9722bce2dedcf786e"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_hash_id)
  
[0m13:46:32.630370 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m13:46:32.632629 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:32.632742 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m13:46:32.633600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:46:32.634507 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:32.634611 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m13:46:32.635163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:32.640337 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:46:32.640451 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:32.640543 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:46:32.642040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:46:32.643945 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m13:46:32.645389 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:32.645492 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m13:46:32.648692 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:46:32.649479 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:46:32.650062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46b48e5-c482-4631-9605-9c83a36c5995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ff1e0>]}
[0m13:46:32.650271 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.06s]
[0m13:46:32.650475 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:46:32.650892 [debug] [MainThread]: On master: COMMIT
[0m13:46:32.650983 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:32.651059 [debug] [MainThread]: On master: COMMIT
[0m13:46:32.651130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:32.658815 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m13:46:32.658928 [debug] [MainThread]: On master: Close
[0m13:46:32.659050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:32.659131 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:46:32.659217 [info ] [MainThread]: 
[0m13:46:32.659319 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m13:46:32.659528 [debug] [MainThread]: Command end result
[0m13:46:32.669168 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:46:32.669843 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:46:32.671789 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:46:32.671883 [info ] [MainThread]: 
[0m13:46:32.672014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:32.672108 [info ] [MainThread]: 
[0m13:46:32.672213 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:46:32.673716 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.45949495, "process_in_blocks": "0", "process_kernel_time": 0.114626, "process_mem_max_rss": "145113088", "process_out_blocks": "0", "process_user_time": 0.79394}
[0m13:46:32.673874 [debug] [MainThread]: Command `dbt build` succeeded at 13:46:32.673840 after 0.46 seconds
[0m13:46:32.673994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af47a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c502360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c502150>]}
[0m13:46:32.674099 [debug] [MainThread]: Flushing usage events
[0m13:46:34.263536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:40.679912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e317f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109deb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109debb10>]}


============================== 13:46:40.681539 | a8dbb038-b464-4bfe-86a1-0b71ffa98827 ==============================
[0m13:46:40.681539 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:46:40.681764 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'invocation_command': 'dbt build --select stg_deal_stages', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'static_parser': 'True'}
[0m13:46:40.736085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8dbb038-b464-4bfe-86a1-0b71ffa98827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d29e0>]}
[0m13:46:40.755533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8dbb038-b464-4bfe-86a1-0b71ffa98827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d4e9c0>]}
[0m13:46:40.755841 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:46:40.786754 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:46:40.822873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:40.823040 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:46:40.823125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:40.834849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8dbb038-b464-4bfe-86a1-0b71ffa98827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae41350>]}
[0m13:46:40.859472 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:46:40.860286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:46:40.869401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8dbb038-b464-4bfe-86a1-0b71ffa98827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e559a0>]}
[0m13:46:40.869585 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:46:40.870242 [info ] [MainThread]: 
[0m13:46:40.870366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:40.870458 [info ] [MainThread]: 
[0m13:46:40.870637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:40.870928 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:46:40.886962 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:46:40.887130 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:46:40.887222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:40.906190 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.019 seconds
[0m13:46:40.906801 [debug] [ThreadPool]: On list_postgres: Close
[0m13:46:40.908380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:46:40.910381 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:46:40.910511 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:46:40.910612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:40.922038 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m13:46:40.922515 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:46:40.922921 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:46:40.924611 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:40.924741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:46:40.924845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:40.934934 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:46:40.935346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8dbb038-b464-4bfe-86a1-0b71ffa98827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af4b930>]}
[0m13:46:40.935502 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:40.935927 [debug] [MainThread]: On master: COMMIT
[0m13:46:40.936015 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:40.936095 [debug] [MainThread]: On master: COMMIT
[0m13:46:40.936751 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:46:40.936841 [debug] [MainThread]: On master: Close
[0m13:46:40.937920 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:46:40.938093 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:46:40.938247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:46:40.938361 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:46:40.943546 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:40.943827 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:46:40.963781 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:46:40.963957 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp134640955795"
  
  
    as
  
  (
    

SELECT
  md5(stage_id::text || stage_name::text) AS deal_stage_hash_id,
  stage_id                 AS deal_stage_id,
  stage_name               AS deal_stage_name
FROM "postgres"."public"."stages"
WHERE stage_name IS NOT NULL

and deal_stage_hash_id NOT IN (SELECT DISTINCT deal_stage_hash_id FROM "postgres"."public_pipedrive_staging"."stg_deal_stages")

  );
  
  
[0m13:46:40.964066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:40.973663 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "deal_stage_hash_id" does not exist
LINE 22: and deal_stage_hash_id NOT IN (SELECT DISTINCT deal_stage_ha...
             ^

[0m13:46:40.973829 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:46:40.976066 [debug] [Thread-1 (]: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_hash_id" does not exist
  LINE 22: and deal_stage_hash_id NOT IN (SELECT DISTINCT deal_stage_ha...
               ^
[0m13:46:40.976700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dbb038-b464-4bfe-86a1-0b71ffa98827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b481f30>]}
[0m13:46:40.976926 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_stages  [[31mERROR[0m in 0.04s]
[0m13:46:40.977142 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:46:40.977298 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_hash_id" does not exist
  LINE 22: and deal_stage_hash_id NOT IN (SELECT DISTINCT deal_stage_ha...
               ^.
[0m13:46:40.977801 [debug] [MainThread]: On master: COMMIT
[0m13:46:40.977900 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:40.977980 [debug] [MainThread]: On master: COMMIT
[0m13:46:40.978053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:40.985054 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:46:40.985193 [debug] [MainThread]: On master: Close
[0m13:46:40.985331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:40.985415 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:46:40.985504 [info ] [MainThread]: 
[0m13:46:40.985610 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m13:46:40.985833 [debug] [MainThread]: Command end result
[0m13:46:41.019202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:46:41.019927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:46:41.021928 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:46:41.022033 [info ] [MainThread]: 
[0m13:46:41.022167 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:46:41.022280 [info ] [MainThread]: 
[0m13:46:41.022407 [error] [MainThread]: [31mFailure in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)[0m
[0m13:46:41.022523 [error] [MainThread]:   Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column "deal_stage_hash_id" does not exist
  LINE 22: and deal_stage_hash_id NOT IN (SELECT DISTINCT deal_stage_ha...
               ^
[0m13:46:41.022605 [info ] [MainThread]: 
[0m13:46:41.022716 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m13:46:41.022807 [info ] [MainThread]: 
[0m13:46:41.022914 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:46:41.024093 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.36949986, "process_in_blocks": "0", "process_kernel_time": 0.095005, "process_mem_max_rss": "142802944", "process_out_blocks": "0", "process_user_time": 0.704693}
[0m13:46:41.024235 [debug] [MainThread]: Command `dbt build` failed at 13:46:41.024205 after 0.37 seconds
[0m13:46:41.024361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b079180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0792e0>]}
[0m13:46:41.024469 [debug] [MainThread]: Flushing usage events
[0m13:46:42.527559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:19.471749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d27b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d27bb10>]}


============================== 13:47:19.473446 | 2165b3ed-5c62-4a51-b5c9-2965f17ca242 ==============================
[0m13:47:19.473446 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:47:19.473691 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --select stg_deal_stages --full-refresh', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'empty': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False'}
[0m13:47:19.528255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2165b3ed-5c62-4a51-b5c9-2965f17ca242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5629e0>]}
[0m13:47:19.547213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2165b3ed-5c62-4a51-b5c9-2965f17ca242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1de9c0>]}
[0m13:47:19.547532 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:47:19.578998 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:47:19.616006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:19.616236 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m13:47:19.698929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2165b3ed-5c62-4a51-b5c9-2965f17ca242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e121150>]}
[0m13:47:19.723951 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:47:19.724677 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:47:19.754567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2165b3ed-5c62-4a51-b5c9-2965f17ca242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca7e8a0>]}
[0m13:47:19.754771 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:47:19.755401 [info ] [MainThread]: 
[0m13:47:19.755530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:19.755624 [info ] [MainThread]: 
[0m13:47:19.755789 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:19.756091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:47:19.774784 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:47:19.774954 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:47:19.775057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:19.794034 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.019 seconds
[0m13:47:19.794591 [debug] [ThreadPool]: On list_postgres: Close
[0m13:47:19.796152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:47:19.798139 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:47:19.798271 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:47:19.798370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:19.808137 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m13:47:19.808563 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:47:19.808991 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:47:19.810753 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:19.810884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:47:19.810996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:19.820691 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:47:19.821060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2165b3ed-5c62-4a51-b5c9-2965f17ca242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e319b70>]}
[0m13:47:19.821212 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:19.821566 [debug] [MainThread]: On master: COMMIT
[0m13:47:19.821660 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:19.821738 [debug] [MainThread]: On master: COMMIT
[0m13:47:19.822331 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:47:19.822420 [debug] [MainThread]: On master: Close
[0m13:47:19.823147 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:47:19.823316 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:47:19.823463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:47:19.823571 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:47:19.827318 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:19.827608 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:47:19.845332 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:19.845680 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:19.845794 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

WITH deal_stage_data AS (
SELECT
  md5(stage_id::text || stage_name::text) AS deal_stage_hash_id,
  stage_id                 AS deal_stage_id,
  stage_name               AS deal_stage_name
FROM "postgres"."public"."stages"
WHERE stage_name IS NOT NULL
)
SELECT
  deal_stage_hash_id,
  deal_stage_id,
  deal_stage_name
FROM deal_stage_data

  );
  
  
[0m13:47:19.845898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:19.857536 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.012 seconds
[0m13:47:19.862167 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:19.862291 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "e7e0c1790894fdb5c32bc96b014805c2"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_hash_id)
  
[0m13:47:19.863365 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m13:47:19.865473 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:19.865588 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m13:47:19.866344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:19.867176 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:19.867275 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m13:47:19.867793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:47:19.872815 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:47:19.872926 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:19.873016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:47:19.874440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:47:19.876301 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m13:47:19.877689 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:19.877795 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m13:47:19.881343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:47:19.882080 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:47:19.882633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2165b3ed-5c62-4a51-b5c9-2965f17ca242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138331e0>]}
[0m13:47:19.882836 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.06s]
[0m13:47:19.883036 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:47:19.883469 [debug] [MainThread]: On master: COMMIT
[0m13:47:19.883581 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:19.883664 [debug] [MainThread]: On master: COMMIT
[0m13:47:19.883740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:19.891746 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m13:47:19.891847 [debug] [MainThread]: On master: Close
[0m13:47:19.891959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:19.892034 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:47:19.892115 [info ] [MainThread]: 
[0m13:47:19.892215 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m13:47:19.892427 [debug] [MainThread]: Command end result
[0m13:47:19.901855 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:47:19.902574 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:47:19.904576 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:47:19.904674 [info ] [MainThread]: 
[0m13:47:19.904801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:19.904894 [info ] [MainThread]: 
[0m13:47:19.905001 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:47:19.906082 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.45846897, "process_in_blocks": "0", "process_kernel_time": 0.113166, "process_mem_max_rss": "145080320", "process_out_blocks": "0", "process_user_time": 0.797952}
[0m13:47:19.906221 [debug] [MainThread]: Command `dbt build` succeeded at 13:47:19.906192 after 0.46 seconds
[0m13:47:19.906330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cffba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40e150>]}
[0m13:47:19.906437 [debug] [MainThread]: Flushing usage events
[0m13:47:23.958801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:26.842552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db2f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db2fb10>]}


============================== 13:47:26.844229 | e4a94435-7a63-4da4-9748-cc6359cd4af2 ==============================
[0m13:47:26.844229 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:47:26.844459 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'invocation_command': 'dbt build --select stg_deal_stages', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None'}
[0m13:47:26.899965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4a94435-7a63-4da4-9748-cc6359cd4af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce169e0>]}
[0m13:47:26.919050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4a94435-7a63-4da4-9748-cc6359cd4af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da929c0>]}
[0m13:47:26.919389 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:47:26.950041 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:47:26.985929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:26.986082 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:47:26.986164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:26.997248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4a94435-7a63-4da4-9748-cc6359cd4af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb81350>]}
[0m13:47:27.021762 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:47:27.022496 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:47:27.031406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4a94435-7a63-4da4-9748-cc6359cd4af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db999a0>]}
[0m13:47:27.031575 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:47:27.032277 [info ] [MainThread]: 
[0m13:47:27.032428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:27.032529 [info ] [MainThread]: 
[0m13:47:27.032709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:27.033024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:47:27.052035 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:47:27.052189 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:47:27.052277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:27.071441 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.019 seconds
[0m13:47:27.071960 [debug] [ThreadPool]: On list_postgres: Close
[0m13:47:27.073507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:47:27.075438 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:47:27.075555 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:47:27.075671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:27.087317 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m13:47:27.087799 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:47:27.088195 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:47:27.089888 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:27.090031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:47:27.090149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:27.099994 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:47:27.100376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a94435-7a63-4da4-9748-cc6359cd4af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed92eb0>]}
[0m13:47:27.100531 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:27.100878 [debug] [MainThread]: On master: COMMIT
[0m13:47:27.100970 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:27.101045 [debug] [MainThread]: On master: COMMIT
[0m13:47:27.101557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:27.101642 [debug] [MainThread]: On master: Close
[0m13:47:27.102704 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:47:27.102882 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:47:27.103041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:47:27.103154 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:47:27.108304 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:27.108598 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:47:27.142134 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:27.142371 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp134727128491"
  
  
    as
  
  (
    

WITH deal_stage_data AS (
SELECT
  md5(stage_id::text || stage_name::text) AS deal_stage_hash_id,
  stage_id                 AS deal_stage_id,
  stage_name               AS deal_stage_name
FROM "postgres"."public"."stages"
WHERE stage_name IS NOT NULL
)
SELECT
  deal_stage_hash_id,
  deal_stage_id,
  deal_stage_name
FROM deal_stage_data

where deal_stage_hash_id NOT IN (SELECT DISTINCT deal_stage_hash_id FROM "postgres"."public_pipedrive_staging"."stg_deal_stages")

  );
  
  
[0m13:47:27.142504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:27.155740 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m13:47:27.183630 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:27.183852 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp134727128491'
        
      order by ordinal_position

  
[0m13:47:27.191636 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.008 seconds
[0m13:47:27.193621 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:27.193753 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m13:47:27.197579 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m13:47:27.200856 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:27.200979 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m13:47:27.203432 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m13:47:27.211213 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:27.211524 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:27.211649 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp134727128491" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_stage_name = DBT_INTERNAL_DEST.deal_stage_name
                )

    
    when matched then update set
        "deal_stage_hash_id" = DBT_INTERNAL_SOURCE."deal_stage_hash_id","deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_hash_id", "deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_hash_id", "deal_stage_id", "deal_stage_name")


  
[0m13:47:27.213138 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.001 seconds
[0m13:47:27.217989 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:47:27.218111 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:47:27.218208 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:47:27.219476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:47:27.220113 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:47:27.220682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4a94435-7a63-4da4-9748-cc6359cd4af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1c7930>]}
[0m13:47:27.220889 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.12s]
[0m13:47:27.221093 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:47:27.221537 [debug] [MainThread]: On master: COMMIT
[0m13:47:27.221660 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:27.221749 [debug] [MainThread]: On master: COMMIT
[0m13:47:27.221825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:27.228741 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:47:27.228850 [debug] [MainThread]: On master: Close
[0m13:47:27.228965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:27.229042 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:47:27.229127 [info ] [MainThread]: 
[0m13:47:27.229242 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:47:27.229471 [debug] [MainThread]: Command end result
[0m13:47:27.237665 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:47:27.238348 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:47:27.240427 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:47:27.240518 [info ] [MainThread]: 
[0m13:47:27.240644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:27.240739 [info ] [MainThread]: 
[0m13:47:27.240845 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:47:27.242185 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.42491895, "process_in_blocks": "0", "process_kernel_time": 0.11466, "process_mem_max_rss": "142721024", "process_out_blocks": "0", "process_user_time": 0.751714}
[0m13:47:27.242332 [debug] [MainThread]: Command `dbt build` succeeded at 13:47:27.242301 after 0.43 seconds
[0m13:47:27.242452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8afa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edbc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edbd390>]}
[0m13:47:27.242557 [debug] [MainThread]: Flushing usage events
[0m13:47:28.835147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:40.284125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924fb10>]}


============================== 13:54:40.286566 | 88ceb6bf-981e-4657-8f4f-b1d93a5dcdf0 ==============================
[0m13:54:40.286566 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:54:40.286801 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'debug': 'False', 'empty': 'False', 'introspect': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select stg_deal_stages --full-refresh', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m13:54:40.359336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88ceb6bf-981e-4657-8f4f-b1d93a5dcdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853a9e0>]}
[0m13:54:40.378297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88ceb6bf-981e-4657-8f4f-b1d93a5dcdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b69c0>]}
[0m13:54:40.378735 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:54:40.412084 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:54:40.453490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:40.453717 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m13:54:40.537623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88ceb6bf-981e-4657-8f4f-b1d93a5dcdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a9150>]}
[0m13:54:40.563115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:54:40.564230 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:54:40.594239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88ceb6bf-981e-4657-8f4f-b1d93a5dcdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a568a0>]}
[0m13:54:40.594457 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:54:40.594588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ceb6bf-981e-4657-8f4f-b1d93a5dcdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a10a970>]}
[0m13:54:40.595229 [info ] [MainThread]: 
[0m13:54:40.595362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:40.595454 [info ] [MainThread]: 
[0m13:54:40.595625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:40.595923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:54:40.618134 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:54:40.618288 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:54:40.618377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:40.648795 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.030 seconds
[0m13:54:40.649352 [debug] [ThreadPool]: On list_postgres: Close
[0m13:54:40.650928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:54:40.652891 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:54:40.653011 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:54:40.653110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:40.664502 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m13:54:40.664921 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:54:40.665290 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:54:40.667186 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:40.667306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:54:40.667407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:40.676994 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:54:40.677400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ceb6bf-981e-4657-8f4f-b1d93a5dcdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a676ea0>]}
[0m13:54:40.677561 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:40.677934 [debug] [MainThread]: On master: COMMIT
[0m13:54:40.678024 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:40.678102 [debug] [MainThread]: On master: COMMIT
[0m13:54:40.678686 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:54:40.678778 [debug] [MainThread]: On master: Close
[0m13:54:40.679858 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:54:40.680026 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:54:40.680181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:54:40.680292 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:54:40.684047 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:40.684300 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:54:40.702515 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:40.702829 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:40.702949 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

WITH source_deal_stages_data AS (
  SELECT
    stage_id as deal_stage_id,
    stage_name as deal_stage_name
  FROM "postgres"."public"."stages"
  WHERE stage_id IS NOT NULL
)

SELECT
  deal_stage_id,
  deal_stage_name
FROM source_deal_stages_data


  );
  
  
[0m13:54:40.703054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:40.715089 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.012 seconds
[0m13:54:40.719905 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:40.720034 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "ccc93b214cc793a3814ff52c5f00a166"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_id, deal_stage_name)
  
[0m13:54:40.721571 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m13:54:40.723695 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:40.723810 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m13:54:40.724623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:40.725444 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:40.725544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m13:54:40.726164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:40.731338 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:54:40.731459 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:40.731552 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:54:40.733061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:54:40.734962 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m13:54:40.736428 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:40.736532 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m13:54:40.739582 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:54:40.740317 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:54:40.741045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ceb6bf-981e-4657-8f4f-b1d93a5dcdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dcdd0>]}
[0m13:54:40.741261 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.06s]
[0m13:54:40.741465 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:54:40.741925 [debug] [MainThread]: On master: COMMIT
[0m13:54:40.742061 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:40.742157 [debug] [MainThread]: On master: COMMIT
[0m13:54:40.742241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:40.748825 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:54:40.748921 [debug] [MainThread]: On master: Close
[0m13:54:40.749042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:40.749129 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:54:40.749245 [info ] [MainThread]: 
[0m13:54:40.749462 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m13:54:40.749724 [debug] [MainThread]: Command end result
[0m13:54:40.757460 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:54:40.758066 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:54:40.760028 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:54:40.760122 [info ] [MainThread]: 
[0m13:54:40.760253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:40.760345 [info ] [MainThread]: 
[0m13:54:40.760456 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:54:40.762029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5043827, "process_in_blocks": "0", "process_kernel_time": 0.141011, "process_mem_max_rss": "143933440", "process_out_blocks": "0", "process_user_time": 0.789618}
[0m13:54:40.762192 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:40.762160 after 0.50 seconds
[0m13:54:40.762309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ade50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8adef0>]}
[0m13:54:40.762421 [debug] [MainThread]: Flushing usage events
[0m13:54:42.744292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:50.095466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969fb10>]}


============================== 13:54:50.097953 | 915ddcda-4e1b-4588-8eef-e13b08272d95 ==============================
[0m13:54:50.097953 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:54:50.098200 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt build --select stg_deal_stages', 'introspect': 'True', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'warn_error': 'None'}
[0m13:54:50.156119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '915ddcda-4e1b-4588-8eef-e13b08272d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089869e0>]}
[0m13:54:50.175127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '915ddcda-4e1b-4588-8eef-e13b08272d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096029c0>]}
[0m13:54:50.175508 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:54:50.209039 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:54:50.252118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:50.252296 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:54:50.252379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:50.263837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '915ddcda-4e1b-4588-8eef-e13b08272d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f1350>]}
[0m13:54:50.288657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:54:50.289655 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:54:50.304670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '915ddcda-4e1b-4588-8eef-e13b08272d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097099a0>]}
[0m13:54:50.304851 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:54:50.305526 [info ] [MainThread]: 
[0m13:54:50.305644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:50.305730 [info ] [MainThread]: 
[0m13:54:50.305936 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:50.306246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:54:50.329010 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:54:50.329188 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:54:50.329281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:50.348352 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.019 seconds
[0m13:54:50.348927 [debug] [ThreadPool]: On list_postgres: Close
[0m13:54:50.350657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:54:50.352711 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:54:50.352839 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:54:50.352948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:50.363602 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m13:54:50.364223 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:54:50.364616 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:54:50.366752 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:50.366917 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:54:50.367027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:50.378347 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m13:54:50.378806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '915ddcda-4e1b-4588-8eef-e13b08272d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fb930>]}
[0m13:54:50.378967 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:50.379464 [debug] [MainThread]: On master: COMMIT
[0m13:54:50.379579 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:50.379704 [debug] [MainThread]: On master: COMMIT
[0m13:54:50.380280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:50.380412 [debug] [MainThread]: On master: Close
[0m13:54:50.381763 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:54:50.381932 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:54:50.382083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:54:50.382194 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:54:50.386960 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:50.387216 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:54:50.407601 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:54:50.407783 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp135450399565"
  
  
    as
  
  (
    

WITH source_deal_stages_data AS (
  SELECT
    stage_id as deal_stage_id,
    stage_name as deal_stage_name
  FROM "postgres"."public"."stages"
  WHERE stage_id IS NOT NULL
)

SELECT
  deal_stage_id,
  deal_stage_name
FROM source_deal_stages_data



LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
  ON source_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  AND source_deal_stages_data.deal_stage_name = existing_deal_stages_data.deal_stage_name
WHERE existing_deal_stages_data.deal_stage_id IS NULL
   OR existing_deal_stages_data.deal_stage_name IS NULL
   

  );
  
  
[0m13:54:50.407899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:50.417921 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "deal_stage_id" is ambiguous
LINE 24:   deal_stage_id,
           ^

[0m13:54:50.418123 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:54:50.423361 [debug] [Thread-1 (]: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column reference "deal_stage_id" is ambiguous
  LINE 24:   deal_stage_id,
             ^
[0m13:54:50.424175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '915ddcda-4e1b-4588-8eef-e13b08272d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad38fc0>]}
[0m13:54:50.424426 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_stages  [[31mERROR[0m in 0.04s]
[0m13:54:50.424642 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:54:50.424833 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column reference "deal_stage_id" is ambiguous
  LINE 24:   deal_stage_id,
             ^.
[0m13:54:50.425396 [debug] [MainThread]: On master: COMMIT
[0m13:54:50.425515 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:50.425607 [debug] [MainThread]: On master: COMMIT
[0m13:54:50.425690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:50.433034 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:54:50.433168 [debug] [MainThread]: On master: Close
[0m13:54:50.433299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:50.433381 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:54:50.433468 [info ] [MainThread]: 
[0m13:54:50.433575 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m13:54:50.433791 [debug] [MainThread]: Command end result
[0m13:54:50.467660 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:54:50.468382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:54:50.470372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:54:50.470472 [info ] [MainThread]: 
[0m13:54:50.470607 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:54:50.470702 [info ] [MainThread]: 
[0m13:54:50.470853 [error] [MainThread]: [31mFailure in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)[0m
[0m13:54:50.470977 [error] [MainThread]:   Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column reference "deal_stage_id" is ambiguous
  LINE 24:   deal_stage_id,
             ^
[0m13:54:50.471064 [info ] [MainThread]: 
[0m13:54:50.471167 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m13:54:50.471251 [info ] [MainThread]: 
[0m13:54:50.471349 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:54:50.472837 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.40510058, "process_in_blocks": "0", "process_kernel_time": 0.109368, "process_mem_max_rss": "143196160", "process_out_blocks": "0", "process_user_time": 0.74044}
[0m13:54:50.472980 [debug] [MainThread]: Command `dbt build` failed at 13:54:50.472951 after 0.41 seconds
[0m13:54:50.473093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92d230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92d390>]}
[0m13:54:50.473201 [debug] [MainThread]: Flushing usage events
[0m13:54:52.062531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:21.121266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e7b10>]}


============================== 13:59:21.123615 | c4d727b1-95da-4c2c-9097-ad861300864e ==============================
[0m13:59:21.123615 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:59:21.123865 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --select stg_deal_stages --full-refresh', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'empty': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80'}
[0m13:59:21.192136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d727b1-95da-4c2c-9097-ad861300864e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bce9e0>]}
[0m13:59:21.210851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4d727b1-95da-4c2c-9097-ad861300864e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984a9c0>]}
[0m13:59:21.211363 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:59:21.247753 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:59:21.289701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:21.289938 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m13:59:21.372878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d727b1-95da-4c2c-9097-ad861300864e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a88d150>]}
[0m13:59:21.398207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:59:21.399590 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:59:21.436287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d727b1-95da-4c2c-9097-ad861300864e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ea8a0>]}
[0m13:59:21.436494 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:59:21.437126 [info ] [MainThread]: 
[0m13:59:21.437253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:21.437347 [info ] [MainThread]: 
[0m13:59:21.437518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:21.437820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:59:21.459765 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:59:21.459924 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:59:21.460013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:21.494620 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.035 seconds
[0m13:59:21.495222 [debug] [ThreadPool]: On list_postgres: Close
[0m13:59:21.496872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m13:59:21.498864 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m13:59:21.498982 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m13:59:21.499083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:21.510762 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m13:59:21.511203 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m13:59:21.511582 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m13:59:21.513470 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:21.513611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:59:21.513726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:21.522971 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m13:59:21.523342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d727b1-95da-4c2c-9097-ad861300864e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa86350>]}
[0m13:59:21.523495 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:21.523870 [debug] [MainThread]: On master: COMMIT
[0m13:59:21.523957 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:21.524036 [debug] [MainThread]: On master: COMMIT
[0m13:59:21.524611 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:59:21.524700 [debug] [MainThread]: On master: Close
[0m13:59:21.525730 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m13:59:21.525896 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m13:59:21.526040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m13:59:21.526153 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m13:59:21.529950 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:59:21.530207 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m13:59:21.548701 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m13:59:21.549022 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:59:21.549134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id as deal_stage_id,
    stage_name as deal_stage_name
  FROM "postgres"."public"."stages"
  WHERE stage_id IS NOT NULL OR stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data


  );
  
  
[0m13:59:21.549234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:21.560817 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.012 seconds
[0m13:59:21.565638 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:59:21.565770 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "82271159bb30759afb8dbbdfa1203f0e"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_id)
  
[0m13:59:21.567050 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m13:59:21.569133 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:59:21.569244 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m13:59:21.569812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:59:21.570628 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:59:21.570727 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m13:59:21.571219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:59:21.576229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:59:21.576336 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:59:21.576425 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m13:59:21.577430 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:59:21.579434 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m13:59:21.580850 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m13:59:21.580960 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m13:59:21.583418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:59:21.584167 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m13:59:21.584880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d727b1-95da-4c2c-9097-ad861300864e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100331e0>]}
[0m13:59:21.585083 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.06s]
[0m13:59:21.585284 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m13:59:21.585706 [debug] [MainThread]: On master: COMMIT
[0m13:59:21.585798 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:21.585872 [debug] [MainThread]: On master: COMMIT
[0m13:59:21.585941 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:21.593341 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:59:21.593467 [debug] [MainThread]: On master: Close
[0m13:59:21.593595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:21.593678 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m13:59:21.593768 [info ] [MainThread]: 
[0m13:59:21.593871 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:59:21.594094 [debug] [MainThread]: Command end result
[0m13:59:21.603659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m13:59:21.604287 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:59:21.606234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m13:59:21.606340 [info ] [MainThread]: 
[0m13:59:21.606466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:21.606556 [info ] [MainThread]: 
[0m13:59:21.606657 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:59:21.608068 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.51357436, "process_in_blocks": "0", "process_kernel_time": 0.14513, "process_mem_max_rss": "145080320", "process_out_blocks": "0", "process_user_time": 0.791605}
[0m13:59:21.608208 [debug] [MainThread]: Command `dbt build` succeeded at 13:59:21.608179 after 0.51 seconds
[0m13:59:21.608323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109667a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7a150>]}
[0m13:59:21.608433 [debug] [MainThread]: Flushing usage events
[0m13:59:23.270031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:27.158072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6a7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6a7b10>]}


============================== 14:04:27.160544 | ac8810ff-62de-4715-a637-624bdb0e9fb6 ==============================
[0m14:04:27.160544 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:04:27.160779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_deal_stages', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager'}
[0m14:04:27.239063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac8810ff-62de-4715-a637-624bdb0e9fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9929e0>]}
[0m14:04:27.258290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac8810ff-62de-4715-a637-624bdb0e9fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d60e9c0>]}
[0m14:04:27.258770 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:04:27.292527 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:04:27.338665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:27.338916 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m14:04:27.425891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac8810ff-62de-4715-a637-624bdb0e9fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e701150>]}
[0m14:04:27.451265 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:04:27.452382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:04:27.485115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac8810ff-62de-4715-a637-624bdb0e9fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7159a0>]}
[0m14:04:27.485328 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m14:04:27.485462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8810ff-62de-4715-a637-624bdb0e9fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e562970>]}
[0m14:04:27.486101 [info ] [MainThread]: 
[0m14:04:27.486230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:27.486323 [info ] [MainThread]: 
[0m14:04:27.486496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:27.486827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:04:27.509361 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:04:27.509523 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:04:27.509618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:27.541563 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.032 seconds
[0m14:04:27.542181 [debug] [ThreadPool]: On list_postgres: Close
[0m14:04:27.543784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m14:04:27.545778 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:04:27.545893 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:04:27.545991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:27.557058 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m14:04:27.557499 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:04:27.557891 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:04:27.559848 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:27.559991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:04:27.560105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:27.569621 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:04:27.570042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8810ff-62de-4715-a637-624bdb0e9fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaceea0>]}
[0m14:04:27.570204 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:27.570578 [debug] [MainThread]: On master: COMMIT
[0m14:04:27.570669 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:27.570760 [debug] [MainThread]: On master: COMMIT
[0m14:04:27.571315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:04:27.571402 [debug] [MainThread]: On master: Close
[0m14:04:27.572441 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:04:27.572614 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m14:04:27.572774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_stages)
[0m14:04:27.572888 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m14:04:27.576685 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:04:27.577068 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m14:04:27.595836 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:04:27.596012 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp140427587262"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."public"."stages"
  WHERE stage_id IS NOT NULL OR stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
      AND new_deal_stages_data.deal_stage_name = existing_deal_stages_data.deal_stage_name
  WHERE
    existing_deal_stages_data.deal_stage_id IS NULL
    OR existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m14:04:27.596124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:27.607823 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m14:04:27.612589 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:04:27.612732 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp140427587262'
        
      order by ordinal_position

  
[0m14:04:27.618903 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m14:04:27.620538 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:04:27.620665 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:04:27.623352 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:04:27.626295 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:04:27.626413 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:04:27.628692 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:04:27.639241 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:04:27.639565 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:04:27.639682 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp140427587262" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m14:04:27.641306 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.001 seconds
[0m14:04:27.646007 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:04:27.646127 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:04:27.646219 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:04:27.648585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:04:27.649226 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m14:04:27.649961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8810ff-62de-4715-a637-624bdb0e9fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec35190>]}
[0m14:04:27.650176 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.08s]
[0m14:04:27.650380 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:04:27.650837 [debug] [MainThread]: On master: COMMIT
[0m14:04:27.650956 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:27.651043 [debug] [MainThread]: On master: COMMIT
[0m14:04:27.651120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:27.657938 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m14:04:27.658067 [debug] [MainThread]: On master: Close
[0m14:04:27.658187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:27.658261 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m14:04:27.658344 [info ] [MainThread]: 
[0m14:04:27.658442 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:04:27.658653 [debug] [MainThread]: Command end result
[0m14:04:27.666439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:04:27.667066 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:04:27.669001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:04:27.669096 [info ] [MainThread]: 
[0m14:04:27.669227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:27.669335 [info ] [MainThread]: 
[0m14:04:27.669447 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:04:27.671035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.53992337, "process_in_blocks": "0", "process_kernel_time": 0.152933, "process_mem_max_rss": "143884288", "process_out_blocks": "0", "process_user_time": 0.80776}
[0m14:04:27.671248 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:27.671210 after 0.54 seconds
[0m14:04:27.671399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8278b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed01310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed011d0>]}
[0m14:04:27.671527 [debug] [MainThread]: Flushing usage events
[0m14:04:29.446256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:51.718047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8b57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86bb10>]}


============================== 14:20:51.720515 | d4a0db4f-12c9-4704-abaa-5a8edb05608c ==============================
[0m14:20:51.720515 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:20:51.720731 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt snapshot', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'target_path': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False'}
[0m14:20:51.797801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4a0db4f-12c9-4704-abaa-5a8edb05608c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb569e0>]}
[0m14:20:51.816344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4a0db4f-12c9-4704-abaa-5a8edb05608c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7d29c0>]}
[0m14:20:51.816767 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:20:51.849188 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:20:51.894911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:20:51.895131 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:20:51.906758 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_activity_types_snapshot' in the 'snapshots' section of file 'snapshots/pipedrive_snapshots.yaml'
[0m14:20:51.934221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4a0db4f-12c9-4704-abaa-5a8edb05608c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8c5350>]}
[0m14:20:51.958988 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:20:51.960096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:20:51.969723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4a0db4f-12c9-4704-abaa-5a8edb05608c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e919c70>]}
[0m14:20:51.969900 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m14:20:51.970018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a0db4f-12c9-4704-abaa-5a8edb05608c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e721fd0>]}
[0m14:20:51.970660 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:20:51.970859 [debug] [MainThread]: Command end result
[0m14:20:52.003285 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:20:52.003951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:20:52.005033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:20:52.006406 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.31537235, "process_in_blocks": "0", "process_kernel_time": 0.127686, "process_mem_max_rss": "127287296", "process_out_blocks": "0", "process_user_time": 0.67436}
[0m14:20:52.006579 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:20:52.006545 after 0.32 seconds
[0m14:20:52.006706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb07ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5efa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ead3d10>]}
[0m14:20:52.006817 [debug] [MainThread]: Flushing usage events
[0m14:20:53.586734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:42.270640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e3b10>]}


============================== 14:21:42.273102 | dec0561d-a84d-4f8b-adc3-bef1afa6c2eb ==============================
[0m14:21:42.273102 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:21:42.273331 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True'}
[0m14:21:42.346004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dec0561d-a84d-4f8b-adc3-bef1afa6c2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bce9e0>]}
[0m14:21:42.365416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dec0561d-a84d-4f8b-adc3-bef1afa6c2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984a9c0>]}
[0m14:21:42.365984 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:21:42.400550 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:21:42.444496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:21:42.444777 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:21:42.519973 [error] [MainThread]: Encountered an error:
A snapshot configured with the check strategy must specify a check_cols configuration.
[0m14:21:42.521308 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config,
        ^^^^^^^^^^^^^^^
    ...<3 lines>...
        active_integrations,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 489, in load
    self.check_valid_snapshot_config()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 1457, in check_valid_snapshot_config
    node.config.final_validate()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/artifacts/resources/v1/snapshot.py", line 51, in final_validate
    raise ValidationError(
    ...<2 lines>...
    )
dbt_common.dataclass_schema.ValidationError: A snapshot configured with the check strategy must specify a check_cols configuration.

[0m14:21:42.523184 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.27953416, "process_in_blocks": "0", "process_kernel_time": 0.127023, "process_mem_max_rss": "129679360", "process_out_blocks": "0", "process_user_time": 0.649383}
[0m14:21:42.523380 [debug] [MainThread]: Command `dbt snapshot` failed at 14:21:42.523336 after 0.28 seconds
[0m14:21:42.523526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109782750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac387d0>]}
[0m14:21:42.523647 [debug] [MainThread]: Flushing usage events
[0m14:21:43.928353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:37.866721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6e57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d69b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d69bb10>]}


============================== 14:25:37.869215 | 17e4fe8f-399a-4371-b419-4178732bfd49 ==============================
[0m14:25:37.869215 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:25:37.869446 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'empty': 'False', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'invocation_command': 'dbt snapshot', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True'}
[0m14:25:37.948639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e4fe8f-399a-4371-b419-4178732bfd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9869e0>]}
[0m14:25:37.967722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17e4fe8f-399a-4371-b419-4178732bfd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6029c0>]}
[0m14:25:37.968198 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:25:38.002521 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:25:38.047212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:38.047461 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:25:38.147296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17e4fe8f-399a-4371-b419-4178732bfd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e64b150>]}
[0m14:25:38.200131 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:25:38.201215 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:25:38.210995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17e4fe8f-399a-4371-b419-4178732bfd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a2b70>]}
[0m14:25:38.211171 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:25:38.211288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e4fe8f-399a-4371-b419-4178732bfd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de22cf0>]}
[0m14:25:38.211965 [info ] [MainThread]: 
[0m14:25:38.212085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:38.212174 [info ] [MainThread]: 
[0m14:25:38.212343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:38.212646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_public'
[0m14:25:38.214598 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:25:38.214700 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:25:38.214779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:38.247129 [debug] [ThreadPool]: On list_public: Close
[0m14:25:38.247512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:38.247632 [debug] [MainThread]: Connection 'list_public' was properly closed.
[0m14:25:38.247733 [info ] [MainThread]: 
[0m14:25:38.247846 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m14:25:38.248011 [error] [MainThread]: Encountered an error:
Runtime Error
  ERROR: Cross-db references not allowed in postgres (public vs postgres)
[0m14:25:38.249465 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.41224635, "process_in_blocks": "0", "process_kernel_time": 0.125261, "process_mem_max_rss": "140296192", "process_out_blocks": "0", "process_user_time": 0.744173}
[0m14:25:38.249624 [debug] [MainThread]: Command `dbt snapshot` failed at 14:25:38.249590 after 0.41 seconds
[0m14:25:38.249739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e977c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d41fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e810050>]}
[0m14:25:38.249851 [debug] [MainThread]: Flushing usage events
[0m14:25:39.957634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:59.822637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9797f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92fb10>]}


============================== 14:25:59.824414 | 9aeb0b01-efae-4bb3-98f8-4394d2b09bb0 ==============================
[0m14:25:59.824414 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:25:59.824656 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m14:25:59.878484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aeb0b01-efae-4bb3-98f8-4394d2b09bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc1a9e0>]}
[0m14:25:59.897737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aeb0b01-efae-4bb3-98f8-4394d2b09bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8969c0>]}
[0m14:25:59.898083 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:25:59.928145 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:25:59.970370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:59.970667 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:26:00.065656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aeb0b01-efae-4bb3-98f8-4394d2b09bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98b250>]}
[0m14:26:00.116244 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:26:00.116997 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:26:00.121759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9aeb0b01-efae-4bb3-98f8-4394d2b09bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9df7a0>]}
[0m14:26:00.121919 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:26:00.122033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aeb0b01-efae-4bb3-98f8-4394d2b09bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e791550>]}
[0m14:26:00.122699 [info ] [MainThread]: 
[0m14:26:00.122815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:00.122899 [info ] [MainThread]: 
[0m14:26:00.123072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:26:00.123394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m14:26:00.125491 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:26:00.125607 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:26:00.125695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:00.143379 [debug] [ThreadPool]: On list_postgres_public: Close
[0m14:26:00.143741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:00.143844 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m14:26:00.143933 [info ] [MainThread]: 
[0m14:26:00.144044 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m14:26:00.144217 [error] [MainThread]: Encountered an error:
Runtime Error
  ERROR: Cross-db references not allowed in postgres (postgres_public vs postgres)
[0m14:26:00.145290 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.34678397, "process_in_blocks": "0", "process_kernel_time": 0.095705, "process_mem_max_rss": "140230656", "process_out_blocks": "0", "process_user_time": 0.742749}
[0m14:26:00.145439 [debug] [MainThread]: Command `dbt snapshot` failed at 14:26:00.145408 after 0.35 seconds
[0m14:26:00.145555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed27d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf7110>]}
[0m14:26:00.145666 [debug] [MainThread]: Flushing usage events
[0m14:26:05.630085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:40.190699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087857f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973bb10>]}


============================== 14:26:40.192352 | 89de4b9f-4b5f-4039-9a08-c4afa013561e ==============================
[0m14:26:40.192352 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:26:40.192586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'empty': 'False', 'debug': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_colors': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'target_path': 'None'}
[0m14:26:40.246536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89de4b9f-4b5f-4039-9a08-c4afa013561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a269e0>]}
[0m14:26:40.265366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89de4b9f-4b5f-4039-9a08-c4afa013561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a29c0>]}
[0m14:26:40.265682 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:26:40.295532 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:26:40.338478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:26:40.338758 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:26:40.434344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89de4b9f-4b5f-4039-9a08-c4afa013561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e7250>]}
[0m14:26:40.484448 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:26:40.485228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:26:40.490287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89de4b9f-4b5f-4039-9a08-c4afa013561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73f7a0>]}
[0m14:26:40.490470 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:26:40.490594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89de4b9f-4b5f-4039-9a08-c4afa013561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f1550>]}
[0m14:26:40.491283 [info ] [MainThread]: 
[0m14:26:40.491411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:40.491503 [info ] [MainThread]: 
[0m14:26:40.491682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:26:40.491962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_public_pipedrive_staging'
[0m14:26:40.493887 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:26:40.493994 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:26:40.494076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:40.512332 [debug] [ThreadPool]: On list_public_pipedrive_staging: Close
[0m14:26:40.512681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:40.512781 [debug] [MainThread]: Connection 'list_public_pipedrive_staging' was properly closed.
[0m14:26:40.512872 [info ] [MainThread]: 
[0m14:26:40.512984 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m14:26:40.513159 [error] [MainThread]: Encountered an error:
Runtime Error
  ERROR: Cross-db references not allowed in postgres (public_pipedrive_staging vs postgres)
[0m14:26:40.514382 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.34819412, "process_in_blocks": "0", "process_kernel_time": 0.103808, "process_mem_max_rss": "140279808", "process_out_blocks": "0", "process_user_time": 0.743095}
[0m14:26:40.514537 [debug] [MainThread]: Command `dbt snapshot` failed at 14:26:40.514507 after 0.35 seconds
[0m14:26:40.514649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa8fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa57110>]}
[0m14:26:40.514760 [debug] [MainThread]: Flushing usage events
[0m14:26:42.221558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:50.663013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109973890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109973b10>]}


============================== 14:26:50.664695 | 314d8c86-9e9e-4b22-b455-e9cb4661a71f ==============================
[0m14:26:50.664695 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:26:50.664939 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_colors': 'True', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'debug': 'False'}
[0m14:26:50.719433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '314d8c86-9e9e-4b22-b455-e9cb4661a71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5e9e0>]}
[0m14:26:50.738699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '314d8c86-9e9e-4b22-b455-e9cb4661a71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098da9c0>]}
[0m14:26:50.739112 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:26:50.770003 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:26:50.811921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:26:50.812205 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:26:50.908654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '314d8c86-9e9e-4b22-b455-e9cb4661a71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cf250>]}
[0m14:26:50.960701 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:26:50.962106 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:26:50.971638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '314d8c86-9e9e-4b22-b455-e9cb4661a71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa237a0>]}
[0m14:26:50.971836 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:26:50.971964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '314d8c86-9e9e-4b22-b455-e9cb4661a71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d9550>]}
[0m14:26:50.972681 [info ] [MainThread]: 
[0m14:26:50.972805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:50.972900 [info ] [MainThread]: 
[0m14:26:50.973069 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:26:50.973387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:26:50.996433 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:26:50.996623 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:26:50.996733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:51.016700 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.020 seconds
[0m14:26:51.017300 [debug] [ThreadPool]: On list_postgres: Close
[0m14:26:51.017551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_snapshots)
[0m14:26:51.017692 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_snapshots"
"
[0m14:26:51.019480 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_snapshots"
[0m14:26:51.019583 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_snapshots"} */
create schema if not exists "pipedrive_snapshots"
[0m14:26:51.019663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:51.028124 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.008 seconds
[0m14:26:51.028467 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: COMMIT
[0m14:26:51.028574 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_snapshots"
[0m14:26:51.028658 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: COMMIT
[0m14:26:51.030021 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:26:51.030104 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: Close
[0m14:26:51.031703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:26:51.033880 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:26:51.034008 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:26:51.034102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:51.047176 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m14:26:51.047640 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:26:51.048016 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:26:51.048176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m14:26:51.049090 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:26:51.049216 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:26:51.049314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:51.058655 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m14:26:51.059059 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:26:51.059392 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:26:51.060945 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:51.061082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:26:51.061197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:51.067900 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:26:51.068329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '314d8c86-9e9e-4b22-b455-e9cb4661a71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbcfc0>]}
[0m14:26:51.068508 [debug] [MainThread]: On master: ROLLBACK
[0m14:26:51.068764 [debug] [MainThread]: On master: COMMIT
[0m14:26:51.068853 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:51.068933 [debug] [MainThread]: On master: COMMIT
[0m14:26:51.069307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:26:51.069396 [debug] [MainThread]: On master: Close
[0m14:26:51.070467 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:26:51.070661 [info ] [Thread-1 (]: 1 of 1 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:26:51.070822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:26:51.070938 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:26:51.074020 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:26:51.100323 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:26:51.100509 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:26:51.100622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:51.111173 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m14:26:51.112253 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:26:51.112363 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:26:51.112750 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:26:51.113117 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:26:51.113461 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:26:51.113569 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"
    ) sbq



  );
  
  
[0m14:26:51.115736 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:26:51.121643 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:26:51.121772 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:26:51.121872 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:26:51.122982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:26:51.123584 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:26:51.124312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '314d8c86-9e9e-4b22-b455-e9cb4661a71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aba1fd0>]}
[0m14:26:51.124603 [info ] [Thread-1 (]: 1 of 1 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mSELECT 4[0m in 0.05s]
[0m14:26:51.124809 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:26:51.125260 [debug] [MainThread]: On master: COMMIT
[0m14:26:51.125361 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:51.125446 [debug] [MainThread]: On master: COMMIT
[0m14:26:51.125525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:26:51.130902 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m14:26:51.131026 [debug] [MainThread]: On master: Close
[0m14:26:51.131158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:51.131287 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' was properly closed.
[0m14:26:51.131419 [info ] [MainThread]: 
[0m14:26:51.131536 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m14:26:51.131823 [debug] [MainThread]: Command end result
[0m14:26:51.141609 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:26:51.142539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:26:51.144654 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:26:51.144773 [info ] [MainThread]: 
[0m14:26:51.144913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:51.145005 [info ] [MainThread]: 
[0m14:26:51.145106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:26:51.146482 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5096358, "process_in_blocks": "0", "process_kernel_time": 0.107355, "process_mem_max_rss": "146472960", "process_out_blocks": "0", "process_user_time": 0.824242}
[0m14:26:51.146645 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:26:51.146612 after 0.51 seconds
[0m14:26:51.146768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b068e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abdc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abdce10>]}
[0m14:26:51.146882 [debug] [MainThread]: Flushing usage events
[0m14:26:52.481518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:06.128841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15fb10>]}


============================== 14:28:06.131191 | bcd9aa42-c6ce-42b7-8049-9bdbd981d00a ==============================
[0m14:28:06.131191 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:28:06.131436 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment'}
[0m14:28:06.199332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcd9aa42-c6ce-42b7-8049-9bdbd981d00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44a9e0>]}
[0m14:28:06.218687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcd9aa42-c6ce-42b7-8049-9bdbd981d00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c69c0>]}
[0m14:28:06.219210 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:28:06.253212 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:28:06.302139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:06.302439 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:28:06.398911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcd9aa42-c6ce-42b7-8049-9bdbd981d00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1bb250>]}
[0m14:28:06.448902 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:28:06.449867 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:28:06.459339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcd9aa42-c6ce-42b7-8049-9bdbd981d00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c20f7a0>]}
[0m14:28:06.459516 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:28:06.459634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd9aa42-c6ce-42b7-8049-9bdbd981d00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfc5550>]}
[0m14:28:06.460326 [info ] [MainThread]: 
[0m14:28:06.460444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:06.460532 [info ] [MainThread]: 
[0m14:28:06.460698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:06.461016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:28:06.482564 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:28:06.482743 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:28:06.482839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:06.514250 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.031 seconds
[0m14:28:06.514884 [debug] [ThreadPool]: On list_postgres: Close
[0m14:28:06.516568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:28:06.518572 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:28:06.518691 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:28:06.518784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:06.528510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m14:28:06.528918 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:28:06.529287 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:28:06.529447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:28:06.530313 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:28:06.530430 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:28:06.530520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:06.539112 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m14:28:06.539492 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:28:06.539836 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:28:06.541579 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:06.541714 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:28:06.541837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:06.550652 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:28:06.551005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd9aa42-c6ce-42b7-8049-9bdbd981d00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c8050>]}
[0m14:28:06.551153 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:06.551546 [debug] [MainThread]: On master: COMMIT
[0m14:28:06.551633 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:06.551712 [debug] [MainThread]: On master: COMMIT
[0m14:28:06.552271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:06.552362 [debug] [MainThread]: On master: Close
[0m14:28:06.553375 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:28:06.553543 [info ] [Thread-1 (]: 1 of 1 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:28:06.553692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:28:06.553821 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:28:06.556456 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:28:06.576029 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:06.576220 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select deal_activity_type_name, deal_activity_type_active, is_deal_activity_type_active, deal_activity_type from (
                select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:28:06.576334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:06.585405 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "deal_activity_type_active" does not exist
LINE 3:         select deal_activity_type_name, deal_activity_type_a...
                                                ^
HINT:  Perhaps you meant to reference the column "subq.is_deal_activity_type_active".

[0m14:28:06.585597 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:28:06.591804 [debug] [Thread-1 (]: Database Error in snapshot stg_deal_activity_types_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "deal_activity_type_active" does not exist
  LINE 3:         select deal_activity_type_name, deal_activity_type_a...
                                                  ^
  HINT:  Perhaps you meant to reference the column "subq.is_deal_activity_type_active".
[0m14:28:06.592615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9aa42-c6ce-42b7-8049-9bdbd981d00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5596d0>]}
[0m14:28:06.592919 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting pipedrive_snapshots.stg_deal_activity_types_snapshot . [[31mERROR[0m in 0.04s]
[0m14:28:06.593139 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:28:06.593338 [debug] [Thread-4 (]: Marking all children of 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot stg_deal_activity_types_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "deal_activity_type_active" does not exist
  LINE 3:         select deal_activity_type_name, deal_activity_type_a...
                                                  ^
  HINT:  Perhaps you meant to reference the column "subq.is_deal_activity_type_active"..
[0m14:28:06.593992 [debug] [MainThread]: On master: COMMIT
[0m14:28:06.594109 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:06.594197 [debug] [MainThread]: On master: COMMIT
[0m14:28:06.594276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:06.601391 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m14:28:06.601496 [debug] [MainThread]: On master: Close
[0m14:28:06.601612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:06.601686 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' was properly closed.
[0m14:28:06.601766 [info ] [MainThread]: 
[0m14:28:06.601863 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:28:06.602079 [debug] [MainThread]: Command end result
[0m14:28:06.611358 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:28:06.611991 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:28:06.613938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:28:06.614060 [info ] [MainThread]: 
[0m14:28:06.614189 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:28:06.614285 [info ] [MainThread]: 
[0m14:28:06.614407 [error] [MainThread]: [31mFailure in snapshot stg_deal_activity_types_snapshot (snapshots/pipedrive_snapshots.yaml)[0m
[0m14:28:06.614526 [error] [MainThread]:   Database Error in snapshot stg_deal_activity_types_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "deal_activity_type_active" does not exist
  LINE 3:         select deal_activity_type_name, deal_activity_type_a...
                                                  ^
  HINT:  Perhaps you meant to reference the column "subq.is_deal_activity_type_active".
[0m14:28:06.614612 [info ] [MainThread]: 
[0m14:28:06.614712 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:28:06.616349 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.5129261, "process_in_blocks": "0", "process_kernel_time": 0.140921, "process_mem_max_rss": "145506304", "process_out_blocks": "0", "process_user_time": 0.80725}
[0m14:28:06.616617 [debug] [MainThread]: Command `dbt snapshot` failed at 14:28:06.616573 after 0.51 seconds
[0m14:28:06.616771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c840d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f3ed0>]}
[0m14:28:06.616909 [debug] [MainThread]: Flushing usage events
[0m14:28:08.135336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:47.226069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086557f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960bb10>]}


============================== 14:28:47.228762 | 0146fae2-12e5-4ea5-9eb1-784f31ceee8d ==============================
[0m14:28:47.228762 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:28:47.228996 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt snapshot', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m14:28:47.297318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0146fae2-12e5-4ea5-9eb1-784f31ceee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f69e0>]}
[0m14:28:47.317063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0146fae2-12e5-4ea5-9eb1-784f31ceee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095729c0>]}
[0m14:28:47.317620 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:28:47.353209 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:28:47.402911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:47.403209 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:28:47.500371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0146fae2-12e5-4ea5-9eb1-784f31ceee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a667250>]}
[0m14:28:47.550790 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:28:47.551787 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:28:47.561158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0146fae2-12e5-4ea5-9eb1-784f31ceee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6bb7a0>]}
[0m14:28:47.561330 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:28:47.561450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0146fae2-12e5-4ea5-9eb1-784f31ceee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a471550>]}
[0m14:28:47.562183 [info ] [MainThread]: 
[0m14:28:47.562305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:47.562391 [info ] [MainThread]: 
[0m14:28:47.562560 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:47.562877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:28:47.583596 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:28:47.583817 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:28:47.583917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:47.614801 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.031 seconds
[0m14:28:47.615432 [debug] [ThreadPool]: On list_postgres: Close
[0m14:28:47.617099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:28:47.619156 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:28:47.619274 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:28:47.619368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:47.630014 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m14:28:47.630399 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:28:47.630779 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:28:47.630931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:28:47.631799 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:28:47.631916 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:28:47.632008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:47.640807 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m14:28:47.641210 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:28:47.641572 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:28:47.643241 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:47.643375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:28:47.643486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:47.652692 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:28:47.653076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0146fae2-12e5-4ea5-9eb1-784f31ceee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac74050>]}
[0m14:28:47.653232 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:47.653589 [debug] [MainThread]: On master: COMMIT
[0m14:28:47.653675 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:47.653752 [debug] [MainThread]: On master: COMMIT
[0m14:28:47.654312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:47.654397 [debug] [MainThread]: On master: Close
[0m14:28:47.655365 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:28:47.655531 [info ] [Thread-1 (]: 1 of 1 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:28:47.655675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:28:47.655786 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:28:47.658467 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:28:47.678045 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.678229 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select deal_activity_type_name, is_deal_activity_type_active, deal_activity_type from (
                select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:28:47.678339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:47.688407 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m14:28:47.693019 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.693157 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:28:47.700388 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m14:28:47.703049 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.703184 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:28:47.705749 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:28:47.723534 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.723744 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

        
  
    

  create temporary table "stg_deal_activity_types_snapshot__dbt_tmp142847720825"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:28:47.727315 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:28:47.728108 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.728219 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp142847720825'
        
      order by ordinal_position

  
[0m14:28:47.730658 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:28:47.731682 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.731790 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:28:47.734200 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:28:47.735017 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.735122 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp142847720825'
        
      order by ordinal_position

  
[0m14:28:47.737291 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:28:47.739533 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.739663 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:28:47.742233 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:28:47.744383 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.744506 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp142847720825'
        
      order by ordinal_position

  
[0m14:28:47.747116 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:28:47.752428 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.752635 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:28:47.753697 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:28:47.754767 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.754879 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:28:47.755345 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:28:47.756349 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.756616 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.756738 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_deal_activity_types_snapshot__dbt_tmp142847720825" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot" ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."deal_activity_type_id",DBT_INTERNAL_SOURCE."deal_activity_type_name",DBT_INTERNAL_SOURCE."is_deal_activity_type_active",DBT_INTERNAL_SOURCE."deal_activity_type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_deal_activity_types_snapshot__dbt_tmp142847720825" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:28:47.758059 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:28:47.762832 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:28:47.762946 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:28:47.763041 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:28:47.765052 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:28:47.766208 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:28:47.766989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0146fae2-12e5-4ea5-9eb1-784f31ceee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a83a210>]}
[0m14:28:47.767290 [info ] [Thread-1 (]: 1 of 1 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mINSERT 0 0[0m in 0.11s]
[0m14:28:47.767492 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:28:47.767956 [debug] [MainThread]: On master: COMMIT
[0m14:28:47.768055 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:47.768134 [debug] [MainThread]: On master: COMMIT
[0m14:28:47.768208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:47.774933 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m14:28:47.775037 [debug] [MainThread]: On master: Close
[0m14:28:47.775158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:47.775239 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' was properly closed.
[0m14:28:47.775327 [info ] [MainThread]: 
[0m14:28:47.775423 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m14:28:47.775636 [debug] [MainThread]: Command end result
[0m14:28:47.784760 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:28:47.785458 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:28:47.787403 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:28:47.787516 [info ] [MainThread]: 
[0m14:28:47.787655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:47.787747 [info ] [MainThread]: 
[0m14:28:47.787853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:28:47.789347 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.58962226, "process_in_blocks": "0", "process_kernel_time": 0.126637, "process_mem_max_rss": "145653760", "process_out_blocks": "0", "process_user_time": 0.860467}
[0m14:28:47.789488 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:28:47.789460 after 0.59 seconds
[0m14:28:47.789598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aced230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad02030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad02d50>]}
[0m14:28:47.789702 [debug] [MainThread]: Flushing usage events
[0m14:28:49.325938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:05.860984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff3b10>]}


============================== 14:33:05.863413 | b077f8b4-2d45-46b2-96b2-4c4fbae348d9 ==============================
[0m14:33:05.863413 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:33:05.863642 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'invocation_command': 'dbt snapshot', 'version_check': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m14:33:05.940447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b077f8b4-2d45-46b2-96b2-4c4fbae348d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092de9e0>]}
[0m14:33:05.959395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b077f8b4-2d45-46b2-96b2-4c4fbae348d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f5a9c0>]}
[0m14:33:05.959832 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:33:05.993169 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:33:06.046048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:06.046292 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m14:33:06.132325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b077f8b4-2d45-46b2-96b2-4c4fbae348d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b04e950>]}
[0m14:33:06.183908 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:33:06.185729 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:33:06.195989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b077f8b4-2d45-46b2-96b2-4c4fbae348d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d23b60>]}
[0m14:33:06.196182 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:33:06.196304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b077f8b4-2d45-46b2-96b2-4c4fbae348d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a826430>]}
[0m14:33:06.197062 [info ] [MainThread]: 
[0m14:33:06.197191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:06.197280 [info ] [MainThread]: 
[0m14:33:06.197447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:33:06.197748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:33:06.220264 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:33:06.220423 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:33:06.220511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:06.253038 [debug] [ThreadPool]: SQL status: SELECT 59 in 0.032 seconds
[0m14:33:06.253611 [debug] [ThreadPool]: On list_postgres: Close
[0m14:33:06.255290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m14:33:06.257299 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:33:06.257430 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:33:06.257528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:06.268697 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m14:33:06.269171 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:33:06.269549 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:33:06.269712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m14:33:06.270755 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:33:06.270854 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:33:06.270938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:06.280817 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m14:33:06.281249 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:33:06.281640 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:33:06.283262 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:06.283391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:33:06.283501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:06.293469 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:33:06.293840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b077f8b4-2d45-46b2-96b2-4c4fbae348d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b544870>]}
[0m14:33:06.293990 [debug] [MainThread]: On master: ROLLBACK
[0m14:33:06.294325 [debug] [MainThread]: On master: COMMIT
[0m14:33:06.294410 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:06.294485 [debug] [MainThread]: On master: COMMIT
[0m14:33:06.294990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:06.295075 [debug] [MainThread]: On master: Close
[0m14:33:06.296118 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:33:06.296291 [info ] [Thread-1 (]: 1 of 1 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:33:06.296484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:33:06.296660 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:33:06.299341 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:33:06.318894 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.319078 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select deal_activity_type_name, is_deal_activity_type_active, deal_activity_type from (
                select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:33:06.319195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:06.329108 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m14:33:06.333936 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.334100 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:33:06.342473 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m14:33:06.344995 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.345113 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:33:06.348386 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:33:06.365454 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.365661 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

        
  
    

  create temporary table "stg_deal_activity_types_snapshot__dbt_tmp143306362734"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:33:06.371400 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m14:33:06.372189 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.372298 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143306362734'
        
      order by ordinal_position

  
[0m14:33:06.375275 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m14:33:06.376271 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.376373 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:33:06.379277 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:33:06.380227 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.380356 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143306362734'
        
      order by ordinal_position

  
[0m14:33:06.382865 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:33:06.383965 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.384083 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:33:06.386704 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:33:06.388836 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.388953 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143306362734'
        
      order by ordinal_position

  
[0m14:33:06.391340 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:33:06.396498 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.396685 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:33:06.397709 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:33:06.398776 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.398886 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:33:06.399345 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:33:06.400324 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.400595 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.400723 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_deal_activity_types_snapshot__dbt_tmp143306362734" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot" ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."deal_activity_type_id",DBT_INTERNAL_SOURCE."deal_activity_type_name",DBT_INTERNAL_SOURCE."is_deal_activity_type_active",DBT_INTERNAL_SOURCE."deal_activity_type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_deal_activity_types_snapshot__dbt_tmp143306362734" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:33:06.402109 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:33:06.406996 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:33:06.407119 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:33:06.407218 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:33:06.408961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:33:06.410159 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:33:06.411123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b077f8b4-2d45-46b2-96b2-4c4fbae348d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b51e210>]}
[0m14:33:06.411423 [info ] [Thread-1 (]: 1 of 1 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mINSERT 0 0[0m in 0.11s]
[0m14:33:06.411627 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:33:06.412061 [debug] [MainThread]: On master: COMMIT
[0m14:33:06.412160 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:06.412242 [debug] [MainThread]: On master: COMMIT
[0m14:33:06.412319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:06.419845 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m14:33:06.419948 [debug] [MainThread]: On master: Close
[0m14:33:06.420063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:06.420140 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' was properly closed.
[0m14:33:06.420226 [info ] [MainThread]: 
[0m14:33:06.420321 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:33:06.420531 [debug] [MainThread]: Command end result
[0m14:33:06.430144 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:33:06.430827 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:33:06.433145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:33:06.433258 [info ] [MainThread]: 
[0m14:33:06.433393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:06.433490 [info ] [MainThread]: 
[0m14:33:06.433593 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:33:06.435085 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6016462, "process_in_blocks": "0", "process_kernel_time": 0.143935, "process_mem_max_rss": "145620992", "process_out_blocks": "0", "process_user_time": 0.838178}
[0m14:33:06.435227 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:33:06.435195 after 0.60 seconds
[0m14:33:06.435341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b337280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b615310>]}
[0m14:33:06.435449 [debug] [MainThread]: Flushing usage events
[0m14:33:08.617747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:31.148430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085717f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109527890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109527b10>]}


============================== 14:35:31.150842 | 6c2b1058-371e-4565-a180-50e347638226 ==============================
[0m14:35:31.150842 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:35:31.151081 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False', 'invocation_command': 'dbt run --select stg_deal_activity_types', 'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m14:35:31.218360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c2b1058-371e-4565-a180-50e347638226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088129e0>]}
[0m14:35:31.237974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c2b1058-371e-4565-a180-50e347638226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948e9c0>]}
[0m14:35:31.238516 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:35:31.273720 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:35:31.323551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:31.323735 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:35:31.323829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:31.340067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2b1058-371e-4565-a180-50e347638226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a581650>]}
[0m14:35:31.368661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:35:31.369659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:35:31.378665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2b1058-371e-4565-a180-50e347638226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095959a0>]}
[0m14:35:31.378827 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:35:31.378944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2b1058-371e-4565-a180-50e347638226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c81ef0>]}
[0m14:35:31.379553 [info ] [MainThread]: 
[0m14:35:31.379670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:31.379757 [info ] [MainThread]: 
[0m14:35:31.379929 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:31.380233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:35:31.402211 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:35:31.402360 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:35:31.402448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:31.436159 [debug] [ThreadPool]: SQL status: SELECT 61 in 0.034 seconds
[0m14:35:31.436757 [debug] [ThreadPool]: On list_postgres: Close
[0m14:35:31.438420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m14:35:31.440418 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:35:31.440530 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:35:31.440620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:31.452178 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m14:35:31.452628 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:35:31.453002 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:35:31.453162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m14:35:31.454055 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:35:31.454168 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:35:31.454257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:31.463599 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m14:35:31.464380 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:35:31.464828 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:35:31.466407 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:31.466536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:35:31.466646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:31.475730 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:35:31.476130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2b1058-371e-4565-a180-50e347638226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cd7e0>]}
[0m14:35:31.476289 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:31.476615 [debug] [MainThread]: On master: COMMIT
[0m14:35:31.476705 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:31.476788 [debug] [MainThread]: On master: COMMIT
[0m14:35:31.477297 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:35:31.477385 [debug] [MainThread]: On master: Close
[0m14:35:31.478408 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:35:31.478591 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:35:31.478746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:35:31.478860 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:35:31.481681 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:35:31.482066 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:35:31.503537 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:35:31.503734 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp143531493158"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."public"."activity_types"
  );
  
  
[0m14:35:31.503854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:31.514556 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m14:35:31.518873 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:35:31.519007 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp143531493158'
        
      order by ordinal_position

  
[0m14:35:31.526531 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m14:35:31.528253 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:35:31.528378 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:35:31.531375 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m14:35:31.556635 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:35:31.556815 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:35:31.561031 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:35:31.569819 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:35:31.570152 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:35:31.570279 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp143531493158" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m14:35:31.571894 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m14:35:31.576497 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:35:31.576620 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:35:31.576719 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:35:31.578476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:35:31.579077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:35:31.579981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2b1058-371e-4565-a180-50e347638226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac41d0>]}
[0m14:35:31.580207 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.10s]
[0m14:35:31.580419 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:35:31.580850 [debug] [MainThread]: On master: COMMIT
[0m14:35:31.580942 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:31.581019 [debug] [MainThread]: On master: COMMIT
[0m14:35:31.581088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:31.587941 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m14:35:31.588063 [debug] [MainThread]: On master: Close
[0m14:35:31.588195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:31.588282 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_activity_types' was properly closed.
[0m14:35:31.588375 [info ] [MainThread]: 
[0m14:35:31.588484 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m14:35:31.588706 [debug] [MainThread]: Command end result
[0m14:35:31.596522 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:35:31.597134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:35:31.599078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:35:31.599188 [info ] [MainThread]: 
[0m14:35:31.599320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:31.599411 [info ] [MainThread]: 
[0m14:35:31.599522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:35:31.601680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.47825482, "process_in_blocks": "0", "process_kernel_time": 0.143725, "process_mem_max_rss": "142032896", "process_out_blocks": "0", "process_user_time": 0.74993}
[0m14:35:31.601869 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:31.601835 after 0.48 seconds
[0m14:35:31.601998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a717280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a380730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3814f0>]}
[0m14:35:31.602116 [debug] [MainThread]: Flushing usage events
[0m14:35:33.101874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:47.753951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfff890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfffb10>]}


============================== 14:35:47.755580 | 194b8682-d1f3-4d80-9541-153039bfab5c ==============================
[0m14:35:47.755580 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:35:47.755821 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt snapshot'}
[0m14:35:47.809911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '194b8682-d1f3-4d80-9541-153039bfab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ea9e0>]}
[0m14:35:47.828885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '194b8682-d1f3-4d80-9541-153039bfab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf669c0>]}
[0m14:35:47.829195 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:35:47.862387 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:35:47.911077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:47.911250 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:35:47.911336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:47.927396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '194b8682-d1f3-4d80-9541-153039bfab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d059650>]}
[0m14:35:47.957262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:35:47.958254 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:35:47.967424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '194b8682-d1f3-4d80-9541-153039bfab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0adb80>]}
[0m14:35:47.967594 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:35:47.967717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '194b8682-d1f3-4d80-9541-153039bfab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfe2eb0>]}
[0m14:35:47.968429 [info ] [MainThread]: 
[0m14:35:47.968550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:47.968641 [info ] [MainThread]: 
[0m14:35:47.968817 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:47.969126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:35:47.988511 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:35:47.988672 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:35:47.988762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:48.007851 [debug] [ThreadPool]: SQL status: SELECT 63 in 0.019 seconds
[0m14:35:48.008468 [debug] [ThreadPool]: On list_postgres: Close
[0m14:35:48.010105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:35:48.012111 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:35:48.012237 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:35:48.012332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:48.023989 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m14:35:48.024421 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:35:48.024746 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:35:48.024899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:35:48.025531 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:35:48.025634 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:35:48.025717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:48.035278 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:35:48.035800 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:35:48.036145 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:35:48.038277 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:48.038412 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:35:48.038526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:48.047746 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:35:48.048144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '194b8682-d1f3-4d80-9541-153039bfab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d481d90>]}
[0m14:35:48.048312 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:48.048633 [debug] [MainThread]: On master: COMMIT
[0m14:35:48.048719 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:48.048793 [debug] [MainThread]: On master: COMMIT
[0m14:35:48.049289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:35:48.049376 [debug] [MainThread]: On master: Close
[0m14:35:48.052636 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:35:48.052818 [info ] [Thread-1 (]: 1 of 1 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:35:48.052972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:35:48.053082 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:35:48.055696 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:35:48.075530 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.075732 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select deal_activity_type_name, is_deal_activity_type_active, deal_activity_type from (
                select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:35:48.075842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:48.085311 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m14:35:48.091268 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.091414 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:35:48.100279 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.009 seconds
[0m14:35:48.102788 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.102911 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:35:48.105686 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:35:48.145907 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.146146 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

        
  
    

  create temporary table "stg_deal_activity_types_snapshot__dbt_tmp143548143235"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:35:48.151743 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m14:35:48.152614 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.152729 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143548143235'
        
      order by ordinal_position

  
[0m14:35:48.155698 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m14:35:48.156726 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.156835 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:35:48.159488 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:35:48.160341 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.160445 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143548143235'
        
      order by ordinal_position

  
[0m14:35:48.163065 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:35:48.164120 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.164242 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:35:48.167309 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:35:48.169390 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.169502 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143548143235'
        
      order by ordinal_position

  
[0m14:35:48.171926 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:35:48.177110 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.177312 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:35:48.178817 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:35:48.179868 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.179989 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:35:48.180757 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:35:48.180932 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.181213 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.181338 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_deal_activity_types_snapshot__dbt_tmp143548143235" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot" ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."deal_activity_type_id",DBT_INTERNAL_SOURCE."deal_activity_type_name",DBT_INTERNAL_SOURCE."is_deal_activity_type_active",DBT_INTERNAL_SOURCE."deal_activity_type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_deal_activity_types_snapshot__dbt_tmp143548143235" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:35:48.183085 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m14:35:48.188055 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:35:48.188172 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:35:48.188269 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:35:48.189598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:35:48.190801 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:35:48.191565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194b8682-d1f3-4d80-9541-153039bfab5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d58cc50>]}
[0m14:35:48.191869 [info ] [Thread-1 (]: 1 of 1 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mINSERT 0 0[0m in 0.14s]
[0m14:35:48.192077 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:35:48.192560 [debug] [MainThread]: On master: COMMIT
[0m14:35:48.192694 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:48.192789 [debug] [MainThread]: On master: COMMIT
[0m14:35:48.192872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:48.200020 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m14:35:48.200140 [debug] [MainThread]: On master: Close
[0m14:35:48.200276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:48.200409 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' was properly closed.
[0m14:35:48.200522 [info ] [MainThread]: 
[0m14:35:48.200631 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:35:48.200865 [debug] [MainThread]: Command end result
[0m14:35:48.208982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:35:48.209590 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:35:48.211461 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:35:48.211549 [info ] [MainThread]: 
[0m14:35:48.211672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:48.211762 [info ] [MainThread]: 
[0m14:35:48.211862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:35:48.213639 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.48390904, "process_in_blocks": "0", "process_kernel_time": 0.105497, "process_mem_max_rss": "142295040", "process_out_blocks": "0", "process_user_time": 0.78002}
[0m14:35:48.213773 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:35:48.213746 after 0.48 seconds
[0m14:35:48.213880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d698050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0b430>]}
[0m14:35:48.213983 [debug] [MainThread]: Flushing usage events
[0m14:35:49.855280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:28.869322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbe57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db9b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db9bb10>]}


============================== 14:37:28.871011 | 963ca679-9958-4786-b9a6-146530088f6f ==============================
[0m14:37:28.871011 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:37:28.871253 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'invocation_command': 'dbt run --select stg_deal_activity_types --full-refresh', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True'}
[0m14:37:28.925418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '963ca679-9958-4786-b9a6-146530088f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce869e0>]}
[0m14:37:28.944324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '963ca679-9958-4786-b9a6-146530088f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db029c0>]}
[0m14:37:28.944621 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:37:28.975588 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:37:29.017274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:29.017410 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:37:29.017493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:29.033102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '963ca679-9958-4786-b9a6-146530088f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf5650>]}
[0m14:37:29.061568 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:37:29.062290 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:37:29.067435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '963ca679-9958-4786-b9a6-146530088f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc099a0>]}
[0m14:37:29.067602 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:37:29.067729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963ca679-9958-4786-b9a6-146530088f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2f5ef0>]}
[0m14:37:29.068336 [info ] [MainThread]: 
[0m14:37:29.068455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:29.068548 [info ] [MainThread]: 
[0m14:37:29.068724 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:29.069032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:37:29.088098 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:37:29.088273 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:37:29.088371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:29.109549 [debug] [ThreadPool]: SQL status: SELECT 63 in 0.021 seconds
[0m14:37:29.110109 [debug] [ThreadPool]: On list_postgres: Close
[0m14:37:29.111670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m14:37:29.113649 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:37:29.113756 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:37:29.113847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:29.123595 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:37:29.124046 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:37:29.124417 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:37:29.124580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m14:37:29.125466 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:37:29.125578 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:37:29.125671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:29.137616 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m14:37:29.138259 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:37:29.138608 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:37:29.140157 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:29.140283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:37:29.140394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:29.147473 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:37:29.147927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963ca679-9958-4786-b9a6-146530088f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0417e0>]}
[0m14:37:29.148111 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:29.148359 [debug] [MainThread]: On master: COMMIT
[0m14:37:29.148465 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:29.148553 [debug] [MainThread]: On master: COMMIT
[0m14:37:29.148910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:29.149014 [debug] [MainThread]: On master: Close
[0m14:37:29.149810 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:37:29.149994 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:37:29.150147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:37:29.150262 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:37:29.153113 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:37:29.153391 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:37:29.174491 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:37:29.174880 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:37:29.175009 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."public"."activity_types"
  );
  
  
[0m14:37:29.175120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:29.184659 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m14:37:29.187825 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:37:29.187945 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types" rename to "stg_deal_activity_types__dbt_backup"
[0m14:37:29.188456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:29.189301 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:37:29.189406 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp" rename to "stg_deal_activity_types"
[0m14:37:29.189801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:29.216877 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:37:29.217066 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:37:29.217177 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:37:29.219067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:37:29.221000 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup"
[0m14:37:29.222527 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:37:29.222642 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup" cascade
[0m14:37:29.226071 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:37:29.226899 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:37:29.227505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963ca679-9958-4786-b9a6-146530088f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f138ad0>]}
[0m14:37:29.227719 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mSELECT 4[0m in 0.08s]
[0m14:37:29.227924 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:37:29.228353 [debug] [MainThread]: On master: COMMIT
[0m14:37:29.228446 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:29.228523 [debug] [MainThread]: On master: COMMIT
[0m14:37:29.228594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:29.235520 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m14:37:29.235643 [debug] [MainThread]: On master: Close
[0m14:37:29.235760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:29.235839 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_activity_types' was properly closed.
[0m14:37:29.235922 [info ] [MainThread]: 
[0m14:37:29.236024 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:37:29.236359 [debug] [MainThread]: Command end result
[0m14:37:29.244668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:37:29.245338 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:37:29.247282 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:37:29.247378 [info ] [MainThread]: 
[0m14:37:29.247508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:29.247604 [info ] [MainThread]: 
[0m14:37:29.247705 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:37:29.248914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40405932, "process_in_blocks": "0", "process_kernel_time": 0.113638, "process_mem_max_rss": "142016512", "process_out_blocks": "0", "process_user_time": 0.739349}
[0m14:37:29.249098 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:29.249063 after 0.40 seconds
[0m14:37:29.249228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed97b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f129c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1282d0>]}
[0m14:37:29.249354 [debug] [MainThread]: Flushing usage events
[0m14:37:31.028003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:06.019967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae597f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0fb10>]}


============================== 14:39:06.022127 | 4897590d-9dcb-4cd4-aaa2-caed67c3b1b6 ==============================
[0m14:39:06.022127 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:39:06.022352 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select stg_deal_activity_types', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs'}
[0m14:39:06.080484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4897590d-9dcb-4cd4-aaa2-caed67c3b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0fa9e0>]}
[0m14:39:06.099195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4897590d-9dcb-4cd4-aaa2-caed67c3b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd769c0>]}
[0m14:39:06.101088 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:39:06.136067 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:39:06.185904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:06.186065 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:39:06.186155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:06.201972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4897590d-9dcb-4cd4-aaa2-caed67c3b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbd650>]}
[0m14:39:06.230776 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:39:06.231941 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:39:06.241374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4897590d-9dcb-4cd4-aaa2-caed67c3b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be7d9a0>]}
[0m14:39:06.241544 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:39:06.241663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4897590d-9dcb-4cd4-aaa2-caed67c3b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bdef0>]}
[0m14:39:06.242288 [info ] [MainThread]: 
[0m14:39:06.242411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:06.242504 [info ] [MainThread]: 
[0m14:39:06.242699 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:06.243015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:39:06.265712 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:39:06.265878 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:39:06.265977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:06.285599 [debug] [ThreadPool]: SQL status: SELECT 63 in 0.020 seconds
[0m14:39:06.286165 [debug] [ThreadPool]: On list_postgres: Close
[0m14:39:06.287782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:39:06.289809 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:39:06.289917 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:39:06.290003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:06.301805 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m14:39:06.302253 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:39:06.302829 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:39:06.303010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:39:06.303660 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:39:06.303757 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:39:06.303843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:06.316883 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m14:39:06.317410 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:39:06.317710 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:39:06.320137 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:06.320280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:39:06.320398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:06.326543 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:39:06.326954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4897590d-9dcb-4cd4-aaa2-caed67c3b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d209a50>]}
[0m14:39:06.327124 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:06.327367 [debug] [MainThread]: On master: COMMIT
[0m14:39:06.327457 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:06.327539 [debug] [MainThread]: On master: COMMIT
[0m14:39:06.327911 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:06.328052 [debug] [MainThread]: On master: Close
[0m14:39:06.329164 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:39:06.329364 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:39:06.329522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:39:06.329639 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:39:06.332764 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:39:06.333053 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:39:06.352994 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:39:06.353168 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp143906344216"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."public"."activity_types"
  );
  
  
[0m14:39:06.353276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:06.363221 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m14:39:06.369153 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:39:06.369299 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp143906344216'
        
      order by ordinal_position

  
[0m14:39:06.375497 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m14:39:06.377262 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:39:06.377385 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:39:06.378541 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:39:06.404668 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:39:06.404855 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:39:06.408140 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m14:39:06.416318 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:39:06.416639 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:39:06.416768 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp143906344216" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m14:39:06.417862 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m14:39:06.422506 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:39:06.422642 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:39:06.422751 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:39:06.423735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:39:06.424339 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:39:06.425089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4897590d-9dcb-4cd4-aaa2-caed67c3b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d300950>]}
[0m14:39:06.425332 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.10s]
[0m14:39:06.425552 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:39:06.425997 [debug] [MainThread]: On master: COMMIT
[0m14:39:06.426092 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:06.426169 [debug] [MainThread]: On master: COMMIT
[0m14:39:06.426239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:06.432405 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m14:39:06.432521 [debug] [MainThread]: On master: Close
[0m14:39:06.432656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:06.432896 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_activity_types' was properly closed.
[0m14:39:06.433017 [info ] [MainThread]: 
[0m14:39:06.433125 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m14:39:06.433348 [debug] [MainThread]: Command end result
[0m14:39:06.441305 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:39:06.441931 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:39:06.443903 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:39:06.444000 [info ] [MainThread]: 
[0m14:39:06.444127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:06.444224 [info ] [MainThread]: 
[0m14:39:06.444331 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:39:06.446217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.45266807, "process_in_blocks": "0", "process_kernel_time": 0.137148, "process_mem_max_rss": "141950976", "process_out_blocks": "0", "process_user_time": 0.74711}
[0m14:39:06.446373 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:06.446343 after 0.45 seconds
[0m14:39:06.446487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf5e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbb9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbb9590>]}
[0m14:39:06.446598 [debug] [MainThread]: Flushing usage events
[0m14:39:08.109008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:25.807814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b543890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b543b10>]}


============================== 14:39:25.810171 | 7ca3782b-45a1-4936-9a8a-ddda45964481 ==============================
[0m14:39:25.810171 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:39:25.810405 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt snapshot', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'warn_error': 'None', 'quiet': 'False'}
[0m14:39:25.868027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ca3782b-45a1-4936-9a8a-ddda45964481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a82e9e0>]}
[0m14:39:25.887172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ca3782b-45a1-4936-9a8a-ddda45964481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4aa9c0>]}
[0m14:39:25.887700 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:39:25.921221 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:39:25.969387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:25.969533 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:39:25.969618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:25.985759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ca3782b-45a1-4936-9a8a-ddda45964481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f5650>]}
[0m14:39:26.015622 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:39:26.016791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:39:26.026072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ca3782b-45a1-4936-9a8a-ddda45964481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c545b80>]}
[0m14:39:26.026252 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:39:26.026376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ca3782b-45a1-4936-9a8a-ddda45964481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b528910>]}
[0m14:39:26.027085 [info ] [MainThread]: 
[0m14:39:26.027203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:26.027294 [info ] [MainThread]: 
[0m14:39:26.027467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:26.027786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:39:26.050095 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:39:26.050275 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:39:26.050378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:26.072039 [debug] [ThreadPool]: SQL status: SELECT 65 in 0.022 seconds
[0m14:39:26.072655 [debug] [ThreadPool]: On list_postgres: Close
[0m14:39:26.074279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:39:26.076308 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:39:26.076421 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:39:26.076513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:26.088533 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m14:39:26.088922 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:39:26.089310 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:39:26.089451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:39:26.090104 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:39:26.090219 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:39:26.090307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:26.100329 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:39:26.100802 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:39:26.101216 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:39:26.103276 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:26.103409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:39:26.103524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:26.113000 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:39:26.113373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ca3782b-45a1-4936-9a8a-ddda45964481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c919d90>]}
[0m14:39:26.113524 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:26.113829 [debug] [MainThread]: On master: COMMIT
[0m14:39:26.113917 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:26.113994 [debug] [MainThread]: On master: COMMIT
[0m14:39:26.114456 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:26.114542 [debug] [MainThread]: On master: Close
[0m14:39:26.116997 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:39:26.117185 [info ] [Thread-1 (]: 1 of 1 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:39:26.117332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:39:26.117443 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:39:26.120380 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:39:26.141349 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.141544 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select deal_activity_type_name, is_deal_activity_type_active, deal_activity_type from (
                select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:39:26.141667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:26.150595 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m14:39:26.156561 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.156703 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:39:26.164122 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m14:39:26.166842 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.166978 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:39:26.169553 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:39:26.208381 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.208620 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

        
  
    

  create temporary table "stg_deal_activity_types_snapshot__dbt_tmp143926205629"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:39:26.214440 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m14:39:26.215325 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.215436 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143926205629'
        
      order by ordinal_position

  
[0m14:39:26.218060 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:39:26.219104 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.219221 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:39:26.221467 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:39:26.222333 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.222439 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143926205629'
        
      order by ordinal_position

  
[0m14:39:26.224523 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:39:26.225534 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.225642 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:39:26.227803 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:39:26.229951 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.230071 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp143926205629'
        
      order by ordinal_position

  
[0m14:39:26.232213 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:39:26.237453 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.237650 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public_pipedrive_staging"."stg_deal_activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(deal_activity_type_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        deal_activity_type_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."deal_activity_type_name" != source_data."deal_activity_type_name"
        or
        (
            ((snapshotted_data."deal_activity_type_name" is null) and not (source_data."deal_activity_type_name" is null))
            or
            ((not snapshotted_data."deal_activity_type_name" is null) and (source_data."deal_activity_type_name" is null))
        ) or snapshotted_data."is_deal_activity_type_active" != source_data."is_deal_activity_type_active"
        or
        (
            ((snapshotted_data."is_deal_activity_type_active" is null) and not (source_data."is_deal_activity_type_active" is null))
            or
            ((not snapshotted_data."is_deal_activity_type_active" is null) and (source_data."is_deal_activity_type_active" is null))
        ) or snapshotted_data."deal_activity_type" != source_data."deal_activity_type"
        or
        (
            ((snapshotted_data."deal_activity_type" is null) and not (source_data."deal_activity_type" is null))
            or
            ((not snapshotted_data."deal_activity_type" is null) and (source_data."deal_activity_type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:39:26.238621 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:39:26.239688 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.239806 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:39:26.240389 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:39:26.240589 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.240907 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.241036 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_deal_activity_types_snapshot__dbt_tmp143926205629" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot" ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."deal_activity_type_id",DBT_INTERNAL_SOURCE."deal_activity_type_name",DBT_INTERNAL_SOURCE."is_deal_activity_type_active",DBT_INTERNAL_SOURCE."deal_activity_type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_deal_activity_types_snapshot__dbt_tmp143926205629" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:39:26.242212 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m14:39:26.247312 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:39:26.247434 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:39:26.247533 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:39:26.248560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:39:26.249777 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:39:26.250552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ca3782b-45a1-4936-9a8a-ddda45964481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca28c50>]}
[0m14:39:26.250865 [info ] [Thread-1 (]: 1 of 1 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mINSERT 0 1[0m in 0.13s]
[0m14:39:26.251080 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:39:26.251548 [debug] [MainThread]: On master: COMMIT
[0m14:39:26.251671 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:26.251765 [debug] [MainThread]: On master: COMMIT
[0m14:39:26.251846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:26.258504 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m14:39:26.258628 [debug] [MainThread]: On master: Close
[0m14:39:26.258761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:26.258847 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' was properly closed.
[0m14:39:26.258941 [info ] [MainThread]: 
[0m14:39:26.259043 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:39:26.259269 [debug] [MainThread]: Command end result
[0m14:39:26.267614 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:39:26.268317 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:39:26.270344 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:39:26.270442 [info ] [MainThread]: 
[0m14:39:26.270570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:26.270666 [info ] [MainThread]: 
[0m14:39:26.270769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:39:26.272572 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.4906247, "process_in_blocks": "0", "process_kernel_time": 0.127468, "process_mem_max_rss": "142426112", "process_out_blocks": "0", "process_user_time": 0.782755}
[0m14:39:26.272715 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:39:26.272687 after 0.49 seconds
[0m14:39:26.272828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb40050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f3430>]}
[0m14:39:26.272936 [debug] [MainThread]: Flushing usage events
[0m14:39:28.071749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:46.766396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0bf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0bfb10>]}


============================== 14:43:46.768921 | 7f09efcc-bd3d-4322-a5fa-48101a5d8674 ==============================
[0m14:43:46.768921 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:43:46.769156 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True', 'empty': 'False', 'indirect_selection': 'eager'}
[0m14:43:46.846339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f09efcc-bd3d-4322-a5fa-48101a5d8674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3aa9e0>]}
[0m14:43:46.865077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f09efcc-bd3d-4322-a5fa-48101a5d8674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0269c0>]}
[0m14:43:46.865506 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:43:46.902584 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:43:46.955047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:43:46.955335 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:43:46.955483 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m14:43:47.126669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f09efcc-bd3d-4322-a5fa-48101a5d8674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d117e50>]}
[0m14:43:47.155989 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:43:47.157080 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:43:47.167211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f09efcc-bd3d-4322-a5fa-48101a5d8674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d16d040>]}
[0m14:43:47.167375 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:43:47.167493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f09efcc-bd3d-4322-a5fa-48101a5d8674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5adc50>]}
[0m14:43:47.168172 [info ] [MainThread]: 
[0m14:43:47.168290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:47.168378 [info ] [MainThread]: 
[0m14:43:47.168543 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:47.168844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:43:47.190765 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:43:47.190921 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:43:47.191011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:47.225668 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.035 seconds
[0m14:43:47.226259 [debug] [ThreadPool]: On list_postgres: Close
[0m14:43:47.227956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:43:47.229953 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:43:47.230090 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:43:47.230195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:47.240719 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m14:43:47.241197 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:43:47.241538 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:43:47.241697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:43:47.242524 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:43:47.242628 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:43:47.242714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:47.252219 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m14:43:47.252629 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:43:47.252975 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:43:47.254696 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:47.254826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:43:47.254932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:47.263720 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:43:47.264120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f09efcc-bd3d-4322-a5fa-48101a5d8674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d502410>]}
[0m14:43:47.264271 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:47.264583 [debug] [MainThread]: On master: COMMIT
[0m14:43:47.264668 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:47.264744 [debug] [MainThread]: On master: COMMIT
[0m14:43:47.265210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:43:47.265298 [debug] [MainThread]: On master: Close
[0m14:43:47.266328 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:43:47.266495 [info ] [Thread-1 (]: 1 of 1 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:43:47.266646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:43:47.266755 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:43:47.269347 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:43:47.291444 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:43:47.291647 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:43:47.291758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:47.303065 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m14:43:47.307694 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:43:47.307833 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:43:47.315612 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m14:43:47.318862 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:43:47.318992 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:43:47.321835 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:43:47.339689 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:43:47.339863 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

        
  
    

  create temporary table "stg_deal_activity_types_snapshot__dbt_tmp144347337014"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (
  TRUE
)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (
  TRUE
)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:43:47.341009 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 25:         id as dbt_unique_key
                 ^

[0m14:43:47.341113 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: ROLLBACK
[0m14:43:47.341846 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:43:47.347728 [debug] [Thread-1 (]: Database Error in snapshot stg_deal_activity_types_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "id" does not exist
  LINE 25:         id as dbt_unique_key
                   ^
[0m14:43:47.348467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f09efcc-bd3d-4322-a5fa-48101a5d8674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5aa150>]}
[0m14:43:47.348746 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting pipedrive_snapshots.stg_deal_activity_types_snapshot . [[31mERROR[0m in 0.08s]
[0m14:43:47.348948 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:43:47.349138 [debug] [Thread-4 (]: Marking all children of 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot stg_deal_activity_types_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "id" does not exist
  LINE 25:         id as dbt_unique_key
                   ^.
[0m14:43:47.349787 [debug] [MainThread]: On master: COMMIT
[0m14:43:47.349899 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:47.349984 [debug] [MainThread]: On master: COMMIT
[0m14:43:47.350061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:43:47.358152 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m14:43:47.358281 [debug] [MainThread]: On master: Close
[0m14:43:47.358400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:47.358478 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' was properly closed.
[0m14:43:47.358562 [info ] [MainThread]: 
[0m14:43:47.358663 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m14:43:47.358887 [debug] [MainThread]: Command end result
[0m14:43:47.367082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:43:47.367707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:43:47.369560 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:43:47.369654 [info ] [MainThread]: 
[0m14:43:47.369777 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:43:47.369874 [info ] [MainThread]: 
[0m14:43:47.370003 [error] [MainThread]: [31mFailure in snapshot stg_deal_activity_types_snapshot (snapshots/pipedrive_snapshots.yaml)[0m
[0m14:43:47.370120 [error] [MainThread]:   Database Error in snapshot stg_deal_activity_types_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "id" does not exist
  LINE 25:         id as dbt_unique_key
                   ^
[0m14:43:47.370208 [info ] [MainThread]: 
[0m14:43:47.370311 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:43:47.372192 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.6348775, "process_in_blocks": "0", "process_kernel_time": 0.152373, "process_mem_max_rss": "148193280", "process_out_blocks": "0", "process_user_time": 0.883935}
[0m14:43:47.372347 [debug] [MainThread]: Command `dbt snapshot` failed at 14:43:47.372315 after 0.64 seconds
[0m14:43:47.372466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d89db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2dddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2dccd0>]}
[0m14:43:47.372576 [debug] [MainThread]: Flushing usage events
[0m14:43:48.917454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:35.099705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109733890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109733b10>]}


============================== 14:45:35.102404 | ee91d451-f719-4882-bcc9-3e73508c1dc4 ==============================
[0m14:45:35.102404 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:45:35.102649 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'quiet': 'False', 'no_print': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m14:45:35.181756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee91d451-f719-4882-bcc9-3e73508c1dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1e9e0>]}
[0m14:45:35.201606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee91d451-f719-4882-bcc9-3e73508c1dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969a9c0>]}
[0m14:45:35.202091 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:45:35.236091 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:45:35.289410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:35.289569 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:45:35.289655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:35.306001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee91d451-f719-4882-bcc9-3e73508c1dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a78d650>]}
[0m14:45:35.336021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:45:35.337537 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:45:35.347380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee91d451-f719-4882-bcc9-3e73508c1dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e1b80>]}
[0m14:45:35.347566 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:45:35.347685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee91d451-f719-4882-bcc9-3e73508c1dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109718910>]}
[0m14:45:35.348410 [info ] [MainThread]: 
[0m14:45:35.348536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:35.348626 [info ] [MainThread]: 
[0m14:45:35.348803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:35.349121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:45:35.371973 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:45:35.372136 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:45:35.372236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:35.405257 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.033 seconds
[0m14:45:35.405844 [debug] [ThreadPool]: On list_postgres: Close
[0m14:45:35.407432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:45:35.409447 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:45:35.409559 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:45:35.409647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:35.419893 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m14:45:35.420303 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:45:35.420676 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:45:35.420830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:45:35.421389 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:45:35.421502 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:45:35.421593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:35.429982 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m14:45:35.430397 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:45:35.430721 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:45:35.432727 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:35.432859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:45:35.432979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:35.440710 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:45:35.441132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee91d451-f719-4882-bcc9-3e73508c1dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb5d90>]}
[0m14:45:35.441287 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:35.441617 [debug] [MainThread]: On master: COMMIT
[0m14:45:35.441709 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:35.441787 [debug] [MainThread]: On master: COMMIT
[0m14:45:35.442256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:35.442364 [debug] [MainThread]: On master: Close
[0m14:45:35.443476 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:45:35.443665 [info ] [Thread-1 (]: 1 of 1 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:45:35.443817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:45:35.443936 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:45:35.446713 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:45:35.473635 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:35.473858 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."activity_types"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:45:35.473980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:35.484063 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m14:45:35.485173 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:35.485286 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:45:35.485743 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:45:35.486115 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:35.486679 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:35.486791 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."activity_types"
    ) sbq



  );
  
  
[0m14:45:35.489668 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m14:45:35.495391 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:45:35.495508 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:35.495601 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:45:35.496483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:35.497084 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:45:35.497795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee91d451-f719-4882-bcc9-3e73508c1dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca8710>]}
[0m14:45:35.498084 [info ] [Thread-1 (]: 1 of 1 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mSELECT 4[0m in 0.05s]
[0m14:45:35.498321 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:45:35.498786 [debug] [MainThread]: On master: COMMIT
[0m14:45:35.498892 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:35.498977 [debug] [MainThread]: On master: COMMIT
[0m14:45:35.499047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:35.505497 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m14:45:35.505622 [debug] [MainThread]: On master: Close
[0m14:45:35.505749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:35.505829 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot' was properly closed.
[0m14:45:35.505920 [info ] [MainThread]: 
[0m14:45:35.506040 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m14:45:35.506253 [debug] [MainThread]: Command end result
[0m14:45:35.539321 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:45:35.540035 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:45:35.542022 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:45:35.542126 [info ] [MainThread]: 
[0m14:45:35.542267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:35.542363 [info ] [MainThread]: 
[0m14:45:35.542471 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:45:35.544360 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.4743446, "process_in_blocks": "0", "process_kernel_time": 0.150145, "process_mem_max_rss": "141819904", "process_out_blocks": "0", "process_user_time": 0.745698}
[0m14:45:35.544508 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:45:35.544478 after 0.47 seconds
[0m14:45:35.544622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd0410>]}
[0m14:45:35.544728 [debug] [MainThread]: Flushing usage events
[0m14:45:37.330953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:44.571129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dff890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dffb10>]}


============================== 14:45:44.572816 | 5d8b625e-60e0-484e-9013-6ca995be044e ==============================
[0m14:45:44.572816 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:45:44.573052 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'empty': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True'}
[0m14:45:44.628124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e69e0>]}
[0m14:45:44.647130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d629c0>]}
[0m14:45:44.647442 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:45:44.676715 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:45:44.719098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:44.719282 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:45:44.719370 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:44.735178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae55650>]}
[0m14:45:44.763808 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:45:44.764565 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:45:44.775835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e699a0>]}
[0m14:45:44.776047 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:45:44.777001 [info ] [MainThread]: 
[0m14:45:44.777131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:44.777223 [info ] [MainThread]: 
[0m14:45:44.777406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:44.778830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:45:44.798266 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:45:44.798440 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:45:44.798549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:44.818286 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.020 seconds
[0m14:45:44.818887 [debug] [ThreadPool]: On list_postgres: Close
[0m14:45:44.819660 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:45:44.819790 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:45:44.819906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:44.828461 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.009 seconds
[0m14:45:44.828967 [debug] [ThreadPool]: On list_postgres: Close
[0m14:45:44.829565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m14:45:44.831706 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:45:44.831824 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:45:44.831916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:44.841735 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:45:44.842187 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:45:44.842563 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:45:44.842734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m14:45:44.845423 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:45:44.845540 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:45:44.845631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:44.854938 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m14:45:44.855374 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:45:44.855784 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:45:44.857403 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:44.857532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:45:44.857647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:44.867476 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:45:44.867870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f7070>]}
[0m14:45:44.868030 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:44.868429 [debug] [MainThread]: On master: COMMIT
[0m14:45:44.868519 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:44.868604 [debug] [MainThread]: On master: COMMIT
[0m14:45:44.869126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:44.869215 [debug] [MainThread]: On master: Close
[0m14:45:44.870013 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m14:45:44.870200 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m14:45:44.870352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activities)
[0m14:45:44.870463 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m14:45:44.898671 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:45:44.899850 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m14:45:44.918839 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:45:44.918989 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp144544909980"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m14:45:44.919099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:44.932472 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m14:45:44.936967 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:45:44.937097 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp144544909980'
        
      order by ordinal_position

  
[0m14:45:44.943883 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m14:45:44.945655 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:45:44.945776 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:44.948683 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m14:45:44.951739 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:45:44.951860 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:44.954192 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:45:44.962457 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:45:44.962796 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:45:44.962934 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp144544909980" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m14:45:44.974874 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.012 seconds
[0m14:45:44.980139 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:45:44.980276 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:45:44.980381 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:45:44.983970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:45:44.984625 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m14:45:44.985231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b558ef0>]}
[0m14:45:44.985458 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.11s]
[0m14:45:44.985670 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m14:45:44.985805 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:45:44.985996 [info ] [Thread-1 (]: 2 of 7 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m14:45:44.986151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m14:45:44.986263 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:45:44.987106 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:45:44.987342 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:45:44.991939 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:45:44.992188 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:45:44.992300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m14:45:44.992404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:45.007076 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.015 seconds
[0m14:45:45.010561 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:45:45.010682 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:45:45.011176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:45.012306 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:45:45.012423 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:45:45.012838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:45.014297 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:45:45.014433 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:45:45.014539 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:45:45.016203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:45.018427 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m14:45:45.020058 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:45:45.020180 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m14:45:45.022415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:45:45.022931 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:45:45.023149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0af590>]}
[0m14:45:45.023370 [info ] [Thread-1 (]: 2 of 7 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.04s]
[0m14:45:45.023554 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:45:45.023679 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m14:45:45.023870 [info ] [Thread-1 (]: 3 of 7 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m14:45:45.024030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m14:45:45.024143 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m14:45:45.025298 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:45:45.025907 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m14:45:45.027132 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:45:45.027248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp144545026553"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m14:45:45.027352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:45.034782 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m14:45:45.035972 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:45:45.036094 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp144545026553'
        
      order by ordinal_position

  
[0m14:45:45.041206 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m14:45:45.042229 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:45:45.042354 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:45.043838 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:45:45.044935 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:45:45.045053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:45.046158 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:45:45.048967 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:45:45.049325 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:45:45.049446 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp144545026553" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m14:45:45.050642 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m14:45:45.051112 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:45:45.051212 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:45:45.051299 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:45:45.052106 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:45.052352 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m14:45:45.052536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f2fc0>]}
[0m14:45:45.052739 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m14:45:45.052923 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m14:45:45.053045 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:45:45.053207 [info ] [Thread-1 (]: 4 of 7 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m14:45:45.053338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m14:45:45.053445 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m14:45:45.056208 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:45:45.056506 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m14:45:45.057930 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:45:45.058045 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp144545057189"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."public"."stages"
  WHERE stage_id IS NOT NULL OR stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
      AND new_deal_stages_data.deal_stage_name = existing_deal_stages_data.deal_stage_name
  WHERE
    existing_deal_stages_data.deal_stage_id IS NULL
    OR existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m14:45:45.058155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:45.064887 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:45:45.066157 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:45:45.066309 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp144545057189'
        
      order by ordinal_position

  
[0m14:45:45.069528 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:45:45.070561 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:45:45.070668 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:45.072680 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:45:45.073889 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:45:45.073997 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:45.075790 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:45:45.076451 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:45:45.076744 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:45:45.076850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp144545057189" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m14:45:45.077264 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m14:45:45.077736 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:45:45.077845 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:45:45.077938 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:45:45.078419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:45:45.078667 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m14:45:45.078912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5df930>]}
[0m14:45:45.079292 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m14:45:45.079526 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:45:45.079661 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m14:45:45.079834 [info ] [Thread-1 (]: 5 of 7 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m14:45:45.079976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m14:45:45.080088 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m14:45:45.081355 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m14:45:45.081605 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m14:45:45.082958 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:45:45.083068 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp144545082441"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m14:45:45.083161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:45.088857 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.006 seconds
[0m14:45:45.089922 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:45:45.090035 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp144545082441'
        
      order by ordinal_position

  
[0m14:45:45.093680 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:45:45.096016 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:45:45.096135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:45.097353 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:45:45.098842 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:45:45.098984 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:45.100014 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:45:45.100740 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m14:45:45.101027 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:45:45.101137 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp144545082441" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m14:45:45.105274 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m14:45:45.105733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:45:45.105832 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:45:45.105919 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:45:45.106962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:45.107206 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m14:45:45.107403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b425a50>]}
[0m14:45:45.107624 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m14:45:45.107809 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m14:45:45.107940 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:45:45.108108 [info ] [Thread-1 (]: 6 of 7 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:45:45.108239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:45:45.108349 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:45:45.109348 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:45:45.127267 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.127439 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:45:45.127545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:45.137058 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m14:45:45.138293 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.138417 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:45:45.145532 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m14:45:45.147838 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.147985 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:45:45.149381 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:45:45.162111 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.162308 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

        
  
    

  create temporary table "stg_deal_activity_types_snapshot__dbt_tmp144545161584"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:45:45.163994 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:45:45.164798 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.164908 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144545161584'
        
      order by ordinal_position

  
[0m14:45:45.165955 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:45:45.167063 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.167183 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:45:45.169683 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:45:45.170571 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.170686 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144545161584'
        
      order by ordinal_position

  
[0m14:45:45.171634 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:45:45.172540 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.172653 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:45:45.174267 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:45:45.176639 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.176772 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144545161584'
        
      order by ordinal_position

  
[0m14:45:45.178007 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:45:45.183114 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.183302 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:45:45.184428 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:45:45.185423 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.185529 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:45:45.185952 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:45:45.186110 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.186404 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.186524 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_deal_activity_types_snapshot__dbt_tmp144545161584" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_deal_activity_types_snapshot__dbt_tmp144545161584" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:45:45.187517 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:45:45.187929 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:45:45.188030 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:45:45.188121 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:45:45.189090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:45.189906 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:45:45.190087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c1cc0>]}
[0m14:45:45.190355 [info ] [Thread-1 (]: 6 of 7 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mINSERT 0 0[0m in 0.08s]
[0m14:45:45.190541 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:45:45.190791 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:45:45.190980 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:45:45.191136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:45:45.191251 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:45:45.192315 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:45:45.192507 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:45:45.193615 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:45:45.193722 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp144545193098"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
  );
  
  
[0m14:45:45.193818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:45.200043 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m14:45:45.201091 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:45:45.201207 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp144545193098'
        
      order by ordinal_position

  
[0m14:45:45.204335 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m14:45:45.205588 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:45:45.205724 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:45.207812 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:45:45.208759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:45:45.208872 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:45:45.209785 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:45:45.210462 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:45:45.210759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:45:45.210875 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp144545193098" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m14:45:45.211328 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m14:45:45.211744 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:45:45.211847 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:45:45.211945 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:45:45.212360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:45:45.212600 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:45:45.212843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8b625e-60e0-484e-9013-6ca995be044e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b552690>]}
[0m14:45:45.213101 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m14:45:45.213292 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:45:45.213752 [debug] [MainThread]: On master: COMMIT
[0m14:45:45.213852 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:45.213938 [debug] [MainThread]: On master: COMMIT
[0m14:45:45.214020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:45.218133 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m14:45:45.218239 [debug] [MainThread]: On master: Close
[0m14:45:45.218365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:45.218450 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_activity_types' was properly closed.
[0m14:45:45.218576 [info ] [MainThread]: 
[0m14:45:45.218687 [info ] [MainThread]: Finished running 5 incremental models, 1 snapshot, 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m14:45:45.219288 [debug] [MainThread]: Command end result
[0m14:45:45.227706 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:45:45.228338 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:45:45.231057 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:45:45.231191 [info ] [MainThread]: 
[0m14:45:45.231318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:45.231414 [info ] [MainThread]: 
[0m14:45:45.231517 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:45:45.232675 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6853668, "process_in_blocks": "0", "process_kernel_time": 0.121156, "process_mem_max_rss": "145260544", "process_out_blocks": "0", "process_user_time": 0.888923}
[0m14:45:45.232814 [debug] [MainThread]: Command `dbt build` succeeded at 14:45:45.232785 after 0.69 seconds
[0m14:45:45.232928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090479b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b46d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b46e9f0>]}
[0m14:45:45.233041 [debug] [MainThread]: Flushing usage events
[0m14:45:47.094387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:19.945037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081597f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109113890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109113b10>]}


============================== 14:46:19.947370 | 178464c1-8ce5-4ee4-8266-b411de6a449a ==============================
[0m14:46:19.947370 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:46:19.947596 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m14:46:20.015388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083fa9e0>]}
[0m14:46:20.034837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090769c0>]}
[0m14:46:20.035509 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:46:20.068735 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:46:20.119005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:20.119173 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:46:20.119259 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:20.135692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bd650>]}
[0m14:46:20.164771 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:46:20.165739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:46:20.180918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917d9a0>]}
[0m14:46:20.181098 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:46:20.182016 [info ] [MainThread]: 
[0m14:46:20.182136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:20.182227 [info ] [MainThread]: 
[0m14:46:20.182403 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:46:20.183808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:46:20.207055 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:46:20.207232 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:46:20.207325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:20.236020 [debug] [ThreadPool]: SQL status: SELECT 75 in 0.029 seconds
[0m14:46:20.236659 [debug] [ThreadPool]: On list_postgres: Close
[0m14:46:20.237496 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:46:20.237637 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:46:20.237724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:20.246375 [debug] [ThreadPool]: SQL status: SELECT 75 in 0.009 seconds
[0m14:46:20.246840 [debug] [ThreadPool]: On list_postgres: Close
[0m14:46:20.247358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m14:46:20.249321 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:46:20.249444 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:46:20.249542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:20.259033 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m14:46:20.259513 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:46:20.259899 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:46:20.260067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m14:46:20.262842 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:46:20.262956 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:46:20.263057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:20.272743 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m14:46:20.273157 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:46:20.273476 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:46:20.275157 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:20.275291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:46:20.275402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:20.285239 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:46:20.285668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35edd0>]}
[0m14:46:20.285826 [debug] [MainThread]: On master: ROLLBACK
[0m14:46:20.286147 [debug] [MainThread]: On master: COMMIT
[0m14:46:20.286237 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:20.286318 [debug] [MainThread]: On master: COMMIT
[0m14:46:20.286857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:46:20.286947 [debug] [MainThread]: On master: Close
[0m14:46:20.288709 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m14:46:20.288889 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m14:46:20.289046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activities)
[0m14:46:20.289160 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m14:46:20.317301 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:46:20.317653 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m14:46:20.336460 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:46:20.336611 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp144620327722"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m14:46:20.336725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:20.349620 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m14:46:20.354095 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:46:20.354223 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp144620327722'
        
      order by ordinal_position

  
[0m14:46:20.360896 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m14:46:20.362633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:46:20.362760 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.365481 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m14:46:20.368463 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:46:20.368580 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.370968 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:46:20.379786 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:46:20.380090 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:46:20.380226 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp144620327722" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m14:46:20.390770 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.010 seconds
[0m14:46:20.395658 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:46:20.395778 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:46:20.395884 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:46:20.398371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:46:20.398968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m14:46:20.399792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f854ef0>]}
[0m14:46:20.400038 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.11s]
[0m14:46:20.400242 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m14:46:20.400374 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:46:20.400552 [info ] [Thread-1 (]: 2 of 7 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m14:46:20.400699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m14:46:20.400813 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:46:20.401720 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:46:20.401934 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:46:20.406420 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:46:20.406640 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:46:20.406757 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m14:46:20.406864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:20.421301 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.014 seconds
[0m14:46:20.424809 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:46:20.424931 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:46:20.425415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:46:20.426487 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:46:20.426599 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:46:20.426971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:46:20.428083 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:46:20.428189 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:46:20.428283 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:46:20.429504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:46:20.431801 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m14:46:20.433503 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:46:20.433638 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m14:46:20.434338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:46:20.434824 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:46:20.435043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a317590>]}
[0m14:46:20.435278 [info ] [Thread-1 (]: 2 of 7 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.03s]
[0m14:46:20.435471 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:46:20.435602 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m14:46:20.435777 [info ] [Thread-1 (]: 3 of 7 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m14:46:20.435916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m14:46:20.436026 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m14:46:20.437234 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:46:20.437514 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m14:46:20.438801 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:46:20.438923 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp144620438210"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m14:46:20.439030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:20.444412 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m14:46:20.445694 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:46:20.445827 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp144620438210'
        
      order by ordinal_position

  
[0m14:46:20.451794 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m14:46:20.452786 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:46:20.452903 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.454863 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:46:20.455858 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:46:20.455971 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.456988 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:46:20.459244 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:46:20.459549 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:46:20.459672 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp144620438210" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m14:46:20.460243 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m14:46:20.460691 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:46:20.460797 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:46:20.460900 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:46:20.461351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:46:20.461576 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m14:46:20.461761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35afc0>]}
[0m14:46:20.461976 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m14:46:20.462172 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m14:46:20.462298 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:46:20.462498 [info ] [Thread-1 (]: 4 of 7 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m14:46:20.462736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m14:46:20.462904 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m14:46:20.465604 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:46:20.465878 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m14:46:20.467295 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:46:20.467422 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp144620466537"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."public"."stages"
  WHERE stage_id IS NOT NULL OR stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
      AND new_deal_stages_data.deal_stage_name = existing_deal_stages_data.deal_stage_name
  WHERE
    existing_deal_stages_data.deal_stage_id IS NULL
    OR existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m14:46:20.467536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:20.473884 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m14:46:20.474966 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:46:20.475095 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp144620466537'
        
      order by ordinal_position

  
[0m14:46:20.478646 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:46:20.479812 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:46:20.479955 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.481228 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m14:46:20.482485 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:46:20.482604 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.484824 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:46:20.485470 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:46:20.485761 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:46:20.485878 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp144620466537" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m14:46:20.486315 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m14:46:20.486748 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:46:20.486853 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:46:20.486948 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:46:20.487591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:46:20.487814 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m14:46:20.487997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8d7930>]}
[0m14:46:20.488209 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m14:46:20.488388 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:46:20.488507 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m14:46:20.488664 [info ] [Thread-1 (]: 5 of 7 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m14:46:20.488790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m14:46:20.488896 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m14:46:20.490138 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m14:46:20.490371 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m14:46:20.491803 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:46:20.491916 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp144620491247"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m14:46:20.492020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:20.498777 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.007 seconds
[0m14:46:20.499835 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:46:20.499954 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp144620491247'
        
      order by ordinal_position

  
[0m14:46:20.504210 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:46:20.506585 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:46:20.506710 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.508602 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:46:20.509574 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:46:20.509700 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.511136 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:46:20.511977 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m14:46:20.512274 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:46:20.512406 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp144620491247" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m14:46:20.516609 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m14:46:20.517078 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:46:20.517186 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:46:20.517282 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:46:20.517932 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:46:20.518177 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m14:46:20.518382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a68da50>]}
[0m14:46:20.518605 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m14:46:20.518794 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m14:46:20.518928 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:46:20.519115 [info ] [Thread-1 (]: 6 of 7 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:46:20.519243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:46:20.519351 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:46:20.520431 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:46:20.539655 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.539863 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:46:20.539977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:20.546893 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:46:20.548081 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.548197 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:46:20.552000 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m14:46:20.554108 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.554240 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:46:20.555907 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:46:20.568730 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.568929 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

        
  
    

  create temporary table "stg_deal_activity_types_snapshot__dbt_tmp144620568194"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:46:20.572456 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:46:20.573233 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.573346 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144620568194'
        
      order by ordinal_position

  
[0m14:46:20.575932 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:46:20.576936 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.577045 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:46:20.579067 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:46:20.580036 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.580154 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144620568194'
        
      order by ordinal_position

  
[0m14:46:20.581263 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:46:20.582154 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.582268 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:46:20.583463 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:46:20.585861 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.585987 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144620568194'
        
      order by ordinal_position

  
[0m14:46:20.587108 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:46:20.592514 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.592721 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:46:20.593686 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:46:20.594697 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.594809 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:46:20.595241 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:46:20.595403 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.595704 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.595846 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_deal_activity_types_snapshot__dbt_tmp144620568194" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_deal_activity_types_snapshot__dbt_tmp144620568194" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:46:20.596849 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m14:46:20.597302 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:46:20.597408 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:46:20.597503 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:46:20.598465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:46:20.599343 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:46:20.599537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f85e3c0>]}
[0m14:46:20.599822 [info ] [Thread-1 (]: 6 of 7 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mINSERT 0 1[0m in 0.08s]
[0m14:46:20.600010 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:46:20.600273 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:46:20.600459 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:46:20.600615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:46:20.600730 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:46:20.601814 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:46:20.602036 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:46:20.603185 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:46:20.603293 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp144620602660"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
  );
  
  
[0m14:46:20.603393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:20.611599 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m14:46:20.612741 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:46:20.612867 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp144620602660'
        
      order by ordinal_position

  
[0m14:46:20.616757 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:46:20.617881 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:46:20.617999 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.619268 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:46:20.620231 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:46:20.620346 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:46:20.621897 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:46:20.622632 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:46:20.622958 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:46:20.623080 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp144620602660" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m14:46:20.623676 [debug] [Thread-1 (]: Postgres adapter: Postgres error: MERGE command cannot affect row a second time
HINT:  Ensure that not more than one source row matches any one target row.

[0m14:46:20.623805 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: ROLLBACK
[0m14:46:20.624098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:46:20.629390 [debug] [Thread-1 (]: Database Error in model stg_deal_activity_types (models/staging/pipedrive/stg_deal_activity_types.sql)
  MERGE command cannot affect row a second time
  HINT:  Ensure that not more than one source row matches any one target row.
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_activity_types.sql
[0m14:46:20.629574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178464c1-8ce5-4ee4-8266-b411de6a449a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f806d50>]}
[0m14:46:20.629808 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[31mERROR[0m in 0.03s]
[0m14:46:20.630012 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:46:20.630192 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_activity_types' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_activity_types (models/staging/pipedrive/stg_deal_activity_types.sql)
  MERGE command cannot affect row a second time
  HINT:  Ensure that not more than one source row matches any one target row.
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_activity_types.sql.
[0m14:46:20.630752 [debug] [MainThread]: On master: COMMIT
[0m14:46:20.630861 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:20.630946 [debug] [MainThread]: On master: COMMIT
[0m14:46:20.631021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:46:20.637030 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m14:46:20.637150 [debug] [MainThread]: On master: Close
[0m14:46:20.637349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:20.637454 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_activity_types' was properly closed.
[0m14:46:20.637593 [info ] [MainThread]: 
[0m14:46:20.637706 [info ] [MainThread]: Finished running 5 incremental models, 1 snapshot, 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m14:46:20.638191 [debug] [MainThread]: Command end result
[0m14:46:20.646986 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:46:20.647730 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:46:20.649891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:46:20.650001 [info ] [MainThread]: 
[0m14:46:20.650121 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:46:20.650218 [info ] [MainThread]: 
[0m14:46:20.650338 [error] [MainThread]: [31mFailure in model stg_deal_activity_types (models/staging/pipedrive/stg_deal_activity_types.sql)[0m
[0m14:46:20.650454 [error] [MainThread]:   Database Error in model stg_deal_activity_types (models/staging/pipedrive/stg_deal_activity_types.sql)
  MERGE command cannot affect row a second time
  HINT:  Ensure that not more than one source row matches any one target row.
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_activity_types.sql
[0m14:46:20.650538 [info ] [MainThread]: 
[0m14:46:20.650639 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_activity_types.sql
[0m14:46:20.650725 [info ] [MainThread]: 
[0m14:46:20.650822 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m14:46:20.652697 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7334543, "process_in_blocks": "0", "process_kernel_time": 0.147888, "process_mem_max_rss": "145768448", "process_out_blocks": "0", "process_user_time": 0.892637}
[0m14:46:20.652837 [debug] [MainThread]: Command `dbt build` failed at 14:46:20.652809 after 0.73 seconds
[0m14:46:20.652958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f97f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f97f950>]}
[0m14:46:20.653065 [debug] [MainThread]: Flushing usage events
[0m14:46:23.076876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:47:18.328414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0917f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e04b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e04bb10>]}


============================== 14:47:18.330083 | e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8 ==============================
[0m14:47:18.330083 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:47:18.330324 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt build', 'indirect_selection': 'eager', 'log_format': 'default', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'version_check': 'True', 'empty': 'False', 'printer_width': '80', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True'}
[0m14:47:18.384827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3329e0>]}
[0m14:47:18.404223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfae9c0>]}
[0m14:47:18.404534 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:47:18.434831 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:47:18.476982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:47:18.477226 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m14:47:18.563100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0a2950>]}
[0m14:47:18.615382 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:47:18.616183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:47:18.625428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad77b60>]}
[0m14:47:18.625614 [info ] [MainThread]: Found 6 models, 1 snapshot, 6 sources, 464 macros
[0m14:47:18.626495 [info ] [MainThread]: 
[0m14:47:18.626628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:18.626721 [info ] [MainThread]: 
[0m14:47:18.626892 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:47:18.628305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:47:18.647558 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:47:18.647720 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:47:18.647812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:18.670364 [debug] [ThreadPool]: SQL status: SELECT 83 in 0.022 seconds
[0m14:47:18.670902 [debug] [ThreadPool]: On list_postgres: Close
[0m14:47:18.671641 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:47:18.671765 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:47:18.671882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:18.679391 [debug] [ThreadPool]: SQL status: SELECT 83 in 0.007 seconds
[0m14:47:18.679841 [debug] [ThreadPool]: On list_postgres: Close
[0m14:47:18.680384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m14:47:18.682619 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:47:18.682777 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:47:18.682909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:18.692494 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:47:18.692946 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:47:18.693322 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:47:18.693489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m14:47:18.694363 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:47:18.694471 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:47:18.694561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:18.702847 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m14:47:18.703212 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:47:18.703537 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:47:18.705041 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:18.705173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:47:18.705285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:18.713697 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:47:18.714094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f17a890>]}
[0m14:47:18.714246 [debug] [MainThread]: On master: ROLLBACK
[0m14:47:18.714582 [debug] [MainThread]: On master: COMMIT
[0m14:47:18.714671 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:18.714752 [debug] [MainThread]: On master: COMMIT
[0m14:47:18.715274 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:47:18.715361 [debug] [MainThread]: On master: Close
[0m14:47:18.716366 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m14:47:18.716538 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m14:47:18.716689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activities)
[0m14:47:18.716806 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m14:47:18.719671 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:47:18.719965 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m14:47:18.740156 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:47:18.740326 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp144718731343"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m14:47:18.740431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:18.751837 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.011 seconds
[0m14:47:18.756579 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:47:18.756719 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp144718731343'
        
      order by ordinal_position

  
[0m14:47:18.763733 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m14:47:18.765435 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:47:18.765565 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:18.768094 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:47:18.771111 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:47:18.771236 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:18.773446 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:47:18.781788 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:47:18.782135 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:47:18.782276 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp144718731343" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m14:47:18.790899 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.008 seconds
[0m14:47:18.796026 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:47:18.796177 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:47:18.796279 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:47:18.798346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:47:18.798980 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m14:47:18.799572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f880390>]}
[0m14:47:18.799800 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m14:47:18.799990 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m14:47:18.800120 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:47:18.800314 [info ] [Thread-1 (]: 2 of 7 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m14:47:18.800488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m14:47:18.800604 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:47:18.801533 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:47:18.801775 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:47:18.808058 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:47:18.808448 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:47:18.808579 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m14:47:18.808697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:18.823782 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.015 seconds
[0m14:47:18.827160 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:47:18.827286 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:47:18.827762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:47:18.828921 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:47:18.829048 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:47:18.829834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:47:18.830937 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:47:18.831047 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:47:18.831138 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:47:18.834438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:47:18.836538 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m14:47:18.838146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:47:18.838269 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m14:47:18.839266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:47:18.839722 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:47:18.839937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3c3dd0>]}
[0m14:47:18.840165 [info ] [Thread-1 (]: 2 of 7 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.04s]
[0m14:47:18.840351 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:47:18.840478 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m14:47:18.840691 [info ] [Thread-1 (]: 3 of 7 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m14:47:18.840843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m14:47:18.840958 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m14:47:18.841933 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:47:18.842191 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m14:47:18.843559 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:47:18.843670 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp144718842998"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m14:47:18.843766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:18.852396 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m14:47:18.853359 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:47:18.853476 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp144718842998'
        
      order by ordinal_position

  
[0m14:47:18.858011 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:47:18.859149 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:47:18.859270 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:18.860399 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:47:18.861406 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:47:18.861525 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:18.862608 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:47:18.864948 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:47:18.865274 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:47:18.865399 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp144718842998" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m14:47:18.866238 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m14:47:18.866698 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:47:18.866812 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:47:18.866917 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:47:18.867436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:47:18.867672 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m14:47:18.867864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f43a8e0>]}
[0m14:47:18.868078 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m14:47:18.868258 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m14:47:18.868378 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:47:18.868537 [info ] [Thread-1 (]: 4 of 7 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m14:47:18.868664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m14:47:18.868767 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m14:47:18.871648 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:47:18.871885 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m14:47:18.873098 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:47:18.873223 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp144718872537"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."public"."stages"
  WHERE stage_id IS NOT NULL OR stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
      AND new_deal_stages_data.deal_stage_name = existing_deal_stages_data.deal_stage_name
  WHERE
    existing_deal_stages_data.deal_stage_id IS NULL
    OR existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m14:47:18.873334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:18.878791 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m14:47:18.880113 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:47:18.880261 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp144718872537'
        
      order by ordinal_position

  
[0m14:47:18.883270 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m14:47:18.884325 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:47:18.884443 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:18.885792 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m14:47:18.886724 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:47:18.886837 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:18.887761 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m14:47:18.888736 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:47:18.889070 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:47:18.889192 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp144718872537" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m14:47:18.889597 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m14:47:18.890049 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:47:18.890157 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:47:18.890254 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:47:18.890992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:47:18.891230 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m14:47:18.891421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8896d0>]}
[0m14:47:18.891648 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.02s]
[0m14:47:18.891838 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:47:18.891962 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m14:47:18.892128 [info ] [Thread-1 (]: 5 of 7 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m14:47:18.892266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_stages, now model.enpal_assessment_project.stg_deal_users)
[0m14:47:18.892376 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m14:47:18.893606 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m14:47:18.893826 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m14:47:18.895217 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:47:18.895333 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp144718894476"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m14:47:18.895436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:18.900833 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.005 seconds
[0m14:47:18.901885 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:47:18.902028 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp144718894476'
        
      order by ordinal_position

  
[0m14:47:18.906411 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:47:18.907380 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:47:18.907495 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:18.908677 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:47:18.909883 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:47:18.910012 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:18.911280 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:47:18.911986 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m14:47:18.912284 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:47:18.912400 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp144718894476" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m14:47:18.914766 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.002 seconds
[0m14:47:18.915340 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:47:18.915467 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:47:18.915571 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:47:18.916249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:47:18.916501 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m14:47:18.916699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6e2750>]}
[0m14:47:18.916924 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.02s]
[0m14:47:18.917112 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m14:47:18.917242 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:47:18.917411 [info ] [Thread-1 (]: 6 of 7 START snapshot pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [RUN]
[0m14:47:18.917545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot)
[0m14:47:18.917655 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:47:18.918685 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:47:18.937072 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.937239 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:47:18.937343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:18.945465 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:47:18.946578 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.946697 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:47:18.953171 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m14:47:18.955295 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.955427 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:47:18.957809 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:47:18.970506 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.970705 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

        
  
    

  create temporary table "stg_deal_activity_types_snapshot__dbt_tmp144718969973"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:47:18.974418 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:47:18.975388 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.975511 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144718969973'
        
      order by ordinal_position

  
[0m14:47:18.976897 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:47:18.977783 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.977893 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:47:18.980325 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:47:18.981229 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.981349 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144718969973'
        
      order by ordinal_position

  
[0m14:47:18.983392 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:47:18.985438 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.985551 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:47:18.987586 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:47:18.989791 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.989917 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types_snapshot__dbt_tmp144718969973'
        
      order by ordinal_position

  
[0m14:47:18.992009 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:47:18.997219 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.997424 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:47:18.998285 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:47:18.999593 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:18.999708 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:47:19.000123 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:47:19.000292 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:19.000606 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:19.000740 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_deal_activity_types_snapshot__dbt_tmp144718969973" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_deal_activity_types_snapshot__dbt_tmp144718969973" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:47:19.001634 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:47:19.002085 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:47:19.002191 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot"
[0m14:47:19.002289 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: COMMIT
[0m14:47:19.003304 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:47:19.004143 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot: Close
[0m14:47:19.004332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8d2c10>]}
[0m14:47:19.004607 [info ] [Thread-1 (]: 6 of 7 OK snapshotted pipedrive_snapshots.stg_deal_activity_types_snapshot ..... [[32mINSERT 0 0[0m in 0.09s]
[0m14:47:19.004802 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot
[0m14:47:19.005071 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:47:19.005246 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:47:19.005405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.stg_deal_activity_types_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:47:19.005516 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:47:19.006472 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:47:19.006692 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:47:19.007987 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:47:19.008099 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp144719007301"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."stg_deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m14:47:19.008199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:19.017284 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m14:47:19.018308 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:47:19.018430 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp144719007301'
        
      order by ordinal_position

  
[0m14:47:19.024382 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m14:47:19.025330 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:47:19.025448 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:19.026749 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:47:19.027922 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:47:19.028040 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:47:19.029999 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:47:19.030682 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:47:19.030968 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:47:19.031089 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp144719007301" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m14:47:19.031941 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m14:47:19.032360 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:47:19.032464 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:47:19.032556 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:47:19.033484 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:47:19.033708 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:47:19.033888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f5db87-1e1a-455c-bf55-0d3b1fa21bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f818c50>]}
[0m14:47:19.034092 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.03s]
[0m14:47:19.034271 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:47:19.034684 [debug] [MainThread]: On master: COMMIT
[0m14:47:19.034780 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:19.034861 [debug] [MainThread]: On master: COMMIT
[0m14:47:19.034936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:19.039783 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m14:47:19.039910 [debug] [MainThread]: On master: Close
[0m14:47:19.040049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:19.040134 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_activity_types' was properly closed.
[0m14:47:19.040261 [info ] [MainThread]: 
[0m14:47:19.040366 [info ] [MainThread]: Finished running 5 incremental models, 1 snapshot, 1 table model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m14:47:19.040829 [debug] [MainThread]: Command end result
[0m14:47:19.049661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:47:19.050389 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:47:19.052660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:47:19.052766 [info ] [MainThread]: 
[0m14:47:19.052898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:19.052997 [info ] [MainThread]: 
[0m14:47:19.053104 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:47:19.054290 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.75002724, "process_in_blocks": "0", "process_kernel_time": 0.125022, "process_mem_max_rss": "147947520", "process_out_blocks": "0", "process_user_time": 0.965233}
[0m14:47:19.054429 [debug] [MainThread]: Command `dbt build` succeeded at 14:47:19.054401 after 0.75 seconds
[0m14:47:19.054539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c594770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f93d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f93fdd0>]}
[0m14:47:19.054643 [debug] [MainThread]: Flushing usage events
[0m14:47:21.263786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:34.037264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8b57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86fb10>]}


============================== 14:53:34.039876 | 95688032-9a8f-42c0-8300-4e3275489695 ==============================
[0m14:53:34.039876 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:53:34.040120 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build', 'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False'}
[0m14:53:34.108868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb569e0>]}
[0m14:53:34.148670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7d29c0>]}
[0m14:53:34.149350 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:53:34.185589 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:53:34.236423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:53:34.236716 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:53:34.236859 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m14:53:34.236979 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m14:53:34.414695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e81df50>]}
[0m14:53:34.444046 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:53:34.445237 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:53:34.461822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d99a0>]}
[0m14:53:34.462001 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m14:53:34.462952 [info ] [MainThread]: 
[0m14:53:34.463099 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:34.463197 [info ] [MainThread]: 
[0m14:53:34.463368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:34.464843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:53:34.487252 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:53:34.487421 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:53:34.487519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:34.518755 [debug] [ThreadPool]: SQL status: SELECT 89 in 0.031 seconds
[0m14:53:34.519383 [debug] [ThreadPool]: On list_postgres: Close
[0m14:53:34.520165 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:53:34.520290 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:53:34.520373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:34.528181 [debug] [ThreadPool]: SQL status: SELECT 89 in 0.008 seconds
[0m14:53:34.528664 [debug] [ThreadPool]: On list_postgres: Close
[0m14:53:34.529335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:53:34.531610 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:53:34.531740 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:53:34.531834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:34.542843 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m14:53:34.543264 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:53:34.543631 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:53:34.543799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:53:34.544452 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:53:34.544557 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:53:34.544645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:34.553511 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m14:53:34.553958 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:53:34.554332 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:53:34.556123 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:34.556271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:53:34.556390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:34.565357 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:53:34.565757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e97cbb0>]}
[0m14:53:34.565911 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:34.566315 [debug] [MainThread]: On master: COMMIT
[0m14:53:34.566401 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:34.566477 [debug] [MainThread]: On master: COMMIT
[0m14:53:34.566998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:53:34.567082 [debug] [MainThread]: On master: Close
[0m14:53:34.568397 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m14:53:34.568582 [info ] [Thread-1 (]: 1 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m14:53:34.568739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m14:53:34.568852 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m14:53:34.571620 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:53:34.571865 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m14:53:34.591466 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:53:34.591637 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp145334583105"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m14:53:34.591746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.603021 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.011 seconds
[0m14:53:34.607553 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:53:34.607680 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp145334583105'
        
      order by ordinal_position

  
[0m14:53:34.614435 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m14:53:34.616148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:53:34.616267 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:53:34.618915 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m14:53:34.621862 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:53:34.621986 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:53:34.624446 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:53:34.633547 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:53:34.633827 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:53:34.633953 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp145334583105" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m14:53:34.643318 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.009 seconds
[0m14:53:34.648196 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:53:34.648320 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:53:34.648420 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:53:34.652073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:53:34.652695 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m14:53:34.653485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f17e820>]}
[0m14:53:34.653714 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m14:53:34.653915 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m14:53:34.654042 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:53:34.654231 [info ] [Thread-1 (]: 2 of 9 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m14:53:34.654400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m14:53:34.654516 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:53:34.655352 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:53:34.655573 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:53:34.659969 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:53:34.660185 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:53:34.660300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m14:53:34.660412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.674130 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.014 seconds
[0m14:53:34.677633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:53:34.677761 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:53:34.678232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:53:34.679299 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:53:34.679409 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:53:34.679809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:53:34.680913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:53:34.681019 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:53:34.681118 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:53:34.682501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:53:34.684756 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m14:53:34.686437 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:53:34.686562 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m14:53:34.687672 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:53:34.688144 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:53:34.688359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed11790>]}
[0m14:53:34.688599 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.03s]
[0m14:53:34.688796 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:53:34.688927 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m14:53:34.689079 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m14:53:34.689248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m14:53:34.689360 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m14:53:34.690349 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:53:34.690626 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m14:53:34.692085 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:53:34.692201 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp145334691517"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m14:53:34.692305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.700609 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m14:53:34.701647 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:53:34.701781 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp145334691517'
        
      order by ordinal_position

  
[0m14:53:34.706555 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m14:53:34.709170 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:53:34.709296 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:53:34.711125 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:53:34.712138 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:53:34.712261 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:53:34.713276 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:53:34.715327 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:53:34.715635 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:53:34.715754 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp145334691517" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m14:53:34.716383 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m14:53:34.716868 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:53:34.716980 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:53:34.717081 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:53:34.717532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:53:34.717769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m14:53:34.717963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed431d0>]}
[0m14:53:34.718187 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m14:53:34.718374 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m14:53:34.718499 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m14:53:34.718665 [info ] [Thread-1 (]: 4 of 9 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m14:53:34.718798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_users)
[0m14:53:34.718906 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m14:53:34.720281 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m14:53:34.720511 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m14:53:34.721712 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:53:34.721826 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp145334721164"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m14:53:34.721935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.728136 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.006 seconds
[0m14:53:34.729331 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:53:34.729457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp145334721164'
        
      order by ordinal_position

  
[0m14:53:34.732055 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:53:34.733224 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:53:34.733361 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:53:34.735048 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:53:34.736115 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:53:34.736244 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:53:34.737708 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:53:34.738675 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m14:53:34.738961 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:53:34.739085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp145334721164" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m14:53:34.742725 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.003 seconds
[0m14:53:34.743173 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:53:34.743279 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:53:34.743375 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:53:34.744109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:53:34.744341 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m14:53:34.744539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b110410>]}
[0m14:53:34.744783 [info ] [Thread-1 (]: 4 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m14:53:34.744978 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m14:53:34.745113 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:53:34.745285 [info ] [Thread-1 (]: 5 of 9 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m14:53:34.745424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m14:53:34.745534 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:53:34.746549 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:53:34.769000 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:53:34.769177 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."activity_types"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:53:34.769289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.776648 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:53:34.777883 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:53:34.778021 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:53:34.778331 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:53:34.778488 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:53:34.778783 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:53:34.778891 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."activity_types"
    ) sbq



  );
  
  
[0m14:53:34.779868 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:53:34.780454 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:53:34.780558 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:53:34.780649 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:53:34.781093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:53:34.781345 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m14:53:34.781553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f035a50>]}
[0m14:53:34.781846 [info ] [Thread-1 (]: 5 of 9 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mSELECT 4[0m in 0.04s]
[0m14:53:34.782038 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:53:34.782165 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:53:34.782341 [info ] [Thread-1 (]: 6 of 9 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m14:53:34.782551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m14:53:34.782688 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:53:34.783723 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:53:34.784736 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:53:34.784847 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:53:34.784947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.792356 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                  ^

[0m14:53:34.792501 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m14:53:34.799018 [debug] [Thread-1 (]: Database Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^
[0m14:53:34.799254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f254050>]}
[0m14:53:34.799550 [error] [Thread-1 (]: 6 of 9 ERROR snapshotting pipedrive_snapshots.deal_stages_snapshot ............. [[31mERROR[0m in 0.02s]
[0m14:53:34.799750 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:53:34.799884 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:53:34.800065 [debug] [Thread-4 (]: Marking all children of 'snapshot.enpal_assessment_project.deal_stages_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^.
[0m14:53:34.800239 [info ] [Thread-1 (]: 7 of 9 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m14:53:34.800600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m14:53:34.800732 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:53:34.801859 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:53:34.802852 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:53:34.802970 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."users"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:53:34.803072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.809814 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:53:34.810122 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:53:34.810232 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:53:34.810532 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:53:34.810707 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:53:34.810998 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:53:34.811117 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_users_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."users"
    ) sbq



  );
  
  
[0m14:53:34.813787 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.003 seconds
[0m14:53:34.814473 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:53:34.814606 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:53:34.814714 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:53:34.815496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:53:34.815751 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m14:53:34.815941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f283830>]}
[0m14:53:34.816223 [info ] [Thread-1 (]: 7 of 9 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mSELECT 1787[0m in 0.02s]
[0m14:53:34.816413 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:53:34.816543 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:53:34.816736 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:53:34.816893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:53:34.817007 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:53:34.818272 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:53:34.818525 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:53:34.819670 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:53:34.819779 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp145334819152"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m14:53:34.819877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.828489 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m14:53:34.829498 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:53:34.829634 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp145334819152'
        
      order by ordinal_position

  
[0m14:53:34.832508 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m14:53:34.833596 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:53:34.833719 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:53:34.835835 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:53:34.836826 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:53:34.836941 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:53:34.837945 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:53:34.838566 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:53:34.838835 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:53:34.838944 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp145334819152" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m14:53:34.839389 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m14:53:34.839783 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:53:34.839880 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:53:34.839964 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:53:34.840428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:53:34.840639 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:53:34.840831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95688032-9a8f-42c0-8300-4e3275489695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f283bf0>]}
[0m14:53:34.841064 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m14:53:34.841260 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:53:34.841382 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:53:34.841533 [info ] [Thread-1 (]: 9 of 9 SKIP relation public_pipedrive_staging.stg_deal_stages .................. [[33mSKIP[0m]
[0m14:53:34.841679 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:53:34.841788 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'skipped'. 
[0m14:53:34.842266 [debug] [MainThread]: On master: COMMIT
[0m14:53:34.842391 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:34.842480 [debug] [MainThread]: On master: COMMIT
[0m14:53:34.842555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:34.847178 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m14:53:34.847320 [debug] [MainThread]: On master: Close
[0m14:53:34.847473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:34.847565 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_activity_types' was properly closed.
[0m14:53:34.847702 [info ] [MainThread]: 
[0m14:53:34.847811 [info ] [MainThread]: Finished running 5 incremental models, 3 snapshots, 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m14:53:34.848336 [debug] [MainThread]: Command end result
[0m14:53:34.858127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:53:34.858788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:53:34.861039 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:53:34.861150 [info ] [MainThread]: 
[0m14:53:34.861275 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:53:34.861372 [info ] [MainThread]: 
[0m14:53:34.861499 [error] [MainThread]: [31mFailure in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)[0m
[0m14:53:34.861615 [error] [MainThread]:   Database Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  column "id" does not exist
  LINE 7:         md5(coalesce(cast(id as varchar ), '')
                                    ^
[0m14:53:34.861706 [info ] [MainThread]: 
[0m14:53:34.861814 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=9
[0m14:53:34.863768 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8538581, "process_in_blocks": "0", "process_kernel_time": 0.155635, "process_mem_max_rss": "151240704", "process_out_blocks": "0", "process_user_time": 1.019947}
[0m14:53:34.863931 [debug] [MainThread]: Command `dbt build` failed at 14:53:34.863898 after 0.85 seconds
[0m14:53:34.864066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae239b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f283d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f283bf0>]}
[0m14:53:34.864497 [debug] [MainThread]: Flushing usage events
[0m14:53:37.588166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:04.722008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfb17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6bb10>]}


============================== 14:54:04.723683 | 7735218c-6d8b-46e9-966d-2e3a81345976 ==============================
[0m14:54:04.723683 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:54:04.723913 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'log_cache_events': 'False'}
[0m14:54:04.778045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2529e0>]}
[0m14:54:04.797084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dece9c0>]}
[0m14:54:04.797433 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:54:04.826993 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:54:04.870094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:04.870358 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m14:54:04.965500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efc7550>]}
[0m14:54:05.015781 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:54:05.016564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:54:05.025773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfd59a0>]}
[0m14:54:05.025952 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m14:54:05.026891 [info ] [MainThread]: 
[0m14:54:05.027013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:05.027104 [info ] [MainThread]: 
[0m14:54:05.027275 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:05.028718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:54:05.047761 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:54:05.047939 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:54:05.048036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:05.070574 [debug] [ThreadPool]: SQL status: SELECT 95 in 0.022 seconds
[0m14:54:05.071168 [debug] [ThreadPool]: On list_postgres: Close
[0m14:54:05.071924 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:54:05.072057 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:54:05.072180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:05.079652 [debug] [ThreadPool]: SQL status: SELECT 95 in 0.007 seconds
[0m14:54:05.080127 [debug] [ThreadPool]: On list_postgres: Close
[0m14:54:05.080672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m14:54:05.082846 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:54:05.082972 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:54:05.083068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:05.092863 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:54:05.093325 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:54:05.093660 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:54:05.093833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m14:54:05.094681 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:54:05.094784 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:54:05.094873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:05.103723 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m14:54:05.104106 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:54:05.104429 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:54:05.106083 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:05.106211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:54:05.106323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:05.114951 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:54:05.115332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6c5ef0>]}
[0m14:54:05.115484 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:05.115810 [debug] [MainThread]: On master: COMMIT
[0m14:54:05.115895 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:05.115973 [debug] [MainThread]: On master: COMMIT
[0m14:54:05.116481 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:54:05.116570 [debug] [MainThread]: On master: Close
[0m14:54:05.117555 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m14:54:05.117740 [info ] [Thread-1 (]: 1 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m14:54:05.117894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activities)
[0m14:54:05.118007 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m14:54:05.120867 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:54:05.121177 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m14:54:05.141250 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:54:05.141426 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp145405132512"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m14:54:05.141536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.152905 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.011 seconds
[0m14:54:05.159343 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:54:05.159501 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp145405132512'
        
      order by ordinal_position

  
[0m14:54:05.165039 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m14:54:05.166908 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:54:05.167038 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.169669 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m14:54:05.172618 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:54:05.172743 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.174759 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:54:05.183106 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:54:05.183467 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:54:05.183590 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp145405132512" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m14:54:05.193375 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.010 seconds
[0m14:54:05.198064 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:54:05.198189 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:54:05.198287 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:54:05.200689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:54:05.201325 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m14:54:05.202135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11483c530>]}
[0m14:54:05.202368 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m14:54:05.202569 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m14:54:05.202703 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:54:05.202878 [info ] [Thread-1 (]: 2 of 9 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m14:54:05.203023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m14:54:05.203136 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:54:05.204010 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:54:05.204200 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:54:05.208462 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:54:05.208741 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:54:05.208867 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m14:54:05.208979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.225256 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.016 seconds
[0m14:54:05.228759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:54:05.228881 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:54:05.229777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:54:05.230862 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:54:05.230976 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:54:05.231580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:54:05.232722 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:54:05.232833 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:54:05.232929 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:54:05.236570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:54:05.238802 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m14:54:05.240482 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:54:05.240600 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m14:54:05.242443 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:54:05.242894 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:54:05.243090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114840410>]}
[0m14:54:05.243305 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.04s]
[0m14:54:05.243493 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:54:05.243619 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m14:54:05.243809 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m14:54:05.243975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m14:54:05.244087 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m14:54:05.245064 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:54:05.245313 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m14:54:05.246761 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:54:05.246878 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp145405246183"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m14:54:05.246982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.254978 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m14:54:05.255908 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:54:05.256025 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp145405246183'
        
      order by ordinal_position

  
[0m14:54:05.260119 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:54:05.261234 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:54:05.261350 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.262791 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:54:05.263910 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:54:05.264053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.265515 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:54:05.267661 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:54:05.267971 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:54:05.268099 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp145405246183" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m14:54:05.268715 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m14:54:05.269167 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:54:05.269278 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:54:05.269375 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:54:05.269817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:54:05.270054 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m14:54:05.270246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f12aba0>]}
[0m14:54:05.270457 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m14:54:05.270639 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m14:54:05.270761 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m14:54:05.270923 [info ] [Thread-1 (]: 4 of 9 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m14:54:05.271053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_users)
[0m14:54:05.271159 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m14:54:05.272608 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m14:54:05.272870 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m14:54:05.274080 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:54:05.274192 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp145405273542"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m14:54:05.274295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.282657 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.008 seconds
[0m14:54:05.283932 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:54:05.284056 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp145405273542'
        
      order by ordinal_position

  
[0m14:54:05.288645 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:54:05.289611 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:54:05.289725 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.291563 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:54:05.292492 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:54:05.292603 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.293594 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:54:05.294646 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m14:54:05.294965 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:54:05.295096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp145405273542" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m14:54:05.297315 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.002 seconds
[0m14:54:05.297878 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:54:05.298010 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:54:05.298117 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:54:05.298861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:54:05.299132 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m14:54:05.299332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11486eb70>]}
[0m14:54:05.299554 [info ] [Thread-1 (]: 4 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m14:54:05.299746 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m14:54:05.299878 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:54:05.300045 [info ] [Thread-1 (]: 5 of 9 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m14:54:05.300182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m14:54:05.300292 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:54:05.301291 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:54:05.320371 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.320538 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:54:05.320640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.328647 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:54:05.329747 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.329947 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:54:05.336450 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m14:54:05.338632 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.338770 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:54:05.340800 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:54:05.353903 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.354088 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp145405353370"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:54:05.357716 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:54:05.358710 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.358831 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145405353370'
        
      order by ordinal_position

  
[0m14:54:05.360134 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:54:05.361076 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.361193 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:54:05.363576 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:54:05.364465 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.364577 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145405353370'
        
      order by ordinal_position

  
[0m14:54:05.366024 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:54:05.368047 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.368165 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:54:05.369252 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:54:05.371447 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.371563 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145405353370'
        
      order by ordinal_position

  
[0m14:54:05.372571 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:54:05.377967 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.378167 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:54:05.379107 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:54:05.380523 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.380652 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:54:05.381047 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:54:05.381215 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.381534 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.381662 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp145405353370" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp145405353370" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:54:05.382545 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:54:05.382989 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:54:05.383094 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:54:05.383188 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:54:05.384325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:54:05.385178 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m14:54:05.385362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b807450>]}
[0m14:54:05.385629 [info ] [Thread-1 (]: 5 of 9 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.09s]
[0m14:54:05.385820 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:54:05.385942 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:54:05.386112 [info ] [Thread-1 (]: 6 of 9 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m14:54:05.386271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m14:54:05.386378 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:54:05.387182 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:54:05.389711 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:54:05.389829 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:54:05.389934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.397574 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:54:05.397918 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:54:05.398021 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:54:05.398408 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:54:05.398556 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:54:05.398863 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:54:05.398974 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



  );
  
  
[0m14:54:05.401079 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m14:54:05.401625 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m14:54:05.401733 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:54:05.401827 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m14:54:05.402586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:54:05.402815 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m14:54:05.402986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1e0c90>]}
[0m14:54:05.403246 [info ] [Thread-1 (]: 6 of 9 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mSELECT 9[0m in 0.02s]
[0m14:54:05.403434 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:54:05.403557 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:54:05.403722 [info ] [Thread-1 (]: 7 of 9 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m14:54:05.403880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m14:54:05.403996 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:54:05.404927 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:54:05.406037 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.406148 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:54:05.406249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.413607 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:54:05.414741 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.414866 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:54:05.421609 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m14:54:05.422813 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.422940 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:54:05.425200 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:54:05.426886 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.427075 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp145405426097"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:54:05.430777 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m14:54:05.431670 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.431794 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145405426097'
        
      order by ordinal_position

  
[0m14:54:05.432993 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:54:05.433973 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.434096 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:54:05.435182 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:54:05.436417 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.436541 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145405426097'
        
      order by ordinal_position

  
[0m14:54:05.437856 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:54:05.438811 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.438935 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:54:05.440196 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:54:05.441260 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.441379 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145405426097'
        
      order by ordinal_position

  
[0m14:54:05.442625 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:54:05.443422 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.443624 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:54:05.444147 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:54:05.444722 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.444837 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:54:05.445140 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:54:05.445315 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.445607 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.445732 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp145405426097" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp145405426097" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:54:05.446225 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m14:54:05.446745 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:54:05.446872 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:54:05.446978 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:54:05.447852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:54:05.448147 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m14:54:05.448341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f609b50>]}
[0m14:54:05.448632 [info ] [Thread-1 (]: 7 of 9 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.04s]
[0m14:54:05.448826 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:54:05.448961 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:54:05.449146 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:54:05.449301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:54:05.449418 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:54:05.450535 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:54:05.450768 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:54:05.452203 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:54:05.452330 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp145405451441"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m14:54:05.452443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.457589 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m14:54:05.458733 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:54:05.458865 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp145405451441'
        
      order by ordinal_position

  
[0m14:54:05.461646 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m14:54:05.462703 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:54:05.462837 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.464060 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:54:05.465341 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:54:05.465462 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.466770 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:54:05.467462 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:54:05.467759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:54:05.467885 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp145405451441" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m14:54:05.468311 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m14:54:05.468752 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:54:05.468862 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:54:05.468962 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:54:05.469497 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:54:05.469731 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:54:05.469922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148b2630>]}
[0m14:54:05.470141 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m14:54:05.470330 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:54:05.470461 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:54:05.470623 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m14:54:05.470757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_stages)
[0m14:54:05.470867 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m14:54:05.473708 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:54:05.473993 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m14:54:05.475466 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:54:05.475593 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp145405474883"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m14:54:05.475710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.482382 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:54:05.483477 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:54:05.483602 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp145405474883'
        
      order by ordinal_position

  
[0m14:54:05.489132 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m14:54:05.490204 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:54:05.490330 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.492062 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:54:05.493376 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:54:05.493510 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:54:05.494549 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m14:54:05.495239 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:54:05.495552 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:54:05.495671 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp145405474883" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m14:54:05.496175 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dbt_internal_source.id does not exist
LINE 19:                     DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DE...
                             ^

[0m14:54:05.496294 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: ROLLBACK
[0m14:54:05.496927 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m14:54:05.501832 [debug] [Thread-1 (]: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column dbt_internal_source.id does not exist
  LINE 19:                     DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DE...
                               ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m14:54:05.502035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7735218c-6d8b-46e9-966d-2e3a81345976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148220f0>]}
[0m14:54:05.502273 [error] [Thread-1 (]: 9 of 9 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_stages  [[31mERROR[0m in 0.03s]
[0m14:54:05.502473 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:54:05.502649 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column dbt_internal_source.id does not exist
  LINE 19:                     DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DE...
                               ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql.
[0m14:54:05.503237 [debug] [MainThread]: On master: COMMIT
[0m14:54:05.503381 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:05.503484 [debug] [MainThread]: On master: COMMIT
[0m14:54:05.503570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:05.508333 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m14:54:05.508471 [debug] [MainThread]: On master: Close
[0m14:54:05.508616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:05.508705 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m14:54:05.508835 [info ] [MainThread]: 
[0m14:54:05.508937 [info ] [MainThread]: Finished running 5 incremental models, 3 snapshots, 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:54:05.509478 [debug] [MainThread]: Command end result
[0m14:54:05.519537 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:54:05.520246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:54:05.522450 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:54:05.522556 [info ] [MainThread]: 
[0m14:54:05.522679 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:54:05.522775 [info ] [MainThread]: 
[0m14:54:05.522900 [error] [MainThread]: [31mFailure in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)[0m
[0m14:54:05.523017 [error] [MainThread]:   Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column dbt_internal_source.id does not exist
  LINE 19:                     DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DE...
                               ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m14:54:05.523104 [info ] [MainThread]: 
[0m14:54:05.523209 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m14:54:05.523293 [info ] [MainThread]: 
[0m14:54:05.523393 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=9
[0m14:54:05.524755 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8269421, "process_in_blocks": "0", "process_kernel_time": 0.126243, "process_mem_max_rss": "148701184", "process_out_blocks": "0", "process_user_time": 0.999145}
[0m14:54:05.524901 [debug] [MainThread]: Command `dbt build` failed at 14:54:05.524870 after 0.83 seconds
[0m14:54:05.525026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d153c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11498f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11498fa10>]}
[0m14:54:05.525146 [debug] [MainThread]: Flushing usage events
[0m14:54:07.385096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:03.374429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e17890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e17b10>]}


============================== 14:55:03.376086 | a7d5d332-f349-42f0-bddc-4069c40c2afc ==============================
[0m14:55:03.376086 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:55:03.376325 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'version_check': 'True', 'invocation_command': 'dbt build --full-refresh', 'use_colors': 'True', 'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'empty': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False'}
[0m14:55:03.430855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fe9e0>]}
[0m14:55:03.449916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7a9c0>]}
[0m14:55:03.450221 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:55:03.480718 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:55:03.524074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:03.524225 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:55:03.524312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:03.540118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae71950>]}
[0m14:55:03.569483 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:55:03.570213 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:55:03.579352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e819a0>]}
[0m14:55:03.579545 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m14:55:03.580495 [info ] [MainThread]: 
[0m14:55:03.580617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:03.580708 [info ] [MainThread]: 
[0m14:55:03.580885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:03.582322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:55:03.602916 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:55:03.603085 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:55:03.603176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:03.625270 [debug] [ThreadPool]: SQL status: SELECT 107 in 0.022 seconds
[0m14:55:03.625858 [debug] [ThreadPool]: On list_postgres: Close
[0m14:55:03.626614 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:55:03.626741 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:55:03.626851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:03.634219 [debug] [ThreadPool]: SQL status: SELECT 107 in 0.007 seconds
[0m14:55:03.634704 [debug] [ThreadPool]: On list_postgres: Close
[0m14:55:03.635256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:55:03.637203 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:55:03.637327 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:55:03.637420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:03.646642 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m14:55:03.668831 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:55:03.669624 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:55:03.669831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:55:03.670623 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:55:03.670732 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:55:03.670820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:03.681662 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m14:55:03.682120 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:55:03.682512 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:55:03.684316 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:03.684439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:55:03.684548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:03.694058 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:55:03.694495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b11ac10>]}
[0m14:55:03.694657 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:03.695060 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.695149 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:03.695230 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.695917 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.696012 [debug] [MainThread]: On master: Close
[0m14:55:03.697073 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m14:55:03.697245 [info ] [Thread-1 (]: 1 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m14:55:03.697406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m14:55:03.697522 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m14:55:03.700347 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:03.700617 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m14:55:03.719471 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:03.719814 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:03.719929 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m14:55:03.720030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.734029 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.014 seconds
[0m14:55:03.737399 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:03.737520 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities" rename to "stg_deal_activities__dbt_backup"
[0m14:55:03.738154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:55:03.738970 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:03.739073 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp" rename to "stg_deal_activities"
[0m14:55:03.739670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:03.744719 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:55:03.744835 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:03.744930 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:55:03.745791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.747678 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup"
[0m14:55:03.749118 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:03.749224 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup" cascade
[0m14:55:03.751081 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:03.751843 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m14:55:03.752399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b565160>]}
[0m14:55:03.752601 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mSELECT 4579[0m in 0.05s]
[0m14:55:03.752803 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m14:55:03.752919 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:55:03.753090 [info ] [Thread-1 (]: 2 of 9 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m14:55:03.753250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m14:55:03.753352 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:55:03.754137 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:03.754341 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:55:03.758484 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:03.758700 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:03.758812 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m14:55:03.758910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.777116 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.018 seconds
[0m14:55:03.778410 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:03.778535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:55:03.779337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:55:03.780479 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:03.780617 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:55:03.781280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:55:03.781838 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:55:03.782184 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:03.782294 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:55:03.786593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:55:03.787286 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m14:55:03.787498 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:03.787602 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m14:55:03.789954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:03.790383 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:55:03.790583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ce750>]}
[0m14:55:03.790793 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.04s]
[0m14:55:03.790977 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:55:03.791099 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m14:55:03.791276 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m14:55:03.791434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m14:55:03.791546 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m14:55:03.792610 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:03.792875 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m14:55:03.794295 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:03.794498 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:03.794608 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m14:55:03.794711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.803324 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m14:55:03.804463 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:03.804577 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m14:55:03.805087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:03.805949 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:03.806058 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m14:55:03.806647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:03.807310 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:55:03.807420 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:03.807517 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:55:03.808414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.809043 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m14:55:03.809250 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:03.809354 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m14:55:03.810961 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:03.811372 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m14:55:03.811555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b112c50>]}
[0m14:55:03.811762 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mSELECT 4[0m in 0.02s]
[0m14:55:03.811946 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m14:55:03.812065 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m14:55:03.812229 [info ] [Thread-1 (]: 4 of 9 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m14:55:03.812377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_users)
[0m14:55:03.812482 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m14:55:03.813771 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m14:55:03.814032 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m14:55:03.815428 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m14:55:03.815624 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:03.815732 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m14:55:03.815836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.826255 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.010 seconds
[0m14:55:03.830682 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:03.830823 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    create  index if not exists
  "2c41b8e4c09395c34d1b0871fffbd268"
  on "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" using btree
  (deal_user_id)
  
[0m14:55:03.832234 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m14:55:03.833330 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:03.833449 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users" rename to "stg_deal_users__dbt_backup"
[0m14:55:03.833902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:03.835021 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:03.835132 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" rename to "stg_deal_users"
[0m14:55:03.835564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:03.836031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:55:03.836141 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:03.836239 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:55:03.837356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.838031 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup"
[0m14:55:03.838243 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:03.838355 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup" cascade
[0m14:55:03.840325 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:03.840831 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m14:55:03.841040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5bedf0>]}
[0m14:55:03.841265 [info ] [Thread-1 (]: 4 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mSELECT 1787[0m in 0.03s]
[0m14:55:03.841455 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m14:55:03.841592 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:03.841798 [info ] [Thread-1 (]: 5 of 9 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m14:55:03.841978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m14:55:03.842106 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:03.843295 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:03.862565 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.862757 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:03.862862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.870861 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:55:03.875634 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.875779 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:03.883722 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m14:55:03.886282 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.886407 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:03.889881 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:55:03.902488 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.902692 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp145503901944"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:03.906874 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m14:55:03.907652 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.907760 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145503901944'
        
      order by ordinal_position

  
[0m14:55:03.910613 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m14:55:03.911621 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.911731 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:03.914395 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:55:03.915293 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.915405 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145503901944'
        
      order by ordinal_position

  
[0m14:55:03.917848 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:55:03.918940 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.919053 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:03.921493 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:03.923568 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.923681 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145503901944'
        
      order by ordinal_position

  
[0m14:55:03.925874 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:55:03.931053 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.931249 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:03.932165 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:55:03.933226 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.933336 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:03.933728 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:03.933896 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.934205 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.934334 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp145503901944" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp145503901944" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:03.935258 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:55:03.935702 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:55:03.935812 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:03.935908 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:55:03.937420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.938263 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m14:55:03.938452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5f2250>]}
[0m14:55:03.938730 [info ] [Thread-1 (]: 5 of 9 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.10s]
[0m14:55:03.938925 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:03.939054 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:03.939225 [info ] [Thread-1 (]: 6 of 9 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m14:55:03.939396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m14:55:03.939506 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:03.940516 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:03.941419 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.941531 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:03.941632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.948934 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:55:03.950202 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.950340 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:03.957907 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m14:55:03.959019 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.959139 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:03.961892 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m14:55:03.963450 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.963637 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp145503962883"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:03.966990 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:55:03.967990 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.968110 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145503962883'
        
      order by ordinal_position

  
[0m14:55:03.970419 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:03.971361 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.971479 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:03.973754 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:55:03.974673 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.974789 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145503962883'
        
      order by ordinal_position

  
[0m14:55:03.976802 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:03.977914 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.978039 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:03.980158 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:55:03.981137 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.981256 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145503962883'
        
      order by ordinal_position

  
[0m14:55:03.983166 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:03.983826 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.984006 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:03.984873 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:55:03.985171 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.985282 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:03.985690 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:03.985862 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.986154 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.986281 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp145503962883" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp145503962883" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:03.987243 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:55:03.987674 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m14:55:03.987787 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:03.987889 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m14:55:03.988699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.988994 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m14:55:03.989199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a1320>]}
[0m14:55:03.989492 [info ] [Thread-1 (]: 6 of 9 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m14:55:03.989695 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:03.989825 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:03.990009 [info ] [Thread-1 (]: 7 of 9 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m14:55:03.990185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m14:55:03.990302 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:03.991435 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:03.992395 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:03.992516 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:03.992629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.998868 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m14:55:04.000138 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.000284 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:04.006663 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m14:55:04.007919 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.008066 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:04.009342 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:55:04.010862 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.011066 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp145504010271"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:04.014506 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:55:04.015634 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.015771 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145504010271'
        
      order by ordinal_position

  
[0m14:55:04.017044 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:55:04.018050 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.018180 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:04.019474 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:55:04.020464 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.020586 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145504010271'
        
      order by ordinal_position

  
[0m14:55:04.021985 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:55:04.023181 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.023303 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:04.024946 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:55:04.026109 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.026251 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145504010271'
        
      order by ordinal_position

  
[0m14:55:04.027527 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:55:04.028299 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.028512 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:04.029060 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:04.029391 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.029516 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:04.029812 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:04.029990 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.030323 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.030459 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp145504010271" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp145504010271" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:04.030974 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m14:55:04.031445 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:55:04.031566 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:04.031675 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:55:04.032285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:55:04.032684 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m14:55:04.032917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d6d50>]}
[0m14:55:04.033242 [info ] [Thread-1 (]: 7 of 9 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.04s]
[0m14:55:04.033467 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:04.033616 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:04.033825 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:55:04.033990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:55:04.034116 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:04.036717 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:04.036973 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:04.038293 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:04.038527 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:04.038654 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m14:55:04.038782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:04.044100 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m14:55:04.045320 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:04.045448 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types" rename to "stg_deal_activity_types__dbt_backup"
[0m14:55:04.045808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:04.046913 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:04.047077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp" rename to "stg_deal_activity_types"
[0m14:55:04.047480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:04.048118 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:55:04.048246 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:04.048354 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:55:04.048780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:55:04.049497 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup"
[0m14:55:04.049719 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:04.049831 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup" cascade
[0m14:55:04.050452 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:55:04.050882 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:55:04.051083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b07c050>]}
[0m14:55:04.051314 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mSELECT 4[0m in 0.02s]
[0m14:55:04.051508 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:04.051639 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:55:04.051787 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m14:55:04.051946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_stages)
[0m14:55:04.052057 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m14:55:04.055122 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.055402 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m14:55:04.056642 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.056865 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.057008 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data


  );
  
  
[0m14:55:04.057131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:04.063803 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.007 seconds
[0m14:55:04.064654 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.064848 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "868fcaf996bb8dd1d4edf63d644a1d01"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_id)
  
[0m14:55:04.065510 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m14:55:04.066106 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.066228 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "c4571e027320ee197d62911b73a025b6"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_name)
  
[0m14:55:04.066673 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:55:04.067900 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.068016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m14:55:04.068351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:04.069211 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.069324 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m14:55:04.070184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:55:04.070647 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:55:04.070754 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.070853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:55:04.071781 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:04.072463 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m14:55:04.072839 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:04.072946 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m14:55:04.074936 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:04.075344 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m14:55:04.075527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5d332-f349-42f0-bddc-4069c40c2afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6546b0>]}
[0m14:55:04.075740 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.02s]
[0m14:55:04.075925 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:55:04.076385 [debug] [MainThread]: On master: COMMIT
[0m14:55:04.076494 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:04.076580 [debug] [MainThread]: On master: COMMIT
[0m14:55:04.076660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:04.082690 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m14:55:04.082828 [debug] [MainThread]: On master: Close
[0m14:55:04.082977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:04.083071 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m14:55:04.083206 [info ] [MainThread]: 
[0m14:55:04.083318 [info ] [MainThread]: Finished running 5 incremental models, 3 snapshots, 1 table model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m14:55:04.083871 [debug] [MainThread]: Command end result
[0m14:55:04.093022 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:55:04.093685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:55:04.096044 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:55:04.096159 [info ] [MainThread]: 
[0m14:55:04.096280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:04.096378 [info ] [MainThread]: 
[0m14:55:04.096484 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m14:55:04.097779 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.74883926, "process_in_blocks": "0", "process_kernel_time": 0.122828, "process_mem_max_rss": "145309696", "process_out_blocks": "0", "process_user_time": 0.921118}
[0m14:55:04.097966 [debug] [MainThread]: Command `dbt build` succeeded at 14:55:04.097928 after 0.75 seconds
[0m14:55:04.098099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d5010>]}
[0m14:55:04.098223 [debug] [MainThread]: Flushing usage events
[0m14:55:05.973915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:13.909076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75bb10>]}


============================== 14:55:13.910724 | 4ef27216-c164-4404-8d16-dbae23bf5c5c ==============================
[0m14:55:13.910724 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:55:13.910967 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'version_check': 'True', 'invocation_command': 'dbt build', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:55:13.964421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca429e0>]}
[0m14:55:13.983324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6be9c0>]}
[0m14:55:13.983622 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:55:14.013483 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:55:14.054698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:14.054853 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:55:14.054939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:14.070659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7b5950>]}
[0m14:55:14.099666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:55:14.100392 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:55:14.109458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7c59a0>]}
[0m14:55:14.109635 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m14:55:14.110542 [info ] [MainThread]: 
[0m14:55:14.110668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:14.110761 [info ] [MainThread]: 
[0m14:55:14.110932 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:14.112369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:55:14.130124 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:55:14.130297 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:55:14.130397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:14.148126 [debug] [ThreadPool]: SQL status: SELECT 111 in 0.018 seconds
[0m14:55:14.148708 [debug] [ThreadPool]: On list_postgres: Close
[0m14:55:14.149478 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:55:14.149612 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:55:14.149731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:14.158026 [debug] [ThreadPool]: SQL status: SELECT 111 in 0.008 seconds
[0m14:55:14.158471 [debug] [ThreadPool]: On list_postgres: Close
[0m14:55:14.159065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:55:14.161043 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:55:14.161168 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:55:14.161254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:14.171439 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m14:55:14.196107 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:55:14.196957 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:55:14.197211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:55:14.198039 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:55:14.198137 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:55:14.198221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:14.209250 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m14:55:14.209703 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:55:14.210074 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:55:14.211892 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:14.212019 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:55:14.212136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:14.222105 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:55:14.222516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea5ec10>]}
[0m14:55:14.222680 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:14.223013 [debug] [MainThread]: On master: COMMIT
[0m14:55:14.223103 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:14.223183 [debug] [MainThread]: On master: COMMIT
[0m14:55:14.223690 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:14.223778 [debug] [MainThread]: On master: Close
[0m14:55:14.224819 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m14:55:14.224998 [info ] [Thread-1 (]: 1 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m14:55:14.225154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m14:55:14.225274 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m14:55:14.228105 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:14.228377 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m14:55:14.247401 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:14.247602 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp145514238834"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m14:55:14.247840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.260035 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.012 seconds
[0m14:55:14.264896 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:14.265059 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp145514238834'
        
      order by ordinal_position

  
[0m14:55:14.271776 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m14:55:14.273697 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:14.273836 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.276696 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m14:55:14.279817 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:14.279962 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.282595 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:55:14.290818 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:14.291140 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:14.291270 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp145514238834" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m14:55:14.305596 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.014 seconds
[0m14:55:14.310541 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:55:14.310675 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:14.310776 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:55:14.313404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:55:14.314043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m14:55:14.314635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee71640>]}
[0m14:55:14.314863 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.09s]
[0m14:55:14.315066 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m14:55:14.315194 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:55:14.315392 [info ] [Thread-1 (]: 2 of 9 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m14:55:14.315568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m14:55:14.315687 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:55:14.316570 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:14.316785 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:55:14.321301 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:14.321521 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:14.321635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m14:55:14.321747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.336137 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.014 seconds
[0m14:55:14.339852 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:14.339995 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:55:14.340584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:14.341702 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:14.341816 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:55:14.342205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:14.343478 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:55:14.343606 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:14.343712 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:55:14.345391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:55:14.347601 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m14:55:14.349283 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:14.349396 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m14:55:14.351298 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:14.351762 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:55:14.351961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea13650>]}
[0m14:55:14.352180 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.04s]
[0m14:55:14.352377 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:55:14.352503 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m14:55:14.352690 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m14:55:14.352852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m14:55:14.352964 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m14:55:14.354151 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:14.354407 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m14:55:14.355627 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:14.355739 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp145514355067"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m14:55:14.355845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.363191 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m14:55:14.364710 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:14.364889 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp145514355067'
        
      order by ordinal_position

  
[0m14:55:14.368945 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m14:55:14.370066 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:14.370203 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.371643 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:55:14.372697 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:14.372813 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.373840 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:55:14.375988 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:14.376281 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:14.376397 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp145514355067" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m14:55:14.377018 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m14:55:14.377487 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:55:14.377597 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:14.377694 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:55:14.378139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:55:14.378438 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m14:55:14.378654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea571d0>]}
[0m14:55:14.378900 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m14:55:14.379258 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m14:55:14.379393 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m14:55:14.379583 [info ] [Thread-1 (]: 4 of 9 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m14:55:14.379729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_users)
[0m14:55:14.379840 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m14:55:14.381095 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m14:55:14.381335 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m14:55:14.382754 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:14.382871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp145514382004"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m14:55:14.382974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.391395 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.008 seconds
[0m14:55:14.392548 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:14.392692 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp145514382004'
        
      order by ordinal_position

  
[0m14:55:14.395414 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m14:55:14.396761 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:14.396922 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.398792 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:55:14.400148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:14.400268 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.401339 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m14:55:14.402104 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m14:55:14.402411 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:14.402526 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp145514382004" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m14:55:14.405135 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.002 seconds
[0m14:55:14.405685 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:55:14.405794 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:14.405885 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:55:14.406652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:14.406916 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m14:55:14.407120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3da90>]}
[0m14:55:14.407352 [info ] [Thread-1 (]: 4 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m14:55:14.407543 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m14:55:14.407675 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:14.407847 [info ] [Thread-1 (]: 5 of 9 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m14:55:14.407985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m14:55:14.408095 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:14.409136 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:14.429026 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.429277 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:14.429401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.435537 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m14:55:14.436658 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.436785 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.441611 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m14:55:14.443780 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.443896 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.445614 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:14.458501 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.458733 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp145514457899"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:14.462458 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m14:55:14.463512 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.463638 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145514457899'
        
      order by ordinal_position

  
[0m14:55:14.465367 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:55:14.466365 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.466489 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.469125 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:55:14.470142 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.470257 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145514457899'
        
      order by ordinal_position

  
[0m14:55:14.472420 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:55:14.473255 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.473362 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.475432 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:14.477508 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.477626 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145514457899'
        
      order by ordinal_position

  
[0m14:55:14.479675 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:55:14.484664 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.485067 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:14.486045 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:55:14.487079 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.487205 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:14.487599 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:14.487757 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.488067 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.488188 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp145514457899" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp145514457899" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:14.489229 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:55:14.489651 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:55:14.489755 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:14.489847 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:55:14.490735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:14.491538 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m14:55:14.491719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac3750>]}
[0m14:55:14.491984 [info ] [Thread-1 (]: 5 of 9 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.08s]
[0m14:55:14.492176 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:14.492305 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:14.492482 [info ] [Thread-1 (]: 6 of 9 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m14:55:14.492678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m14:55:14.492823 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:14.493697 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:14.494781 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.494899 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:14.495000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.502564 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:55:14.503446 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.503562 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.509903 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m14:55:14.510992 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.511111 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.512337 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m14:55:14.513946 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.514128 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp145514513142"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:14.515820 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:55:14.516798 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.516928 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145514513142'
        
      order by ordinal_position

  
[0m14:55:14.519048 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:14.520076 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.520205 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.521899 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:55:14.523060 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.523183 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145514513142'
        
      order by ordinal_position

  
[0m14:55:14.524154 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:55:14.525129 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.525248 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.527908 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m14:55:14.528847 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.528959 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145514513142'
        
      order by ordinal_position

  
[0m14:55:14.531021 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:14.531676 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.531846 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:14.532657 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:55:14.533183 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.533292 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:14.533697 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:14.533858 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.534133 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.534254 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp145514513142" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp145514513142" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:14.535107 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:55:14.535522 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m14:55:14.535630 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:14.535724 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m14:55:14.536523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:14.536813 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m14:55:14.536995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11400f0e0>]}
[0m14:55:14.537260 [info ] [Thread-1 (]: 6 of 9 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.04s]
[0m14:55:14.537450 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:14.537578 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:14.537773 [info ] [Thread-1 (]: 7 of 9 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m14:55:14.537973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m14:55:14.538099 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:14.539022 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:14.539929 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.540044 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:14.540149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.546936 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:55:14.548540 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.548692 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.555186 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m14:55:14.556463 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.556593 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.558472 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:14.560139 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.560342 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp145514559379"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:14.563328 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:55:14.564229 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.564353 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145514559379'
        
      order by ordinal_position

  
[0m14:55:14.565486 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:55:14.566522 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.566651 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.568391 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:14.569596 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.569729 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145514559379'
        
      order by ordinal_position

  
[0m14:55:14.571381 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:55:14.572347 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.572469 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:14.573895 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:55:14.574954 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.575078 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145514559379'
        
      order by ordinal_position

  
[0m14:55:14.576149 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:55:14.576873 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.577074 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:14.577596 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:14.577896 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.578009 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:14.578318 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:14.578515 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.578841 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.578974 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp145514559379" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp145514559379" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:14.580636 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m14:55:14.581099 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:55:14.581220 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:14.581325 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:55:14.582382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:14.582686 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m14:55:14.582879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee81250>]}
[0m14:55:14.583160 [info ] [Thread-1 (]: 7 of 9 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.04s]
[0m14:55:14.583351 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:14.583490 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:14.583659 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:55:14.583792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:55:14.583903 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:14.585046 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:14.585279 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:14.586550 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:14.586673 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp145514585955"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m14:55:14.586785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.591998 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m14:55:14.593439 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:14.593578 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp145514585955'
        
      order by ordinal_position

  
[0m14:55:14.596448 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m14:55:14.597560 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:14.597694 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.599352 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:55:14.600573 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:14.600703 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.603070 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m14:55:14.603778 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:14.604062 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:14.604184 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp145514585955" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m14:55:14.605250 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m14:55:14.605704 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:55:14.605815 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:14.605914 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:55:14.606742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:14.606981 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:55:14.607179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0cb050>]}
[0m14:55:14.607400 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m14:55:14.607592 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:14.607721 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:55:14.607881 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m14:55:14.608008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_stages)
[0m14:55:14.608115 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m14:55:14.611000 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:14.611240 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m14:55:14.612767 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:14.612895 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp145514612091"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m14:55:14.613010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.621455 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:55:14.622604 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:14.622737 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp145514612091'
        
      order by ordinal_position

  
[0m14:55:14.629025 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m14:55:14.630192 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:14.630341 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.631840 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m14:55:14.633198 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:14.633337 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m14:55:14.635048 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:55:14.635838 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:14.636161 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:14.636293 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp145514612091" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m14:55:14.636784 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dbt_internal_source.id does not exist
LINE 19:                     DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DE...
                             ^

[0m14:55:14.636909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: ROLLBACK
[0m14:55:14.637243 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m14:55:14.639684 [debug] [Thread-1 (]: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column dbt_internal_source.id does not exist
  LINE 19:                     DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DE...
                               ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m14:55:14.639887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef27216-c164-4404-8d16-dbae23bf5c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9c02f0>]}
[0m14:55:14.640134 [error] [Thread-1 (]: 9 of 9 ERROR creating sql incremental model public_pipedrive_staging.stg_deal_stages  [[31mERROR[0m in 0.03s]
[0m14:55:14.640338 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:55:14.640531 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'error'.  Reason: Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column dbt_internal_source.id does not exist
  LINE 19:                     DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DE...
                               ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql.
[0m14:55:14.641148 [debug] [MainThread]: On master: COMMIT
[0m14:55:14.641270 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:14.641367 [debug] [MainThread]: On master: COMMIT
[0m14:55:14.641458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:14.646100 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m14:55:14.646242 [debug] [MainThread]: On master: Close
[0m14:55:14.646390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:14.646483 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m14:55:14.646619 [info ] [MainThread]: 
[0m14:55:14.646729 [info ] [MainThread]: Finished running 5 incremental models, 3 snapshots, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m14:55:14.647293 [debug] [MainThread]: Command end result
[0m14:55:14.656670 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:55:14.657340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:55:14.659821 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:55:14.659947 [info ] [MainThread]: 
[0m14:55:14.660074 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:55:14.660171 [info ] [MainThread]: 
[0m14:55:14.660294 [error] [MainThread]: [31mFailure in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)[0m
[0m14:55:14.660409 [error] [MainThread]:   Database Error in model stg_deal_stages (models/staging/pipedrive/stg_deal_stages.sql)
  column dbt_internal_source.id does not exist
  LINE 19:                     DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DE...
                               ^
  compiled code at target/run/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m14:55:14.660498 [info ] [MainThread]: 
[0m14:55:14.660599 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/pipedrive/stg_deal_stages.sql
[0m14:55:14.660686 [info ] [MainThread]: 
[0m14:55:14.660787 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=9
[0m14:55:14.661930 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.77657, "process_in_blocks": "0", "process_kernel_time": 0.109485, "process_mem_max_rss": "145735680", "process_out_blocks": "0", "process_user_time": 0.932581}
[0m14:55:14.662082 [debug] [MainThread]: Command `dbt build` failed at 14:55:14.662050 after 0.78 seconds
[0m14:55:14.662206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1079b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114053950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140539b0>]}
[0m14:55:14.662320 [debug] [MainThread]: Flushing usage events
[0m14:55:16.503660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:31.146546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109efb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109efbb10>]}


============================== 14:55:31.148230 | 36afd9e3-7ce9-41f6-80ce-a65fa9b86acc ==============================
[0m14:55:31.148230 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:55:31.148462 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt build --full-refresh', 'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m14:55:31.202939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e29e0>]}
[0m14:55:31.221937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5e9c0>]}
[0m14:55:31.222239 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:55:31.252206 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:55:31.295450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:31.295713 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m14:55:31.379783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af56250>]}
[0m14:55:31.432223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:55:31.432999 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:55:31.442085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f659a0>]}
[0m14:55:31.442264 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m14:55:31.443194 [info ] [MainThread]: 
[0m14:55:31.443319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:31.443410 [info ] [MainThread]: 
[0m14:55:31.443576 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:31.445029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:55:31.464228 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:55:31.464397 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:55:31.464490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:31.483833 [debug] [ThreadPool]: SQL status: SELECT 125 in 0.019 seconds
[0m14:55:31.484451 [debug] [ThreadPool]: On list_postgres: Close
[0m14:55:31.485199 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:55:31.485330 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:55:31.485450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:31.493405 [debug] [ThreadPool]: SQL status: SELECT 125 in 0.008 seconds
[0m14:55:31.493887 [debug] [ThreadPool]: On list_postgres: Close
[0m14:55:31.494427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m14:55:31.496572 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m14:55:31.496688 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m14:55:31.496775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:31.506372 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m14:55:31.506815 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m14:55:31.507163 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m14:55:31.507329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m14:55:31.508127 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m14:55:31.508230 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m14:55:31.508318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:31.517591 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m14:55:31.518003 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m14:55:31.518357 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m14:55:31.520290 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.520427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:55:31.520538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:31.529556 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:55:31.529965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b045fd0>]}
[0m14:55:31.530117 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:31.530509 [debug] [MainThread]: On master: COMMIT
[0m14:55:31.530601 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.530679 [debug] [MainThread]: On master: COMMIT
[0m14:55:31.531265 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:55:31.531357 [debug] [MainThread]: On master: Close
[0m14:55:31.532124 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m14:55:31.532294 [info ] [Thread-1 (]: 1 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m14:55:31.532438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m14:55:31.532549 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m14:55:31.535337 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:31.535627 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m14:55:31.555054 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:31.555381 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:31.555498 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m14:55:31.555606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.569586 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.014 seconds
[0m14:55:31.572903 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:31.573022 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities" rename to "stg_deal_activities__dbt_backup"
[0m14:55:31.573592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.574498 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:31.574608 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp" rename to "stg_deal_activities"
[0m14:55:31.575116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.580522 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:55:31.580642 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:31.580741 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m14:55:31.582458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:55:31.584477 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup"
[0m14:55:31.585997 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m14:55:31.586110 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup" cascade
[0m14:55:31.587951 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:31.588757 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m14:55:31.589381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b724ae0>]}
[0m14:55:31.589658 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mSELECT 4579[0m in 0.06s]
[0m14:55:31.589874 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m14:55:31.590035 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:55:31.590240 [info ] [Thread-1 (]: 2 of 9 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m14:55:31.590408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m14:55:31.590522 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:55:31.591405 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:31.591625 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:55:31.597384 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:31.597633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:31.597742 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m14:55:31.597839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.614817 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.017 seconds
[0m14:55:31.616121 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:31.616249 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:55:31.616850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.617756 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:31.617870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:55:31.618305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.618834 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:55:31.618947 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:31.619046 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:55:31.621974 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:55:31.622965 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m14:55:31.623175 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:55:31.623275 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m14:55:31.624697 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:55:31.625094 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:55:31.625278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a7f50>]}
[0m14:55:31.625482 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.03s]
[0m14:55:31.625673 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:55:31.625807 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m14:55:31.625997 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m14:55:31.626169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m14:55:31.626281 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m14:55:31.627290 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:31.627572 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m14:55:31.628895 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:31.629115 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:31.629229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m14:55:31.629338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.636704 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m14:55:31.638027 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:31.638145 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m14:55:31.638671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.639510 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:31.639607 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m14:55:31.640020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.640635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:55:31.640735 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:31.640822 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m14:55:31.641805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:31.642392 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m14:55:31.642580 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m14:55:31.642675 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m14:55:31.644435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:31.644784 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m14:55:31.644948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2fb5f0>]}
[0m14:55:31.645133 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mSELECT 4[0m in 0.02s]
[0m14:55:31.645304 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m14:55:31.645410 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m14:55:31.645559 [info ] [Thread-1 (]: 4 of 9 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m14:55:31.645723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_users)
[0m14:55:31.645886 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m14:55:31.647087 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m14:55:31.647381 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m14:55:31.648998 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m14:55:31.649221 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:31.649335 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m14:55:31.649446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.660554 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.011 seconds
[0m14:55:31.664876 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:31.665019 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    create  index if not exists
  "2b9c641b8a09420793ec78fba15a8e9e"
  on "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" using btree
  (deal_user_id)
  
[0m14:55:31.666827 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m14:55:31.667783 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:31.667882 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users" rename to "stg_deal_users__dbt_backup"
[0m14:55:31.668418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.669372 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:31.669473 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" rename to "stg_deal_users"
[0m14:55:31.669912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.670324 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:55:31.670420 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:31.670505 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m14:55:31.671954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:31.672559 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup"
[0m14:55:31.672744 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m14:55:31.672840 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup" cascade
[0m14:55:31.675018 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:55:31.675362 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m14:55:31.675525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b32d3b0>]}
[0m14:55:31.675712 [info ] [Thread-1 (]: 4 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mSELECT 1787[0m in 0.03s]
[0m14:55:31.675900 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m14:55:31.676012 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:31.676169 [info ] [Thread-1 (]: 5 of 9 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m14:55:31.676314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m14:55:31.676415 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:31.677189 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:31.694668 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.694836 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:31.694945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.702709 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:55:31.707318 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.707448 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.715324 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m14:55:31.717780 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.717895 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.720663 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m14:55:31.733180 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.733382 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp145531732637"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:31.737739 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m14:55:31.738537 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.738648 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145531732637'
        
      order by ordinal_position

  
[0m14:55:31.741385 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m14:55:31.742399 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.742504 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.744830 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:31.745708 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.745855 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145531732637'
        
      order by ordinal_position

  
[0m14:55:31.747899 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:55:31.748842 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.748957 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.751275 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:31.753508 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.753628 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp145531732637'
        
      order by ordinal_position

  
[0m14:55:31.755725 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m14:55:31.760881 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.761067 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:31.762048 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:55:31.763160 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.763274 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:31.763707 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:31.763896 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.764292 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.764428 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp145531732637" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp145531732637" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:31.765233 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:55:31.765700 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:55:31.765814 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m14:55:31.765914 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m14:55:31.766990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:31.767945 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m14:55:31.768137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b78a650>]}
[0m14:55:31.768416 [info ] [Thread-1 (]: 5 of 9 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.09s]
[0m14:55:31.768614 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m14:55:31.768744 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:31.768930 [info ] [Thread-1 (]: 6 of 9 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m14:55:31.769123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m14:55:31.769269 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:31.770332 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:31.771272 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.771387 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:31.771493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.779842 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:55:31.780974 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.781102 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.788078 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m14:55:31.790202 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.790328 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.793465 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m14:55:31.794896 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.795069 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp145531794350"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:31.797338 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m14:55:31.798154 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.798268 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145531794350'
        
      order by ordinal_position

  
[0m14:55:31.800585 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:31.801644 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.801755 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.803977 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:55:31.804825 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.804948 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145531794350'
        
      order by ordinal_position

  
[0m14:55:31.807343 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:31.808344 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.808461 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.810711 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m14:55:31.811626 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.811738 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp145531794350'
        
      order by ordinal_position

  
[0m14:55:31.813648 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m14:55:31.814275 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.814438 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:31.815322 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:55:31.815606 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.815711 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:31.816065 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:31.816226 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.816515 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.816637 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp145531794350" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp145531794350" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:31.817598 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:55:31.818009 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m14:55:31.818114 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m14:55:31.818208 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m14:55:31.819038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:31.819317 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m14:55:31.819496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71df60>]}
[0m14:55:31.819763 [info ] [Thread-1 (]: 6 of 9 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m14:55:31.819949 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m14:55:31.820072 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:31.820238 [info ] [Thread-1 (]: 7 of 9 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m14:55:31.820419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m14:55:31.820570 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:31.821505 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:31.822676 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.822793 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:31.822896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.829670 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m14:55:31.830765 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.830898 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.837581 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m14:55:31.838946 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.839073 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.840600 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:55:31.842034 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.842232 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp145531841486"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:55:31.846693 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m14:55:31.847505 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.847626 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145531841486'
        
      order by ordinal_position

  
[0m14:55:31.849165 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:55:31.850469 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.850612 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.851773 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:55:31.852796 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.852924 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145531841486'
        
      order by ordinal_position

  
[0m14:55:31.854016 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:55:31.855055 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.855181 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m14:55:31.856758 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m14:55:31.858019 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.858142 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp145531841486'
        
      order by ordinal_position

  
[0m14:55:31.859480 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m14:55:31.860199 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.860400 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:31.860917 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:31.861225 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.861338 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:55:31.861647 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m14:55:31.861815 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.862129 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.862257 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp145531841486" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp145531841486" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:55:31.862779 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m14:55:31.863225 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:55:31.863338 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m14:55:31.863442 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m14:55:31.863868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:55:31.864161 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m14:55:31.864358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b795910>]}
[0m14:55:31.864651 [info ] [Thread-1 (]: 7 of 9 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.04s]
[0m14:55:31.864855 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m14:55:31.864989 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:31.865163 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m14:55:31.865304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m14:55:31.865420 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:31.866585 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:31.866828 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:31.868316 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:31.868531 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:31.868650 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m14:55:31.868763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.873732 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m14:55:31.874785 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:31.874904 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types" rename to "stg_deal_activity_types__dbt_backup"
[0m14:55:31.875205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.876271 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:31.876386 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp" rename to "stg_deal_activity_types"
[0m14:55:31.876681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.877159 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:55:31.877273 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:31.877377 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m14:55:31.877924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:55:31.878606 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup"
[0m14:55:31.878827 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m14:55:31.878940 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup" cascade
[0m14:55:31.879554 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:55:31.880051 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m14:55:31.880252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b58d7f0>]}
[0m14:55:31.880488 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mSELECT 4[0m in 0.01s]
[0m14:55:31.880823 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m14:55:31.881057 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m14:55:31.881256 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m14:55:31.881404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_stages)
[0m14:55:31.881524 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m14:55:31.883132 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.883427 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m14:55:31.884894 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.885112 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.885226 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data


  );
  
  
[0m14:55:31.885338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.894281 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.009 seconds
[0m14:55:31.894860 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.894974 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "94fbb33e3cd8e09aa57f1c839b057901"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_id)
  
[0m14:55:31.895608 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m14:55:31.896148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.896260 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "97ce132ca8a2bc909bf54ec80e0a4e47"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_name)
  
[0m14:55:31.896731 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:55:31.897851 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.897980 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m14:55:31.898384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.899535 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.899656 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m14:55:31.899986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:31.900470 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:55:31.900583 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.900681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m14:55:31.901143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:55:31.901815 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m14:55:31.902027 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m14:55:31.902132 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m14:55:31.902790 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:55:31.903185 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m14:55:31.903382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36afd9e3-7ce9-41f6-80ce-a65fa9b86acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b58ccb0>]}
[0m14:55:31.903603 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.02s]
[0m14:55:31.903784 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m14:55:31.904309 [debug] [MainThread]: On master: COMMIT
[0m14:55:31.904411 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.904495 [debug] [MainThread]: On master: COMMIT
[0m14:55:31.904574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:31.910566 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m14:55:31.910698 [debug] [MainThread]: On master: Close
[0m14:55:31.910847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:31.910943 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m14:55:31.911080 [info ] [MainThread]: 
[0m14:55:31.911195 [info ] [MainThread]: Finished running 5 incremental models, 3 snapshots, 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m14:55:31.911762 [debug] [MainThread]: Command end result
[0m14:55:31.922059 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m14:55:31.922810 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:55:31.925267 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m14:55:31.925390 [info ] [MainThread]: 
[0m14:55:31.925523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:31.925623 [info ] [MainThread]: 
[0m14:55:31.925728 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m14:55:31.926916 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8047979, "process_in_blocks": "0", "process_kernel_time": 0.124357, "process_mem_max_rss": "147341312", "process_out_blocks": "0", "process_user_time": 0.981606}
[0m14:55:31.927070 [debug] [MainThread]: Command `dbt build` succeeded at 14:55:31.927037 after 0.80 seconds
[0m14:55:31.927191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b58e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b58f2f0>]}
[0m14:55:31.927304 [debug] [MainThread]: Flushing usage events
[0m14:55:33.629288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:49.732948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88fb10>]}


============================== 15:04:49.735448 | 67f246ff-a4a5-4487-82eb-3730f7f77fa9 ==============================
[0m15:04:49.735448 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:04:49.735679 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment'}
[0m15:04:49.813921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb769e0>]}
[0m15:04:49.833071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7f29c0>]}
[0m15:04:49.833511 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:04:49.868580 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:04:49.922629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:49.922930 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:04:50.044815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e73f750>]}
[0m15:04:50.074106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:04:50.075134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:04:50.090252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a503b60>]}
[0m15:04:50.090432 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:04:50.091337 [info ] [MainThread]: 
[0m15:04:50.091477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:50.091570 [info ] [MainThread]: 
[0m15:04:50.091735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:04:50.093141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:04:50.115534 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:04:50.115701 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:04:50.115796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:50.148392 [debug] [ThreadPool]: SQL status: SELECT 131 in 0.033 seconds
[0m15:04:50.149147 [debug] [ThreadPool]: On list_postgres: Close
[0m15:04:50.149960 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:04:50.150077 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:04:50.150156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:50.158651 [debug] [ThreadPool]: SQL status: SELECT 131 in 0.008 seconds
[0m15:04:50.159147 [debug] [ThreadPool]: On list_postgres: Close
[0m15:04:50.159708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m15:04:50.161817 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:04:50.161940 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:04:50.162032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:50.172143 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m15:04:50.172616 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:04:50.173000 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:04:50.173171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m15:04:50.173946 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:04:50.174047 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:04:50.174133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:50.184194 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m15:04:50.184620 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:04:50.185090 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:04:50.188330 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:50.188469 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:04:50.188582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:50.199374 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m15:04:50.199778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d871fd0>]}
[0m15:04:50.199934 [debug] [MainThread]: On master: ROLLBACK
[0m15:04:50.200255 [debug] [MainThread]: On master: COMMIT
[0m15:04:50.200348 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:50.200434 [debug] [MainThread]: On master: COMMIT
[0m15:04:50.200923 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:50.201010 [debug] [MainThread]: On master: Close
[0m15:04:50.202069 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m15:04:50.202247 [info ] [Thread-1 (]: 1 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m15:04:50.202395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m15:04:50.202506 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m15:04:50.205312 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m15:04:50.205687 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m15:04:50.225707 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:04:50.225881 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp150450217111"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m15:04:50.225992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.238189 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.012 seconds
[0m15:04:50.243092 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:04:50.243269 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp150450217111'
        
      order by ordinal_position

  
[0m15:04:50.250275 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m15:04:50.252055 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:04:50.252185 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.255152 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:04:50.258146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:04:50.258263 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.260666 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:04:50.269656 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m15:04:50.269948 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:04:50.270082 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp150450217111" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m15:04:50.279870 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.010 seconds
[0m15:04:50.284758 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m15:04:50.284878 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:04:50.284977 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m15:04:50.289603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:04:50.290210 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m15:04:50.291235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef08390>]}
[0m15:04:50.291479 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.09s]
[0m15:04:50.291678 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m15:04:50.291804 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m15:04:50.291981 [info ] [Thread-1 (]: 2 of 9 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m15:04:50.292131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m15:04:50.292239 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m15:04:50.293071 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m15:04:50.293273 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m15:04:50.297595 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m15:04:50.297809 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:04:50.297925 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m15:04:50.298059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.310703 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.013 seconds
[0m15:04:50.314105 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:04:50.314229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m15:04:50.314615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:04:50.315655 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:04:50.315762 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m15:04:50.316526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:50.317570 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m15:04:50.317680 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:04:50.317778 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m15:04:50.321807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:04:50.323753 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m15:04:50.325369 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:04:50.325483 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m15:04:50.326353 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:04:50.326801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m15:04:50.326997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8cbe90>]}
[0m15:04:50.327214 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.03s]
[0m15:04:50.327399 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m15:04:50.327525 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m15:04:50.327724 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m15:04:50.327902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m15:04:50.328019 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m15:04:50.329231 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m15:04:50.329710 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m15:04:50.330917 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:04:50.331038 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp150450330361"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m15:04:50.331146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.339334 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m15:04:50.340630 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:04:50.340769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp150450330361'
        
      order by ordinal_position

  
[0m15:04:50.343986 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m15:04:50.345020 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:04:50.345141 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.346327 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:04:50.347393 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:04:50.347518 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.348601 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:04:50.350701 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m15:04:50.350999 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:04:50.351120 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp150450330361" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m15:04:50.352771 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.002 seconds
[0m15:04:50.353484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m15:04:50.353602 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:04:50.353696 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m15:04:50.354653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:04:50.354893 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m15:04:50.355069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab7b70>]}
[0m15:04:50.355273 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m15:04:50.355454 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m15:04:50.355574 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m15:04:50.355736 [info ] [Thread-1 (]: 4 of 9 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m15:04:50.355866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_users)
[0m15:04:50.355970 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m15:04:50.357065 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m15:04:50.357262 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m15:04:50.358417 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:04:50.358529 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp150450357889"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m15:04:50.358633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.367302 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.009 seconds
[0m15:04:50.368593 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:04:50.368727 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp150450357889'
        
      order by ordinal_position

  
[0m15:04:50.375171 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m15:04:50.376137 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:04:50.376259 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.377619 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:04:50.378834 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:04:50.378959 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.380044 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:04:50.380791 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m15:04:50.381074 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:04:50.381196 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp150450357889" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m15:04:50.386534 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.005 seconds
[0m15:04:50.387036 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m15:04:50.387155 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:04:50.387260 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m15:04:50.388323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:04:50.388565 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m15:04:50.388753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efb09b0>]}
[0m15:04:50.388970 [info ] [Thread-1 (]: 4 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m15:04:50.389155 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m15:04:50.389288 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:04:50.389461 [info ] [Thread-1 (]: 5 of 9 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:04:50.389593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:04:50.389707 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:04:50.390717 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:04:50.410806 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.410985 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:04:50.411097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.417313 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m15:04:50.418371 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.418498 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.424060 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m15:04:50.427554 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.427713 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.428990 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:04:50.441991 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.442199 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp150450441438"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:04:50.443661 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:04:50.444638 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.444759 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp150450441438'
        
      order by ordinal_position

  
[0m15:04:50.447766 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m15:04:50.448689 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.448803 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.451206 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:04:50.452081 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.452192 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp150450441438'
        
      order by ordinal_position

  
[0m15:04:50.454266 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:04:50.455308 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.455420 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.457466 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:04:50.459545 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.459657 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp150450441438'
        
      order by ordinal_position

  
[0m15:04:50.461400 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:04:50.466520 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.466713 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:04:50.467643 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:04:50.468859 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.468973 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:04:50.469380 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:04:50.469546 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.469846 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.469966 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp150450441438" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp150450441438" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:04:50.470831 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:04:50.471260 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:04:50.471368 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:04:50.471464 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:04:50.472498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:04:50.473358 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:04:50.473548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede3dd0>]}
[0m15:04:50.473827 [info ] [Thread-1 (]: 5 of 9 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.08s]
[0m15:04:50.474016 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:04:50.474142 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:04:50.474314 [info ] [Thread-1 (]: 6 of 9 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:04:50.474498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:04:50.474642 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:04:50.475487 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:04:50.476396 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.476524 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:04:50.476634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.483416 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:04:50.484634 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.484766 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.491242 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m15:04:50.492255 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.492368 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.494423 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:04:50.496009 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.496178 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp150450495249"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:04:50.499045 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m15:04:50.499791 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.499903 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp150450495249'
        
      order by ordinal_position

  
[0m15:04:50.502031 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:04:50.502911 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.503026 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.504891 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:04:50.505956 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.506072 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp150450495249'
        
      order by ordinal_position

  
[0m15:04:50.507848 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:04:50.508723 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.508840 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.510637 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:04:50.511557 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.511671 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp150450495249'
        
      order by ordinal_position

  
[0m15:04:50.513476 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:04:50.514130 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.514311 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:04:50.515121 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:04:50.515654 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.515767 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:04:50.516150 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:04:50.516323 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.516625 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.516757 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp150450495249" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp150450495249" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:04:50.517606 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:04:50.518019 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:04:50.518126 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:04:50.518228 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:04:50.519073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:04:50.519370 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:04:50.519568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efc40c0>]}
[0m15:04:50.519856 [info ] [Thread-1 (]: 6 of 9 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:04:50.520048 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:04:50.520177 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:04:50.520347 [info ] [Thread-1 (]: 7 of 9 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:04:50.520530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:04:50.520674 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:04:50.521593 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:04:50.522560 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.522686 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:04:50.522797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.529262 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m15:04:50.530415 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.530543 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.536713 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m15:04:50.537806 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.537933 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.540668 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:04:50.542271 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.542481 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp150450541540"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:04:50.545683 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m15:04:50.546738 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.546885 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp150450541540'
        
      order by ordinal_position

  
[0m15:04:50.548783 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:04:50.549909 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.550053 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.551466 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:04:50.552676 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.552802 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp150450541540'
        
      order by ordinal_position

  
[0m15:04:50.554230 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:04:50.555308 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.555448 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:04:50.556874 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:04:50.557919 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.558042 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp150450541540'
        
      order by ordinal_position

  
[0m15:04:50.560204 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:04:50.561034 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.561252 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:04:50.561842 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:04:50.562159 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.562278 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:04:50.562587 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:04:50.562758 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.563083 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.563239 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp150450541540" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp150450541540" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:04:50.563799 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m15:04:50.564572 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:04:50.564698 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:04:50.564807 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:04:50.565421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:04:50.565769 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:04:50.565985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eef2a50>]}
[0m15:04:50.566293 [info ] [Thread-1 (]: 7 of 9 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:04:50.566496 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:04:50.566636 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m15:04:50.566813 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m15:04:50.566954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m15:04:50.567070 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m15:04:50.568272 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:04:50.568660 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m15:04:50.569960 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:04:50.570087 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp150450569363"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m15:04:50.570200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.577662 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m15:04:50.580011 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:04:50.580165 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp150450569363'
        
      order by ordinal_position

  
[0m15:04:50.586221 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m15:04:50.587304 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:04:50.587440 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.589522 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m15:04:50.590790 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:04:50.590923 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.592271 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:04:50.593110 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:04:50.593443 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:04:50.593579 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp150450569363" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m15:04:50.594129 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m15:04:50.594643 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m15:04:50.594764 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:04:50.594873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m15:04:50.595334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:04:50.595594 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m15:04:50.595791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e76a690>]}
[0m15:04:50.596022 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.03s]
[0m15:04:50.596216 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m15:04:50.596349 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m15:04:50.596520 [info ] [Thread-1 (]: 9 of 9 START sql incremental model public_pipedrive_staging.stg_deal_stages .... [RUN]
[0m15:04:50.596662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_stages)
[0m15:04:50.596776 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m15:04:50.599716 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m15:04:50.599962 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m15:04:50.601442 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:04:50.601578 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp150450600646"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m15:04:50.601698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.607993 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m15:04:50.609030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:04:50.609154 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp150450600646'
        
      order by ordinal_position

  
[0m15:04:50.611866 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m15:04:50.613059 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:04:50.613200 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.614721 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m15:04:50.615977 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:04:50.616101 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:04:50.617113 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m15:04:50.617830 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m15:04:50.618123 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:04:50.618243 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp150450600646" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m15:04:50.618624 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m15:04:50.619103 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m15:04:50.619226 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:04:50.619331 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m15:04:50.619897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:04:50.620140 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m15:04:50.620342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f246ff-a4a5-4487-82eb-3730f7f77fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114002810>]}
[0m15:04:50.620571 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.02s]
[0m15:04:50.620765 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m15:04:50.621272 [debug] [MainThread]: On master: COMMIT
[0m15:04:50.621391 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:50.621487 [debug] [MainThread]: On master: COMMIT
[0m15:04:50.621576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:50.626139 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m15:04:50.626368 [debug] [MainThread]: On master: Close
[0m15:04:50.626527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:50.626626 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m15:04:50.626772 [info ] [MainThread]: 
[0m15:04:50.626892 [info ] [MainThread]: Finished running 5 incremental models, 3 snapshots, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m15:04:50.627483 [debug] [MainThread]: Command end result
[0m15:04:50.637120 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:04:50.637808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:04:50.640088 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:04:50.640191 [info ] [MainThread]: 
[0m15:04:50.640310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:50.640397 [info ] [MainThread]: 
[0m15:04:50.640501 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m15:04:50.642384 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.93657947, "process_in_blocks": "0", "process_kernel_time": 0.162186, "process_mem_max_rss": "148471808", "process_out_blocks": "0", "process_user_time": 1.014098}
[0m15:04:50.642571 [debug] [MainThread]: Command `dbt build` succeeded at 15:04:50.642534 after 0.94 seconds
[0m15:04:50.642703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7d7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e95e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e92d130>]}
[0m15:04:50.642826 [debug] [MainThread]: Flushing usage events
[0m15:04:53.909146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:45.849736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae697f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be23890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be23b10>]}


============================== 15:06:45.852292 | 873a9216-c590-4978-98c8-1d28920d95a5 ==============================
[0m15:06:45.852292 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:06:45.852536 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'invocation_command': 'dbt build', 'cache_selected_only': 'False', 'quiet': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'no_print': 'None'}
[0m15:06:45.931341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b10a9e0>]}
[0m15:06:45.950099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd869c0>]}
[0m15:06:45.950530 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:06:45.984876 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:06:46.045964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:46.046152 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:06:46.046243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:46.062874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce7d950>]}
[0m15:06:46.093234 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:06:46.094527 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:06:46.110200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be8d9a0>]}
[0m15:06:46.110391 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:06:46.111371 [info ] [MainThread]: 
[0m15:06:46.111506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:46.111599 [info ] [MainThread]: 
[0m15:06:46.111781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:46.113213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:06:46.137896 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:06:46.138069 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:06:46.138163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:46.172380 [debug] [ThreadPool]: SQL status: SELECT 138 in 0.034 seconds
[0m15:06:46.173042 [debug] [ThreadPool]: On list_postgres: Close
[0m15:06:46.173847 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:06:46.173971 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:06:46.174053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.181784 [debug] [ThreadPool]: SQL status: SELECT 138 in 0.008 seconds
[0m15:06:46.182343 [debug] [ThreadPool]: On list_postgres: Close
[0m15:06:46.182592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_snapshots)
[0m15:06:46.182747 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_snapshots"
"
[0m15:06:46.209175 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_snapshots"
[0m15:06:46.209341 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_snapshots"} */
create schema if not exists "pipedrive_snapshots"
[0m15:06:46.209426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.219678 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.010 seconds
[0m15:06:46.220112 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: COMMIT
[0m15:06:46.220270 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_snapshots"
[0m15:06:46.220375 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: COMMIT
[0m15:06:46.222139 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:06:46.222254 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: Close
[0m15:06:46.222852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_snapshots, now list_postgres_pipedrive_snapshots)
[0m15:06:46.224781 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:06:46.224894 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:06:46.224985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.236919 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m15:06:46.237409 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:06:46.237843 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:06:46.238014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m15:06:46.238610 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:06:46.238713 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:06:46.238804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.248183 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m15:06:46.248641 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:06:46.248994 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:06:46.250989 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:46.251126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:06:46.251239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:46.260933 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:06:46.261342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf5cc90>]}
[0m15:06:46.261513 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:46.261829 [debug] [MainThread]: On master: COMMIT
[0m15:06:46.261916 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:46.261994 [debug] [MainThread]: On master: COMMIT
[0m15:06:46.262452 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:06:46.262547 [debug] [MainThread]: On master: Close
[0m15:06:46.263649 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m15:06:46.263815 [info ] [Thread-1 (]: 1 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m15:06:46.263964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m15:06:46.264074 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m15:06:46.266917 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m15:06:46.267410 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m15:06:46.287111 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:06:46.287294 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp150646278309"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m15:06:46.287403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.300061 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m15:06:46.304754 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:06:46.304899 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp150646278309'
        
      order by ordinal_position

  
[0m15:06:46.313057 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m15:06:46.314711 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:06:46.314820 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:06:46.317414 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:06:46.320569 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:06:46.320692 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:06:46.322934 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:06:46.331724 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m15:06:46.331996 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:06:46.332115 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp150646278309" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m15:06:46.341088 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.009 seconds
[0m15:06:46.346009 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m15:06:46.346135 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:06:46.346235 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m15:06:46.349351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:06:46.349974 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m15:06:46.350825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d569b20>]}
[0m15:06:46.351076 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.09s]
[0m15:06:46.351284 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m15:06:46.351416 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m15:06:46.351591 [info ] [Thread-1 (]: 2 of 9 START sql table model public_pipedrive_staging.stg_deal_changes ......... [RUN]
[0m15:06:46.351735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m15:06:46.351844 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m15:06:46.352881 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m15:06:46.353096 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m15:06:46.357367 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m15:06:46.357613 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:06:46.357736 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m15:06:46.357848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.372851 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.015 seconds
[0m15:06:46.376626 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:06:46.376761 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m15:06:46.377147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:46.378042 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:06:46.378158 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m15:06:46.378630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:46.379931 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m15:06:46.380063 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:06:46.380170 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m15:06:46.381831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:06:46.384121 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m15:06:46.385755 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:06:46.385874 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m15:06:46.386611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:06:46.387073 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m15:06:46.387277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0d8c50>]}
[0m15:06:46.387498 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public_pipedrive_staging.stg_deal_changes .... [[32mSELECT 15406[0m in 0.04s]
[0m15:06:46.387687 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m15:06:46.387813 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m15:06:46.388009 [info ] [Thread-1 (]: 3 of 9 START sql incremental model public_pipedrive_staging.stg_deal_fields .... [RUN]
[0m15:06:46.388173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_fields)
[0m15:06:46.388291 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m15:06:46.389321 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m15:06:46.389805 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m15:06:46.391110 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:06:46.391236 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp150646390543"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."public"."fields"
  );
  
  
[0m15:06:46.391346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.397193 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m15:06:46.398537 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:06:46.398671 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp150646390543'
        
      order by ordinal_position

  
[0m15:06:46.402232 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m15:06:46.403239 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:06:46.403358 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:06:46.405181 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m15:06:46.406400 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:06:46.406523 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:06:46.407507 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:06:46.409447 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m15:06:46.409754 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:06:46.409878 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp150646390543" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m15:06:46.410412 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m15:06:46.410855 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m15:06:46.410967 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:06:46.411063 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m15:06:46.411661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:06:46.412091 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m15:06:46.412314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11f490>]}
[0m15:06:46.412544 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.02s]
[0m15:06:46.412727 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m15:06:46.412851 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m15:06:46.413011 [info ] [Thread-1 (]: 4 of 9 START sql incremental model public_pipedrive_staging.stg_deal_users ..... [RUN]
[0m15:06:46.413141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_users)
[0m15:06:46.413248 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m15:06:46.414461 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m15:06:46.414932 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m15:06:46.416351 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:06:46.416468 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp150646415783"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m15:06:46.416570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.422180 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.006 seconds
[0m15:06:46.423325 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:06:46.423457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp150646415783'
        
      order by ordinal_position

  
[0m15:06:46.426356 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m15:06:46.427581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:06:46.427712 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:06:46.428949 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:06:46.430263 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:06:46.430428 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:06:46.431548 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:06:46.432330 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m15:06:46.432630 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:06:46.432745 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp150646415783" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m15:06:46.436915 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m15:06:46.437360 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m15:06:46.437467 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:06:46.437562 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m15:06:46.438486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:06:46.438722 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m15:06:46.438928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d633390>]}
[0m15:06:46.439156 [info ] [Thread-1 (]: 4 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m15:06:46.439360 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m15:06:46.439500 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:06:46.439699 [info ] [Thread-1 (]: 5 of 9 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:06:46.439872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:06:46.439997 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:06:46.441050 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:06:46.464818 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:06:46.465002 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."activity_types"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:06:46.465118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.475357 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m15:06:46.476593 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:06:46.476702 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:06:46.477149 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:06:46.477306 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:06:46.477746 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:06:46.477882 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."activity_types"
    ) sbq



  );
  
  
[0m15:06:46.479703 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m15:06:46.480262 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:06:46.480371 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:06:46.480466 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:06:46.481399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:06:46.481634 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:06:46.481813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4427d0>]}
[0m15:06:46.482078 [info ] [Thread-1 (]: 5 of 9 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mSELECT 4[0m in 0.04s]
[0m15:06:46.482270 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:06:46.482397 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:06:46.482570 [info ] [Thread-1 (]: 6 of 9 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:06:46.482754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:06:46.482896 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:06:46.483727 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:06:46.484863 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:06:46.484978 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:06:46.485080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.493174 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:06:46.493480 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:06:46.493591 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:06:46.493997 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:06:46.494162 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:06:46.494443 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:06:46.494561 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



  );
  
  
[0m15:06:46.495561 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m15:06:46.498781 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: ROLLBACK
[0m15:06:46.499296 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:06:46.504399 [debug] [Thread-1 (]: Compilation Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
[0m15:06:46.504588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afdbe00>]}
[0m15:06:46.504894 [error] [Thread-1 (]: 6 of 9 ERROR snapshotting pipedrive_snapshots.deal_stages_snapshot ............. [[31mERROR[0m in 0.02s]
[0m15:06:46.505106 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:06:46.505235 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:06:46.505395 [debug] [Thread-4 (]: Marking all children of 'snapshot.enpal_assessment_project.deal_stages_snapshot' to be skipped because of status 'error'.  Reason: Compilation Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml).
[0m15:06:46.505539 [info ] [Thread-1 (]: 7 of 9 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:06:46.505855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:06:46.505969 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:06:46.506860 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:06:46.508083 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:06:46.508211 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."users"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:06:46.508328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.515784 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:06:46.516143 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:06:46.516247 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:06:46.516578 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:06:46.516723 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:06:46.516985 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:06:46.517085 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_users_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."users"
    ) sbq



  );
  
  
[0m15:06:46.522555 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.005 seconds
[0m15:06:46.523247 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: ROLLBACK
[0m15:06:46.523662 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:06:46.525613 [debug] [Thread-1 (]: Compilation Error in snapshot deal_users_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_users_snapshot (snapshots/pipedrive_snapshots.yaml)
[0m15:06:46.525769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b00b1d0>]}
[0m15:06:46.526044 [error] [Thread-1 (]: 7 of 9 ERROR snapshotting pipedrive_snapshots.deal_users_snapshot .............. [[31mERROR[0m in 0.02s]
[0m15:06:46.526235 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:06:46.526362 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m15:06:46.526516 [debug] [Thread-4 (]: Marking all children of 'snapshot.enpal_assessment_project.deal_users_snapshot' to be skipped because of status 'error'.  Reason: Compilation Error in snapshot deal_users_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_users_snapshot (snapshots/pipedrive_snapshots.yaml).
[0m15:06:46.526660 [info ] [Thread-1 (]: 8 of 9 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m15:06:46.526862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m15:06:46.526984 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m15:06:46.528101 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:06:46.528587 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m15:06:46.529994 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:06:46.530106 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp150646529248"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m15:06:46.530205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.535228 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m15:06:46.536168 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:06:46.536276 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp150646529248'
        
      order by ordinal_position

  
[0m15:06:46.538845 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m15:06:46.539829 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:06:46.539955 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:06:46.541249 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:06:46.542357 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:06:46.542465 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m15:06:46.543727 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m15:06:46.544415 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:06:46.544684 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:06:46.544818 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp150646529248" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m15:06:46.545249 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m15:06:46.545675 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m15:06:46.545775 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:06:46.545868 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m15:06:46.546489 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:06:46.546862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m15:06:46.547092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873a9216-c590-4978-98c8-1d28920d95a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d54aed0>]}
[0m15:06:46.547327 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m15:06:46.547516 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m15:06:46.547652 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m15:06:46.547800 [info ] [Thread-1 (]: 9 of 9 SKIP relation public_pipedrive_staging.stg_deal_stages .................. [[33mSKIP[0m]
[0m15:06:46.547924 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m15:06:46.548038 [debug] [Thread-4 (]: Marking all children of 'model.enpal_assessment_project.stg_deal_stages' to be skipped because of status 'skipped'. 
[0m15:06:46.548518 [debug] [MainThread]: On master: COMMIT
[0m15:06:46.548622 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:46.548707 [debug] [MainThread]: On master: COMMIT
[0m15:06:46.548785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:46.552888 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:06:46.553004 [debug] [MainThread]: On master: Close
[0m15:06:46.553160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:46.553283 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_activity_types' was properly closed.
[0m15:06:46.553434 [info ] [MainThread]: 
[0m15:06:46.553550 [info ] [MainThread]: Finished running 5 incremental models, 3 snapshots, 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m15:06:46.554087 [debug] [MainThread]: Command end result
[0m15:06:46.562854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:06:46.563682 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:06:46.565935 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:06:46.566035 [info ] [MainThread]: 
[0m15:06:46.566154 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:06:46.566259 [info ] [MainThread]: 
[0m15:06:46.566379 [error] [MainThread]: [31mFailure in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)[0m
[0m15:06:46.566499 [error] [MainThread]:   Compilation Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
[0m15:06:46.566592 [info ] [MainThread]: 
[0m15:06:46.566702 [error] [MainThread]: [31mFailure in snapshot deal_users_snapshot (snapshots/pipedrive_snapshots.yaml)[0m
[0m15:06:46.566818 [error] [MainThread]:   Compilation Error in snapshot deal_users_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_users_snapshot (snapshots/pipedrive_snapshots.yaml)
[0m15:06:46.566910 [info ] [MainThread]: 
[0m15:06:46.567010 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=9
[0m15:06:46.568898 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7485077, "process_in_blocks": "0", "process_kernel_time": 0.155686, "process_mem_max_rss": "145293312", "process_out_blocks": "0", "process_user_time": 0.875811}
[0m15:06:46.569050 [debug] [MainThread]: Command `dbt build` failed at 15:06:46.569021 after 0.75 seconds
[0m15:06:46.569173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b00b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc9eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d53b950>]}
[0m15:06:46.569294 [debug] [MainThread]: Flushing usage events
[0m15:06:48.418400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:13.754231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b017f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab7b10>]}


============================== 15:14:13.756745 | 3eb1fa1c-aad0-498b-850b-435a4e411729 ==============================
[0m15:14:13.756745 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:14:13.756978 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'partial_parse': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs'}
[0m15:14:13.835473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da29e0>]}
[0m15:14:13.854314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a1e9c0>]}
[0m15:14:13.854787 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:14:13.889393 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:14:13.943405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:13.943704 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:14:14.042468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab17550>]}
[0m15:14:14.094878 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:14:14.095965 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:14:14.105731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab694f0>]}
[0m15:14:14.105916 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:14:14.106040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a91d9b0>]}
[0m15:14:14.106748 [info ] [MainThread]: 
[0m15:14:14.106873 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:14.106966 [info ] [MainThread]: 
[0m15:14:14.107134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:14.108411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:14:14.131413 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:14:14.131584 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:14:14.131680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:14.166981 [debug] [ThreadPool]: SQL status: SELECT 139 in 0.035 seconds
[0m15:14:14.167604 [debug] [ThreadPool]: On list_postgres: Close
[0m15:14:14.168212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m15:14:14.170221 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:14:14.170340 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:14:14.170435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:14.181812 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m15:14:14.182275 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:14:14.182650 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:14:14.182815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m15:14:14.183928 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:14:14.184044 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:14:14.184135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:14.195255 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m15:14:14.195632 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:14:14.195949 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:14:14.197574 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:14.197730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:14:14.197861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:14.207571 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:14:14.207997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b025090>]}
[0m15:14:14.208164 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:14.208562 [debug] [MainThread]: On master: COMMIT
[0m15:14:14.208657 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:14.208741 [debug] [MainThread]: On master: COMMIT
[0m15:14:14.209217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:14:14.209309 [debug] [MainThread]: On master: Close
[0m15:14:14.210332 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:14:14.210504 [info ] [Thread-1 (]: 1 of 3 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:14:14.210650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:14:14.210761 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:14:14.213623 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:14:14.233637 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.233826 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:14:14.233935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:14.243213 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:14:14.247645 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.247777 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:14.255570 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m15:14:14.258394 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.258530 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:14.261197 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:14:14.278756 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.278958 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp151414276017"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:14:14.283643 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:14:14.284558 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.284672 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151414276017'
        
      order by ordinal_position

  
[0m15:14:14.287022 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:14:14.287886 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.287993 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:14.290292 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:14:14.291207 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.291318 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151414276017'
        
      order by ordinal_position

  
[0m15:14:14.293249 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:14:14.295616 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.295734 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:14.297874 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:14:14.300042 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.300168 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151414276017'
        
      order by ordinal_position

  
[0m15:14:14.302212 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:14:14.307437 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.307630 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:14.308586 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:14:14.309670 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.309789 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:14.310251 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:14:14.311275 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.311730 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.311854 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp151414276017" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp151414276017" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:14:14.312847 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:14:14.317784 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:14:14.317901 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:14.317996 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:14:14.319998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:14:14.321122 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:14:14.321902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeba810>]}
[0m15:14:14.322214 [info ] [Thread-1 (]: 1 of 3 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.11s]
[0m15:14:14.322431 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:14:14.322571 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:14:14.322775 [info ] [Thread-1 (]: 2 of 3 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:14:14.322951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:14:14.323068 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:14:14.323900 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:14:14.326412 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:14.326543 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:14.326656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:14.334548 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:14:14.334912 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:14.335023 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:14.335537 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:14:14.335725 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:14.336015 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:14.336123 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



  );
  
  
[0m15:14:14.339297 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m15:14:14.343741 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: ROLLBACK
[0m15:14:14.344682 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:14:14.349709 [debug] [Thread-1 (]: Compilation Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
[0m15:14:14.349889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b085440>]}
[0m15:14:14.350171 [error] [Thread-1 (]: 2 of 3 ERROR snapshotting pipedrive_snapshots.deal_stages_snapshot ............. [[31mERROR[0m in 0.03s]
[0m15:14:14.350385 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:14:14.350524 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:14:14.350700 [debug] [Thread-4 (]: Marking all children of 'snapshot.enpal_assessment_project.deal_stages_snapshot' to be skipped because of status 'error'.  Reason: Compilation Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml).
[0m15:14:14.350854 [info ] [Thread-1 (]: 3 of 3 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:14:14.351241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:14:14.351356 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:14:14.352205 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:14:14.353455 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:14.353576 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."users"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:14.353680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:14.361743 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:14:14.362068 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:14.362171 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:14.362604 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:14:14.362756 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:14.363022 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:14.363125 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_users_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."users"
    ) sbq



  );
  
  
[0m15:14:14.371231 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.008 seconds
[0m15:14:14.373119 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:14.373242 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

    create  index if not exists
  "871a0d3e9766fa5dc36893158661790a"
  on "postgres"."pipedrive_snapshots"."deal_users_snapshot" using btree
  (id, dbt_valid_from, dbt_valid_to)
  
[0m15:14:14.375786 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m15:14:14.376190 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:14:14.376317 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:14.376419 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:14:14.378068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:14:14.378342 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:14:14.378522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3eb1fa1c-aad0-498b-850b-435a4e411729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b240f50>]}
[0m15:14:14.378779 [info ] [Thread-1 (]: 3 of 3 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mSELECT 1787[0m in 0.03s]
[0m15:14:14.378961 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:14:14.379404 [debug] [MainThread]: On master: COMMIT
[0m15:14:14.379499 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:14.379581 [debug] [MainThread]: On master: COMMIT
[0m15:14:14.379655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:14.387322 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m15:14:14.387449 [debug] [MainThread]: On master: Close
[0m15:14:14.387581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:14.387665 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:14:14.387761 [info ] [MainThread]: 
[0m15:14:14.387863 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m15:14:14.388171 [debug] [MainThread]: Command end result
[0m15:14:14.397294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:14:14.397955 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:14:14.400162 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:14:14.400274 [info ] [MainThread]: 
[0m15:14:14.400402 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:14:14.400502 [info ] [MainThread]: 
[0m15:14:14.400627 [error] [MainThread]: [31mFailure in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)[0m
[0m15:14:14.400745 [error] [MainThread]:   Compilation Error in snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
  Could not parse index config: at path []: Additional properties are not allowed ('where' was unexpected)
  
  > in macro postgres__get_create_index_sql (macros/adapters.sql)
  > called by macro get_create_index_sql (macros/adapters/indexes.sql)
  > called by macro default__create_indexes (macros/adapters/indexes.sql)
  > called by macro create_indexes (macros/adapters/indexes.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot deal_stages_snapshot (snapshots/pipedrive_snapshots.yaml)
[0m15:14:14.400844 [info ] [MainThread]: 
[0m15:14:14.400943 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m15:14:14.402686 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.6768834, "process_in_blocks": "0", "process_kernel_time": 0.15204, "process_mem_max_rss": "146178048", "process_out_blocks": "0", "process_user_time": 0.879331}
[0m15:14:14.402829 [debug] [MainThread]: Command `dbt snapshot` failed at 15:14:14.402799 after 0.68 seconds
[0m15:14:14.402960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad701d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0be1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae2d60>]}
[0m15:14:14.403081 [debug] [MainThread]: Flushing usage events
[0m15:14:15.904275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:29.152940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7217f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d7b10>]}


============================== 15:14:29.155269 | b69018d5-0e46-4c84-bab7-a94f7ded3048 ==============================
[0m15:14:29.155269 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:14:29.155497 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'invocation_command': 'dbt snapshot', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'debug': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_colors': 'True', 'empty': 'False'}
[0m15:14:29.221017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c29e0>]}
[0m15:14:29.239979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b63e9c0>]}
[0m15:14:29.240473 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:14:29.274652 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:14:29.322059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:29.322331 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:14:29.414816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c737550>]}
[0m15:14:29.465858 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:14:29.466819 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:14:29.476152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7894f0>]}
[0m15:14:29.476379 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:14:29.476509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5399b0>]}
[0m15:14:29.477275 [info ] [MainThread]: 
[0m15:14:29.477397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:29.477486 [info ] [MainThread]: 
[0m15:14:29.477657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:29.478980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:14:29.498171 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:14:29.498337 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:14:29.498425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:29.522250 [debug] [ThreadPool]: SQL status: SELECT 141 in 0.024 seconds
[0m15:14:29.522869 [debug] [ThreadPool]: On list_postgres: Close
[0m15:14:29.523446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m15:14:29.525363 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:14:29.525466 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:14:29.525554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:29.536538 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m15:14:29.537055 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:14:29.537522 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:14:29.537700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m15:14:29.538812 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:14:29.538925 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:14:29.539020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:29.548510 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m15:14:29.548891 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:14:29.549245 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:14:29.550796 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:29.550919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:14:29.551029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:29.559733 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:14:29.560079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc44e20>]}
[0m15:14:29.560230 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:29.560606 [debug] [MainThread]: On master: COMMIT
[0m15:14:29.560695 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:29.560775 [debug] [MainThread]: On master: COMMIT
[0m15:14:29.561309 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:14:29.561397 [debug] [MainThread]: On master: Close
[0m15:14:29.562339 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:14:29.562508 [info ] [Thread-1 (]: 1 of 3 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:14:29.562654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:14:29.562764 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:14:29.565581 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:14:29.587254 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.587473 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:14:29.587584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:29.597049 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:14:29.601785 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.601924 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:29.610713 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.009 seconds
[0m15:14:29.613521 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.613658 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:29.616635 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:14:29.634956 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.635212 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp151429632218"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:14:29.639978 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m15:14:29.641049 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.641163 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151429632218'
        
      order by ordinal_position

  
[0m15:14:29.644867 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m15:14:29.645796 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.645906 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:29.649059 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:14:29.649900 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.650002 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151429632218'
        
      order by ordinal_position

  
[0m15:14:29.652333 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:14:29.654655 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.654767 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:29.657533 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:14:29.659642 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.659784 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151429632218'
        
      order by ordinal_position

  
[0m15:14:29.662122 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:14:29.667067 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.667252 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:29.668255 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:14:29.669267 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.669375 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:29.669844 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:14:29.670012 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.670310 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.670429 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp151429632218" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp151429632218" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:14:29.671681 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:14:29.676551 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:14:29.676663 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:14:29.676755 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:14:29.679044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:14:29.680199 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:14:29.680991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e2810>]}
[0m15:14:29.681252 [info ] [Thread-1 (]: 1 of 3 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.12s]
[0m15:14:29.681448 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:14:29.681568 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:14:29.681753 [info ] [Thread-1 (]: 2 of 3 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:14:29.681935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:14:29.682049 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:14:29.682858 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:14:29.685315 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:29.685435 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:29.685540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:29.693273 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:14:29.693675 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:29.693787 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:29.694272 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:14:29.694428 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:29.694685 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:29.694790 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



  );
  
  
[0m15:14:29.697547 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m15:14:29.702415 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:29.702572 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

    create  index if not exists
  "cbf4c2086aa8359d26b71f0718c4ffa7"
  on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" using btree
  (stage_id, dbt_valid_from, dbt_valid_to)
  
[0m15:14:29.704884 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m15:14:29.705293 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:14:29.705419 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:14:29.705532 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:14:29.706688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:14:29.706958 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:14:29.707145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccfd4f0>]}
[0m15:14:29.707450 [info ] [Thread-1 (]: 2 of 3 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mSELECT 9[0m in 0.03s]
[0m15:14:29.707674 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:14:29.707805 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:14:29.707976 [info ] [Thread-1 (]: 3 of 3 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:14:29.708129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:14:29.708230 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:14:29.709041 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:14:29.710083 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.710186 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:14:29.710277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:29.717786 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:14:29.718842 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.718971 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:29.726601 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m15:14:29.727994 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.728116 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:29.730740 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:14:29.732114 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.732292 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp151429731578"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:14:29.740066 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:14:29.740851 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.740967 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151429731578'
        
      order by ordinal_position

  
[0m15:14:29.742874 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:14:29.743995 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.744116 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:29.745949 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:14:29.746975 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.747145 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151429731578'
        
      order by ordinal_position

  
[0m15:14:29.748870 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:14:29.749853 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.750022 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:14:29.751670 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:14:29.752882 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.753047 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151429731578'
        
      order by ordinal_position

  
[0m15:14:29.755468 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:14:29.756200 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.756679 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:29.757901 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:14:29.758234 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.758390 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:14:29.758806 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:14:29.759003 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.759308 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.759527 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp151429731578" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp151429731578" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:14:29.760840 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:14:29.761297 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:14:29.761434 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:14:29.761562 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:14:29.762465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:14:29.762794 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:14:29.762996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69018d5-0e46-4c84-bab7-a94f7ded3048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce25130>]}
[0m15:14:29.763339 [info ] [Thread-1 (]: 3 of 3 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:14:29.763561 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:14:29.764037 [debug] [MainThread]: On master: COMMIT
[0m15:14:29.764157 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:29.764248 [debug] [MainThread]: On master: COMMIT
[0m15:14:29.764335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:29.770826 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m15:14:29.770950 [debug] [MainThread]: On master: Close
[0m15:14:29.771087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:29.771181 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:14:29.771287 [info ] [MainThread]: 
[0m15:14:29.771394 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:14:29.771703 [debug] [MainThread]: Command end result
[0m15:14:29.781118 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:14:29.781833 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:14:29.784037 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:14:29.784136 [info ] [MainThread]: 
[0m15:14:29.784262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:29.784351 [info ] [MainThread]: 
[0m15:14:29.784455 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:14:29.786418 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6641502, "process_in_blocks": "0", "process_kernel_time": 0.112697, "process_mem_max_rss": "146079744", "process_out_blocks": "0", "process_user_time": 0.888374}
[0m15:14:29.786573 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:14:29.786542 after 0.66 seconds
[0m15:14:29.786692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c98ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccde1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b706d60>]}
[0m15:14:29.786807 [debug] [MainThread]: Flushing usage events
[0m15:14:31.075796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:41.126067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081397f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ef890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090efb10>]}


============================== 15:16:41.128656 | b8ee581f-28d7-483f-b905-0f9003c3a753 ==============================
[0m15:16:41.128656 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:16:41.128889 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'empty': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt snapshot', 'fail_fast': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m15:16:41.204323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ee581f-28d7-483f-b905-0f9003c3a753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083da9e0>]}
[0m15:16:41.223221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ee581f-28d7-483f-b905-0f9003c3a753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090569c0>]}
[0m15:16:41.223676 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:16:41.256748 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:16:41.308829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:41.309198 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:16:41.379721 [error] [MainThread]: Encountered an error:
Snapshots must be configured with a 'strategy' and 'unique_key'.
[0m15:16:41.381024 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config,
        ^^^^^^^^^^^^^^^
    ...<3 lines>...
        active_integrations,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 489, in load
    self.check_valid_snapshot_config()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 1457, in check_valid_snapshot_config
    node.config.final_validate()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/dbt_enpal_assessment/dbt_venv/lib/python3.13/site-packages/dbt/artifacts/resources/v1/snapshot.py", line 46, in final_validate
    raise ValidationError(
        "Snapshots must be configured with a 'strategy' and 'unique_key'."
    )
dbt_common.dataclass_schema.ValidationError: Snapshots must be configured with a 'strategy' and 'unique_key'.

[0m15:16:41.382933 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.28737342, "process_in_blocks": "0", "process_kernel_time": 0.127313, "process_mem_max_rss": "129662976", "process_out_blocks": "0", "process_user_time": 0.650185}
[0m15:16:41.383115 [debug] [MainThread]: Command `dbt snapshot` failed at 15:16:41.383074 after 0.29 seconds
[0m15:16:41.383254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a445b80>]}
[0m15:16:41.383378 [debug] [MainThread]: Flushing usage events
[0m15:16:42.819705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:02.299610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1fb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1fbb10>]}


============================== 15:17:02.301272 | aea298a1-bfb1-42da-8161-838ad7c56f7a ==============================
[0m15:17:02.301272 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:17:02.301514 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt snapshot', 'printer_width': '80', 'introspect': 'True'}
[0m15:17:02.356449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e69e0>]}
[0m15:17:02.375959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1629c0>]}
[0m15:17:02.376265 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:17:02.405883 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:17:02.447125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:02.447403 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:17:02.565582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e25b050>]}
[0m15:17:02.594722 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:17:02.595753 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:17:02.605105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b28a0>]}
[0m15:17:02.605262 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:17:02.605378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da2e270>]}
[0m15:17:02.606084 [info ] [MainThread]: 
[0m15:17:02.606199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:02.606284 [info ] [MainThread]: 
[0m15:17:02.606439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:17:02.607718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:17:02.629967 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:17:02.630116 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:17:02.630201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:02.663443 [debug] [ThreadPool]: SQL status: SELECT 141 in 0.033 seconds
[0m15:17:02.664056 [debug] [ThreadPool]: On list_postgres: Close
[0m15:17:02.664652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m15:17:02.666609 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:17:02.666714 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:17:02.666804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:02.677705 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m15:17:02.678173 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:17:02.678566 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:17:02.678725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m15:17:02.679742 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:17:02.679839 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:17:02.679925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:02.689360 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m15:17:02.689768 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:17:02.690139 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:17:02.691791 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:02.691924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:17:02.692042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:02.701257 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:17:02.701634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e781160>]}
[0m15:17:02.701782 [debug] [MainThread]: On master: ROLLBACK
[0m15:17:02.702176 [debug] [MainThread]: On master: COMMIT
[0m15:17:02.702266 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:02.702342 [debug] [MainThread]: On master: COMMIT
[0m15:17:02.702935 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:17:02.703022 [debug] [MainThread]: On master: Close
[0m15:17:02.704040 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:17:02.704242 [info ] [Thread-1 (]: 1 of 3 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:17:02.704410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:17:02.704528 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:17:02.707291 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:17:02.727458 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.727647 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:17:02.727760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:02.738145 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m15:17:02.742628 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.742758 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.750576 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m15:17:02.753429 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.753577 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.756482 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:17:02.774282 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.774502 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp151702771506"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:17:02.778795 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:17:02.779963 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.780090 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151702771506'
        
      order by ordinal_position

  
[0m15:17:02.782479 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:17:02.783442 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.783566 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.786383 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:17:02.787258 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.787360 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151702771506'
        
      order by ordinal_position

  
[0m15:17:02.789686 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:17:02.792372 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.792552 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.795090 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:02.797406 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.797539 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151702771506'
        
      order by ordinal_position

  
[0m15:17:02.800195 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m15:17:02.805203 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.805389 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:02.806588 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:17:02.807583 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.807691 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:02.808195 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:17:02.808615 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.808924 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.809092 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp151702771506" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp151702771506" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:17:02.810465 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:17:02.815385 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:17:02.815506 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:02.815602 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:17:02.817134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:17:02.818270 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:17:02.818985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5be450>]}
[0m15:17:02.819248 [info ] [Thread-1 (]: 1 of 3 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.11s]
[0m15:17:02.819451 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:17:02.819566 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:17:02.819722 [info ] [Thread-1 (]: 2 of 3 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:17:02.819863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:17:02.819962 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:17:02.820743 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:17:02.821817 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.821922 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:17:02.822019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:02.829389 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:17:02.830435 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.830579 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.838874 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m15:17:02.839887 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.839996 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.842881 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:17:02.844582 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.844766 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp151702843778"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:17:02.848578 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:17:02.849338 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.849452 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151702843778'
        
      order by ordinal_position

  
[0m15:17:02.852020 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:02.852895 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.853007 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.855891 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:17:02.856941 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.857055 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151702843778'
        
      order by ordinal_position

  
[0m15:17:02.859281 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:02.860191 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.860305 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.862832 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:17:02.863739 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.863848 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151702843778'
        
      order by ordinal_position

  
[0m15:17:02.865974 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:02.866803 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.866978 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:02.867667 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:17:02.867962 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.868068 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:02.868465 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:17:02.868640 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.868914 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.869037 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp151702843778" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp151702843778" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:17:02.870108 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:17:02.870529 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:17:02.870633 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:02.870726 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:17:02.871789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:17:02.872071 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:17:02.872255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f4f70>]}
[0m15:17:02.872525 [info ] [Thread-1 (]: 2 of 3 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:17:02.872713 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:17:02.872834 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:17:02.872997 [info ] [Thread-1 (]: 3 of 3 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:17:02.873129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:17:02.873235 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:17:02.874150 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:17:02.875038 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.875144 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:17:02.875242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:02.883224 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:17:02.884338 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.884453 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.891773 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m15:17:02.892876 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.892998 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.895353 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:02.896991 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.897176 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp151702896211"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:17:02.902442 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m15:17:02.903288 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.903406 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151702896211'
        
      order by ordinal_position

  
[0m15:17:02.905587 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:17:02.906686 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.906814 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.908471 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:02.909882 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.910023 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151702896211'
        
      order by ordinal_position

  
[0m15:17:02.911330 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:17:02.912390 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.912519 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:02.914188 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:02.915234 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.915355 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151702896211'
        
      order by ordinal_position

  
[0m15:17:02.916591 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:17:02.917351 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.917553 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:02.918134 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:17:02.918802 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.918937 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:02.919245 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:17:02.919426 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.919745 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.919878 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp151702896211" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp151702896211" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:17:02.920411 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m15:17:02.921252 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.921377 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m15:17:02.922203 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:17:02.922515 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:17:02.922636 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:02.922743 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:17:02.923697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:17:02.924029 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:17:02.924231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea298a1-bfb1-42da-8161-838ad7c56f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e967430>]}
[0m15:17:02.924536 [info ] [Thread-1 (]: 3 of 3 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:17:02.924737 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:17:02.925244 [debug] [MainThread]: On master: COMMIT
[0m15:17:02.925348 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:02.925438 [debug] [MainThread]: On master: COMMIT
[0m15:17:02.925525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:02.930628 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m15:17:02.930748 [debug] [MainThread]: On master: Close
[0m15:17:02.930887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:02.930979 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:17:02.931082 [info ] [MainThread]: 
[0m15:17:02.931189 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:17:02.931512 [debug] [MainThread]: Command end result
[0m15:17:02.942162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:17:02.943047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:17:02.945672 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:17:02.945801 [info ] [MainThread]: 
[0m15:17:02.945942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:02.946038 [info ] [MainThread]: 
[0m15:17:02.946142 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:17:02.948120 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6724812, "process_in_blocks": "0", "process_kernel_time": 0.113572, "process_mem_max_rss": "145965056", "process_out_blocks": "0", "process_user_time": 0.90079}
[0m15:17:02.948293 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:17:02.948258 after 0.67 seconds
[0m15:17:02.948446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4eaad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e35fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d226d60>]}
[0m15:17:02.948576 [debug] [MainThread]: Flushing usage events
[0m15:17:04.351516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:45.522153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac1d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbd3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbd3b10>]}


============================== 15:17:45.523834 | 83a7f430-56dd-4b11-8975-11f1ed7f91c4 ==============================
[0m15:17:45.523834 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:17:45.524067 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'target_path': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'cache_selected_only': 'False', 'version_check': 'True'}
[0m15:17:45.579217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebe9e0>]}
[0m15:17:45.598259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb3a9c0>]}
[0m15:17:45.598613 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:17:45.629982 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:17:45.671848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:45.672130 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:17:45.787706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc32d50>]}
[0m15:17:45.815830 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:17:45.816510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:17:45.821300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc83f20>]}
[0m15:17:45.821456 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:17:45.821571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4058d0>]}
[0m15:17:45.822274 [info ] [MainThread]: 
[0m15:17:45.822391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:45.822480 [info ] [MainThread]: 
[0m15:17:45.822639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:17:45.823919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:17:45.839502 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:17:45.839673 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:17:45.839767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:45.859948 [debug] [ThreadPool]: SQL status: SELECT 145 in 0.020 seconds
[0m15:17:45.860614 [debug] [ThreadPool]: On list_postgres: Close
[0m15:17:45.861224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m15:17:45.863239 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:17:45.863365 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:17:45.863456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:45.874226 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m15:17:45.874675 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:17:45.875047 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:17:45.875215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m15:17:45.876285 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:17:45.876397 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:17:45.876492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:45.886067 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m15:17:45.886506 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:17:45.886883 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:17:45.888649 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:45.888779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:17:45.888886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:45.897890 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:17:45.898266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d155230>]}
[0m15:17:45.898423 [debug] [MainThread]: On master: ROLLBACK
[0m15:17:45.898723 [debug] [MainThread]: On master: COMMIT
[0m15:17:45.898814 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:45.898894 [debug] [MainThread]: On master: COMMIT
[0m15:17:45.899361 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:17:45.899454 [debug] [MainThread]: On master: Close
[0m15:17:45.900176 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:17:45.900348 [info ] [Thread-1 (]: 1 of 3 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:17:45.900494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:17:45.900612 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:17:45.903451 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:17:45.923413 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.923613 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:17:45.923733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:45.932272 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:17:45.936613 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.936737 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:45.945376 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.009 seconds
[0m15:17:45.948146 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.948279 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:45.951308 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:17:45.968732 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.968940 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp151745966038"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:17:45.973311 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:17:45.974230 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.974343 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151745966038'
        
      order by ordinal_position

  
[0m15:17:45.976944 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:17:45.977824 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.977934 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:45.980705 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:17:45.981602 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.981717 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151745966038'
        
      order by ordinal_position

  
[0m15:17:45.983957 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:17:45.986511 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.986626 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:45.989023 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:45.991173 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.991294 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151745966038'
        
      order by ordinal_position

  
[0m15:17:45.993456 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:17:45.998655 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:45.998853 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:45.999790 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:17:46.000900 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:46.001019 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:46.001549 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:17:46.001778 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:46.002083 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:46.002214 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp151745966038" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp151745966038" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:17:46.003330 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:17:46.008425 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:17:46.008568 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:17:46.008714 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:17:46.010119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:17:46.011343 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:17:46.011927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce06450>]}
[0m15:17:46.012204 [info ] [Thread-1 (]: 1 of 3 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.11s]
[0m15:17:46.012404 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:17:46.012538 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:17:46.012734 [info ] [Thread-1 (]: 2 of 3 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:17:46.012910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:17:46.013035 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:17:46.013940 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:17:46.015013 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.015126 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:17:46.015225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:46.022667 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:17:46.023823 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.023949 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:46.031057 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m15:17:46.032169 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.032283 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:46.035553 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:17:46.037053 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.037217 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp151746036316"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:17:46.041497 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:17:46.042249 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.042363 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151746036316'
        
      order by ordinal_position

  
[0m15:17:46.045110 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:17:46.045963 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.046078 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:46.048651 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:17:46.049707 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.049828 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151746036316'
        
      order by ordinal_position

  
[0m15:17:46.051842 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:46.052686 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.052802 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:46.054960 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:17:46.055859 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.055971 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151746036316'
        
      order by ordinal_position

  
[0m15:17:46.057910 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:46.058726 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.058905 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:46.059737 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:17:46.060025 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.060134 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:46.060470 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:17:46.060629 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.060891 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.061014 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp151746036316" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp151746036316" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:17:46.061849 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:17:46.062266 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:17:46.062375 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:17:46.062474 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:17:46.063372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:17:46.063655 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:17:46.063839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d0f70>]}
[0m15:17:46.064110 [info ] [Thread-1 (]: 2 of 3 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:17:46.064298 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:17:46.064425 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:17:46.064590 [info ] [Thread-1 (]: 3 of 3 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:17:46.064722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:17:46.064832 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:17:46.065726 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:17:46.066615 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.066728 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:17:46.066833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:46.073684 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:17:46.074776 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.074892 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:46.078253 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:17:46.079574 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.079710 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:46.082040 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:17:46.083801 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.083999 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp151746082976"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:17:46.090229 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m15:17:46.091096 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.091218 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151746082976'
        
      order by ordinal_position

  
[0m15:17:46.092358 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:17:46.093502 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.093645 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:46.095084 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:17:46.096372 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.096509 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151746082976'
        
      order by ordinal_position

  
[0m15:17:46.097840 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:17:46.098773 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.098891 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:17:46.099924 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:17:46.101051 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.101193 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151746082976'
        
      order by ordinal_position

  
[0m15:17:46.102283 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:17:46.103006 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.103196 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:46.103696 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:17:46.104225 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.104340 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:17:46.104649 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:17:46.104827 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.105117 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.105244 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp151746082976" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp151746082976" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:17:46.105733 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m15:17:46.106514 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.106658 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m15:17:46.107008 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:17:46.107324 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:17:46.107446 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:17:46.107549 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:17:46.108144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:17:46.108440 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:17:46.108631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a7f430-56dd-4b11-8975-11f1ed7f91c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d37f430>]}
[0m15:17:46.108912 [info ] [Thread-1 (]: 3 of 3 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.04s]
[0m15:17:46.109099 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:17:46.109556 [debug] [MainThread]: On master: COMMIT
[0m15:17:46.109668 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:46.109755 [debug] [MainThread]: On master: COMMIT
[0m15:17:46.109836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:46.114278 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:17:46.114392 [debug] [MainThread]: On master: Close
[0m15:17:46.114524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:46.114611 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:17:46.114719 [info ] [MainThread]: 
[0m15:17:46.114857 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:17:46.115205 [debug] [MainThread]: Command end result
[0m15:17:46.124883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:17:46.125643 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:17:46.128180 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:17:46.128312 [info ] [MainThread]: 
[0m15:17:46.128450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:46.128544 [info ] [MainThread]: 
[0m15:17:46.128651 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:17:46.129830 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.63165945, "process_in_blocks": "0", "process_kernel_time": 0.103951, "process_mem_max_rss": "146014208", "process_out_blocks": "0", "process_user_time": 0.890299}
[0m15:17:46.129980 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:17:46.129949 after 0.63 seconds
[0m15:17:46.130101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3ffa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbfed60>]}
[0m15:17:46.130220 [debug] [MainThread]: Flushing usage events
[0m15:17:47.877315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:18.011571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088517f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109807890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109807b10>]}


============================== 15:18:18.013252 | 16d97d98-bb3a-4ea4-ab7b-c949e602cf41 ==============================
[0m15:18:18.013252 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:18:18.013490 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot --select tag:pipedrive', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False'}
[0m15:18:18.068334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af29e0>]}
[0m15:18:18.087294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976e9c0>]}
[0m15:18:18.087614 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:18:18.118936 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:18:18.162514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:18.162686 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:18:18.162773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:18.178794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a865950>]}
[0m15:18:18.207693 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:18:18.208438 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:18:18.213508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b9b80>]}
[0m15:18:18.213667 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:18:18.213784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ec210>]}
[0m15:18:18.214426 [info ] [MainThread]: 
[0m15:18:18.214539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:18.214623 [info ] [MainThread]: 
[0m15:18:18.214787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:18.216070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:18:18.234974 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:18:18.235148 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:18:18.235243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:18.256091 [debug] [ThreadPool]: SQL status: SELECT 147 in 0.021 seconds
[0m15:18:18.256733 [debug] [ThreadPool]: On list_postgres: Close
[0m15:18:18.257326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m15:18:18.259394 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:18:18.259525 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:18:18.259623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:18.270416 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m15:18:18.270876 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:18:18.271358 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:18:18.271553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m15:18:18.272322 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:18:18.272428 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:18:18.272521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:18.283795 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m15:18:18.284563 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:18:18.284926 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:18:18.287139 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:18.287313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:18:18.287436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:18.295718 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:18:18.296282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa664e0>]}
[0m15:18:18.296489 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:18.296760 [debug] [MainThread]: On master: COMMIT
[0m15:18:18.296914 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:18.297039 [debug] [MainThread]: On master: COMMIT
[0m15:18:18.297467 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:18:18.297570 [debug] [MainThread]: On master: Close
[0m15:18:18.298622 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:18:18.298863 [info ] [Thread-1 (]: 1 of 3 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:18:18.299045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:18:18.299195 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:18:18.302429 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:18:18.323961 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.324145 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:18:18.324256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:18.329665 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m15:18:18.360103 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.360308 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.363416 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:18:18.366114 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.366258 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.367568 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:18.385623 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.385836 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp151818382887"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:18:18.390081 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:18:18.390989 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.391106 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151818382887'
        
      order by ordinal_position

  
[0m15:18:18.393564 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:18:18.394444 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.394555 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.395852 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:18.396680 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.396785 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151818382887'
        
      order by ordinal_position

  
[0m15:18:18.398356 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:18:18.399326 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.399431 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.402108 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:18:18.404210 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.404331 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151818382887'
        
      order by ordinal_position

  
[0m15:18:18.406356 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:18:18.411496 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.411671 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:18.412615 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:18:18.413576 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.413676 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:18.414089 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:18.414261 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.414584 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.414693 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp151818382887" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp151818382887" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:18:18.415658 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:18:18.420526 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:18:18.420635 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:18.420723 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:18:18.421656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:18:18.422759 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:18:18.423297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc1850>]}
[0m15:18:18.423562 [info ] [Thread-1 (]: 1 of 3 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.12s]
[0m15:18:18.423771 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:18:18.423885 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:18:18.424078 [info ] [Thread-1 (]: 2 of 3 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:18:18.424273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:18:18.424396 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:18:18.425269 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:18:18.426341 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.426458 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:18:18.426560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:18.433722 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:18:18.434778 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.434906 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.442471 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m15:18:18.443632 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.443777 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.446302 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:18:18.447899 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.448068 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp151818447123"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:18:18.450032 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m15:18:18.450816 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.450935 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151818447123'
        
      order by ordinal_position

  
[0m15:18:18.452376 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:18.453262 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.453379 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.454724 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m15:18:18.455821 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.455935 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151818447123'
        
      order by ordinal_position

  
[0m15:18:18.457194 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:18.458031 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.458144 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.459198 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m15:18:18.460266 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.460394 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151818447123'
        
      order by ordinal_position

  
[0m15:18:18.461544 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:18.462522 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.462717 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:18.463235 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:18.463539 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.463651 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:18.463965 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:18.464125 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.464404 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.464526 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp151818447123" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp151818447123" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:18:18.464980 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m15:18:18.465400 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:18:18.465507 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:18.465608 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:18:18.466071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:18:18.466372 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:18:18.466565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae98100>]}
[0m15:18:18.466840 [info ] [Thread-1 (]: 2 of 3 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.04s]
[0m15:18:18.467037 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:18:18.467166 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:18:18.467357 [info ] [Thread-1 (]: 3 of 3 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:18:18.467509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:18:18.467622 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:18:18.468600 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:18:18.469529 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.469642 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:18:18.469745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:18.474455 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m15:18:18.475685 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.475859 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.480507 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m15:18:18.481743 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.481863 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.483708 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:18:18.485404 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.485598 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp151818484605"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:18:18.491233 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m15:18:18.492065 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.492185 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151818484605'
        
      order by ordinal_position

  
[0m15:18:18.493322 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:18:18.494343 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.494473 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.495785 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:18.496975 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.497098 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151818484605'
        
      order by ordinal_position

  
[0m15:18:18.498148 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:18:18.499063 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.499180 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:18.500246 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:18.501289 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.501418 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151818484605'
        
      order by ordinal_position

  
[0m15:18:18.502431 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:18:18.504096 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.504305 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:18.504834 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:18.505144 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.505259 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:18.505569 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:18.505776 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.506080 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.506212 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp151818484605" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp151818484605" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:18:18.506680 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m15:18:18.507435 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.507555 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m15:18:18.507883 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:18:18.508169 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:18:18.508284 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:18.508387 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:18:18.508807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:18:18.509108 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:18:18.509301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d97d98-bb3a-4ea4-ab7b-c949e602cf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed2170>]}
[0m15:18:18.509592 [info ] [Thread-1 (]: 3 of 3 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.04s]
[0m15:18:18.509788 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:18:18.510254 [debug] [MainThread]: On master: COMMIT
[0m15:18:18.510353 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:18.510439 [debug] [MainThread]: On master: COMMIT
[0m15:18:18.510521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:18.514735 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:18:18.514859 [debug] [MainThread]: On master: Close
[0m15:18:18.514998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:18.515106 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:18:18.515219 [info ] [MainThread]: 
[0m15:18:18.515331 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m15:18:18.515739 [debug] [MainThread]: Command end result
[0m15:18:18.524826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:18:18.525595 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:18:18.528247 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:18:18.528367 [info ] [MainThread]: 
[0m15:18:18.528504 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:18.528598 [info ] [MainThread]: 
[0m15:18:18.528701 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:18:18.530189 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5442001, "process_in_blocks": "0", "process_kernel_time": 0.126812, "process_mem_max_rss": "142671872", "process_out_blocks": "0", "process_user_time": 0.826248}
[0m15:18:18.530340 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:18:18.530308 after 0.54 seconds
[0m15:18:18.530459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abe8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107127450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109832d60>]}
[0m15:18:18.530573 [debug] [MainThread]: Flushing usage events
[0m15:18:20.771797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:49.100916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be8b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be8bb10>]}


============================== 15:18:49.102584 | 8c241715-eaa3-448c-952c-73735ee3b2bb ==============================
[0m15:18:49.102584 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:18:49.102834 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'log_format': 'default', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select tag:pipedrive', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False'}
[0m15:18:49.157167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1769e0>]}
[0m15:18:49.176377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdf29c0>]}
[0m15:18:49.176727 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:18:49.206152 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:18:49.249718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:49.250037 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:18:49.367427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceeb050>]}
[0m15:18:49.395672 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:18:49.397147 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:18:49.406362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf3ff20>]}
[0m15:18:49.406518 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:18:49.406633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6bd8d0>]}
[0m15:18:49.407287 [info ] [MainThread]: 
[0m15:18:49.407402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:49.407487 [info ] [MainThread]: 
[0m15:18:49.407643 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:49.408978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:18:49.430897 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:18:49.431058 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:18:49.431149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:49.453720 [debug] [ThreadPool]: SQL status: SELECT 151 in 0.023 seconds
[0m15:18:49.454356 [debug] [ThreadPool]: On list_postgres: Close
[0m15:18:49.454936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m15:18:49.457038 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:18:49.457186 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:18:49.457285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:49.467068 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m15:18:49.467525 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:18:49.467904 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:18:49.468072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m15:18:49.469032 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:18:49.469137 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:18:49.469223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:49.479082 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m15:18:49.479486 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:18:49.479835 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:18:49.481594 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:49.481728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:18:49.481840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:49.492698 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m15:18:49.493096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d415160>]}
[0m15:18:49.493247 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:49.493950 [debug] [MainThread]: On master: COMMIT
[0m15:18:49.494038 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:49.494115 [debug] [MainThread]: On master: COMMIT
[0m15:18:49.494690 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:18:49.494777 [debug] [MainThread]: On master: Close
[0m15:18:49.495745 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:18:49.495917 [info ] [Thread-1 (]: 1 of 3 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:18:49.496058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:18:49.496170 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:18:49.499003 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:18:49.518806 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.518989 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:18:49.519096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:49.528056 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:18:49.532500 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.532652 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.539531 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m15:18:49.542472 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.542608 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.544937 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:18:49.562168 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.562376 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp151849559565"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:18:49.566398 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:18:49.567316 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.567425 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151849559565'
        
      order by ordinal_position

  
[0m15:18:49.570122 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m15:18:49.570997 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.571112 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.573304 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:18:49.574189 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.574293 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151849559565'
        
      order by ordinal_position

  
[0m15:18:49.576204 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:18:49.578996 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.579138 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.581241 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:18:49.583473 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.583605 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp151849559565'
        
      order by ordinal_position

  
[0m15:18:49.585682 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:18:49.590630 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.590826 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:49.591826 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:18:49.592882 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.592991 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:49.593391 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:49.593566 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.593880 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.593996 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp151849559565" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp151849559565" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:18:49.594846 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:18:49.599906 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:18:49.600042 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:18:49.600147 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:18:49.601240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:18:49.602409 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:18:49.603143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b2450>]}
[0m15:18:49.603419 [info ] [Thread-1 (]: 1 of 3 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.11s]
[0m15:18:49.603625 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:18:49.603760 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:18:49.603931 [info ] [Thread-1 (]: 2 of 3 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:18:49.604070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:18:49.604186 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:18:49.605005 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:18:49.606036 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.606159 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:18:49.606269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:49.613739 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:18:49.614847 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.614988 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.623397 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m15:18:49.624425 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.624538 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.627512 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:18:49.629217 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.629409 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp151849628414"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:18:49.633218 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:18:49.634003 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.634121 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151849628414'
        
      order by ordinal_position

  
[0m15:18:49.637199 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:18:49.638110 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.638222 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.641023 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:18:49.642152 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.642292 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151849628414'
        
      order by ordinal_position

  
[0m15:18:49.644515 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:18:49.645494 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.645619 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.648152 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:18:49.649136 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.649261 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp151849628414'
        
      order by ordinal_position

  
[0m15:18:49.651540 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:18:49.652423 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.652600 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:49.653531 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:18:49.653833 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.653944 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:49.654390 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:49.654560 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.654834 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.654961 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp151849628414" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp151849628414" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:18:49.655807 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:18:49.656534 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.656650 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m15:18:49.657735 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:18:49.658017 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:18:49.658129 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:18:49.658228 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:18:49.658986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:18:49.659280 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:18:49.659479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d588ec0>]}
[0m15:18:49.659772 [info ] [Thread-1 (]: 2 of 3 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.06s]
[0m15:18:49.659966 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:18:49.660094 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:18:49.660261 [info ] [Thread-1 (]: 3 of 3 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:18:49.660391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:18:49.660502 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:18:49.661368 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:18:49.662478 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.662600 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:18:49.662707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:49.670917 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:18:49.671826 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.671946 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.679657 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m15:18:49.680794 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.680920 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.684038 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:18:49.685796 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.686004 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp151849684947"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:18:49.692853 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:18:49.693712 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.693837 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151849684947'
        
      order by ordinal_position

  
[0m15:18:49.695796 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:18:49.696855 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.696986 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.698285 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:49.699535 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.699666 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151849684947'
        
      order by ordinal_position

  
[0m15:18:49.701104 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:18:49.702150 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.702278 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:18:49.703461 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:18:49.704530 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.704657 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp151849684947'
        
      order by ordinal_position

  
[0m15:18:49.705798 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:18:49.706551 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.706761 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:49.707338 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:49.707904 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.708027 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:18:49.708379 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:18:49.708559 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.708871 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.709008 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp151849684947" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp151849684947" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:18:49.709541 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m15:18:49.710364 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.710498 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m15:18:49.710866 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:18:49.711258 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:18:49.711400 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:18:49.711523 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:18:49.711962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:18:49.712293 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:18:49.712497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c241715-eaa3-448c-952c-73735ee3b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6342d0>]}
[0m15:18:49.712810 [info ] [Thread-1 (]: 3 of 3 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:18:49.713025 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:18:49.713520 [debug] [MainThread]: On master: COMMIT
[0m15:18:49.713639 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:49.713733 [debug] [MainThread]: On master: COMMIT
[0m15:18:49.713820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:49.718307 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:18:49.718456 [debug] [MainThread]: On master: Close
[0m15:18:49.718600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:49.718693 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:18:49.718805 [info ] [MainThread]: 
[0m15:18:49.718992 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m15:18:49.719386 [debug] [MainThread]: Command end result
[0m15:18:49.730110 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:18:49.730894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:18:49.733166 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:18:49.733280 [info ] [MainThread]: 
[0m15:18:49.733414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:49.733510 [info ] [MainThread]: 
[0m15:18:49.733613 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:18:49.735497 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.65870893, "process_in_blocks": "0", "process_kernel_time": 0.119678, "process_mem_max_rss": "146145280", "process_out_blocks": "0", "process_user_time": 0.897329}
[0m15:18:49.735657 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:18:49.735623 after 0.66 seconds
[0m15:18:49.735784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109643150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d43b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beb6d60>]}
[0m15:18:49.735909 [debug] [MainThread]: Flushing usage events
[0m15:18:51.376601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:55.552582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1897f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13fb10>]}


============================== 15:19:55.554902 | c3f195f7-9ea0-4063-8a00-c321b83263b4 ==============================
[0m15:19:55.554902 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:19:55.555135 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'invocation_command': 'dbt snapshot --select tag:pipedrive', 'no_print': 'None', 'log_format': 'default'}
[0m15:19:55.612910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f195f7-9ea0-4063-8a00-c321b83263b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c42a9e0>]}
[0m15:19:55.632165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f195f7-9ea0-4063-8a00-c321b83263b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0a69c0>]}
[0m15:19:55.632658 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:19:55.665994 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:19:55.704855 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: pipedrive_snapshots.yaml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |       +indexes: [
    28 |         {'columns': ['id', 'dbt_valid_from', 'dbt_valid_to'], 'type': btree}
    29 |       ]
    30 |       post_hook: "create index if not exists snap_deal_users_current_idx \
    31 |         on {{ this }} (id) \
    32 |         where dbt_valid_to is null"
    33 |       
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 5, column 7
    did not find expected key
      in "<unicode string>", line 30, column 19
[0m15:19:55.706217 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.18022692, "process_in_blocks": "0", "process_kernel_time": 0.104171, "process_mem_max_rss": "124764160", "process_out_blocks": "0", "process_user_time": 0.585625}
[0m15:19:55.706388 [debug] [MainThread]: Command `dbt snapshot` failed at 15:19:55.706349 after 0.18 seconds
[0m15:19:55.706512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e141040>]}
[0m15:19:55.706628 [debug] [MainThread]: Flushing usage events
[0m15:19:57.464401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:16.540318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997fb10>]}


============================== 15:20:16.541940 | ace49064-e69e-4a93-bc5a-8cd7bb552700 ==============================
[0m15:20:16.541940 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:20:16.542184 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'warn_error': 'None', 'introspect': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt snapshot --select tag:pipedrive', 'cache_selected_only': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default'}
[0m15:20:16.595304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6a9e0>]}
[0m15:20:16.614535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e69c0>]}
[0m15:20:16.614851 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:20:16.644464 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:20:16.693990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:16.694277 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:20:16.812938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a833050>]}
[0m15:20:16.841670 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:20:16.842575 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:20:16.851719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ed9a0>]}
[0m15:20:16.851882 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:20:16.851999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0158d0>]}
[0m15:20:16.852649 [info ] [MainThread]: 
[0m15:20:16.852763 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:16.852847 [info ] [MainThread]: 
[0m15:20:16.853004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:20:16.854275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:20:16.876186 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:20:16.876351 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:20:16.876443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:16.896864 [debug] [ThreadPool]: SQL status: SELECT 151 in 0.020 seconds
[0m15:20:16.897436 [debug] [ThreadPool]: On list_postgres: Close
[0m15:20:16.897996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m15:20:16.899989 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:20:16.900119 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:20:16.900215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:16.911124 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m15:20:16.911606 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:20:16.911995 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:20:16.912170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m15:20:16.913332 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:20:16.913452 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:20:16.913547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:16.922883 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m15:20:16.923269 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:20:16.923616 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:20:16.925336 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:16.925463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:20:16.925574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:16.935530 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:20:16.935891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad55230>]}
[0m15:20:16.936043 [debug] [MainThread]: On master: ROLLBACK
[0m15:20:16.936394 [debug] [MainThread]: On master: COMMIT
[0m15:20:16.936480 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:16.936559 [debug] [MainThread]: On master: COMMIT
[0m15:20:16.937084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:20:16.937172 [debug] [MainThread]: On master: Close
[0m15:20:16.938712 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:20:16.938888 [info ] [Thread-1 (]: 1 of 3 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:20:16.939028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:20:16.939134 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:20:16.941904 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:20:16.961932 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:16.962116 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:20:16.962220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:16.970835 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:20:16.975419 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:16.975550 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:16.983682 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m15:20:16.986530 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:16.986667 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:16.989884 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:20:17.007410 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.007628 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp152017004786"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:20:17.011648 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:20:17.012556 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.012667 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152017004786'
        
      order by ordinal_position

  
[0m15:20:17.015189 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:20:17.016134 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.016247 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.018588 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:20:17.019488 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.019597 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152017004786'
        
      order by ordinal_position

  
[0m15:20:17.021583 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:20:17.023966 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.024081 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.026367 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:20:17.028477 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.028588 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152017004786'
        
      order by ordinal_position

  
[0m15:20:17.030656 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:20:17.035519 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.035708 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:17.036569 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:20:17.037730 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.037862 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:17.038317 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:20:17.038493 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.038801 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.038926 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp152017004786" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp152017004786" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:20:17.040131 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:20:17.045361 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.045516 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (id) where dbt_valid_to is null
      
[0m15:20:17.046556 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:20:17.046890 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:20:17.046993 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:17.047084 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:20:17.048217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:20:17.049389 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:20:17.050170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab8a450>]}
[0m15:20:17.050448 [info ] [Thread-1 (]: 1 of 3 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.11s]
[0m15:20:17.050657 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:20:17.050792 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:20:17.050953 [info ] [Thread-1 (]: 2 of 3 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:20:17.051092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:20:17.051205 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:20:17.052032 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:20:17.053046 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.053148 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:20:17.053243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:17.060431 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:20:17.061373 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.061481 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.069290 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m15:20:17.070250 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.070355 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.073397 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:20:17.075336 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.075550 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp152017074354"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:20:17.079632 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:20:17.080479 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.080612 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152017074354'
        
      order by ordinal_position

  
[0m15:20:17.083524 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:20:17.084454 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.084568 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.087947 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:20:17.089034 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.089150 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152017074354'
        
      order by ordinal_position

  
[0m15:20:17.091481 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:20:17.092351 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.092465 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.094693 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:20:17.095612 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.095721 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152017074354'
        
      order by ordinal_position

  
[0m15:20:17.097918 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:20:17.098743 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.098922 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:17.099819 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:20:17.100110 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.100218 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:17.100679 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:20:17.100838 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.101091 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.101209 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp152017074354" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp152017074354" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:20:17.102258 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:20:17.102978 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.103093 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m15:20:17.103581 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:20:17.103855 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:20:17.103967 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:17.104066 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:20:17.105128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:20:17.105424 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:20:17.105612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed01b0>]}
[0m15:20:17.105899 [info ] [Thread-1 (]: 2 of 3 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:20:17.106087 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:20:17.106212 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:20:17.106378 [info ] [Thread-1 (]: 3 of 3 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:20:17.106507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:20:17.106617 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:20:17.107463 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:20:17.108538 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.108651 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:20:17.108755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:17.116451 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:20:17.119707 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.122755 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.129724 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m15:20:17.130977 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.131116 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.134031 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:20:17.135807 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.136009 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp152017134937"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:20:17.143386 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:20:17.144309 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.144449 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152017134937'
        
      order by ordinal_position

  
[0m15:20:17.145932 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:20:17.147122 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.147273 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.150194 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:20:17.151589 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.151751 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152017134937'
        
      order by ordinal_position

  
[0m15:20:17.154583 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m15:20:17.155706 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.155845 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:20:17.157191 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:20:17.158349 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.158488 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152017134937'
        
      order by ordinal_position

  
[0m15:20:17.160302 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:20:17.161072 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.161281 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:17.161857 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:20:17.162463 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.162590 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:17.162910 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:20:17.163108 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.163438 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.163579 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp152017134937" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp152017134937" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:20:17.164299 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:20:17.166022 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.166155 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m15:20:17.166763 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:20:17.167105 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:20:17.167237 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:17.167354 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:20:17.168284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:20:17.168614 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:20:17.168818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace49064-e69e-4a93-bc5a-8cd7bb552700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af7c4b0>]}
[0m15:20:17.169132 [info ] [Thread-1 (]: 3 of 3 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.06s]
[0m15:20:17.169348 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:20:17.169857 [debug] [MainThread]: On master: COMMIT
[0m15:20:17.169991 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:17.170093 [debug] [MainThread]: On master: COMMIT
[0m15:20:17.170186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:17.175717 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m15:20:17.175853 [debug] [MainThread]: On master: Close
[0m15:20:17.176008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:17.176110 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:20:17.176225 [info ] [MainThread]: 
[0m15:20:17.176345 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:20:17.176693 [debug] [MainThread]: Command end result
[0m15:20:17.187558 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:20:17.188298 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:20:17.190633 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:20:17.190741 [info ] [MainThread]: 
[0m15:20:17.190871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:17.190967 [info ] [MainThread]: 
[0m15:20:17.191074 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:20:17.192320 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.67664975, "process_in_blocks": "0", "process_kernel_time": 0.110048, "process_mem_max_rss": "146046976", "process_out_blocks": "0", "process_user_time": 0.904611}
[0m15:20:17.192482 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:20:17.192449 after 0.68 seconds
[0m15:20:17.192612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092be2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa8ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099aad60>]}
[0m15:20:17.192737 [debug] [MainThread]: Flushing usage events
[0m15:20:18.715101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:42.779763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8fb10>]}


============================== 15:20:42.781458 | 3f906201-0906-44a5-8b6d-787bc95ee894 ==============================
[0m15:20:42.781458 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:20:42.781692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select tag:pipedrive', 'cache_selected_only': 'False', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True'}
[0m15:20:42.840368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7a9e0>]}
[0m15:20:42.859621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f69c0>]}
[0m15:20:42.860235 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:20:42.896346 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:20:42.946668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:42.946972 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:20:43.068149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa42e50>]}
[0m15:20:43.096292 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:20:43.097662 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:20:43.106890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa99b80>]}
[0m15:20:43.107057 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 sources, 464 macros
[0m15:20:43.107177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a844130>]}
[0m15:20:43.107849 [info ] [MainThread]: 
[0m15:20:43.107985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:43.108075 [info ] [MainThread]: 
[0m15:20:43.108229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:20:43.109532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:20:43.131806 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:20:43.131976 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:20:43.132066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:43.154703 [debug] [ThreadPool]: SQL status: SELECT 152 in 0.023 seconds
[0m15:20:43.155301 [debug] [ThreadPool]: On list_postgres: Close
[0m15:20:43.155544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_snapshots)
[0m15:20:43.155683 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_snapshots"
"
[0m15:20:43.157535 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_snapshots"
[0m15:20:43.157651 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_snapshots"} */
create schema if not exists "pipedrive_snapshots"
[0m15:20:43.157738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:43.165301 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.008 seconds
[0m15:20:43.165683 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: COMMIT
[0m15:20:43.165791 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_snapshots"
[0m15:20:43.165880 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: COMMIT
[0m15:20:43.166654 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:20:43.166747 [debug] [ThreadPool]: On create_postgres_pipedrive_snapshots: Close
[0m15:20:43.167311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_snapshots, now list_postgres_pipedrive_snapshots)
[0m15:20:43.169491 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:20:43.169601 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:20:43.169698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:43.178967 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m15:20:43.179378 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:20:43.179785 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:20:43.179972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m15:20:43.180559 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:20:43.180662 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:20:43.180752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:43.189615 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m15:20:43.190037 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:20:43.190341 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:20:43.192213 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:43.192380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:20:43.192507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:43.200872 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:20:43.201477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af65570>]}
[0m15:20:43.201636 [debug] [MainThread]: On master: ROLLBACK
[0m15:20:43.201948 [debug] [MainThread]: On master: COMMIT
[0m15:20:43.202039 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:43.202121 [debug] [MainThread]: On master: COMMIT
[0m15:20:43.202596 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:20:43.202709 [debug] [MainThread]: On master: Close
[0m15:20:43.203818 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:20:43.204009 [info ] [Thread-1 (]: 1 of 3 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:20:43.204176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:20:43.204297 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:20:43.206935 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:20:43.232315 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:43.232509 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."activity_types"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:43.232627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:43.241682 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:20:43.242719 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:43.242838 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:43.243261 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:20:43.243437 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:43.243705 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:43.243814 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."activity_types"
    ) sbq



  );
  
  
[0m15:20:43.246145 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m15:20:43.256915 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:43.257075 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

    create  index if not exists
  "2b4a3900c1acebe204fb4ce0ac0028d7"
  on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" using btree
  (id, dbt_valid_from, dbt_valid_to)
  
[0m15:20:43.258232 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:20:43.258903 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:43.259022 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (id) where dbt_valid_to is null
      
[0m15:20:43.259707 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:20:43.259967 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:20:43.260069 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:20:43.260159 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:20:43.261026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:20:43.261609 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:20:43.262372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aba6150>]}
[0m15:20:43.262646 [info ] [Thread-1 (]: 1 of 3 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mSELECT 4[0m in 0.06s]
[0m15:20:43.262839 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:20:43.262971 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:20:43.263168 [info ] [Thread-1 (]: 2 of 3 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:20:43.263348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:20:43.263461 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:20:43.264400 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:20:43.265668 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:43.265785 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:43.265890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:43.272393 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m15:20:43.272795 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:43.272904 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:43.273486 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:20:43.273661 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:43.273932 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:43.274035 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."stages"
    ) sbq



  );
  
  
[0m15:20:43.275855 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m15:20:43.276550 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:43.276784 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

    create  index if not exists
  "3362ff30f9cb39435d705e7c8c9016e8"
  on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" using btree
  (stage_id, dbt_valid_from, dbt_valid_to)
  
[0m15:20:43.277618 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:20:43.278317 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:43.278426 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m15:20:43.279293 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:20:43.279549 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:20:43.279649 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:20:43.279739 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:20:43.280533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:20:43.280766 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:20:43.280942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b01c260>]}
[0m15:20:43.281200 [info ] [Thread-1 (]: 2 of 3 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mSELECT 9[0m in 0.02s]
[0m15:20:43.281389 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:20:43.281514 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:20:43.281669 [info ] [Thread-1 (]: 3 of 3 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:20:43.281799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:20:43.281907 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:20:43.282747 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:20:43.283932 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:43.284040 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."users"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:43.284139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:43.292804 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:20:43.293294 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:43.293453 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:20:43.293867 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:20:43.294014 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:43.294281 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:43.294381 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_users_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."users"
    ) sbq



  );
  
  
[0m15:20:43.302745 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.008 seconds
[0m15:20:43.303421 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:43.303526 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

    create  index if not exists
  "c52c49eb1530b85cd3d5e3e5d9d90b24"
  on "postgres"."pipedrive_snapshots"."deal_users_snapshot" using btree
  (id, dbt_valid_from, dbt_valid_to)
  
[0m15:20:43.306049 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m15:20:43.306702 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:43.306808 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m15:20:43.308391 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:20:43.308757 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:20:43.308875 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:20:43.308981 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:20:43.310725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:20:43.310983 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:20:43.311163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f906201-0906-44a5-8b6d-787bc95ee894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1416d0>]}
[0m15:20:43.311432 [info ] [Thread-1 (]: 3 of 3 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mSELECT 1787[0m in 0.03s]
[0m15:20:43.311626 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:20:43.312065 [debug] [MainThread]: On master: COMMIT
[0m15:20:43.312164 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:43.312246 [debug] [MainThread]: On master: COMMIT
[0m15:20:43.312322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:43.320217 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m15:20:43.320327 [debug] [MainThread]: On master: Close
[0m15:20:43.320450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:43.320532 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:20:43.320628 [info ] [MainThread]: 
[0m15:20:43.320734 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m15:20:43.321031 [debug] [MainThread]: Command end result
[0m15:20:43.329916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:20:43.330670 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:20:43.332797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:20:43.332908 [info ] [MainThread]: 
[0m15:20:43.333064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:43.333181 [info ] [MainThread]: 
[0m15:20:43.333292 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:20:43.335168 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5821191, "process_in_blocks": "0", "process_kernel_time": 0.121592, "process_mem_max_rss": "145670144", "process_out_blocks": "0", "process_user_time": 0.854079}
[0m15:20:43.335323 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:20:43.335285 after 0.58 seconds
[0m15:20:43.335439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b00d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acced50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abad60>]}
[0m15:20:43.335543 [debug] [MainThread]: Flushing usage events
[0m15:20:44.927446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:34.774779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d15f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d15fb10>]}


============================== 15:23:34.776460 | 4b71cedf-71db-4ddb-a621-9cb868870d4a ==============================
[0m15:23:34.776460 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:23:34.776709 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'debug': 'False', 'invocation_command': 'dbt snapshot --select tag:pipedrive', 'write_json': 'True'}
[0m15:23:34.830839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c44a9e0>]}
[0m15:23:34.849872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0c69c0>]}
[0m15:23:34.850236 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:23:34.884664 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:23:34.934945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:34.935313 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m15:23:35.055680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1bf050>]}
[0m15:23:35.084927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:23:35.086027 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:23:35.095721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e211310>]}
[0m15:23:35.095903 [info ] [MainThread]: Found 6 models, 4 snapshots, 6 sources, 464 macros
[0m15:23:35.096024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9918d0>]}
[0m15:23:35.096710 [info ] [MainThread]: 
[0m15:23:35.096831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:35.096919 [info ] [MainThread]: 
[0m15:23:35.097081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:35.098416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:23:35.120472 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:23:35.120633 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:23:35.120724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:35.141047 [debug] [ThreadPool]: SQL status: SELECT 153 in 0.020 seconds
[0m15:23:35.141854 [debug] [ThreadPool]: On list_postgres: Close
[0m15:23:35.142596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m15:23:35.144654 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:23:35.144774 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:23:35.144866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:35.156683 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m15:23:35.157133 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:23:35.157509 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:23:35.157673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m15:23:35.158790 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:23:35.158915 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:23:35.159009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:35.169913 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m15:23:35.170306 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:23:35.170669 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:23:35.172374 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:35.172513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:23:35.172628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:35.182555 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:23:35.182947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e1640>]}
[0m15:23:35.183105 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:35.183485 [debug] [MainThread]: On master: COMMIT
[0m15:23:35.183576 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:35.183656 [debug] [MainThread]: On master: COMMIT
[0m15:23:35.184272 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:23:35.184364 [debug] [MainThread]: On master: Close
[0m15:23:35.187392 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:23:35.187568 [info ] [Thread-1 (]: 1 of 4 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ......... [RUN]
[0m15:23:35.187717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:23:35.187826 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:23:35.190641 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:23:35.210350 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.210519 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:23:35.210615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:35.219647 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:23:35.224062 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.224198 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.231348 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m15:23:35.234217 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.234355 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.237774 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:23:35.255989 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.256253 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp152335253319"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:23:35.259762 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m15:23:35.260892 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.261038 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152335253319'
        
      order by ordinal_position

  
[0m15:23:35.263598 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:23:35.264527 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.264642 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.267317 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:23:35.268196 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.268317 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152335253319'
        
      order by ordinal_position

  
[0m15:23:35.270764 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:23:35.273246 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.273362 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.275807 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:23:35.277983 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.278105 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152335253319'
        
      order by ordinal_position

  
[0m15:23:35.280329 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:23:35.285312 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.285489 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:23:35.286702 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:23:35.287699 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.287806 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:23:35.288280 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:23:35.288451 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.288743 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.288857 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp152335253319" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp152335253319" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:23:35.289989 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:23:35.295041 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.295162 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (id) where dbt_valid_to is null
      
[0m15:23:35.296091 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:23:35.296368 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:23:35.296472 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:23:35.296564 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:23:35.298465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:23:35.299629 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:23:35.300390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e556510>]}
[0m15:23:35.300660 [info ] [Thread-1 (]: 1 of 4 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ......... [[32mINSERT 0 0[0m in 0.11s]
[0m15:23:35.300869 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:23:35.301000 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m15:23:35.301174 [info ] [Thread-1 (]: 2 of 4 START snapshot pipedrive_snapshots.deal_fields_snapshot ................. [RUN]
[0m15:23:35.301317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m15:23:35.301428 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m15:23:35.302213 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m15:23:35.304709 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:23:35.304824 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."fields"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:23:35.304925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:35.313565 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:23:35.313937 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:23:35.314042 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:23:35.314446 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:23:35.314599 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:23:35.314853 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:23:35.314957 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      
  
    

  create  table "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        select * from "postgres"."public"."fields"
    ) sbq



  );
  
  
[0m15:23:35.317391 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m15:23:35.322251 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:23:35.322378 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

    create  index if not exists
  "fcdee310340bd0be072383e93c97b56f"
  on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" using btree
  (id, dbt_valid_from, dbt_valid_to)
  
[0m15:23:35.324350 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m15:23:35.324918 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:23:35.325022 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m15:23:35.325843 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:23:35.326125 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m15:23:35.326228 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:23:35.326318 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m15:23:35.327490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:23:35.327742 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m15:23:35.327912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8612e0>]}
[0m15:23:35.328166 [info ] [Thread-1 (]: 2 of 4 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................. [[32mSELECT 4[0m in 0.03s]
[0m15:23:35.328362 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m15:23:35.328471 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:23:35.328638 [info ] [Thread-1 (]: 3 of 4 START snapshot pipedrive_snapshots.deal_stages_snapshot ................. [RUN]
[0m15:23:35.328798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:23:35.328902 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:23:35.329718 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:23:35.330774 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.330882 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:23:35.330976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:35.339549 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:23:35.340411 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.340517 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.347298 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m15:23:35.348553 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.348686 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.351588 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:23:35.352959 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.353129 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp152335352427"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:23:35.357599 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:23:35.358320 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.358426 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152335352427'
        
      order by ordinal_position

  
[0m15:23:35.361086 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:23:35.362120 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.362230 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.364848 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:23:35.365711 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.365820 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152335352427'
        
      order by ordinal_position

  
[0m15:23:35.368077 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:23:35.368963 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.369072 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.371655 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:23:35.372746 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.372861 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152335352427'
        
      order by ordinal_position

  
[0m15:23:35.375251 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:23:35.375888 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.376059 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:23:35.377000 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:23:35.377278 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.377384 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:23:35.377752 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:23:35.377910 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.378180 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.378301 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp152335352427" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp152335352427" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:23:35.379211 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:23:35.379914 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.380027 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m15:23:35.380475 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:23:35.380749 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:23:35.380859 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:23:35.380955 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:23:35.381863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:23:35.382152 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:23:35.382330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8c8a50>]}
[0m15:23:35.382603 [info ] [Thread-1 (]: 3 of 4 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:23:35.382785 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:23:35.382906 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:23:35.383065 [info ] [Thread-1 (]: 4 of 4 START snapshot pipedrive_snapshots.deal_users_snapshot .................. [RUN]
[0m15:23:35.383197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:23:35.383305 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:23:35.384144 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:23:35.385237 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.385345 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:23:35.385445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:35.392508 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:23:35.393387 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.393703 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.398583 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m15:23:35.400048 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.400185 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.402072 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:23:35.403661 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.403876 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp152335403067"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:23:35.408185 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:23:35.409138 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.409299 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152335403067'
        
      order by ordinal_position

  
[0m15:23:35.410684 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:23:35.411979 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.412110 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.413311 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:23:35.414439 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.414585 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152335403067'
        
      order by ordinal_position

  
[0m15:23:35.415960 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:23:35.417011 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.417147 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:23:35.418347 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:23:35.419673 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.419803 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152335403067'
        
      order by ordinal_position

  
[0m15:23:35.421025 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:23:35.421757 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.421966 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:23:35.422547 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:23:35.422865 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.422982 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:23:35.423302 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:23:35.423487 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.423809 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.423940 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp152335403067" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp152335403067" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:23:35.424469 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m15:23:35.425341 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.425473 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m15:23:35.425821 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:23:35.426143 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:23:35.426270 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:23:35.426382 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:23:35.426964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:23:35.427283 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:23:35.427480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b71cedf-71db-4ddb-a621-9cb868870d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e73a750>]}
[0m15:23:35.427783 [info ] [Thread-1 (]: 4 of 4 OK snapshotted pipedrive_snapshots.deal_users_snapshot .................. [[32mINSERT 0 0[0m in 0.04s]
[0m15:23:35.427984 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:23:35.428496 [debug] [MainThread]: On master: COMMIT
[0m15:23:35.428608 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:35.428698 [debug] [MainThread]: On master: COMMIT
[0m15:23:35.428809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:35.433227 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:23:35.433344 [debug] [MainThread]: On master: Close
[0m15:23:35.433480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:35.433569 [debug] [MainThread]: Connection 'snapshot.enpal_assessment_project.deal_users_snapshot' was properly closed.
[0m15:23:35.433699 [info ] [MainThread]: 
[0m15:23:35.433801 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:23:35.434172 [debug] [MainThread]: Command end result
[0m15:23:35.444929 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:23:35.445708 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:23:35.447997 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:23:35.448105 [info ] [MainThread]: 
[0m15:23:35.448239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:35.448330 [info ] [MainThread]: 
[0m15:23:35.448434 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:23:35.450401 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.69991726, "process_in_blocks": "0", "process_kernel_time": 0.12443, "process_mem_max_rss": "146194432", "process_out_blocks": "0", "process_user_time": 0.918628}
[0m15:23:35.450578 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:23:35.450541 after 0.70 seconds
[0m15:23:35.450715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d18ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104259be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0490d0>]}
[0m15:23:35.450843 [debug] [MainThread]: Flushing usage events
[0m15:23:37.048808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:50.240093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0317f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfeb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfebb10>]}


============================== 15:24:50.242404 | fa90fe2b-c03e-45ee-bde3-d38776411e73 ==============================
[0m15:24:50.242404 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:24:50.242632 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --full-refresh', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True'}
[0m15:24:50.299922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2d29e0>]}
[0m15:24:50.318557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf4e9c0>]}
[0m15:24:50.319096 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:24:50.352356 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:24:50.401528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:24:50.401783 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_fields.sql
[0m15:24:50.485550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d046e50>]}
[0m15:24:50.542259 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:24:50.543264 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:24:50.558704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0559a0>]}
[0m15:24:50.558899 [info ] [MainThread]: Found 6 models, 4 snapshots, 6 sources, 464 macros
[0m15:24:50.559887 [info ] [MainThread]: 
[0m15:24:50.560013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:50.560102 [info ] [MainThread]: 
[0m15:24:50.560275 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:24:50.561737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:24:50.583891 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:24:50.584067 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:24:50.584165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:50.603637 [debug] [ThreadPool]: SQL status: SELECT 153 in 0.019 seconds
[0m15:24:50.604307 [debug] [ThreadPool]: On list_postgres: Close
[0m15:24:50.605058 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:24:50.605176 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:24:50.605258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:50.612968 [debug] [ThreadPool]: SQL status: SELECT 153 in 0.008 seconds
[0m15:24:50.613590 [debug] [ThreadPool]: On list_postgres: Close
[0m15:24:50.614143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m15:24:50.616037 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m15:24:50.616157 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m15:24:50.616246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:50.625747 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m15:24:50.626191 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m15:24:50.626572 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m15:24:50.626741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m15:24:50.627562 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m15:24:50.627663 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m15:24:50.627751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:50.637159 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m15:24:50.637556 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m15:24:50.637931 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m15:24:50.639965 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:50.640100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:24:50.640209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:24:50.649523 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:24:50.649945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c742890>]}
[0m15:24:50.650119 [debug] [MainThread]: On master: ROLLBACK
[0m15:24:50.650440 [debug] [MainThread]: On master: COMMIT
[0m15:24:50.650528 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:50.650607 [debug] [MainThread]: On master: COMMIT
[0m15:24:50.651174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:24:50.651274 [debug] [MainThread]: On master: Close
[0m15:24:50.652892 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m15:24:50.653101 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m15:24:50.653283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m15:24:50.653400 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m15:24:50.656203 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m15:24:50.656623 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m15:24:50.675264 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m15:24:50.675573 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:24:50.675692 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m15:24:50.675798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:50.689025 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m15:24:50.692744 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:24:50.692890 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities" rename to "stg_deal_activities__dbt_backup"
[0m15:24:50.693722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:50.694610 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:24:50.694714 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_tmp" rename to "stg_deal_activities"
[0m15:24:50.695314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:50.700432 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m15:24:50.700547 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:24:50.700639 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m15:24:50.703072 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:24:50.704969 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup"
[0m15:24:50.706378 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m15:24:50.706480 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activities__dbt_backup" cascade
[0m15:24:50.709050 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:24:50.709856 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m15:24:50.710678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112820940>]}
[0m15:24:50.710884 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mSELECT 4579[0m in 0.06s]
[0m15:24:50.711071 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m15:24:50.711198 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m15:24:50.711373 [info ] [Thread-1 (]: 2 of 10 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m15:24:50.711543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m15:24:50.711649 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m15:24:50.712482 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m15:24:50.712713 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m15:24:50.718507 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m15:24:50.718732 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:24:50.718831 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m15:24:50.718929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:50.737686 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.019 seconds
[0m15:24:50.738943 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:24:50.739072 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m15:24:50.739912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:50.740771 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:24:50.740881 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m15:24:50.741339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:50.742119 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m15:24:50.742242 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:24:50.742358 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m15:24:50.746111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:24:50.746794 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m15:24:50.747000 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m15:24:50.747102 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m15:24:50.748962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:24:50.749367 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m15:24:50.749557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d19be90>]}
[0m15:24:50.749769 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 15406[0m in 0.04s]
[0m15:24:50.749960 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m15:24:50.750083 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m15:24:50.750271 [info ] [Thread-1 (]: 3 of 10 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m15:24:50.750443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_users)
[0m15:24:50.750557 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m15:24:50.751724 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m15:24:50.751985 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m15:24:50.753422 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m15:24:50.753623 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:24:50.753732 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m15:24:50.753835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:50.762476 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.009 seconds
[0m15:24:50.766830 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:24:50.766983 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    create  index if not exists
  "b180d80709621dedad0ddd3332a6d416"
  on "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" using btree
  (deal_user_id)
  
[0m15:24:50.768836 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m15:24:50.769914 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:24:50.770027 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users" rename to "stg_deal_users__dbt_backup"
[0m15:24:50.770478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:50.771517 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:24:50.771626 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_tmp" rename to "stg_deal_users"
[0m15:24:50.772021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:50.772485 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m15:24:50.772593 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:24:50.772688 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m15:24:50.774333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:24:50.774985 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup"
[0m15:24:50.775205 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m15:24:50.775349 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_users__dbt_backup" cascade
[0m15:24:50.777418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:24:50.777818 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m15:24:50.777989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3e3330>]}
[0m15:24:50.778188 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mSELECT 1787[0m in 0.03s]
[0m15:24:50.778367 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m15:24:50.778490 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:24:50.778673 [info ] [Thread-1 (]: 4 of 10 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m15:24:50.778828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m15:24:50.778939 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:24:50.779827 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:24:50.798179 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.798345 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:24:50.798451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:50.807678 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m15:24:50.812329 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.812465 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.820638 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m15:24:50.823255 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.823376 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.826305 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m15:24:50.838661 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.838856 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp152450838144"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:24:50.842712 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:24:50.843475 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.843580 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152450838144'
        
      order by ordinal_position

  
[0m15:24:50.846176 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:24:50.847168 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.847273 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.849774 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.850635 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.850745 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152450838144'
        
      order by ordinal_position

  
[0m15:24:50.852915 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:24:50.853765 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.853873 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.856260 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.858473 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.858581 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp152450838144'
        
      order by ordinal_position

  
[0m15:24:50.860911 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:24:50.865897 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.866082 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:24:50.867042 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:24:50.868078 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.868187 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:24:50.868660 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:24:50.868814 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.869104 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.869228 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp152450838144" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp152450838144" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:24:50.870139 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:24:50.870748 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.870853 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (id) where dbt_valid_to is null
      
[0m15:24:50.871368 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:24:50.871636 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:24:50.871742 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m15:24:50.871834 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m15:24:50.872944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:24:50.873768 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m15:24:50.873951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cccd0>]}
[0m15:24:50.874224 [info ] [Thread-1 (]: 4 of 10 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.10s]
[0m15:24:50.874412 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m15:24:50.874534 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m15:24:50.874699 [info ] [Thread-1 (]: 5 of 10 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m15:24:50.874877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m15:24:50.875012 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m15:24:50.876001 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m15:24:50.876910 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.877020 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:24:50.877120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:50.884573 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:24:50.885655 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.885781 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.893030 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m15:24:50.894296 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.894415 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.897055 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.898432 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.898613 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp152450897895"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:24:50.902100 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m15:24:50.902927 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.903048 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp152450897895'
        
      order by ordinal_position

  
[0m15:24:50.905820 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m15:24:50.906916 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.907034 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.909499 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.910415 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.910528 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp152450897895'
        
      order by ordinal_position

  
[0m15:24:50.912534 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:24:50.914723 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.914846 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.916996 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.917990 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.918106 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp152450897895'
        
      order by ordinal_position

  
[0m15:24:50.919979 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:24:50.920666 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.920861 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:24:50.921701 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:24:50.922016 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.922132 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:24:50.922476 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:24:50.922647 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.922947 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.923076 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp152450897895" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp152450897895" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:24:50.923910 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:24:50.924679 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.924798 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m15:24:50.925226 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:24:50.925525 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m15:24:50.925646 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m15:24:50.925753 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m15:24:50.926761 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:24:50.927062 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m15:24:50.927253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7a39d0>]}
[0m15:24:50.927547 [info ] [Thread-1 (]: 5 of 10 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m15:24:50.927746 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m15:24:50.927883 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:24:50.928064 [info ] [Thread-1 (]: 6 of 10 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m15:24:50.928236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m15:24:50.928355 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:24:50.929478 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:24:50.930435 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.930551 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:24:50.930657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:50.937601 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m15:24:50.938629 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.938760 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.943491 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m15:24:50.944881 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.945011 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.946858 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:24:50.948337 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.948529 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp152450947756"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:24:50.950206 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:24:50.951172 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.951323 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152450947756'
        
      order by ordinal_position

  
[0m15:24:50.953493 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.954671 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.954796 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.956185 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m15:24:50.957161 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.957287 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152450947756'
        
      order by ordinal_position

  
[0m15:24:50.959444 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.960588 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.960718 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.963044 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m15:24:50.964050 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.964174 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp152450947756'
        
      order by ordinal_position

  
[0m15:24:50.966006 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.966696 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.966881 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:24:50.968263 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:24:50.968571 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.968685 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:24:50.969171 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:24:50.969338 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.969656 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.969787 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp152450947756" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp152450947756" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:24:50.970804 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:24:50.971582 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.971703 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m15:24:50.972355 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:24:50.972668 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:24:50.972790 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m15:24:50.972899 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m15:24:50.973840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:24:50.974143 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m15:24:50.974342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128efaf0>]}
[0m15:24:50.974650 [info ] [Thread-1 (]: 6 of 10 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m15:24:50.974859 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m15:24:50.975023 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:24:50.975260 [info ] [Thread-1 (]: 7 of 10 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m15:24:50.975491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m15:24:50.975637 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:24:50.976637 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:24:50.977983 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:50.978115 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:24:50.978234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:50.985992 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m15:24:50.987179 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:50.987329 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.993069 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m15:24:50.994667 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:50.994825 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:50.996702 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:50.998290 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:50.998500 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp152450997689"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:24:51.003565 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m15:24:51.004579 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.004722 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152450997689'
        
      order by ordinal_position

  
[0m15:24:51.006546 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m15:24:51.007913 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.008063 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:51.009609 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m15:24:51.010703 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.010838 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152450997689'
        
      order by ordinal_position

  
[0m15:24:51.012225 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:24:51.013262 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.013395 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m15:24:51.015118 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m15:24:51.016610 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.016762 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp152450997689'
        
      order by ordinal_position

  
[0m15:24:51.017900 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m15:24:51.018726 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.018956 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:24:51.019534 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:24:51.019884 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.020014 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:24:51.020362 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:24:51.020579 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.020930 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.021076 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp152450997689" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp152450997689" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:24:51.021592 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m15:24:51.022465 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.022605 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m15:24:51.022979 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:24:51.023312 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:24:51.023442 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m15:24:51.023563 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m15:24:51.024110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:24:51.024462 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m15:24:51.024689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128906b0>]}
[0m15:24:51.025024 [info ] [Thread-1 (]: 7 of 10 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m15:24:51.025247 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m15:24:51.025400 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m15:24:51.025591 [info ] [Thread-1 (]: 8 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m15:24:51.025750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m15:24:51.025881 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m15:24:51.027186 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:24:51.027633 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m15:24:51.029311 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:24:51.029563 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:24:51.029692 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m15:24:51.029817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:51.035369 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m15:24:51.036531 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:24:51.036668 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types" rename to "stg_deal_activity_types__dbt_backup"
[0m15:24:51.037002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:51.038158 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:24:51.038286 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_tmp" rename to "stg_deal_activity_types"
[0m15:24:51.038608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:51.039115 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m15:24:51.039242 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:24:51.039353 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m15:24:51.039927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:24:51.040661 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup"
[0m15:24:51.040900 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m15:24:51.041021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_activity_types__dbt_backup" cascade
[0m15:24:51.041600 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:24:51.042039 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m15:24:51.042242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6ed9d0>]}
[0m15:24:51.042482 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mSELECT 4[0m in 0.02s]
[0m15:24:51.042687 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m15:24:51.042826 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m15:24:51.043046 [info ] [Thread-1 (]: 9 of 10 START sql incremental model public_pipedrive_staging.stg_deal_fields ... [RUN]
[0m15:24:51.043195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m15:24:51.043319 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m15:24:51.044582 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m15:24:51.045125 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m15:24:51.046778 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m15:24:51.047019 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:24:51.047141 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m15:24:51.047260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:51.054333 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m15:24:51.055574 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:24:51.055711 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields" rename to "stg_deal_fields__dbt_backup"
[0m15:24:51.056033 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:51.058190 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:24:51.058328 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_tmp" rename to "stg_deal_fields"
[0m15:24:51.058680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:51.059287 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m15:24:51.059408 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:24:51.059513 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m15:24:51.060108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:24:51.060963 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup"
[0m15:24:51.061219 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m15:24:51.061349 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_fields__dbt_backup" cascade
[0m15:24:51.062231 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:24:51.062689 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m15:24:51.062894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6ed5b0>]}
[0m15:24:51.063127 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mSELECT 4[0m in 0.02s]
[0m15:24:51.063319 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m15:24:51.063447 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m15:24:51.063592 [info ] [Thread-1 (]: 10 of 10 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m15:24:51.063771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m15:24:51.063891 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m15:24:51.066978 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.067264 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m15:24:51.068500 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.068731 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.068849 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      
  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data


  );
  
  
[0m15:24:51.068963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:51.075095 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m15:24:51.075714 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.075832 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "8e6578911123d65b5eeaea462cc0355c"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_id)
  
[0m15:24:51.076612 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m15:24:51.077267 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.077402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    create  index if not exists
  "a535e766987bf422fe17113668c15d02"
  on "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" using btree
  (deal_stage_name)
  
[0m15:24:51.077844 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m15:24:51.079077 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.079200 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages" rename to "stg_deal_stages__dbt_backup"
[0m15:24:51.079529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:51.080383 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.080493 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_tmp" rename to "stg_deal_stages"
[0m15:24:51.080786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:51.081248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m15:24:51.081359 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.081458 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m15:24:51.081990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m15:24:51.082634 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup"
[0m15:24:51.082842 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m15:24:51.082947 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_stages__dbt_backup" cascade
[0m15:24:51.083575 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:24:51.083966 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m15:24:51.084151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa90fe2b-c03e-45ee-bde3-d38776411e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d1f10>]}
[0m15:24:51.084367 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mSELECT 9[0m in 0.02s]
[0m15:24:51.084547 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m15:24:51.085125 [debug] [MainThread]: On master: COMMIT
[0m15:24:51.085261 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:51.085364 [debug] [MainThread]: On master: COMMIT
[0m15:24:51.085454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:24:51.091898 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m15:24:51.092037 [debug] [MainThread]: On master: Close
[0m15:24:51.092185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:51.092277 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m15:24:51.092406 [info ] [MainThread]: 
[0m15:24:51.092514 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m15:24:51.093095 [debug] [MainThread]: Command end result
[0m15:24:51.102092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m15:24:51.102758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m15:24:51.105141 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m15:24:51.105259 [info ] [MainThread]: 
[0m15:24:51.105385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:51.105480 [info ] [MainThread]: 
[0m15:24:51.105585 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m15:24:51.106981 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.892143, "process_in_blocks": "0", "process_kernel_time": 0.14522, "process_mem_max_rss": "148275200", "process_out_blocks": "0", "process_user_time": 1.011453}
[0m15:24:51.107142 [debug] [MainThread]: Command `dbt build` succeeded at 15:24:51.107110 after 0.89 seconds
[0m15:24:51.107265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112893e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128922d0>]}
[0m15:24:51.107381 [debug] [MainThread]: Flushing usage events
[0m15:24:52.864950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:26.129061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109163890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109163b10>]}


============================== 20:06:26.131523 | d7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258 ==============================
[0m20:06:26.131523 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:06:26.131761 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'invocation_command': 'dbt build', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'use_colors': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True'}
[0m20:06:26.236992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844a9e0>]}
[0m20:06:26.255605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c69c0>]}
[0m20:06:26.256056 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:06:26.309709 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:06:26.359204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:06:26.359498 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://snapshots/pipedrive_snapshots.yaml
[0m20:06:26.478315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a013350>]}
[0m20:06:26.506984 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m20:06:26.507889 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m20:06:26.523130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1bb60>]}
[0m20:06:26.523296 [info ] [MainThread]: Found 6 models, 4 snapshots, 6 sources, 464 macros
[0m20:06:26.524248 [info ] [MainThread]: 
[0m20:06:26.524372 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:06:26.524463 [info ] [MainThread]: 
[0m20:06:26.524633 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:06:26.526091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:06:26.553303 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:06:26.553472 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:06:26.553569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:26.586669 [debug] [ThreadPool]: SQL status: SELECT 155 in 0.033 seconds
[0m20:06:26.587301 [debug] [ThreadPool]: On list_postgres: Close
[0m20:06:26.588064 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:06:26.588182 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:06:26.588265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:26.595991 [debug] [ThreadPool]: SQL status: SELECT 155 in 0.008 seconds
[0m20:06:26.596655 [debug] [ThreadPool]: On list_postgres: Close
[0m20:06:26.597270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m20:06:26.599283 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m20:06:26.599402 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m20:06:26.599493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:26.609975 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m20:06:26.610397 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m20:06:26.610762 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m20:06:26.610918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m20:06:26.611759 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m20:06:26.611879 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m20:06:26.611975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:26.620891 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m20:06:26.621279 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m20:06:26.621660 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m20:06:26.623610 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:26.623750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:06:26.623866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:26.634849 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m20:06:26.635231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971faf0>]}
[0m20:06:26.635378 [debug] [MainThread]: On master: ROLLBACK
[0m20:06:26.635671 [debug] [MainThread]: On master: COMMIT
[0m20:06:26.635756 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:26.635832 [debug] [MainThread]: On master: COMMIT
[0m20:06:26.636295 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:06:26.636377 [debug] [MainThread]: On master: Close
[0m20:06:26.637444 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m20:06:26.637617 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m20:06:26.637772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m20:06:26.637883 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m20:06:26.640661 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m20:06:26.640908 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m20:06:26.662383 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m20:06:26.662565 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp200626653799"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m20:06:26.662673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.679119 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.016 seconds
[0m20:06:26.683935 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m20:06:26.684075 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp200626653799'
        
      order by ordinal_position

  
[0m20:06:26.691976 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m20:06:26.693751 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m20:06:26.693879 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:26.695661 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m20:06:26.698963 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m20:06:26.699105 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:26.700159 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m20:06:26.708106 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m20:06:26.708408 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m20:06:26.708536 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp200626653799" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m20:06:26.718581 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.010 seconds
[0m20:06:26.723578 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m20:06:26.723705 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m20:06:26.723806 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m20:06:26.725213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:26.725918 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m20:06:26.726729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f848940>]}
[0m20:06:26.726977 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.09s]
[0m20:06:26.727177 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m20:06:26.727306 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m20:06:26.727483 [info ] [Thread-1 (]: 2 of 10 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m20:06:26.727628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m20:06:26.727735 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m20:06:26.728667 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:26.728906 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m20:06:26.733431 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:26.733734 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:26.733870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    SELECT
  deal_id,
  change_time       AS deal_field_change_time,
  changed_field_key AS deal_changed_field_key,
  new_value         AS deal_changed_field_new_value
FROM "postgres"."public"."deal_changes"
  );
  
[0m20:06:26.733987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.742670 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.009 seconds
[0m20:06:26.746447 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:26.746592 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m20:06:26.747231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:06:26.748333 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:26.748453 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m20:06:26.748749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:06:26.749851 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:06:26.749965 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:26.750061 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m20:06:26.751210 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:26.753419 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m20:06:26.755042 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m20:06:26.755163 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m20:06:26.756292 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:06:26.756752 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m20:06:26.756962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c31d0>]}
[0m20:06:26.757187 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 15406[0m in 0.03s]
[0m20:06:26.757376 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m20:06:26.757503 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m20:06:26.757646 [info ] [Thread-1 (]: 3 of 10 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m20:06:26.757809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_users)
[0m20:06:26.757916 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m20:06:26.759223 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m20:06:26.759496 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m20:06:26.760700 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m20:06:26.760825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp200626760138"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m20:06:26.760930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.768540 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.008 seconds
[0m20:06:26.769938 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m20:06:26.770078 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp200626760138'
        
      order by ordinal_position

  
[0m20:06:26.774096 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m20:06:26.775249 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m20:06:26.775378 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:26.776989 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m20:06:26.778049 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m20:06:26.778164 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:26.779187 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m20:06:26.781402 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m20:06:26.781700 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m20:06:26.781815 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp200626760138" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m20:06:26.786360 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m20:06:26.786871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m20:06:26.786984 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m20:06:26.787083 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m20:06:26.787975 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:26.788217 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m20:06:26.788413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f80c050>]}
[0m20:06:26.788636 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m20:06:26.788821 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m20:06:26.788950 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m20:06:26.789122 [info ] [Thread-1 (]: 4 of 10 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m20:06:26.789254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m20:06:26.789364 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m20:06:26.790312 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m20:06:26.808968 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.809157 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m20:06:26.809263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.816429 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:06:26.817437 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.817546 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.821652 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m20:06:26.823799 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.823928 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.826040 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m20:06:26.838534 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.838719 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp200626838013"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m20:06:26.844383 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m20:06:26.845351 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.845479 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp200626838013'
        
      order by ordinal_position

  
[0m20:06:26.846977 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m20:06:26.847877 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.847983 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.848980 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:26.849886 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.850002 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp200626838013'
        
      order by ordinal_position

  
[0m20:06:26.850876 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m20:06:26.851995 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.852110 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.853171 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:26.855307 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.855423 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp200626838013'
        
      order by ordinal_position

  
[0m20:06:26.857730 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m20:06:26.864035 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.864224 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m20:06:26.865196 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m20:06:26.866190 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.866292 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:06:26.866712 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:06:26.866866 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.867147 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.867261 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp200626838013" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp200626838013" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:06:26.868228 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m20:06:26.868889 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.869007 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m20:06:26.869950 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m20:06:26.870211 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m20:06:26.870315 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m20:06:26.870405 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m20:06:26.871196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:26.871995 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m20:06:26.872178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f92f2f0>]}
[0m20:06:26.872452 [info ] [Thread-1 (]: 4 of 10 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.08s]
[0m20:06:26.872638 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m20:06:26.872761 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m20:06:26.872927 [info ] [Thread-1 (]: 5 of 10 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m20:06:26.873102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m20:06:26.873221 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m20:06:26.874024 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m20:06:26.875025 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.875132 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m20:06:26.875227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.882258 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:06:26.883325 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.883448 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.889657 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:06:26.890842 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.890964 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.892384 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:26.894098 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.894289 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp200626893298"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m20:06:26.897268 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m20:06:26.898116 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.898231 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp200626893298'
        
      order by ordinal_position

  
[0m20:06:26.899426 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m20:06:26.900396 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.900523 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.901805 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:26.902971 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.903087 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp200626893298'
        
      order by ordinal_position

  
[0m20:06:26.904062 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m20:06:26.905055 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.905172 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.906391 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:26.907379 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.907492 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp200626893298'
        
      order by ordinal_position

  
[0m20:06:26.908889 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m20:06:26.909606 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.909790 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m20:06:26.910289 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:06:26.910799 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.910908 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:06:26.911181 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:06:26.911338 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.911633 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.911750 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp200626893298" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp200626893298" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:06:26.912255 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m20:06:26.912997 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.913116 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m20:06:26.914150 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m20:06:26.914446 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m20:06:26.914558 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m20:06:26.914654 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m20:06:26.915402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:26.915698 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m20:06:26.915880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a646b50>]}
[0m20:06:26.916156 [info ] [Thread-1 (]: 5 of 10 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m20:06:26.916340 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m20:06:26.916462 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m20:06:26.916627 [info ] [Thread-1 (]: 6 of 10 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m20:06:26.916798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m20:06:26.916923 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m20:06:26.917780 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m20:06:26.918863 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.918974 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m20:06:26.919079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.925693 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:06:26.926742 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.926869 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.930150 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m20:06:26.931324 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.931464 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.933209 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m20:06:26.934895 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.935082 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp200626934082"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m20:06:26.938529 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m20:06:26.939496 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.939626 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp200626934082'
        
      order by ordinal_position

  
[0m20:06:26.941568 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m20:06:26.942574 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.942696 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.943790 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m20:06:26.945042 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.945170 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp200626934082'
        
      order by ordinal_position

  
[0m20:06:26.946443 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:26.947415 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.947540 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.949449 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m20:06:26.950477 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.950599 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp200626934082'
        
      order by ordinal_position

  
[0m20:06:26.953780 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m20:06:26.955487 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.955707 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m20:06:26.956934 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m20:06:26.958464 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.958895 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:06:26.960187 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m20:06:26.960855 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.961733 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.962182 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp200626934082" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp200626934082" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:06:26.964009 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m20:06:26.965026 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.965177 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m20:06:26.965862 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m20:06:26.966349 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m20:06:26.966734 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m20:06:26.967017 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m20:06:26.968165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:26.968675 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m20:06:26.968897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a79d2b0>]}
[0m20:06:26.969201 [info ] [Thread-1 (]: 6 of 10 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m20:06:26.969557 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m20:06:26.969706 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m20:06:26.969920 [info ] [Thread-1 (]: 7 of 10 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m20:06:26.970139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m20:06:26.970283 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m20:06:26.971294 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m20:06:26.972239 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:26.972350 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m20:06:26.972450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.979938 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:06:26.981296 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:26.981452 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.987748 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:06:26.988931 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:26.989051 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:26.990403 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:26.991992 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:26.992176 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp200626991231"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m20:06:26.997838 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m20:06:26.998677 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:26.998798 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp200626991231'
        
      order by ordinal_position

  
[0m20:06:26.999846 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m20:06:27.000782 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.000900 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:27.001906 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:27.002985 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.003098 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp200626991231'
        
      order by ordinal_position

  
[0m20:06:27.004248 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m20:06:27.005274 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.005396 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m20:06:27.006749 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m20:06:27.007834 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.007960 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp200626991231'
        
      order by ordinal_position

  
[0m20:06:27.008927 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m20:06:27.009717 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.009922 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m20:06:27.010433 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:06:27.011624 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.011744 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m20:06:27.012051 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m20:06:27.012222 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.012524 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.012653 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp200626991231" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp200626991231" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:06:27.013086 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m20:06:27.013861 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.013987 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m20:06:27.014301 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m20:06:27.014588 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m20:06:27.014706 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m20:06:27.014810 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m20:06:27.015329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m20:06:27.015626 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m20:06:27.015823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8d0170>]}
[0m20:06:27.016114 [info ] [Thread-1 (]: 7 of 10 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m20:06:27.016302 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m20:06:27.016428 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m20:06:27.016594 [info ] [Thread-1 (]: 8 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m20:06:27.016723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m20:06:27.016832 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m20:06:27.017924 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m20:06:27.018180 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m20:06:27.019627 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m20:06:27.019748 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp200627018853"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m20:06:27.019859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:27.024889 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:06:27.025902 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m20:06:27.026039 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp200627018853'
        
      order by ordinal_position

  
[0m20:06:27.030540 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m20:06:27.031502 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m20:06:27.031628 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:27.033138 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m20:06:27.034425 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m20:06:27.034590 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:27.035544 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m20:06:27.036400 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m20:06:27.036723 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m20:06:27.036854 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp200627018853" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m20:06:27.037545 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m20:06:27.038010 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m20:06:27.038122 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m20:06:27.038226 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m20:06:27.038835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:27.039071 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m20:06:27.039263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1df230>]}
[0m20:06:27.039486 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m20:06:27.039675 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m20:06:27.039799 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m20:06:27.039978 [info ] [Thread-1 (]: 9 of 10 START sql incremental model public_pipedrive_staging.stg_deal_fields ... [RUN]
[0m20:06:27.040132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m20:06:27.040248 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m20:06:27.041375 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m20:06:27.041630 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m20:06:27.043091 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m20:06:27.043211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp200627042293"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m20:06:27.043325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:27.049187 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:06:27.050257 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m20:06:27.050390 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp200627042293'
        
      order by ordinal_position

  
[0m20:06:27.053287 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m20:06:27.054495 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m20:06:27.054634 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:27.056659 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m20:06:27.057922 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m20:06:27.058047 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:27.059153 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m20:06:27.059910 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m20:06:27.060206 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m20:06:27.060329 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp200627042293" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m20:06:27.062702 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.002 seconds
[0m20:06:27.063159 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m20:06:27.063268 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m20:06:27.063364 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m20:06:27.064230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:27.064467 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m20:06:27.064658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a691c10>]}
[0m20:06:27.064876 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.02s]
[0m20:06:27.065062 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m20:06:27.065187 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m20:06:27.065346 [info ] [Thread-1 (]: 10 of 10 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m20:06:27.065480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m20:06:27.065590 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m20:06:27.068478 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m20:06:27.068777 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m20:06:27.070243 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m20:06:27.070367 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp200627069682"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m20:06:27.070483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:27.077571 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m20:06:27.078601 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m20:06:27.078721 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp200627069682'
        
      order by ordinal_position

  
[0m20:06:27.082744 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m20:06:27.084042 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m20:06:27.084181 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:27.085336 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:06:27.086385 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m20:06:27.086503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m20:06:27.087650 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:06:27.088370 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m20:06:27.088672 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m20:06:27.088788 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp200627069682" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m20:06:27.089185 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m20:06:27.089629 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m20:06:27.089737 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m20:06:27.089836 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m20:06:27.090462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:06:27.090695 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m20:06:27.090897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b76b2e-3bb2-4d5e-b7dd-d1b94c8c5258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8d2990>]}
[0m20:06:27.091124 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m20:06:27.091315 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m20:06:27.091841 [debug] [MainThread]: On master: COMMIT
[0m20:06:27.091978 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:27.092079 [debug] [MainThread]: On master: COMMIT
[0m20:06:27.092163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:27.096763 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m20:06:27.096893 [debug] [MainThread]: On master: Close
[0m20:06:27.097038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:27.097130 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m20:06:27.097270 [info ] [MainThread]: 
[0m20:06:27.097386 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m20:06:27.097991 [debug] [MainThread]: Command end result
[0m20:06:27.108045 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m20:06:27.108878 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m20:06:27.111305 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m20:06:27.111423 [info ] [MainThread]: 
[0m20:06:27.111555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:27.111648 [info ] [MainThread]: 
[0m20:06:27.111758 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m20:06:27.135322 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0337374, "process_in_blocks": "0", "process_kernel_time": 0.183682, "process_mem_max_rss": "149127168", "process_out_blocks": "0", "process_user_time": 1.07535}
[0m20:06:27.135576 [debug] [MainThread]: Command `dbt build` succeeded at 20:06:27.135534 after 1.03 seconds
[0m20:06:27.135726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108441790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f94ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f94f9b0>]}
[0m20:06:27.135867 [debug] [MainThread]: Flushing usage events
[0m20:06:37.097003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:11.772177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925fb10>]}


============================== 21:10:11.774525 | 73623328-ca83-489a-a2de-d73b8397f271 ==============================
[0m21:10:11.774525 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:10:11.774754 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'introspect': 'True'}
[0m21:10:11.842528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73623328-ca83-489a-a2de-d73b8397f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085469e0>]}
[0m21:10:11.861883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73623328-ca83-489a-a2de-d73b8397f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c29c0>]}
[0m21:10:11.862407 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:10:11.894450 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:10:11.944372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:10:11.944612 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m21:10:12.004069 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_deal_changes' (models/staging/pipedrive/stg_deal_changes.sql) depends on a source named 'pipedrive.deal_changes' which was not found
[0m21:10:12.005959 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.2600887, "process_in_blocks": "0", "process_kernel_time": 0.107209, "process_mem_max_rss": "128892928", "process_out_blocks": "0", "process_user_time": 0.644196}
[0m21:10:12.006157 [debug] [MainThread]: Command `dbt build` failed at 21:10:12.006117 after 0.26 seconds
[0m21:10:12.006297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a548b90>]}
[0m21:10:12.006419 [debug] [MainThread]: Flushing usage events
[0m21:10:13.386840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:26.805586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b867890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b867b10>]}


============================== 21:10:26.807149 | 8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401 ==============================
[0m21:10:26.807149 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:10:26.807386 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'printer_width': '80', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default'}
[0m21:10:26.861906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab4e9e0>]}
[0m21:10:26.881648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7ca9c0>]}
[0m21:10:26.881989 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:10:26.912474 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:10:26.954933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:10:26.955168 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m21:10:27.055196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c816c50>]}
[0m21:10:27.108314 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m21:10:27.109339 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m21:10:27.124850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d19a0>]}
[0m21:10:27.125051 [info ] [MainThread]: Found 6 models, 4 snapshots, 6 sources, 464 macros
[0m21:10:27.126035 [info ] [MainThread]: 
[0m21:10:27.126156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:10:27.126249 [info ] [MainThread]: 
[0m21:10:27.126425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:10:27.127884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:10:27.150066 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:10:27.150240 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:10:27.150338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:27.181684 [debug] [ThreadPool]: SQL status: SELECT 165 in 0.031 seconds
[0m21:10:27.182376 [debug] [ThreadPool]: On list_postgres: Close
[0m21:10:27.183174 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:10:27.183297 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:10:27.183381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:27.191860 [debug] [ThreadPool]: SQL status: SELECT 165 in 0.008 seconds
[0m21:10:27.192558 [debug] [ThreadPool]: On list_postgres: Close
[0m21:10:27.193131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m21:10:27.195055 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m21:10:27.195178 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m21:10:27.195274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:27.205425 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m21:10:27.205831 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m21:10:27.206212 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m21:10:27.206403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m21:10:27.207230 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m21:10:27.207335 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m21:10:27.207421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:27.216556 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m21:10:27.216969 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m21:10:27.217347 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m21:10:27.219324 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:27.219461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:10:27.219577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:27.229497 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m21:10:27.229877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c90e7b0>]}
[0m21:10:27.230033 [debug] [MainThread]: On master: ROLLBACK
[0m21:10:27.230361 [debug] [MainThread]: On master: COMMIT
[0m21:10:27.230448 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:27.230525 [debug] [MainThread]: On master: COMMIT
[0m21:10:27.231038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:10:27.231122 [debug] [MainThread]: On master: Close
[0m21:10:27.231915 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m21:10:27.232083 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m21:10:27.232233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m21:10:27.232342 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m21:10:27.235151 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m21:10:27.235433 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m21:10:27.254957 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m21:10:27.255124 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp211027246170"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m21:10:27.255231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.268108 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m21:10:27.272906 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m21:10:27.273039 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp211027246170'
        
      order by ordinal_position

  
[0m21:10:27.279919 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m21:10:27.281677 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m21:10:27.281832 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.283981 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m21:10:27.287535 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m21:10:27.287682 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.289620 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m21:10:27.297962 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m21:10:27.298354 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m21:10:27.298510 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp211027246170" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m21:10:27.307627 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.009 seconds
[0m21:10:27.312443 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m21:10:27.312572 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m21:10:27.312668 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m21:10:27.315789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:10:27.316416 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m21:10:27.317219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112028e20>]}
[0m21:10:27.317454 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m21:10:27.317655 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m21:10:27.317775 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m21:10:27.317944 [info ] [Thread-1 (]: 2 of 10 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m21:10:27.318089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m21:10:27.318190 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m21:10:27.319088 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:10:27.319305 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m21:10:27.325312 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m21:10:27.325662 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:10:27.325804 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  MAX(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  MAX(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  MAX(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  MAX(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes
WHERE deal_id = 881836
ORDER BY change_time DESC
  );
  
[0m21:10:27.325936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.336389 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.010 seconds
[0m21:10:27.339656 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:10:27.339769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m21:10:27.340175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:10:27.341278 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:10:27.341390 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m21:10:27.341809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:10:27.343003 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:10:27.343114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:10:27.343206 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m21:10:27.343908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:10:27.345765 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m21:10:27.347286 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m21:10:27.347392 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m21:10:27.348439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:10:27.348929 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m21:10:27.349144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c97fad0>]}
[0m21:10:27.349382 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 9[0m in 0.03s]
[0m21:10:27.349579 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m21:10:27.349707 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m21:10:27.349907 [info ] [Thread-1 (]: 3 of 10 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m21:10:27.350063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_users)
[0m21:10:27.350180 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m21:10:27.351446 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m21:10:27.351716 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m21:10:27.352830 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m21:10:27.352954 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp211027352307"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m21:10:27.353061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.359109 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.006 seconds
[0m21:10:27.360304 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m21:10:27.360429 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp211027352307'
        
      order by ordinal_position

  
[0m21:10:27.365799 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m21:10:27.366726 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m21:10:27.366839 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.368551 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m21:10:27.369561 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m21:10:27.369680 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.370676 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m21:10:27.372748 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m21:10:27.373022 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m21:10:27.373133 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp211027352307" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m21:10:27.377271 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m21:10:27.377740 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m21:10:27.377847 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m21:10:27.377939 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m21:10:27.378804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:10:27.379046 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m21:10:27.379243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb5f8b0>]}
[0m21:10:27.379467 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m21:10:27.379648 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m21:10:27.379775 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m21:10:27.379941 [info ] [Thread-1 (]: 4 of 10 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m21:10:27.380072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m21:10:27.380179 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m21:10:27.381127 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m21:10:27.399929 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.400119 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m21:10:27.400229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.409615 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m21:10:27.410651 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.410767 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.415612 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m21:10:27.418088 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.418238 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.419616 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m21:10:27.434485 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.434735 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp211027433841"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m21:10:27.438969 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m21:10:27.440007 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.440118 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp211027433841'
        
      order by ordinal_position

  
[0m21:10:27.441433 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m21:10:27.442338 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.442445 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.443496 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m21:10:27.444361 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.444464 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp211027433841'
        
      order by ordinal_position

  
[0m21:10:27.445437 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m21:10:27.446592 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.446715 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.449008 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m21:10:27.451402 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.451551 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp211027433841'
        
      order by ordinal_position

  
[0m21:10:27.453870 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m21:10:27.458875 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.459060 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m21:10:27.460525 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m21:10:27.461722 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.461825 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m21:10:27.462252 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:10:27.462404 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.462694 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.462804 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp211027433841" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp211027433841" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:10:27.463881 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m21:10:27.464469 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.464567 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m21:10:27.465060 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m21:10:27.465312 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m21:10:27.465411 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m21:10:27.465499 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m21:10:27.466269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:10:27.467048 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m21:10:27.467223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120bca50>]}
[0m21:10:27.467491 [info ] [Thread-1 (]: 4 of 10 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.09s]
[0m21:10:27.467681 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m21:10:27.467810 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m21:10:27.467982 [info ] [Thread-1 (]: 5 of 10 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m21:10:27.468181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m21:10:27.468316 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m21:10:27.469128 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m21:10:27.470198 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.470307 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m21:10:27.470405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.478195 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m21:10:27.479102 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.479213 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.485431 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m21:10:27.486560 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.486684 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.488496 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m21:10:27.490103 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.490288 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp211027489332"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m21:10:27.492735 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m21:10:27.493619 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.493760 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp211027489332'
        
      order by ordinal_position

  
[0m21:10:27.495325 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m21:10:27.496309 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.496422 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.498308 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m21:10:27.500449 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.500569 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp211027489332'
        
      order by ordinal_position

  
[0m21:10:27.502033 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m21:10:27.502942 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.503055 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.504057 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m21:10:27.504994 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.505103 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp211027489332'
        
      order by ordinal_position

  
[0m21:10:27.506086 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m21:10:27.506787 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.506978 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m21:10:27.507489 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:10:27.507993 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.508105 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m21:10:27.508416 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:10:27.508650 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.508975 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.509112 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp211027489332" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp211027489332" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:10:27.510411 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m21:10:27.511187 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.511308 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m21:10:27.511855 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m21:10:27.512151 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m21:10:27.512262 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m21:10:27.512360 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m21:10:27.513042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:10:27.513342 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m21:10:27.513526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1a8d0>]}
[0m21:10:27.513805 [info ] [Thread-1 (]: 5 of 10 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m21:10:27.513991 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m21:10:27.514117 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m21:10:27.514286 [info ] [Thread-1 (]: 6 of 10 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m21:10:27.514449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m21:10:27.514557 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m21:10:27.515417 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m21:10:27.516320 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.516434 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m21:10:27.516536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.523314 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m21:10:27.524474 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.524593 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.530637 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m21:10:27.531908 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.532043 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.533483 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m21:10:27.535236 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.535422 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp211027534392"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m21:10:27.537736 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m21:10:27.538671 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.538801 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp211027534392'
        
      order by ordinal_position

  
[0m21:10:27.540329 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m21:10:27.541373 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.541500 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.543518 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m21:10:27.544884 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.545031 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp211027534392'
        
      order by ordinal_position

  
[0m21:10:27.546176 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m21:10:27.547184 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.547312 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.548415 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m21:10:27.549605 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.549748 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp211027534392'
        
      order by ordinal_position

  
[0m21:10:27.552077 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m21:10:27.552816 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.552997 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m21:10:27.553502 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:10:27.554043 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.554161 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m21:10:27.554466 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:10:27.554643 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.554945 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.555071 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp211027534392" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp211027534392" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:10:27.555579 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m21:10:27.556399 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.556531 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m21:10:27.556852 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m21:10:27.557155 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m21:10:27.557286 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m21:10:27.557395 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m21:10:27.557841 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:10:27.558159 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m21:10:27.558363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120963c0>]}
[0m21:10:27.558662 [info ] [Thread-1 (]: 6 of 10 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m21:10:27.558862 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m21:10:27.558993 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m21:10:27.559168 [info ] [Thread-1 (]: 7 of 10 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m21:10:27.559342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m21:10:27.559459 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m21:10:27.560377 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m21:10:27.561326 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.561441 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m21:10:27.561546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.569072 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m21:10:27.570331 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.570460 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.576775 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m21:10:27.577932 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.578055 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.579585 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m21:10:27.581451 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.581694 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp211027580558"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m21:10:27.586912 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m21:10:27.587791 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.587925 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp211027580558'
        
      order by ordinal_position

  
[0m21:10:27.589524 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m21:10:27.590660 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.590806 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.592563 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m21:10:27.593916 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.594057 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp211027580558'
        
      order by ordinal_position

  
[0m21:10:27.595180 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m21:10:27.596286 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.596429 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m21:10:27.598089 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m21:10:27.599259 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.599400 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp211027580558'
        
      order by ordinal_position

  
[0m21:10:27.600555 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m21:10:27.601350 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.601571 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m21:10:27.602127 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:10:27.602702 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.602832 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m21:10:27.603150 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m21:10:27.603350 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.603693 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.603839 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp211027580558" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp211027580558" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:10:27.604350 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m21:10:27.605218 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.605351 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m21:10:27.605713 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m21:10:27.606036 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m21:10:27.606164 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m21:10:27.606279 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m21:10:27.606978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:10:27.607321 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m21:10:27.607533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112082ed0>]}
[0m21:10:27.607852 [info ] [Thread-1 (]: 7 of 10 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m21:10:27.608067 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m21:10:27.608208 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m21:10:27.608392 [info ] [Thread-1 (]: 8 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m21:10:27.608542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m21:10:27.608667 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m21:10:27.609847 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m21:10:27.610110 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m21:10:27.611655 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m21:10:27.611789 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp211027610840"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m21:10:27.611912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.618463 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m21:10:27.619501 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m21:10:27.619636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp211027610840'
        
      order by ordinal_position

  
[0m21:10:27.622586 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m21:10:27.623676 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m21:10:27.623815 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.625605 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m21:10:27.626893 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m21:10:27.627030 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.628113 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m21:10:27.628897 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m21:10:27.629216 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m21:10:27.629357 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp211027610840" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m21:10:27.629805 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m21:10:27.630287 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m21:10:27.630412 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m21:10:27.630522 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m21:10:27.630933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:10:27.631205 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m21:10:27.631428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112083050>]}
[0m21:10:27.631750 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m21:10:27.631980 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m21:10:27.632125 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m21:10:27.632316 [info ] [Thread-1 (]: 9 of 10 START sql incremental model public_pipedrive_staging.stg_deal_fields ... [RUN]
[0m21:10:27.632474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m21:10:27.632597 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m21:10:27.633826 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m21:10:27.634105 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m21:10:27.636409 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m21:10:27.636540 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp211027634824"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m21:10:27.636659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.643489 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m21:10:27.644522 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m21:10:27.644649 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp211027634824'
        
      order by ordinal_position

  
[0m21:10:27.647389 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m21:10:27.648719 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m21:10:27.648913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.650690 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m21:10:27.652107 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m21:10:27.652243 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.654723 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m21:10:27.655519 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m21:10:27.655830 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m21:10:27.655959 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp211027634824" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m21:10:27.657442 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m21:10:27.657916 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m21:10:27.658040 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m21:10:27.658143 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m21:10:27.659078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:10:27.659335 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m21:10:27.659536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cebadb0>]}
[0m21:10:27.659766 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m21:10:27.659960 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m21:10:27.660090 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m21:10:27.660262 [info ] [Thread-1 (]: 10 of 10 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m21:10:27.660398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m21:10:27.660512 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m21:10:27.663477 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m21:10:27.663719 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m21:10:27.665380 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m21:10:27.665534 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp211027664622"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m21:10:27.665658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:27.672208 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m21:10:27.673339 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m21:10:27.673484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp211027664622'
        
      order by ordinal_position

  
[0m21:10:27.678635 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m21:10:27.679902 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m21:10:27.680037 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.681165 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m21:10:27.682302 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m21:10:27.682457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m21:10:27.684038 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m21:10:27.684816 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m21:10:27.685124 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m21:10:27.685248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp211027664622" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m21:10:27.685640 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m21:10:27.686122 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m21:10:27.686240 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m21:10:27.686348 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m21:10:27.686947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:10:27.687201 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m21:10:27.687407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8383787d-a3a8-4ffc-8ac7-ea5a9e1d7401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceba450>]}
[0m21:10:27.687651 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m21:10:27.687859 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m21:10:27.688384 [debug] [MainThread]: On master: COMMIT
[0m21:10:27.688513 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:27.688612 [debug] [MainThread]: On master: COMMIT
[0m21:10:27.688705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:10:27.693369 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m21:10:27.693498 [debug] [MainThread]: On master: Close
[0m21:10:27.693641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:27.693731 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m21:10:27.693866 [info ] [MainThread]: 
[0m21:10:27.693975 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m21:10:27.694587 [debug] [MainThread]: Command end result
[0m21:10:27.704632 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m21:10:27.705459 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m21:10:27.708015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m21:10:27.708134 [info ] [MainThread]: 
[0m21:10:27.708260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:10:27.708357 [info ] [MainThread]: 
[0m21:10:27.708463 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m21:10:27.709682 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.92841387, "process_in_blocks": "0", "process_kernel_time": 0.115946, "process_mem_max_rss": "148258816", "process_out_blocks": "0", "process_user_time": 1.043263}
[0m21:10:27.709847 [debug] [MainThread]: Command `dbt build` succeeded at 21:10:27.709813 after 0.93 seconds
[0m21:10:27.709972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112023e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120230b0>]}
[0m21:10:27.710094 [debug] [MainThread]: Flushing usage events
[0m21:10:29.465414 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:06.494630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3797f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d333890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d333b10>]}


============================== 23:19:06.497145 | 4906dfa9-34fd-41be-9377-628b28f62841 ==============================
[0m23:19:06.497145 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:19:06.497376 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt build', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m23:19:06.566346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c61a9e0>]}
[0m23:19:06.585992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2969c0>]}
[0m23:19:06.586601 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:19:06.620825 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:19:06.670197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:19:06.670456 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m23:19:06.756320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e39a950>]}
[0m23:19:06.806666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:19:06.808144 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:19:06.823371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d39d9a0>]}
[0m23:19:06.823552 [info ] [MainThread]: Found 6 models, 4 snapshots, 6 sources, 464 macros
[0m23:19:06.824511 [info ] [MainThread]: 
[0m23:19:06.824632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:19:06.824725 [info ] [MainThread]: 
[0m23:19:06.824896 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:06.826373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:19:06.848373 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:19:06.848535 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:19:06.848625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:06.880085 [debug] [ThreadPool]: SQL status: SELECT 171 in 0.031 seconds
[0m23:19:06.880746 [debug] [ThreadPool]: On list_postgres: Close
[0m23:19:06.881496 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:19:06.881617 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:19:06.881699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:06.890112 [debug] [ThreadPool]: SQL status: SELECT 171 in 0.008 seconds
[0m23:19:06.890824 [debug] [ThreadPool]: On list_postgres: Close
[0m23:19:06.891395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m23:19:06.893326 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m23:19:06.893439 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m23:19:06.893528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:06.903401 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m23:19:06.903872 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m23:19:06.904287 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m23:19:06.904457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m23:19:06.905230 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m23:19:06.905330 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m23:19:06.905417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:06.914869 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m23:19:06.915267 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m23:19:06.915573 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m23:19:06.917525 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:06.917656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:19:06.917765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:06.927003 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m23:19:06.927371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4867b0>]}
[0m23:19:06.927519 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:06.927922 [debug] [MainThread]: On master: COMMIT
[0m23:19:06.928008 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:06.928098 [debug] [MainThread]: On master: COMMIT
[0m23:19:06.928617 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:19:06.928704 [debug] [MainThread]: On master: Close
[0m23:19:06.930368 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m23:19:06.930534 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m23:19:06.930680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m23:19:06.930790 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m23:19:06.933546 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:19:06.933780 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m23:19:06.952921 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:19:06.953079 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp231906944491"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m23:19:06.953186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:06.964185 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.011 seconds
[0m23:19:06.968732 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:19:06.968873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp231906944491'
        
      order by ordinal_position

  
[0m23:19:06.975629 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:19:06.977392 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:19:06.977527 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:06.980446 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:19:06.983571 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:19:06.983697 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:06.986033 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:19:06.994774 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:19:06.995060 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:19:06.995180 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp231906944491" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m23:19:07.004707 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.009 seconds
[0m23:19:07.009566 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:19:07.009689 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:19:07.009787 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:19:07.012336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:19:07.012962 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m23:19:07.013756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb80e20>]}
[0m23:19:07.014007 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m23:19:07.014216 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m23:19:07.014349 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:19:07.014529 [info ] [Thread-1 (]: 2 of 10 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m23:19:07.014670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m23:19:07.014783 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:19:07.015686 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:19:07.015893 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:19:07.021864 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:19:07.022118 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:19:07.022251 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  FIRST_VALUE(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  FIRST_VALUE(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  FIRST_VALUE(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  FIRST_VALUE(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes
WHERE deal_id = 881836
ORDER BY change_time DESC
  );
  
[0m23:19:07.022374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.033443 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.011 seconds
[0m23:19:07.037114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:19:07.037266 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m23:19:07.038259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:19:07.039351 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:19:07.039459 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:19:07.039965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:19:07.041078 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:19:07.041189 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:19:07.041287 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:19:07.042319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:07.044229 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m23:19:07.046194 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:19:07.046345 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m23:19:07.048271 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:19:07.048756 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:19:07.048964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4f7ad0>]}
[0m23:19:07.049187 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 9[0m in 0.03s]
[0m23:19:07.049383 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:19:07.049512 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m23:19:07.049699 [info ] [Thread-1 (]: 3 of 10 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m23:19:07.049848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_users)
[0m23:19:07.049959 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m23:19:07.051231 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m23:19:07.051464 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m23:19:07.052640 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:19:07.052757 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp231907052096"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m23:19:07.052861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.062343 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.009 seconds
[0m23:19:07.063554 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:19:07.063677 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp231907052096'
        
      order by ordinal_position

  
[0m23:19:07.070213 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:19:07.071231 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:19:07.071353 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:07.073759 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:19:07.074822 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:19:07.074942 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:07.075968 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:19:07.078244 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m23:19:07.078671 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:19:07.078808 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp231907052096" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m23:19:07.083022 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m23:19:07.083508 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:19:07.083621 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:19:07.083719 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:19:07.084590 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:07.084864 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m23:19:07.085070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6db800>]}
[0m23:19:07.085294 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.04s]
[0m23:19:07.085483 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m23:19:07.085619 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:19:07.085793 [info ] [Thread-1 (]: 4 of 10 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m23:19:07.085928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m23:19:07.086043 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:19:07.087032 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:19:07.106043 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.106235 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:19:07.106347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.115163 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m23:19:07.116226 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.116348 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.123003 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m23:19:07.125295 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.125431 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.127608 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:19:07.140925 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.141133 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp231907140352"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:19:07.144835 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:19:07.145828 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.145952 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp231907140352'
        
      order by ordinal_position

  
[0m23:19:07.148355 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:19:07.149307 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.149422 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.151620 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:19:07.152521 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.152628 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp231907140352'
        
      order by ordinal_position

  
[0m23:19:07.154621 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:19:07.155633 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.155745 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.157945 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:19:07.160108 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.160223 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp231907140352'
        
      order by ordinal_position

  
[0m23:19:07.162205 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:19:07.167468 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.167664 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:19:07.168499 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:19:07.169771 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.169883 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:19:07.170289 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:19:07.170447 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.170746 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.170873 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp231907140352" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp231907140352" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:19:07.171719 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:19:07.172337 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.172446 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m23:19:07.173019 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:19:07.173295 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:19:07.173404 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:19:07.173500 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:19:07.174505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:07.175334 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m23:19:07.175521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf8190>]}
[0m23:19:07.175805 [info ] [Thread-1 (]: 4 of 10 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.09s]
[0m23:19:07.176003 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:19:07.176124 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:19:07.176308 [info ] [Thread-1 (]: 5 of 10 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m23:19:07.176503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m23:19:07.176621 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:19:07.177440 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:19:07.178521 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.178636 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:19:07.178737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.186538 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m23:19:07.187547 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.187676 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.194926 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m23:19:07.196162 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.196290 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.197753 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:19:07.199504 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.199708 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp231907198683"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:19:07.201333 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:19:07.202135 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.202259 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp231907198683'
        
      order by ordinal_position

  
[0m23:19:07.204895 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:19:07.205818 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.205936 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.208306 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:19:07.210619 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.210748 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp231907198683'
        
      order by ordinal_position

  
[0m23:19:07.211802 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:19:07.212884 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.213017 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.214723 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:19:07.215773 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.215898 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp231907198683'
        
      order by ordinal_position

  
[0m23:19:07.217950 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:19:07.218651 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.218864 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:19:07.219407 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:19:07.219973 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.220094 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:19:07.220418 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:19:07.220612 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.221199 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.221355 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp231907198683" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp231907198683" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:19:07.221873 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:19:07.222652 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.222773 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m23:19:07.223110 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:19:07.223439 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:19:07.223559 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:19:07.223664 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:19:07.224194 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:19:07.224502 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m23:19:07.224692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5e68d0>]}
[0m23:19:07.224985 [info ] [Thread-1 (]: 5 of 10 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m23:19:07.225176 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:19:07.225303 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:19:07.225476 [info ] [Thread-1 (]: 6 of 10 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m23:19:07.225669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m23:19:07.225791 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:19:07.226710 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:19:07.227669 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.227785 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:19:07.227892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.233204 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:19:07.234515 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.234658 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.241153 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m23:19:07.242329 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.242459 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.244265 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:19:07.246302 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.246504 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp231907245299"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:19:07.248527 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:19:07.249396 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.249525 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp231907245299'
        
      order by ordinal_position

  
[0m23:19:07.251433 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:19:07.252512 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.252652 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.254519 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:19:07.255846 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.255987 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp231907245299'
        
      order by ordinal_position

  
[0m23:19:07.257314 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:19:07.258499 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.258648 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.260432 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:19:07.261566 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.261702 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp231907245299'
        
      order by ordinal_position

  
[0m23:19:07.262942 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:19:07.263794 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.264007 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:19:07.264547 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:19:07.265142 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.265273 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:19:07.265612 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:19:07.265829 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.266168 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.266312 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp231907245299" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp231907245299" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:19:07.266823 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:19:07.267679 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.267822 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m23:19:07.268756 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m23:19:07.269099 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:19:07.269234 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:19:07.269352 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:19:07.270376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:07.270730 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m23:19:07.270941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4bed60>]}
[0m23:19:07.271267 [info ] [Thread-1 (]: 6 of 10 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m23:19:07.271481 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:19:07.271621 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:19:07.271808 [info ] [Thread-1 (]: 7 of 10 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m23:19:07.272001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m23:19:07.272135 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:19:07.273161 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:19:07.274227 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.274356 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:19:07.274473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.279636 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:19:07.281042 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.281185 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.286007 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:19:07.287341 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.287486 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.289565 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:19:07.291419 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.291635 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp231907290534"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:19:07.295964 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m23:19:07.296914 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.297051 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp231907290534'
        
      order by ordinal_position

  
[0m23:19:07.298729 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:19:07.299948 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.300103 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.302239 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:19:07.303640 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.303794 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp231907290534'
        
      order by ordinal_position

  
[0m23:19:07.305500 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:19:07.306698 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.306850 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:19:07.308238 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:19:07.309400 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.309541 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp231907290534'
        
      order by ordinal_position

  
[0m23:19:07.311039 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:19:07.311861 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.312084 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:19:07.312671 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:19:07.313345 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.313484 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:19:07.313834 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:19:07.314038 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.314356 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.314502 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp231907290534" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp231907290534" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:19:07.315045 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:19:07.315917 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.316054 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m23:19:07.316425 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:19:07.316758 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:19:07.316890 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:19:07.317014 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:19:07.317469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:19:07.317805 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m23:19:07.318025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebc2390>]}
[0m23:19:07.318358 [info ] [Thread-1 (]: 7 of 10 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m23:19:07.318588 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:19:07.318740 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:19:07.318917 [info ] [Thread-1 (]: 8 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m23:19:07.319130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m23:19:07.319285 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m23:19:07.320539 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:19:07.320820 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m23:19:07.322480 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:19:07.322620 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp231907321588"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m23:19:07.322752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.329756 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m23:19:07.330913 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:19:07.331056 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp231907321588'
        
      order by ordinal_position

  
[0m23:19:07.334942 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:19:07.336147 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:19:07.336296 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:07.338098 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:19:07.339624 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:19:07.339782 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:07.341084 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:19:07.341954 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:19:07.342309 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:19:07.342466 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp231907321588" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m23:19:07.342939 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:19:07.343511 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:19:07.343649 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:19:07.343771 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:19:07.344497 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:07.344771 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m23:19:07.344985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebc17f0>]}
[0m23:19:07.345249 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.03s]
[0m23:19:07.345467 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:19:07.345612 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m23:19:07.345794 [info ] [Thread-1 (]: 9 of 10 START sql incremental model public_pipedrive_staging.stg_deal_fields ... [RUN]
[0m23:19:07.345947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m23:19:07.346072 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m23:19:07.347310 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:19:07.347566 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m23:19:07.349863 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:19:07.350000 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp231907348304"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:19:07.350122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.356322 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:19:07.357528 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:19:07.357668 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp231907348304'
        
      order by ordinal_position

  
[0m23:19:07.361666 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:19:07.362830 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:19:07.362969 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:07.364652 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:19:07.366118 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:19:07.366267 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:07.367630 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:19:07.368476 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:19:07.368795 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:19:07.368932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp231907348304" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m23:19:07.369536 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:19:07.370061 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:19:07.370191 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:19:07.370306 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:19:07.370795 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:19:07.371073 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m23:19:07.371296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea37590>]}
[0m23:19:07.371552 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m23:19:07.371773 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m23:19:07.371919 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m23:19:07.372077 [info ] [Thread-1 (]: 10 of 10 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m23:19:07.372254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m23:19:07.372378 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m23:19:07.375549 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:19:07.375863 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m23:19:07.377472 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:19:07.377616 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp231907376845"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m23:19:07.377740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:07.384594 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:19:07.385705 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:19:07.385844 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp231907376845'
        
      order by ordinal_position

  
[0m23:19:07.390425 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m23:19:07.391636 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:19:07.391768 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:07.393087 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:19:07.394132 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:19:07.394261 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:19:07.395481 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:19:07.396394 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:19:07.396754 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:19:07.396899 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp231907376845" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m23:19:07.397322 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m23:19:07.397882 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:19:07.398012 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:19:07.398129 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:19:07.398758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:07.399020 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m23:19:07.399227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4906dfa9-34fd-41be-9377-628b28f62841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea359d0>]}
[0m23:19:07.399465 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m23:19:07.399674 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m23:19:07.400205 [debug] [MainThread]: On master: COMMIT
[0m23:19:07.400329 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:07.400427 [debug] [MainThread]: On master: COMMIT
[0m23:19:07.400518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:19:07.405097 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m23:19:07.405234 [debug] [MainThread]: On master: Close
[0m23:19:07.405389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:07.405489 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m23:19:07.405638 [info ] [MainThread]: 
[0m23:19:07.405756 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m23:19:07.406418 [debug] [MainThread]: Command end result
[0m23:19:07.416405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:19:07.417208 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:19:07.419729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m23:19:07.419847 [info ] [MainThread]: 
[0m23:19:07.419974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:19:07.420069 [info ] [MainThread]: 
[0m23:19:07.420177 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m23:19:07.422169 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.9541256, "process_in_blocks": "0", "process_kernel_time": 0.150458, "process_mem_max_rss": "148242432", "process_out_blocks": "0", "process_user_time": 1.032951}
[0m23:19:07.422338 [debug] [MainThread]: Command `dbt build` succeeded at 23:19:07.422303 after 0.95 seconds
[0m23:19:07.422466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cca3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb5fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb5ebd0>]}
[0m23:19:07.422588 [debug] [MainThread]: Flushing usage events
[0m23:19:09.023164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:01.044600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b307890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b307b10>]}


============================== 23:21:01.046200 | 6b470a16-fcd4-48ab-b28f-f84aa399e1a3 ==============================
[0m23:21:01.046200 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:21:01.046432 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'empty': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m23:21:01.100723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ee9e0>]}
[0m23:21:01.119570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26a9c0>]}
[0m23:21:01.119912 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:21:01.149327 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:21:01.191870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:21:01.192120 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m23:21:01.276373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c2950>]}
[0m23:21:01.330274 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:21:01.331087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:21:01.340368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3719a0>]}
[0m23:21:01.340563 [info ] [MainThread]: Found 6 models, 4 snapshots, 6 sources, 464 macros
[0m23:21:01.341471 [info ] [MainThread]: 
[0m23:21:01.341595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:01.341687 [info ] [MainThread]: 
[0m23:21:01.341865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:01.343332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:21:01.361665 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:21:01.361821 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:21:01.361921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:01.380139 [debug] [ThreadPool]: SQL status: SELECT 177 in 0.018 seconds
[0m23:21:01.380847 [debug] [ThreadPool]: On list_postgres: Close
[0m23:21:01.381643 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:21:01.381791 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:21:01.381898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:01.390924 [debug] [ThreadPool]: SQL status: SELECT 177 in 0.009 seconds
[0m23:21:01.391634 [debug] [ThreadPool]: On list_postgres: Close
[0m23:21:01.392232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m23:21:01.394253 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m23:21:01.394406 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m23:21:01.394536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:01.404556 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m23:21:01.404993 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m23:21:01.405368 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m23:21:01.405533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m23:21:01.406346 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m23:21:01.406455 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m23:21:01.406548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:01.415241 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m23:21:01.415640 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m23:21:01.415948 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m23:21:01.417957 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:01.418089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:21:01.418202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:21:01.426756 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m23:21:01.427109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c39e7b0>]}
[0m23:21:01.427275 [debug] [MainThread]: On master: ROLLBACK
[0m23:21:01.427650 [debug] [MainThread]: On master: COMMIT
[0m23:21:01.427741 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:01.427821 [debug] [MainThread]: On master: COMMIT
[0m23:21:01.428354 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:21:01.428448 [debug] [MainThread]: On master: Close
[0m23:21:01.429235 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m23:21:01.429406 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m23:21:01.429552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m23:21:01.429661 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m23:21:01.432494 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:21:01.432783 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m23:21:01.452492 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:21:01.452644 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp232101443537"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m23:21:01.452751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.463058 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.010 seconds
[0m23:21:01.467761 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:21:01.467897 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp232101443537'
        
      order by ordinal_position

  
[0m23:21:01.474569 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:21:01.476259 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:21:01.476381 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.478975 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:21:01.482093 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:21:01.482221 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.484449 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:21:01.492604 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:21:01.492944 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:21:01.493086 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp232101443537" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m23:21:01.502704 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.009 seconds
[0m23:21:01.507603 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:21:01.507730 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:21:01.507835 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:21:01.510642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:21:01.511272 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m23:21:01.511864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caa8e20>]}
[0m23:21:01.512096 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m23:21:01.512303 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m23:21:01.512431 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:21:01.512621 [info ] [Thread-1 (]: 2 of 10 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m23:21:01.512791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m23:21:01.512908 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:21:01.513939 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:21:01.514167 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:21:01.520884 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:21:01.521267 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:21:01.521416 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  LAST_VALUE(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  LAST_VALUE(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  LAST_VALUE(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  LAST_VALUE(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes
WHERE deal_id = 881836
ORDER BY change_time DESC
  );
  
[0m23:21:01.521550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.530290 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.009 seconds
[0m23:21:01.533825 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:21:01.533960 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m23:21:01.534568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:01.535800 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:21:01.535926 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:21:01.536716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:21:01.537886 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:21:01.537991 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:21:01.538081 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:21:01.538856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:21:01.540724 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m23:21:01.542213 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:21:01.542318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m23:21:01.544435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:21:01.544862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:21:01.545052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c423ad0>]}
[0m23:21:01.545252 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 9[0m in 0.03s]
[0m23:21:01.545436 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:21:01.545547 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m23:21:01.545718 [info ] [Thread-1 (]: 3 of 10 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m23:21:01.545876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_users)
[0m23:21:01.545981 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m23:21:01.547160 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m23:21:01.547392 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m23:21:01.548503 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:21:01.548612 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp232101547983"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m23:21:01.548708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.558258 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.010 seconds
[0m23:21:01.559361 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:21:01.559481 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp232101547983'
        
      order by ordinal_position

  
[0m23:21:01.565140 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:21:01.566039 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:21:01.566148 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.568451 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:21:01.569353 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:21:01.569459 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.572471 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:21:01.574671 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m23:21:01.574962 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:21:01.575080 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp232101547983" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m23:21:01.578304 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.003 seconds
[0m23:21:01.578853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:21:01.578977 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:21:01.579081 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:21:01.579843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:21:01.580113 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m23:21:01.580318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5eb800>]}
[0m23:21:01.580539 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m23:21:01.580723 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m23:21:01.580852 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:21:01.581019 [info ] [Thread-1 (]: 4 of 10 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m23:21:01.581150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m23:21:01.581261 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:21:01.582240 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:21:01.600686 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.600860 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:21:01.600972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.609738 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m23:21:01.610812 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.610926 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.616146 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:21:01.618272 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.618397 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.620289 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:21:01.632868 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.633062 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp232101632348"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:21:01.637410 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m23:21:01.638354 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.638476 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232101632348'
        
      order by ordinal_position

  
[0m23:21:01.639637 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:21:01.640543 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.640653 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.642203 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:21:01.643035 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.643139 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232101632348'
        
      order by ordinal_position

  
[0m23:21:01.644612 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:21:01.645691 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.645805 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.646831 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:21:01.649148 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.649277 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232101632348'
        
      order by ordinal_position

  
[0m23:21:01.652223 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m23:21:01.657564 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.657768 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:21:01.659033 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:21:01.660325 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.660442 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:21:01.660880 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:21:01.661044 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.661351 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.661478 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp232101632348" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp232101632348" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:21:01.662760 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:21:01.663395 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.663505 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m23:21:01.664039 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:21:01.664323 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:21:01.664435 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:21:01.664530 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:21:01.665502 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:21:01.666348 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m23:21:01.666535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb23430>]}
[0m23:21:01.666824 [info ] [Thread-1 (]: 4 of 10 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.09s]
[0m23:21:01.667020 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:21:01.667148 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:21:01.667336 [info ] [Thread-1 (]: 5 of 10 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m23:21:01.667544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m23:21:01.667688 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:21:01.668535 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:21:01.669642 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.669758 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:21:01.669861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.678030 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m23:21:01.679042 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.679162 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.685839 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m23:21:01.686979 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.687102 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.688712 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:21:01.690381 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.690580 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp232101689591"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:21:01.692828 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:21:01.693699 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.693829 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232101689591'
        
      order by ordinal_position

  
[0m23:21:01.695438 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:21:01.696480 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.696611 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.699262 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:21:01.701512 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.701637 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232101689591'
        
      order by ordinal_position

  
[0m23:21:01.704179 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:21:01.705168 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.705292 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.707349 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:21:01.708403 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.708532 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232101689591'
        
      order by ordinal_position

  
[0m23:21:01.709911 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:21:01.710597 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.710792 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:21:01.711309 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:21:01.711839 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.711954 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:21:01.712232 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:21:01.712393 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.712693 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.712815 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp232101689591" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp232101689591" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:21:01.713318 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:21:01.714195 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.714330 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m23:21:01.714717 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:21:01.715089 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:21:01.715225 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:21:01.715339 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:21:01.715902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:21:01.716231 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m23:21:01.716430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7f5d0>]}
[0m23:21:01.716729 [info ] [Thread-1 (]: 5 of 10 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m23:21:01.716923 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:21:01.717053 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:21:01.717226 [info ] [Thread-1 (]: 6 of 10 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m23:21:01.717408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m23:21:01.717530 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:21:01.718431 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:21:01.719370 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.719493 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:21:01.719605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.726459 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:21:01.727827 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.727969 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.731143 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:21:01.732250 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.732378 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.733883 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:21:01.735683 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.735877 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp232101734860"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:21:01.739851 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m23:21:01.740724 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.740864 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232101734860'
        
      order by ordinal_position

  
[0m23:21:01.742835 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:21:01.744010 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.744153 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.745870 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:21:01.747154 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.747290 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232101734860'
        
      order by ordinal_position

  
[0m23:21:01.748725 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:21:01.749728 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.749856 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.751062 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:21:01.752099 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.752227 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232101734860'
        
      order by ordinal_position

  
[0m23:21:01.753681 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:21:01.754386 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.754569 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:21:01.755248 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:21:01.755795 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.755917 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:21:01.756894 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:21:01.757070 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.757373 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.757505 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp232101734860" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp232101734860" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:21:01.758671 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:21:01.759489 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.759629 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m23:21:01.760123 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:21:01.760438 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:21:01.760584 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:21:01.760718 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:21:01.761396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:21:01.761731 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m23:21:01.761941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca24520>]}
[0m23:21:01.762253 [info ] [Thread-1 (]: 6 of 10 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:21:01.762462 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:21:01.762597 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:21:01.762784 [info ] [Thread-1 (]: 7 of 10 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m23:21:01.762980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m23:21:01.763130 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:21:01.764152 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:21:01.765199 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.765327 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:21:01.765445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.771472 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:21:01.772930 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.773079 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.778489 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:21:01.779744 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.779886 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.781257 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:21:01.783123 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.783344 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp232101782252"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:21:01.788654 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:21:01.789614 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.789748 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232101782252'
        
      order by ordinal_position

  
[0m23:21:01.791077 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:21:01.792178 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.792311 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.793842 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:21:01.795225 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.795369 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232101782252'
        
      order by ordinal_position

  
[0m23:21:01.796866 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:21:01.797957 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.798101 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:21:01.799479 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:21:01.800784 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.800939 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232101782252'
        
      order by ordinal_position

  
[0m23:21:01.802318 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:21:01.803129 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.803357 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:21:01.804016 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:21:01.804727 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.804875 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:21:01.805214 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:21:01.805410 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.805712 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.805858 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp232101782252" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp232101782252" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:21:01.806428 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:21:01.807335 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.807478 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m23:21:01.807843 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:21:01.808191 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:21:01.808326 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:21:01.808446 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:21:01.808892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:21:01.809234 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m23:21:01.809452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cae5130>]}
[0m23:21:01.809789 [info ] [Thread-1 (]: 7 of 10 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m23:21:01.810023 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:21:01.810171 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:21:01.810360 [info ] [Thread-1 (]: 8 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m23:21:01.810513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m23:21:01.810672 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m23:21:01.811961 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:21:01.812222 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m23:21:01.813850 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:21:01.813982 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp232101812991"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m23:21:01.814101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.819865 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:21:01.821137 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:21:01.821289 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp232101812991'
        
      order by ordinal_position

  
[0m23:21:01.825310 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:21:01.826522 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:21:01.826671 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.828016 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:21:01.829553 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:21:01.829715 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.830835 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:21:01.831647 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:21:01.831985 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:21:01.832126 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp232101812991" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m23:21:01.832590 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:21:01.833079 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:21:01.833201 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:21:01.833312 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:21:01.833797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:21:01.834056 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m23:21:01.834265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cae63f0>]}
[0m23:21:01.834517 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m23:21:01.834730 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:21:01.834869 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m23:21:01.835074 [info ] [Thread-1 (]: 9 of 10 START sql incremental model public_pipedrive_staging.stg_deal_fields ... [RUN]
[0m23:21:01.835254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m23:21:01.835391 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m23:21:01.836622 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:21:01.836906 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m23:21:01.839370 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:21:01.839508 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp232101837694"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:21:01.839632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.845752 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:21:01.846950 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:21:01.847096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp232101837694'
        
      order by ordinal_position

  
[0m23:21:01.853130 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:21:01.854220 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:21:01.854357 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.856517 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:21:01.857970 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:21:01.858109 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.859758 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:21:01.860713 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:21:01.861057 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:21:01.861202 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp232101837694" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m23:21:01.861902 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m23:21:01.862424 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:21:01.862551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:21:01.862665 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:21:01.863358 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:21:01.863632 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m23:21:01.863844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c955610>]}
[0m23:21:01.864093 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m23:21:01.864306 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m23:21:01.864446 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m23:21:01.864630 [info ] [Thread-1 (]: 10 of 10 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m23:21:01.864779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m23:21:01.864903 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m23:21:01.868071 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:21:01.868338 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m23:21:01.870269 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:21:01.870491 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp232101869514"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m23:21:01.870633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:01.877197 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:21:01.878659 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:21:01.878839 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp232101869514'
        
      order by ordinal_position

  
[0m23:21:01.882775 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m23:21:01.884202 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:21:01.884349 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.885949 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:21:01.887080 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:21:01.887223 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:21:01.888776 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:21:01.889550 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:21:01.889914 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:21:01.890045 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp232101869514" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m23:21:01.890446 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m23:21:01.890936 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:21:01.891058 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:21:01.891169 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:21:01.891622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:21:01.891885 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m23:21:01.892110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b470a16-fcd4-48ab-b28f-f84aa399e1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c955610>]}
[0m23:21:01.892366 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m23:21:01.892591 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m23:21:01.893177 [debug] [MainThread]: On master: COMMIT
[0m23:21:01.893295 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:01.893389 [debug] [MainThread]: On master: COMMIT
[0m23:21:01.893480 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:21:01.898729 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m23:21:01.898925 [debug] [MainThread]: On master: Close
[0m23:21:01.899106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:01.899212 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m23:21:01.899369 [info ] [MainThread]: 
[0m23:21:01.899497 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 1 table model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m23:21:01.900167 [debug] [MainThread]: Command end result
[0m23:21:01.910634 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:21:01.911567 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:21:01.914179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m23:21:01.914304 [info ] [MainThread]: 
[0m23:21:01.914434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:21:01.914531 [info ] [MainThread]: 
[0m23:21:01.914641 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m23:21:01.915883 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.89453226, "process_in_blocks": "0", "process_kernel_time": 0.12303, "process_mem_max_rss": "148275200", "process_out_blocks": "0", "process_user_time": 1.033715}
[0m23:21:01.916045 [debug] [MainThread]: Command `dbt build` succeeded at 23:21:01.916013 after 0.89 seconds
[0m23:21:01.916173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ef050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca87410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca86c90>]}
[0m23:21:01.916291 [debug] [MainThread]: Flushing usage events
[0m23:21:03.480237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:18.977790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1f17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ab890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1abb10>]}


============================== 23:22:18.979442 | 53916f8d-8c76-4eed-8154-c240d9e25ec9 ==============================
[0m23:22:18.979442 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:22:18.979686 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt build'}
[0m23:22:19.033710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4929e0>]}
[0m23:22:19.052801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b10e9c0>]}
[0m23:22:19.053106 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:22:19.082806 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:22:19.124887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:22:19.125150 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m23:22:19.207906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c166950>]}
[0m23:22:19.259637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:22:19.260479 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:22:19.269623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2159a0>]}
[0m23:22:19.269803 [info ] [MainThread]: Found 6 models, 4 snapshots, 6 sources, 464 macros
[0m23:22:19.270739 [info ] [MainThread]: 
[0m23:22:19.270868 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:22:19.270960 [info ] [MainThread]: 
[0m23:22:19.271129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:22:19.272586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:22:19.290449 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:22:19.290603 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:22:19.290692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:19.312423 [debug] [ThreadPool]: SQL status: SELECT 179 in 0.022 seconds
[0m23:22:19.313139 [debug] [ThreadPool]: On list_postgres: Close
[0m23:22:19.313913 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:22:19.314040 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:22:19.314132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:19.323136 [debug] [ThreadPool]: SQL status: SELECT 179 in 0.009 seconds
[0m23:22:19.323821 [debug] [ThreadPool]: On list_postgres: Close
[0m23:22:19.324433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m23:22:19.326434 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m23:22:19.326550 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m23:22:19.326641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:19.336315 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m23:22:19.336772 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m23:22:19.337159 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m23:22:19.337318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m23:22:19.338161 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m23:22:19.338261 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m23:22:19.338350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:19.346707 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m23:22:19.347094 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m23:22:19.347384 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m23:22:19.349265 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:19.349396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:22:19.349503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:19.357451 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:22:19.357836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c251ef0>]}
[0m23:22:19.357989 [debug] [MainThread]: On master: ROLLBACK
[0m23:22:19.358269 [debug] [MainThread]: On master: COMMIT
[0m23:22:19.358368 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:19.358448 [debug] [MainThread]: On master: COMMIT
[0m23:22:19.358839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:22:19.358927 [debug] [MainThread]: On master: Close
[0m23:22:19.359772 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m23:22:19.359986 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m23:22:19.360160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activities)
[0m23:22:19.360310 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m23:22:19.363231 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:22:19.363522 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m23:22:19.383629 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:22:19.383799 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp232219374634"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m23:22:19.383907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.394802 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.011 seconds
[0m23:22:19.399564 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:22:19.399688 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp232219374634'
        
      order by ordinal_position

  
[0m23:22:19.405936 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m23:22:19.407614 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:22:19.407734 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.409958 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:22:19.413063 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:22:19.413184 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.415173 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:22:19.423174 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:22:19.423519 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:22:19.423666 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp232219374634" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m23:22:19.432116 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.008 seconds
[0m23:22:19.436985 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:22:19.437111 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:22:19.437211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:22:19.438401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:19.439016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m23:22:19.439642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c94ce20>]}
[0m23:22:19.439876 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m23:22:19.440071 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m23:22:19.440203 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:22:19.440351 [info ] [Thread-1 (]: 2 of 10 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m23:22:19.440523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m23:22:19.440631 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:22:19.441563 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:22:19.441783 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:22:19.447799 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:22:19.448077 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:22:19.448213 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  MAX(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  MAX(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  MAX(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  MAX(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes
WHERE deal_id = 881836
ORDER BY change_time DESC
  );
  
[0m23:22:19.448339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.458141 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.010 seconds
[0m23:22:19.461926 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:22:19.462067 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m23:22:19.462660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:19.463730 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:22:19.463832 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:22:19.464222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:22:19.465247 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:22:19.465350 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:22:19.465438 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:22:19.466345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:19.468190 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m23:22:19.469725 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:22:19.469835 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m23:22:19.471152 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:22:19.471651 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:22:19.471929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c7ad0>]}
[0m23:22:19.472177 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 9[0m in 0.03s]
[0m23:22:19.472382 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:22:19.472507 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m23:22:19.472679 [info ] [Thread-1 (]: 3 of 10 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m23:22:19.472829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_users)
[0m23:22:19.472928 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m23:22:19.474154 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m23:22:19.474400 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m23:22:19.475509 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:22:19.475613 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp232219474996"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m23:22:19.475710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.484736 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.009 seconds
[0m23:22:19.485944 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:22:19.486091 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp232219474996'
        
      order by ordinal_position

  
[0m23:22:19.492265 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:22:19.493166 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:22:19.493295 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.494791 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:22:19.495817 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:22:19.495928 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.498267 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:22:19.500477 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m23:22:19.500770 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:22:19.500887 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp232219474996" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m23:22:19.506591 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.006 seconds
[0m23:22:19.507101 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:22:19.507240 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:22:19.507347 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:22:19.508331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:19.508611 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m23:22:19.508818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c49b800>]}
[0m23:22:19.509045 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.04s]
[0m23:22:19.509239 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m23:22:19.509370 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:22:19.509537 [info ] [Thread-1 (]: 4 of 10 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m23:22:19.509670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m23:22:19.509778 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:22:19.510758 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:22:19.529188 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.529356 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:22:19.529462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.538332 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m23:22:19.539329 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.539441 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.544763 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:22:19.546850 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.546970 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.548395 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:22:19.560991 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.561185 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp232219560468"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:22:19.564646 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:22:19.565523 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.565629 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232219560468'
        
      order by ordinal_position

  
[0m23:22:19.567672 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:22:19.568529 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.568631 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.571116 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:22:19.571990 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.572096 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232219560468'
        
      order by ordinal_position

  
[0m23:22:19.574148 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:22:19.575135 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.575241 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.576683 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:22:19.578723 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.578830 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232219560468'
        
      order by ordinal_position

  
[0m23:22:19.580161 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:22:19.585435 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.585635 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:22:19.586623 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:22:19.587886 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.587997 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:22:19.588409 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:22:19.588571 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.588870 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.589003 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp232219560468" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp232219560468" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:22:19.589862 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:22:19.590490 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.590596 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m23:22:19.591093 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:22:19.591366 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:22:19.591471 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:22:19.591565 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:22:19.592523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:19.593352 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m23:22:19.593568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9c7430>]}
[0m23:22:19.593896 [info ] [Thread-1 (]: 4 of 10 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.08s]
[0m23:22:19.594102 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:22:19.594235 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:22:19.594407 [info ] [Thread-1 (]: 5 of 10 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m23:22:19.594576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m23:22:19.594686 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:22:19.595528 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:22:19.596613 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.596722 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:22:19.596822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.604028 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:22:19.605007 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.605124 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.610965 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:22:19.612046 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.612155 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.613591 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:22:19.615295 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.615494 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp232219614497"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:22:19.617868 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:22:19.618666 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.618785 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232219614497'
        
      order by ordinal_position

  
[0m23:22:19.620594 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:22:19.621547 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.621665 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.623315 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:22:19.625557 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.625682 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232219614497'
        
      order by ordinal_position

  
[0m23:22:19.628052 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:22:19.628997 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.629114 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.631505 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:22:19.632476 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.632594 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232219614497'
        
      order by ordinal_position

  
[0m23:22:19.634693 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:22:19.635363 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.635549 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:22:19.636101 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:22:19.636651 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.636773 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:22:19.637082 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:22:19.637251 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.637556 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.637678 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp232219614497" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp232219614497" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:22:19.638159 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:22:19.638892 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.639007 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m23:22:19.639324 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:22:19.639600 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:22:19.639711 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:22:19.639810 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:22:19.640237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:22:19.640526 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m23:22:19.640717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfd10d0>]}
[0m23:22:19.641004 [info ] [Thread-1 (]: 5 of 10 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m23:22:19.641190 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:22:19.641315 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:22:19.641484 [info ] [Thread-1 (]: 6 of 10 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m23:22:19.641668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m23:22:19.641791 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:22:19.642675 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:22:19.643884 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.644010 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:22:19.644122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.648752 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:22:19.650215 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.650362 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.653984 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:22:19.655187 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.655308 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.656665 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:22:19.658475 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.658669 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp232219657635"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:22:19.661878 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:22:19.662759 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.662881 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232219657635'
        
      order by ordinal_position

  
[0m23:22:19.665246 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:22:19.666202 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.666318 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.668577 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:22:19.669762 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.669883 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232219657635'
        
      order by ordinal_position

  
[0m23:22:19.672465 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:22:19.673543 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.673681 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.675279 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:22:19.676270 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.676388 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232219657635'
        
      order by ordinal_position

  
[0m23:22:19.677583 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:22:19.678263 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.678447 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:22:19.678929 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:22:19.679485 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.679610 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:22:19.679934 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:22:19.680134 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.680435 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.680570 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp232219657635" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp232219657635" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:22:19.681765 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:22:19.682585 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.682713 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m23:22:19.683164 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:22:19.683474 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:22:19.683594 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:22:19.683707 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:22:19.684378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:19.684699 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m23:22:19.684899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c96df60>]}
[0m23:22:19.685195 [info ] [Thread-1 (]: 6 of 10 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:22:19.685396 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:22:19.685527 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:22:19.685707 [info ] [Thread-1 (]: 7 of 10 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m23:22:19.685881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m23:22:19.685999 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:22:19.686930 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:22:19.687911 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.688029 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:22:19.688142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.694378 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:22:19.695756 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.695889 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.699838 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:22:19.701038 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.701170 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.702423 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:22:19.704263 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.704478 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp232219703416"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:22:19.709854 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:22:19.710812 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.710944 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232219703416'
        
      order by ordinal_position

  
[0m23:22:19.712265 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:22:19.713358 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.713491 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.714769 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:22:19.716048 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.716175 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232219703416'
        
      order by ordinal_position

  
[0m23:22:19.717260 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:22:19.718319 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.718452 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:22:19.720135 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:22:19.721223 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.721352 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232219703416'
        
      order by ordinal_position

  
[0m23:22:19.722434 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:22:19.723205 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.723410 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:22:19.723941 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:22:19.724511 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.724636 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:22:19.724948 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:22:19.725132 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.725429 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.725567 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp232219703416" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp232219703416" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:22:19.726068 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:22:19.726876 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.727002 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m23:22:19.727352 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:22:19.727667 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:22:19.727799 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:22:19.727916 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:22:19.728441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:22:19.728817 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m23:22:19.729040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c29e0f0>]}
[0m23:22:19.729368 [info ] [Thread-1 (]: 7 of 10 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.04s]
[0m23:22:19.729588 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:22:19.729731 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:22:19.729915 [info ] [Thread-1 (]: 8 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m23:22:19.730063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m23:22:19.730185 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m23:22:19.731384 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:22:19.731650 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m23:22:19.733228 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:22:19.733358 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp232219732392"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m23:22:19.733475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.739437 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:22:19.740661 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:22:19.740814 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp232219732392'
        
      order by ordinal_position

  
[0m23:22:19.744135 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:22:19.745253 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:22:19.745390 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.747076 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:22:19.748351 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:22:19.748480 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.750811 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:22:19.751654 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:22:19.751971 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:22:19.752110 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp232219732392" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m23:22:19.752578 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:22:19.753092 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:22:19.753212 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:22:19.753317 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:22:19.753943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:19.754195 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m23:22:19.754398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c989010>]}
[0m23:22:19.754635 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m23:22:19.754832 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:22:19.754966 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m23:22:19.755132 [info ] [Thread-1 (]: 9 of 10 START sql incremental model public_pipedrive_staging.stg_deal_fields ... [RUN]
[0m23:22:19.755271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m23:22:19.755389 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m23:22:19.756593 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:22:19.756816 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m23:22:19.759017 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:22:19.759143 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp232219757514"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:22:19.759256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.766984 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m23:22:19.768126 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:22:19.768261 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp232219757514'
        
      order by ordinal_position

  
[0m23:22:19.773308 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:22:19.774355 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:22:19.774484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.776021 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:22:19.777432 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:22:19.777569 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.779041 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:22:19.779856 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:22:19.780152 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:22:19.780277 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp232219757514" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m23:22:19.780851 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:22:19.781311 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:22:19.781426 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:22:19.781530 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:22:19.782298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:22:19.782541 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m23:22:19.782742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4a1370>]}
[0m23:22:19.782975 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m23:22:19.783176 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m23:22:19.783312 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m23:22:19.783461 [info ] [Thread-1 (]: 10 of 10 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m23:22:19.783636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m23:22:19.783768 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m23:22:19.786775 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:22:19.787049 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m23:22:19.788581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:22:19.788720 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp232219787974"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m23:22:19.788851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:19.794119 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:22:19.795407 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:22:19.795559 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp232219787974'
        
      order by ordinal_position

  
[0m23:22:19.799002 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m23:22:19.800240 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:22:19.800362 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.802121 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:22:19.803165 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:22:19.803289 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:22:19.804773 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:22:19.805463 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:22:19.805783 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:22:19.805909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp232219787974" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m23:22:19.806323 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m23:22:19.806853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:22:19.806977 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:22:19.807085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:22:19.807572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:22:19.807825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m23:22:19.808030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53916f8d-8c76-4eed-8154-c240d9e25ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c29f1d0>]}
[0m23:22:19.808262 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.02s]
[0m23:22:19.808456 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m23:22:19.808982 [debug] [MainThread]: On master: COMMIT
[0m23:22:19.809127 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:19.809231 [debug] [MainThread]: On master: COMMIT
[0m23:22:19.809323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:22:19.814110 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m23:22:19.814289 [debug] [MainThread]: On master: Close
[0m23:22:19.814460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:19.814560 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m23:22:19.814706 [info ] [MainThread]: 
[0m23:22:19.814821 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m23:22:19.815449 [debug] [MainThread]: Command end result
[0m23:22:19.825106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:22:19.825798 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:22:19.828295 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m23:22:19.828403 [info ] [MainThread]: 
[0m23:22:19.828524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:22:19.828616 [info ] [MainThread]: 
[0m23:22:19.828738 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m23:22:19.830072 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8756859, "process_in_blocks": "0", "process_kernel_time": 0.122016, "process_mem_max_rss": "148291584", "process_out_blocks": "0", "process_user_time": 1.017645}
[0m23:22:19.830238 [debug] [MainThread]: Command `dbt build` succeeded at 23:22:19.830205 after 0.88 seconds
[0m23:22:19.830370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c98a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9895b0>]}
[0m23:22:19.830500 [debug] [MainThread]: Flushing usage events
[0m23:22:21.740846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:51.917349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ab890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095abb10>]}


============================== 23:26:51.919039 | e1c07546-6601-490c-8929-bec2a1f5bc3c ==============================
[0m23:26:51.919039 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:26:51.919277 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'introspect': 'True', 'invocation_command': 'dbt build', 'empty': 'False', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs'}
[0m23:26:51.973992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088929e0>]}
[0m23:26:51.993074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950e9c0>]}
[0m23:26:51.993438 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:26:52.023337 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:26:52.067660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:26:52.067938 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m23:26:52.152923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a612950>]}
[0m23:26:52.204648 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:26:52.205429 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:26:52.214682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096159a0>]}
[0m23:26:52.214869 [info ] [MainThread]: Found 6 models, 4 snapshots, 6 sources, 464 macros
[0m23:26:52.215788 [info ] [MainThread]: 
[0m23:26:52.215919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:52.216016 [info ] [MainThread]: 
[0m23:26:52.216184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:52.217600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:26:52.235890 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:26:52.236054 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:26:52.236147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:52.255925 [debug] [ThreadPool]: SQL status: SELECT 179 in 0.020 seconds
[0m23:26:52.256600 [debug] [ThreadPool]: On list_postgres: Close
[0m23:26:52.257356 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:26:52.257482 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:26:52.257575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:52.265006 [debug] [ThreadPool]: SQL status: SELECT 179 in 0.007 seconds
[0m23:26:52.265736 [debug] [ThreadPool]: On list_postgres: Close
[0m23:26:52.266323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m23:26:52.268243 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m23:26:52.268355 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m23:26:52.268444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:52.278995 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m23:26:52.279428 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m23:26:52.279824 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m23:26:52.279981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m23:26:52.280747 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m23:26:52.280847 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m23:26:52.280937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:52.289872 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m23:26:52.290260 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m23:26:52.290564 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m23:26:52.292531 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:52.292690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:26:52.292816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:52.301964 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m23:26:52.302363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6fe7b0>]}
[0m23:26:52.302518 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:52.302829 [debug] [MainThread]: On master: COMMIT
[0m23:26:52.302919 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:52.302999 [debug] [MainThread]: On master: COMMIT
[0m23:26:52.303427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:52.303547 [debug] [MainThread]: On master: Close
[0m23:26:52.304397 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m23:26:52.304589 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m23:26:52.304752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m23:26:52.304869 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m23:26:52.307774 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:26:52.308102 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m23:26:52.327869 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:26:52.328043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp232652318881"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m23:26:52.328151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.339012 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.011 seconds
[0m23:26:52.343829 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:26:52.343952 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp232652318881'
        
      order by ordinal_position

  
[0m23:26:52.350731 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:26:52.352459 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:26:52.352589 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.354132 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:26:52.357314 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:26:52.357454 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.359709 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:26:52.367898 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:26:52.368224 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:26:52.368350 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp232652318881" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m23:26:52.375737 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.007 seconds
[0m23:26:52.380658 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:26:52.380787 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:26:52.380891 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:26:52.382419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.383085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m23:26:52.383752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10addce20>]}
[0m23:26:52.383992 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m23:26:52.384188 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m23:26:52.384318 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:26:52.384497 [info ] [Thread-1 (]: 2 of 10 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m23:26:52.384640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m23:26:52.384751 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:26:52.385786 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:26:52.386013 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:26:52.392437 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:26:52.392809 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:26:52.392981 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  MAX(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  MAX(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  MAX(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  MAX(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes
ORDER BY change_time DESC
  );
  
[0m23:26:52.393123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.408679 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.015 seconds
[0m23:26:52.412872 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:26:52.413025 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m23:26:52.413620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.414682 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:26:52.414789 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:26:52.415141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.416248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:26:52.416350 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:26:52.416438 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:26:52.417922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.419990 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m23:26:52.421478 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:26:52.421584 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m23:26:52.422328 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:26:52.422796 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:26:52.423010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a76fad0>]}
[0m23:26:52.423233 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 15406[0m in 0.04s]
[0m23:26:52.423427 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:26:52.423556 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m23:26:52.423756 [info ] [Thread-1 (]: 3 of 10 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m23:26:52.423932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_users)
[0m23:26:52.424058 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m23:26:52.425416 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m23:26:52.425696 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m23:26:52.426859 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:26:52.426972 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp232652426330"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m23:26:52.427089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.432373 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.005 seconds
[0m23:26:52.433523 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:26:52.433659 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp232652426330'
        
      order by ordinal_position

  
[0m23:26:52.436490 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:26:52.437455 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:26:52.437562 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.438750 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:26:52.439754 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:26:52.439876 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.440934 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:26:52.443113 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m23:26:52.443476 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:26:52.443611 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp232652426330" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m23:26:52.446952 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.003 seconds
[0m23:26:52.447503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:26:52.447610 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:26:52.447700 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:26:52.448820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.449149 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m23:26:52.449362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93b800>]}
[0m23:26:52.449601 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m23:26:52.449794 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m23:26:52.449927 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:26:52.450104 [info ] [Thread-1 (]: 4 of 10 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m23:26:52.450245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m23:26:52.450357 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:26:52.451411 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:26:52.469781 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.469959 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:26:52.470066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.476785 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:26:52.477926 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.478047 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.483550 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:26:52.485790 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.485909 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.487501 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:26:52.499899 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.500086 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp232652499365"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:26:52.501892 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:26:52.502830 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.502940 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232652499365'
        
      order by ordinal_position

  
[0m23:26:52.505889 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m23:26:52.506752 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.506858 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.509420 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:52.510415 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.510543 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232652499365'
        
      order by ordinal_position

  
[0m23:26:52.513140 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:26:52.514121 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.514222 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.516775 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:52.519072 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.519202 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp232652499365'
        
      order by ordinal_position

  
[0m23:26:52.520384 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:26:52.525372 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.525608 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:52.527146 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:26:52.528408 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.528521 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:52.529415 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:26:52.529578 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.529833 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.529945 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp232652499365" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp232652499365" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:26:52.531122 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:52.531731 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.531836 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m23:26:52.532598 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m23:26:52.532850 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:26:52.532951 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:26:52.533041 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:26:52.533859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.534708 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m23:26:52.534889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae73430>]}
[0m23:26:52.535157 [info ] [Thread-1 (]: 4 of 10 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.08s]
[0m23:26:52.535345 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:26:52.535469 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:26:52.535641 [info ] [Thread-1 (]: 5 of 10 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m23:26:52.535828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m23:26:52.535950 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:26:52.536753 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:26:52.537763 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.537865 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:26:52.537960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.544876 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:26:52.546246 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.546365 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.550787 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:26:52.551920 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.552035 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.553368 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:26:52.554863 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.555032 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp232652554150"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:26:52.557060 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:26:52.557818 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.557929 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232652554150'
        
      order by ordinal_position

  
[0m23:26:52.559163 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:26:52.560298 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.560428 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.562015 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:26:52.564366 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.564507 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232652554150'
        
      order by ordinal_position

  
[0m23:26:52.566029 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:26:52.567030 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.567152 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.569004 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:52.569982 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.570097 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp232652554150'
        
      order by ordinal_position

  
[0m23:26:52.571090 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:26:52.571779 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.571971 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:52.572528 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:26:52.573048 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.573161 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:52.573458 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:26:52.573617 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.573927 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.574046 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp232652554150" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp232652554150" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:26:52.575392 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:52.576183 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.576301 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m23:26:52.577381 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m23:26:52.577648 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:26:52.577753 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:26:52.577847 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:26:52.579332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.579619 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m23:26:52.579806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fbbd0>]}
[0m23:26:52.580082 [info ] [Thread-1 (]: 5 of 10 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:26:52.580269 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:26:52.580388 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:26:52.580557 [info ] [Thread-1 (]: 6 of 10 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m23:26:52.580714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m23:26:52.580837 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:26:52.581743 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:26:52.582651 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.582763 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:26:52.582863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.590316 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:26:52.591657 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.591787 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.594901 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:26:52.596306 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.596455 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.598789 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:26:52.600462 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.600646 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp232652599647"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:26:52.602946 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:26:52.603755 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.603873 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232652599647'
        
      order by ordinal_position

  
[0m23:26:52.605643 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:52.606582 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.606706 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.607752 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:26:52.608916 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.609036 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232652599647'
        
      order by ordinal_position

  
[0m23:26:52.610119 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:26:52.611153 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.611288 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.612657 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:26:52.613730 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.613860 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp232652599647'
        
      order by ordinal_position

  
[0m23:26:52.614780 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:26:52.615445 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.615622 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:52.616056 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:26:52.616590 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.616710 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:52.616990 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:26:52.617149 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.617441 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.617564 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp232652599647" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp232652599647" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:26:52.618017 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:26:52.618752 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.618870 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m23:26:52.619179 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:26:52.619457 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:26:52.619572 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:26:52.619672 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:26:52.620050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:26:52.620344 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m23:26:52.620536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a97b5b0>]}
[0m23:26:52.620823 [info ] [Thread-1 (]: 6 of 10 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:26:52.621013 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:26:52.621136 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:26:52.621307 [info ] [Thread-1 (]: 7 of 10 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m23:26:52.621477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m23:26:52.621590 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:26:52.622468 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:26:52.623394 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.623507 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:26:52.623614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.629540 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:26:52.630956 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.631093 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.637700 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:26:52.638980 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.639128 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.640437 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:26:52.642270 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.642480 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp232652641332"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:26:52.647665 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:26:52.648518 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.648639 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232652641332'
        
      order by ordinal_position

  
[0m23:26:52.650016 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:26:52.651089 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.651225 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.652470 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:26:52.653665 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.653790 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232652641332'
        
      order by ordinal_position

  
[0m23:26:52.654769 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:26:52.655717 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.655838 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:26:52.657060 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:26:52.658078 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.658201 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp232652641332'
        
      order by ordinal_position

  
[0m23:26:52.659323 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:26:52.660034 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.660234 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:52.660748 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:26:52.661293 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.661413 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:52.661729 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:26:52.661900 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.662229 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.662364 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp232652641332" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp232652641332" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:26:52.662817 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:26:52.663612 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.663740 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m23:26:52.664072 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:26:52.664380 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:26:52.664500 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:26:52.664606 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:26:52.665321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.665626 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m23:26:52.665826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acac230>]}
[0m23:26:52.666123 [info ] [Thread-1 (]: 7 of 10 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.04s]
[0m23:26:52.666324 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:26:52.666461 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:26:52.666636 [info ] [Thread-1 (]: 8 of 10 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m23:26:52.666777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m23:26:52.666894 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m23:26:52.668030 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:26:52.668279 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m23:26:52.669783 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:26:52.669913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp232652668973"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
where dbt_valid_to is null
  );
  
  
[0m23:26:52.670025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.675224 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:26:52.676428 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:26:52.676573 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp232652668973'
        
      order by ordinal_position

  
[0m23:26:52.682259 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:26:52.683268 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:26:52.683397 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.684606 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:26:52.685918 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:26:52.686046 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.687013 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:26:52.687762 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:26:52.688068 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:26:52.688200 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp232652668973" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m23:26:52.688648 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:26:52.689110 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:26:52.689226 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:26:52.689332 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:26:52.689934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:26:52.690175 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m23:26:52.690368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae3d070>]}
[0m23:26:52.690596 [info ] [Thread-1 (]: 8 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m23:26:52.690791 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:26:52.690918 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m23:26:52.691084 [info ] [Thread-1 (]: 9 of 10 START sql incremental model public_pipedrive_staging.stg_deal_fields ... [RUN]
[0m23:26:52.691221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m23:26:52.691335 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m23:26:52.692472 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:26:52.692703 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m23:26:52.694882 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:26:52.695005 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp232652693376"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:26:52.695114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.700551 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:26:52.701713 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:26:52.701858 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp232652693376'
        
      order by ordinal_position

  
[0m23:26:52.706568 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:26:52.707557 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:26:52.707681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.708964 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:26:52.710413 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:26:52.710562 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.711940 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:26:52.712759 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:26:52.713080 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:26:52.713209 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp232652693376" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m23:26:52.713752 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:26:52.714206 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:26:52.714321 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:26:52.714424 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:26:52.715029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.715274 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m23:26:52.715472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9589b0>]}
[0m23:26:52.715698 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.02s]
[0m23:26:52.715894 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m23:26:52.716022 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m23:26:52.716190 [info ] [Thread-1 (]: 10 of 10 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m23:26:52.716330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m23:26:52.716445 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m23:26:52.719362 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:26:52.719598 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m23:26:52.721035 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:26:52.721163 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp232652720462"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE dbt_valid_to IS NULL
  AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m23:26:52.721278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.726315 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:26:52.727566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:26:52.727720 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp232652720462'
        
      order by ordinal_position

  
[0m23:26:52.733185 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m23:26:52.734444 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:26:52.734570 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.736770 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:26:52.737763 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:26:52.737889 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:26:52.739067 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:26:52.739743 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:26:52.740045 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:26:52.740165 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp232652720462" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m23:26:52.740544 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m23:26:52.740999 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:26:52.741115 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:26:52.741220 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:26:52.741819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:26:52.742062 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m23:26:52.742402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c07546-6601-490c-8929-bec2a1f5bc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acaf350>]}
[0m23:26:52.742667 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m23:26:52.742876 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m23:26:52.743378 [debug] [MainThread]: On master: COMMIT
[0m23:26:52.743496 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:52.743591 [debug] [MainThread]: On master: COMMIT
[0m23:26:52.743682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:52.748050 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m23:26:52.748167 [debug] [MainThread]: On master: Close
[0m23:26:52.748303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:52.748393 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m23:26:52.748530 [info ] [MainThread]: 
[0m23:26:52.748640 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m23:26:52.749248 [debug] [MainThread]: Command end result
[0m23:26:52.758762 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:26:52.759568 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:26:52.762327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m23:26:52.762439 [info ] [MainThread]: 
[0m23:26:52.762558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:52.762650 [info ] [MainThread]: 
[0m23:26:52.762750 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m23:26:52.763956 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8702995, "process_in_blocks": "0", "process_kernel_time": 0.119203, "process_mem_max_rss": "148307968", "process_out_blocks": "0", "process_user_time": 1.029491}
[0m23:26:52.764111 [debug] [MainThread]: Command `dbt build` succeeded at 23:26:52.764078 after 0.87 seconds
[0m23:26:52.764235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f524b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae3da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae3c470>]}
[0m23:26:52.764354 [debug] [MainThread]: Flushing usage events
[0m23:26:54.738939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:46.462314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9217f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8db890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8dbb10>]}


============================== 23:42:46.463975 | be0cfb0b-f273-4141-a144-06869322341a ==============================
[0m23:42:46.463975 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:42:46.464217 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m23:42:46.517538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abc29e0>]}
[0m23:42:46.536313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83e9c0>]}
[0m23:42:46.536620 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:42:46.566368 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:42:46.609150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m23:42:46.609379 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/pipedrive/stg_deal_lost_reason.sql
[0m23:42:46.609515 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_stages.sql
[0m23:42:46.609635 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m23:42:46.696903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c896050>]}
[0m23:42:46.748494 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:42:46.749283 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:42:46.758640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9459a0>]}
[0m23:42:46.758822 [info ] [MainThread]: Found 7 models, 4 snapshots, 6 sources, 464 macros
[0m23:42:46.759764 [info ] [MainThread]: 
[0m23:42:46.759891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:46.759983 [info ] [MainThread]: 
[0m23:42:46.760154 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:46.761620 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:42:46.779754 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:42:46.779919 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:42:46.780012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:46.799232 [debug] [ThreadPool]: SQL status: SELECT 183 in 0.019 seconds
[0m23:42:46.799877 [debug] [ThreadPool]: On list_postgres: Close
[0m23:42:46.800632 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:42:46.800761 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:42:46.800880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:46.808269 [debug] [ThreadPool]: SQL status: SELECT 183 in 0.007 seconds
[0m23:42:46.808943 [debug] [ThreadPool]: On list_postgres: Close
[0m23:42:46.809521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m23:42:46.811460 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m23:42:46.811581 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m23:42:46.811671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:46.820694 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m23:42:46.821116 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m23:42:46.821481 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m23:42:46.821639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m23:42:46.822494 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m23:42:46.822593 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m23:42:46.822683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:46.831442 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m23:42:46.832005 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m23:42:46.832328 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m23:42:46.834315 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:46.834459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:42:46.834577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:46.843657 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m23:42:46.844069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8bb150>]}
[0m23:42:46.844227 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:46.844612 [debug] [MainThread]: On master: COMMIT
[0m23:42:46.844699 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:46.844775 [debug] [MainThread]: On master: COMMIT
[0m23:42:46.845304 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:46.845402 [debug] [MainThread]: On master: Close
[0m23:42:46.846171 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m23:42:46.846342 [info ] [Thread-1 (]: 1 of 11 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m23:42:46.846498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activities)
[0m23:42:46.846610 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m23:42:46.849375 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:42:46.849659 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m23:42:46.868753 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:42:46.868922 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp234246860483"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m23:42:46.869029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:46.880878 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.012 seconds
[0m23:42:46.885457 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:42:46.885586 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp234246860483'
        
      order by ordinal_position

  
[0m23:42:46.892665 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:42:46.894360 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:42:46.894476 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:46.897196 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:42:46.901567 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:42:46.901702 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:46.904062 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:42:46.912068 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:42:46.912402 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:42:46.912540 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp234246860483" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m23:42:46.921775 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.009 seconds
[0m23:42:46.926652 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:42:46.926770 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:42:46.926871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:42:46.930206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:42:46.930819 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m23:42:46.931400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc68fc0>]}
[0m23:42:46.931622 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m23:42:46.931813 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m23:42:46.931943 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:42:46.932137 [info ] [Thread-1 (]: 2 of 11 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m23:42:46.932297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m23:42:46.932409 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:42:46.933370 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:42:46.933592 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:42:46.938682 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:42:46.939003 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:42:46.939137 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  MAX(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  MAX(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  MAX(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  MAX(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes
ORDER BY change_time DESC
  );
  
[0m23:42:46.939260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:46.964118 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.025 seconds
[0m23:42:46.967903 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:42:46.968045 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m23:42:46.968535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:46.969731 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:42:46.969852 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:42:46.970229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:46.971409 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:42:46.971528 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:42:46.971629 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:42:46.972952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:46.974950 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m23:42:46.976551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:42:46.976667 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m23:42:46.977506 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:42:46.977974 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:42:46.978190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbead50>]}
[0m23:42:46.978421 [info ] [Thread-1 (]: 2 of 11 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 15406[0m in 0.05s]
[0m23:42:46.978613 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:42:46.978742 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:42:46.978977 [info ] [Thread-1 (]: 3 of 11 START sql table model public_pipedrive_staging.stg_deal_lost_reason .... [RUN]
[0m23:42:46.979173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_lost_reason)
[0m23:42:46.979305 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:42:46.980095 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:42:46.980391 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:42:46.981461 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:42:46.981658 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:42:46.981759 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_lost_reason__dbt_tmp"
  
  
    as
  
  (
    SELECT
  (array_elems ->> 'id')::INT     AS lost_reason_id,
  (array_elems ->> 'label')::TEXT AS actual_lost_reason
FROM public.fields,
  LATERAL JSONB_ARRAY_ELEMENTS(field_value_options) AS array_elems
WHERE field_key = 'lost_reason'
  );
  
[0m23:42:46.981866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:46.987137 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m23:42:46.988800 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:42:46.988932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_lost_reason__dbt_tmp" rename to "stg_deal_lost_reason"
[0m23:42:46.989376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:46.989814 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: COMMIT
[0m23:42:46.989928 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:42:46.990025 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: COMMIT
[0m23:42:46.990432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:42:46.991071 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_lost_reason__dbt_backup"
[0m23:42:46.991260 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:42:46.991354 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_lost_reason__dbt_backup" cascade
[0m23:42:46.991687 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:42:46.992081 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: Close
[0m23:42:46.992268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb9fc20>]}
[0m23:42:46.992533 [info ] [Thread-1 (]: 3 of 11 OK created sql table model public_pipedrive_staging.stg_deal_lost_reason  [[32mSELECT 5[0m in 0.01s]
[0m23:42:46.992836 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:42:46.992990 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m23:42:46.993172 [info ] [Thread-1 (]: 4 of 11 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m23:42:46.993317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_lost_reason, now model.enpal_assessment_project.stg_deal_users)
[0m23:42:46.993428 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m23:42:46.994651 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m23:42:46.994886 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m23:42:46.996213 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:42:46.996319 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp234246995703"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m23:42:46.996415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:47.002207 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.006 seconds
[0m23:42:47.003296 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:42:47.003441 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp234246995703'
        
      order by ordinal_position

  
[0m23:42:47.007217 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:42:47.008409 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:42:47.008516 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:47.010346 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:42:47.011310 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:42:47.011421 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:47.012459 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:42:47.014610 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m23:42:47.014920 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:42:47.015042 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp234246995703" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m23:42:47.018951 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m23:42:47.019402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:42:47.019508 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:42:47.019606 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:42:47.020565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:47.020908 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m23:42:47.021160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0aa490>]}
[0m23:42:47.021410 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m23:42:47.021611 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m23:42:47.021744 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:42:47.021919 [info ] [Thread-1 (]: 5 of 11 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m23:42:47.022056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m23:42:47.022168 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:42:47.023349 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:42:47.041005 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.041159 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:42:47.041265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:47.046410 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:42:47.047445 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.047560 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.052652 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:42:47.054712 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.054841 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.056389 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.069168 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.069362 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp234247068598"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:42:47.070898 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:42:47.071705 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.071812 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234247068598'
        
      order by ordinal_position

  
[0m23:42:47.074524 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m23:42:47.075600 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.075713 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.076790 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.077685 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.077817 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234247068598'
        
      order by ordinal_position

  
[0m23:42:47.078891 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:42:47.079764 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.079874 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.081009 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.083163 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.083276 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234247068598'
        
      order by ordinal_position

  
[0m23:42:47.084788 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:42:47.089673 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.089848 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:42:47.091141 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:42:47.092133 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.092235 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:42:47.092684 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:42:47.092837 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.093139 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.093256 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp234247068598" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp234247068598" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:42:47.094322 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:42:47.094911 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.095010 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m23:42:47.095516 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:42:47.095772 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:42:47.095875 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:42:47.095964 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:42:47.096934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:47.097801 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m23:42:47.097997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13e2d0>]}
[0m23:42:47.098270 [info ] [Thread-1 (]: 5 of 11 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.08s]
[0m23:42:47.098462 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:42:47.098589 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:42:47.098761 [info ] [Thread-1 (]: 6 of 11 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m23:42:47.098945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m23:42:47.099068 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:42:47.101110 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:42:47.101947 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.102054 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:42:47.102151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:47.109464 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:42:47.110451 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.110566 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.116607 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:42:47.117653 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.117770 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.119312 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.120692 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.120881 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp234247120145"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:42:47.122558 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:42:47.123566 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.123681 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234247120145'
        
      order by ordinal_position

  
[0m23:42:47.125427 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:42:47.126325 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.126439 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.127947 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.128917 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.129039 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234247120145'
        
      order by ordinal_position

  
[0m23:42:47.130489 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:42:47.131616 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.131729 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.132744 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.133795 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.133924 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234247120145'
        
      order by ordinal_position

  
[0m23:42:47.134953 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:42:47.135625 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.135813 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:42:47.136287 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:42:47.136573 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.136679 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:42:47.136946 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:42:47.137184 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.137515 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.137642 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp234247120145" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp234247120145" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:42:47.138129 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:42:47.138870 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.138982 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m23:42:47.139305 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:42:47.139642 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:42:47.139759 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:42:47.139860 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:42:47.140281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:42:47.140594 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m23:42:47.140792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfeec10>]}
[0m23:42:47.141080 [info ] [Thread-1 (]: 6 of 11 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:42:47.141273 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:42:47.141404 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:42:47.141578 [info ] [Thread-1 (]: 7 of 11 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m23:42:47.141715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m23:42:47.141833 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:42:47.142944 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:42:47.143856 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.143966 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:42:47.144067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:47.151421 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:42:47.152326 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.152440 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.156589 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m23:42:47.157995 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.158128 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.160030 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:42:47.161456 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.161641 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp234247160906"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:42:47.163376 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:42:47.164414 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.164533 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234247160906'
        
      order by ordinal_position

  
[0m23:42:47.165687 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.166599 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.166715 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.167734 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:42:47.168706 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.168830 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234247160906'
        
      order by ordinal_position

  
[0m23:42:47.170046 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.171277 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.171405 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.172464 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:42:47.173444 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.173565 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234247160906'
        
      order by ordinal_position

  
[0m23:42:47.174633 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.175315 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.175493 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:42:47.175966 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:42:47.176254 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.176368 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:42:47.177156 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:42:47.177324 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.177607 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.177728 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp234247160906" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp234247160906" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:42:47.178880 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:42:47.179623 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.179740 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m23:42:47.180559 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m23:42:47.180843 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:42:47.180957 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:42:47.181059 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:42:47.181807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:47.182104 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m23:42:47.182294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c690b90>]}
[0m23:42:47.182578 [info ] [Thread-1 (]: 7 of 11 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:42:47.182764 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:42:47.182890 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:42:47.183062 [info ] [Thread-1 (]: 8 of 11 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m23:42:47.183225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m23:42:47.183344 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:42:47.184464 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:42:47.185419 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.185531 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:42:47.185637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:47.190210 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:42:47.191292 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.191428 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.195359 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:42:47.196754 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.196879 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.198574 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:42:47.200092 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.200300 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp234247199520"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:42:47.204537 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m23:42:47.205417 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.205543 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234247199520'
        
      order by ordinal_position

  
[0m23:42:47.206672 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:42:47.207905 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.208042 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.209454 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.210549 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.210685 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234247199520'
        
      order by ordinal_position

  
[0m23:42:47.212042 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:42:47.213249 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.213377 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:42:47.214529 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:42:47.215542 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.215666 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234247199520'
        
      order by ordinal_position

  
[0m23:42:47.216776 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:42:47.217472 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.217668 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:42:47.218176 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:42:47.218472 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.218582 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:42:47.218888 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:42:47.219050 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.219349 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.219477 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp234247199520" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp234247199520" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:42:47.220034 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:42:47.220826 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.220952 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m23:42:47.221295 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:42:47.221594 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:42:47.221714 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:42:47.221821 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:42:47.222523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:47.222827 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m23:42:47.223027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f1430>]}
[0m23:42:47.223325 [info ] [Thread-1 (]: 8 of 11 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.04s]
[0m23:42:47.223523 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:42:47.223660 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:42:47.223834 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m23:42:47.223976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m23:42:47.224093 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m23:42:47.226803 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:42:47.227064 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m23:42:47.228343 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:42:47.228469 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp234247227763"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:42:47.228580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:47.234685 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:42:47.235727 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:42:47.235859 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp234247227763'
        
      order by ordinal_position

  
[0m23:42:47.240011 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:42:47.241275 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:42:47.241406 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:47.242747 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:42:47.243806 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:42:47.243936 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:47.245433 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:42:47.246159 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:42:47.246453 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:42:47.246591 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp234247227763" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m23:42:47.247076 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:42:47.247556 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:42:47.247674 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:42:47.247787 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:42:47.248256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:42:47.248503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m23:42:47.248702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca37650>]}
[0m23:42:47.248946 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m23:42:47.249142 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:42:47.249277 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m23:42:47.249422 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public_pipedrive_staging.stg_deal_fields .. [RUN]
[0m23:42:47.249581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m23:42:47.249696 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m23:42:47.251017 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:42:47.251237 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m23:42:47.252511 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:42:47.252638 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp234247251922"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:42:47.252754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:47.260805 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m23:42:47.262036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:42:47.262165 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp234247251922'
        
      order by ordinal_position

  
[0m23:42:47.268292 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:42:47.269321 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:42:47.269448 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:47.270817 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:42:47.271953 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:42:47.272077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:47.273581 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:42:47.274522 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:42:47.274872 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:42:47.275015 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp234247251922" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m23:42:47.275629 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:42:47.276116 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:42:47.276494 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:42:47.276611 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:42:47.277212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:42:47.277465 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m23:42:47.277668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d05a8d0>]}
[0m23:42:47.277909 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.03s]
[0m23:42:47.278130 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m23:42:47.278274 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m23:42:47.278451 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m23:42:47.278596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m23:42:47.278716 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m23:42:47.280439 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:42:47.280716 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m23:42:47.282033 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:42:47.282171 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp234247281422"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE
    dbt_valid_to IS NULL
    AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m23:42:47.282293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:47.287736 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:42:47.289144 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:42:47.289284 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp234247281422'
        
      order by ordinal_position

  
[0m23:42:47.293155 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m23:42:47.294227 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:42:47.294360 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:47.295788 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:42:47.297060 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:42:47.297199 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:42:47.298539 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:42:47.299280 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:42:47.299606 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:42:47.299737 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp234247281422" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m23:42:47.300131 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m23:42:47.300641 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:42:47.300761 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:42:47.300870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:42:47.301285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:42:47.301537 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m23:42:47.301742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0cfb0b-f273-4141-a144-06869322341a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d05a4b0>]}
[0m23:42:47.301977 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.02s]
[0m23:42:47.302170 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m23:42:47.302670 [debug] [MainThread]: On master: COMMIT
[0m23:42:47.302776 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:47.302867 [debug] [MainThread]: On master: COMMIT
[0m23:42:47.302951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:47.307382 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m23:42:47.307522 [debug] [MainThread]: On master: Close
[0m23:42:47.307662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:47.307751 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m23:42:47.307894 [info ] [MainThread]: 
[0m23:42:47.308006 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 2 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m23:42:47.308659 [debug] [MainThread]: Command end result
[0m23:42:47.318178 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:42:47.318869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:42:47.321402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m23:42:47.321532 [info ] [MainThread]: 
[0m23:42:47.321657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:47.321758 [info ] [MainThread]: 
[0m23:42:47.321867 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m23:42:47.323183 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8850602, "process_in_blocks": "0", "process_kernel_time": 0.121649, "process_mem_max_rss": "148652032", "process_out_blocks": "0", "process_user_time": 1.032201}
[0m23:42:47.323376 [debug] [MainThread]: Command `dbt build` succeeded at 23:42:47.323338 after 0.89 seconds
[0m23:42:47.323507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1a79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f1d30>]}
[0m23:42:47.323629 [debug] [MainThread]: Flushing usage events
[0m23:42:49.007250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:33.922658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8717f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d82b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d82bb10>]}


============================== 23:43:33.924300 | 54ed121f-9f9f-48da-93e3-bebe04daff5c ==============================
[0m23:43:33.924300 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:43:33.924537 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_format': 'default'}
[0m23:43:33.978150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb129e0>]}
[0m23:43:33.997559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d78e9c0>]}
[0m23:43:33.997866 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:43:34.027389 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:43:34.070340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:34.070559 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:43:34.070684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:34.086704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7e5b50>]}
[0m23:43:34.115867 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:43:34.116647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:43:34.126144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea1f5c0>]}
[0m23:43:34.126328 [info ] [MainThread]: Found 7 models, 4 snapshots, 6 sources, 464 macros
[0m23:43:34.127305 [info ] [MainThread]: 
[0m23:43:34.127428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:43:34.127519 [info ] [MainThread]: 
[0m23:43:34.127698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:34.129238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:43:34.149549 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:43:34.149729 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:43:34.149827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:34.172043 [debug] [ThreadPool]: SQL status: SELECT 185 in 0.022 seconds
[0m23:43:34.172783 [debug] [ThreadPool]: On list_postgres: Close
[0m23:43:34.173639 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:43:34.173776 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:43:34.173884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:34.182712 [debug] [ThreadPool]: SQL status: SELECT 185 in 0.009 seconds
[0m23:43:34.183276 [debug] [ThreadPool]: On list_postgres: Close
[0m23:43:34.183906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_snapshots)
[0m23:43:34.209939 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m23:43:34.210121 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m23:43:34.210219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:34.222246 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m23:43:34.222772 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m23:43:34.223310 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m23:43:34.223492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now list_postgres_public_pipedrive_staging)
[0m23:43:34.224363 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m23:43:34.224478 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m23:43:34.224568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:34.235083 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m23:43:34.235522 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m23:43:34.235867 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m23:43:34.237844 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:34.237967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:43:34.238071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:34.247856 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m23:43:34.248257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea867b0>]}
[0m23:43:34.248422 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:34.248760 [debug] [MainThread]: On master: COMMIT
[0m23:43:34.248854 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:34.248935 [debug] [MainThread]: On master: COMMIT
[0m23:43:34.249413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:43:34.249503 [debug] [MainThread]: On master: Close
[0m23:43:34.250576 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m23:43:34.250754 [info ] [Thread-1 (]: 1 of 11 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m23:43:34.250918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now model.enpal_assessment_project.stg_deal_activities)
[0m23:43:34.251033 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m23:43:34.253885 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:43:34.254210 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m23:43:34.273527 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:43:34.273695 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp234334264556"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m23:43:34.273797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.286025 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.012 seconds
[0m23:43:34.290799 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:43:34.290939 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp234334264556'
        
      order by ordinal_position

  
[0m23:43:34.297346 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m23:43:34.299017 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:43:34.299129 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.301736 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:43:34.304918 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:43:34.305061 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.307388 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:43:34.315412 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:43:34.315716 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:43:34.315842 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp234334264556" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m23:43:34.324555 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.009 seconds
[0m23:43:34.329820 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:43:34.329971 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:43:34.330079 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:43:34.332821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:43:34.333476 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m23:43:34.334093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed57e0>]}
[0m23:43:34.334326 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.08s]
[0m23:43:34.334527 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m23:43:34.334658 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:43:34.334848 [info ] [Thread-1 (]: 2 of 11 START sql table model public_pipedrive_staging.stg_deal_changes ........ [RUN]
[0m23:43:34.335005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m23:43:34.335116 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:43:34.336029 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:43:34.336238 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:43:34.340608 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:43:34.340822 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:43:34.340943 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  MAX(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  MAX(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  MAX(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  MAX(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes
ORDER BY change_time DESC
  );
  
[0m23:43:34.341057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.363374 [debug] [Thread-1 (]: SQL status: SELECT 15406 in 0.022 seconds
[0m23:43:34.367134 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:43:34.367267 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m23:43:34.367703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:43:34.368790 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:43:34.368905 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:43:34.369271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:43:34.370463 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:43:34.370581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:43:34.370682 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:43:34.372211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:43:34.374360 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup"
[0m23:43:34.375996 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:43:34.376116 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_changes__dbt_backup" cascade
[0m23:43:34.376902 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:43:34.377350 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:43:34.377564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9e3050>]}
[0m23:43:34.377794 [info ] [Thread-1 (]: 2 of 11 OK created sql table model public_pipedrive_staging.stg_deal_changes ... [[32mSELECT 15406[0m in 0.04s]
[0m23:43:34.377984 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:43:34.378112 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:43:34.378285 [info ] [Thread-1 (]: 3 of 11 START sql table model public_pipedrive_staging.stg_deal_lost_reason .... [RUN]
[0m23:43:34.378420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_lost_reason)
[0m23:43:34.378529 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:43:34.379309 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:43:34.379582 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:43:34.380651 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:43:34.380859 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:43:34.380968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

  
    

  create  table "postgres"."public_pipedrive_staging"."stg_deal_lost_reason__dbt_tmp"
  
  
    as
  
  (
    SELECT
  (array_elems ->> 'id')::INT     AS lost_reason_id,
  (array_elems ->> 'label')::TEXT AS actual_lost_reason
FROM public.fields,
  LATERAL JSONB_ARRAY_ELEMENTS(field_value_options) AS array_elems
WHERE field_key = 'lost_reason'
  );
  
[0m23:43:34.381074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.386506 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m23:43:34.388020 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:43:34.388203 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_lost_reason" rename to "stg_deal_lost_reason__dbt_backup"
[0m23:43:34.388646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:43:34.389676 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:43:34.389798 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */
alter table "postgres"."public_pipedrive_staging"."stg_deal_lost_reason__dbt_tmp" rename to "stg_deal_lost_reason"
[0m23:43:34.390129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:43:34.390629 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: COMMIT
[0m23:43:34.390745 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:43:34.390847 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: COMMIT
[0m23:43:34.391486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:43:34.392217 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_staging"."stg_deal_lost_reason__dbt_backup"
[0m23:43:34.392440 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:43:34.392548 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */
drop table if exists "postgres"."public_pipedrive_staging"."stg_deal_lost_reason__dbt_backup" cascade
[0m23:43:34.393266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:43:34.393714 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: Close
[0m23:43:34.393916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea7f3e0>]}
[0m23:43:34.394145 [info ] [Thread-1 (]: 3 of 11 OK created sql table model public_pipedrive_staging.stg_deal_lost_reason  [[32mSELECT 5[0m in 0.02s]
[0m23:43:34.394334 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:43:34.394466 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m23:43:34.394660 [info ] [Thread-1 (]: 4 of 11 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m23:43:34.394797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_lost_reason, now model.enpal_assessment_project.stg_deal_users)
[0m23:43:34.394910 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m23:43:34.396396 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m23:43:34.396671 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m23:43:34.397953 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:43:34.398073 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp234334397359"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m23:43:34.398182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.403780 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.006 seconds
[0m23:43:34.405464 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:43:34.405654 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp234334397359'
        
      order by ordinal_position

  
[0m23:43:34.408331 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:43:34.409470 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:43:34.409590 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.410874 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:43:34.412000 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:43:34.412137 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.413532 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:43:34.415824 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m23:43:34.416148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:43:34.416268 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp234334397359" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m23:43:34.419987 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m23:43:34.420523 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:43:34.420646 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:43:34.420750 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:43:34.421404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:43:34.421654 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m23:43:34.421848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef5e850>]}
[0m23:43:34.422068 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m23:43:34.422251 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m23:43:34.422385 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:43:34.422555 [info ] [Thread-1 (]: 5 of 11 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m23:43:34.422689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m23:43:34.422801 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:43:34.423812 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:43:34.443106 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.443273 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:43:34.443377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.448596 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:43:34.449632 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.449744 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.454714 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:43:34.456754 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.456883 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.459153 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:43:34.471687 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.471872 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp234334471150"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:43:34.475799 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m23:43:34.476687 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.476793 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234334471150'
        
      order by ordinal_position

  
[0m23:43:34.479417 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:43:34.480331 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.480435 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.482216 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:43:34.483199 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.483322 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234334471150'
        
      order by ordinal_position

  
[0m23:43:34.484260 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:43:34.485383 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.485503 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.486687 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:43:34.488868 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.488988 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234334471150'
        
      order by ordinal_position

  
[0m23:43:34.490020 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:43:34.494949 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.495152 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:43:34.496495 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:43:34.497729 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.497838 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:43:34.498292 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:43:34.498445 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.498746 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.498868 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp234334471150" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp234334471150" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:43:34.499961 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:43:34.500563 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.500665 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m23:43:34.501248 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:43:34.501523 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:43:34.501627 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:43:34.501718 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:43:34.502570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:43:34.503360 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m23:43:34.503537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edbd850>]}
[0m23:43:34.503834 [info ] [Thread-1 (]: 5 of 11 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.08s]
[0m23:43:34.504084 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:43:34.504215 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:43:34.504389 [info ] [Thread-1 (]: 6 of 11 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m23:43:34.504585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m23:43:34.504699 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:43:34.505458 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:43:34.506454 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.506560 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:43:34.506658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.513949 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:43:34.514842 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.514959 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.521509 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:43:34.522745 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.522869 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.525383 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:43:34.526984 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.527173 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp234334526218"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:43:34.530582 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:43:34.531362 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.531480 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234334526218'
        
      order by ordinal_position

  
[0m23:43:34.533197 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:43:34.534107 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.534223 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.535853 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:43:34.537228 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.537350 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234334526218'
        
      order by ordinal_position

  
[0m23:43:34.539061 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:43:34.539980 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.540106 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.542738 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:43:34.543687 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.543800 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234334526218'
        
      order by ordinal_position

  
[0m23:43:34.546057 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:43:34.546804 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.547000 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:43:34.547541 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:43:34.548087 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.548200 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:43:34.548507 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:43:34.548668 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.548954 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.549081 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp234334526218" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp234334526218" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:43:34.549594 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:43:34.550415 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.550546 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m23:43:34.550862 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:43:34.551160 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:43:34.551279 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:43:34.551380 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:43:34.551977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:43:34.552284 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m23:43:34.552481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11400c440>]}
[0m23:43:34.552780 [info ] [Thread-1 (]: 6 of 11 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m23:43:34.552975 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:43:34.553103 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:43:34.553278 [info ] [Thread-1 (]: 7 of 11 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m23:43:34.553461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m23:43:34.553583 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:43:34.554523 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:43:34.555440 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.555552 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:43:34.555654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.562250 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:43:34.563571 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.563708 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.570029 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m23:43:34.571237 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.571378 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.572882 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:43:34.574685 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.574873 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp234334573851"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:43:34.576663 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:43:34.577494 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.577615 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234334573851'
        
      order by ordinal_position

  
[0m23:43:34.578734 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:43:34.579704 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.579834 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.581452 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:43:34.582620 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.582739 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234334573851'
        
      order by ordinal_position

  
[0m23:43:34.583776 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:43:34.584751 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.584877 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.585900 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:43:34.586949 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.587070 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234334573851'
        
      order by ordinal_position

  
[0m23:43:34.588079 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:43:34.588844 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.589040 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:43:34.589534 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:43:34.590851 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.590969 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:43:34.591791 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:43:34.591962 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.592261 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.592385 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp234334573851" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp234334573851" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:43:34.593574 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:43:34.594315 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.594431 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m23:43:34.594930 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:43:34.595215 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:43:34.595329 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:43:34.595432 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:43:34.596639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:43:34.596947 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m23:43:34.597135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3e6f0>]}
[0m23:43:34.597421 [info ] [Thread-1 (]: 7 of 11 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:43:34.597612 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:43:34.597738 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:43:34.597912 [info ] [Thread-1 (]: 8 of 11 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m23:43:34.598094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m23:43:34.598230 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:43:34.599166 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:43:34.600093 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.600208 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:43:34.600315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.607341 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:43:34.608654 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.608784 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.613938 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:43:34.615082 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.615202 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.617048 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:43:34.618694 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.618882 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp234334617897"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:43:34.623783 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:43:34.624733 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.624858 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234334617897'
        
      order by ordinal_position

  
[0m23:43:34.626280 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:43:34.627259 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.627379 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.628646 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:43:34.629857 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.629979 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234334617897'
        
      order by ordinal_position

  
[0m23:43:34.631167 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:43:34.632153 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.632283 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:43:34.633855 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:43:34.634826 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.634942 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234334617897'
        
      order by ordinal_position

  
[0m23:43:34.635968 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:43:34.636722 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.636915 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:43:34.637915 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:43:34.638607 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.638729 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:43:34.639240 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:43:34.639407 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.639684 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.639808 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp234334617897" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp234334617897" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:43:34.640761 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:43:34.641528 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.641647 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m23:43:34.642099 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:43:34.642378 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:43:34.642490 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:43:34.642590 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:43:34.643447 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:43:34.643746 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m23:43:34.643934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3f830>]}
[0m23:43:34.644217 [info ] [Thread-1 (]: 8 of 11 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.05s]
[0m23:43:34.644408 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:43:34.644537 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:43:34.644705 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m23:43:34.644841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m23:43:34.644949 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m23:43:34.646071 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:43:34.646297 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m23:43:34.647768 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:43:34.647886 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp234334646970"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:43:34.647997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.654046 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:43:34.655116 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:43:34.655252 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp234334646970'
        
      order by ordinal_position

  
[0m23:43:34.659298 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:43:34.660326 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:43:34.660445 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.661869 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:43:34.663054 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:43:34.663171 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.664216 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:43:34.664960 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:43:34.665266 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:43:34.665387 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp234334646970" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m23:43:34.665822 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:43:34.666332 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:43:34.666453 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:43:34.666561 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:43:34.667041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:43:34.667278 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m23:43:34.667474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3edb0>]}
[0m23:43:34.667709 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m23:43:34.667896 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:43:34.668020 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m23:43:34.668177 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public_pipedrive_staging.stg_deal_fields .. [RUN]
[0m23:43:34.668310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m23:43:34.668415 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m23:43:34.669498 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:43:34.669754 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m23:43:34.671459 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:43:34.671586 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp234334670503"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:43:34.671696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.676759 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:43:34.677731 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:43:34.677858 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp234334670503'
        
      order by ordinal_position

  
[0m23:43:34.680847 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:43:34.681809 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:43:34.681927 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.683060 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:43:34.684322 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:43:34.684451 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.685795 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:43:34.686692 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:43:34.687036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:43:34.687220 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp234334670503" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m23:43:34.688370 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m23:43:34.688873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:43:34.688990 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:43:34.689091 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:43:34.690052 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:43:34.690321 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m23:43:34.690521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3d790>]}
[0m23:43:34.690739 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.02s]
[0m23:43:34.690923 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m23:43:34.691045 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m23:43:34.691206 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m23:43:34.691336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m23:43:34.691444 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m23:43:34.694223 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:43:34.694483 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m23:43:34.695949 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:43:34.696069 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp234334695385"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE
    dbt_valid_to IS NULL
    AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m23:43:34.696177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:34.703882 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m23:43:34.704922 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:43:34.705051 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp234334695385'
        
      order by ordinal_position

  
[0m23:43:34.707895 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m23:43:34.709194 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:43:34.709324 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.711010 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:43:34.712002 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:43:34.712115 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:43:34.713060 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:43:34.713815 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:43:34.714129 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:43:34.714253 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp234334695385" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m23:43:34.715146 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.001 seconds
[0m23:43:34.715587 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:43:34.715692 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:43:34.715786 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:43:34.716631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:43:34.716865 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m23:43:34.717051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ed121f-9f9f-48da-93e3-bebe04daff5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3e4b0>]}
[0m23:43:34.717259 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m23:43:34.717440 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m23:43:34.717915 [debug] [MainThread]: On master: COMMIT
[0m23:43:34.718027 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:34.718115 [debug] [MainThread]: On master: COMMIT
[0m23:43:34.718192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:34.723047 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m23:43:34.723170 [debug] [MainThread]: On master: Close
[0m23:43:34.723306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:34.723390 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m23:43:34.723527 [info ] [MainThread]: 
[0m23:43:34.723639 [info ] [MainThread]: Finished running 5 incremental models, 4 snapshots, 2 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m23:43:34.724265 [debug] [MainThread]: Command end result
[0m23:43:34.734385 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:43:34.735043 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:43:34.737336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m23:43:34.737441 [info ] [MainThread]: 
[0m23:43:34.737565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:34.737660 [info ] [MainThread]: 
[0m23:43:34.737769 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m23:43:34.739098 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.84024084, "process_in_blocks": "0", "process_kernel_time": 0.124051, "process_mem_max_rss": "145391616", "process_out_blocks": "0", "process_user_time": 0.968598}
[0m23:43:34.739404 [debug] [MainThread]: Command `dbt build` succeeded at 23:43:34.739357 after 0.84 seconds
[0m23:43:34.739551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9c4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeaeab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140241d0>]}
[0m23:43:34.739686 [debug] [MainThread]: Flushing usage events
[0m23:43:36.419142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:06.956833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf6d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df27890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df27b10>]}


============================== 23:49:06.959170 | 0bc18590-caa8-4cbb-a62b-4dc40c060451 ==============================
[0m23:49:06.959170 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:49:06.959397 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build', 'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'False', 'no_print': 'None', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m23:49:07.027723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bc18590-caa8-4cbb-a62b-4dc40c060451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20e9e0>]}
[0m23:49:07.046783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bc18590-caa8-4cbb-a62b-4dc40c060451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de8a9c0>]}
[0m23:49:07.047297 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:49:07.081723 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:49:07.131684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:49:07.131917 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m23:49:07.132047 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m23:49:07.132165 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_lost_reason.sql
[0m23:49:07.132277 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m23:49:07.200949 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_deal_lost_reason (models/staging/pipedrive/stg_deal_lost_reason.sql)
  expected token ',', got 'unique_key'
    line 4
      unique_key = ['lost_reason_id'],
[0m23:49:07.202789 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.2729543, "process_in_blocks": "0", "process_kernel_time": 0.125096, "process_mem_max_rss": "129253376", "process_out_blocks": "0", "process_user_time": 0.643497}
[0m23:49:07.202984 [debug] [MainThread]: Command `dbt build` failed at 23:49:07.202944 after 0.27 seconds
[0m23:49:07.203129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef8da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef8db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f215040>]}
[0m23:49:07.203249 [debug] [MainThread]: Flushing usage events
[0m23:49:09.014631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:19.755991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109787890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109787b10>]}


============================== 23:49:19.757699 | 6d093f32-f4eb-43c2-a17b-70a6a85b693d ==============================
[0m23:49:19.757699 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:49:19.757945 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'invocation_command': 'dbt build', 'version_check': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'False', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m23:49:19.812600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d093f32-f4eb-43c2-a17b-70a6a85b693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a6e9e0>]}
[0m23:49:19.832162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d093f32-f4eb-43c2-a17b-70a6a85b693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ea9c0>]}
[0m23:49:19.833410 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:49:19.863139 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:49:19.906595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:49:19.906863 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m23:49:19.907001 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m23:49:19.907117 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m23:49:19.907227 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_lost_reason.sql
[0m23:49:19.963974 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_deal_activity_types (models/staging/pipedrive/stg_deal_activity_types.sql)
  expected token ',', got 'on_schema_change'
    line 6
      on_schema_change='sync_all_columns'
[0m23:49:19.965130 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.23299913, "process_in_blocks": "0", "process_kernel_time": 0.082873, "process_mem_max_rss": "128303104", "process_out_blocks": "0", "process_user_time": 0.633556}
[0m23:49:19.965293 [debug] [MainThread]: Command `dbt build` failed at 23:49:19.965259 after 0.23 seconds
[0m23:49:19.965423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a741050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a741950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c08c0>]}
[0m23:49:19.965541 [debug] [MainThread]: Flushing usage events
[0m23:49:21.201078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:29.231114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a23d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f7b10>]}


============================== 23:49:29.232759 | 0702c7e4-0e09-42ce-8e9c-23befe8b0bc5 ==============================
[0m23:49:29.232759 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:49:29.232989 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt build', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m23:49:29.287167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4de9e0>]}
[0m23:49:29.306916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15a9c0>]}
[0m23:49:29.307361 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:49:29.339634 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:49:29.382385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:49:29.382628 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activity_types.sql
[0m23:49:29.382761 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_changes.sql
[0m23:49:29.382880 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_activities.sql
[0m23:49:29.382986 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/pipedrive/stg_deal_lost_reason.sql
[0m23:49:29.473469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b2050>]}
[0m23:49:29.526445 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:49:29.527428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:49:29.542889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eafb60>]}
[0m23:49:29.543090 [info ] [MainThread]: Found 7 models, 4 snapshots, 6 sources, 464 macros
[0m23:49:29.544070 [info ] [MainThread]: 
[0m23:49:29.544191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:49:29.544289 [info ] [MainThread]: 
[0m23:49:29.544468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:29.545961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:49:29.567573 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:49:29.567743 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:49:29.567840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:29.599786 [debug] [ThreadPool]: SQL status: SELECT 193 in 0.032 seconds
[0m23:49:29.600521 [debug] [ThreadPool]: On list_postgres: Close
[0m23:49:29.601331 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:49:29.601467 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:49:29.601552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:29.609208 [debug] [ThreadPool]: SQL status: SELECT 193 in 0.008 seconds
[0m23:49:29.609985 [debug] [ThreadPool]: On list_postgres: Close
[0m23:49:29.610599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m23:49:29.612599 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m23:49:29.612728 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m23:49:29.612822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:29.622981 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m23:49:29.623390 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m23:49:29.623751 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m23:49:29.623886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m23:49:29.624703 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m23:49:29.624804 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m23:49:29.624890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:29.635115 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m23:49:29.635489 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m23:49:29.635827 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m23:49:29.637731 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:29.637864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:49:29.637975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:29.647265 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m23:49:29.647625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b95c050>]}
[0m23:49:29.647783 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:29.648115 [debug] [MainThread]: On master: COMMIT
[0m23:49:29.648255 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:29.648355 [debug] [MainThread]: On master: COMMIT
[0m23:49:29.648813 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:29.648912 [debug] [MainThread]: On master: Close
[0m23:49:29.650591 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m23:49:29.650762 [info ] [Thread-1 (]: 1 of 11 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m23:49:29.650915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activities)
[0m23:49:29.651025 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m23:49:29.653857 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.654114 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m23:49:29.673855 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.674047 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp234929664542"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m23:49:29.674160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.685327 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.011 seconds
[0m23:49:29.690157 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.690305 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp234929664542'
        
      order by ordinal_position

  
[0m23:49:29.696973 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:49:29.698775 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.698897 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:29.700911 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:29.708114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.708296 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp234929664542'
        
      order by ordinal_position

  
[0m23:49:29.710743 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:29.711748 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.711884 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:29.714244 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:29.718176 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_staging"."stg_deal_activities":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:49:29.726499 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.726791 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.726917 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp234929664542" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m23:49:29.735790 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.009 seconds
[0m23:49:29.740715 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:49:29.740843 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:29.740946 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:49:29.743924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:49:29.744591 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m23:49:29.745460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c81e5b0>]}
[0m23:49:29.745700 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.09s]
[0m23:49:29.745898 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m23:49:29.746030 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:49:29.746226 [info ] [Thread-1 (]: 2 of 11 START sql incremental model public_pipedrive_staging.stg_deal_changes .. [RUN]
[0m23:49:29.746388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m23:49:29.746498 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:49:29.747865 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.748097 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:49:29.749503 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.749632 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp234929748752"
  
  
    as
  
  (
    
WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  MAX(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  MAX(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  MAX(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  MAX(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes

WHERE
  change_time > (SELECT MAX(change_time) FROM "postgres"."public_pipedrive_staging"."stg_deal_changes")

ORDER BY change_time DESC
  );
  
  
[0m23:49:29.749747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.756986 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:49:29.758034 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.758162 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp234929748752'
        
      order by ordinal_position

  
[0m23:49:29.762193 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m23:49:29.763143 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.763262 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:29.764466 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:49:29.765680 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.765821 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp234929748752'
        
      order by ordinal_position

  
[0m23:49:29.767369 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:49:29.768254 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.768392 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:29.769452 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:49:29.770227 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_staging"."stg_deal_changes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:49:29.770673 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.771039 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.771172 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_changes" as DBT_INTERNAL_DEST
        using "stg_deal_changes__dbt_tmp234929748752" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                ) and (
                    DBT_INTERNAL_SOURCE.change_time = DBT_INTERNAL_DEST.change_time
                )

    
    when matched then update set
        "deal_id" = DBT_INTERNAL_SOURCE."deal_id","change_time" = DBT_INTERNAL_SOURCE."change_time","deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_created_at" = DBT_INTERNAL_SOURCE."deal_created_at","deal_lost_reason" = DBT_INTERNAL_SOURCE."deal_lost_reason"
    

    when not matched then insert
        ("deal_id", "change_time", "deal_stage_id", "deal_user_id", "deal_created_at", "deal_lost_reason")
    values
        ("deal_id", "change_time", "deal_stage_id", "deal_user_id", "deal_created_at", "deal_lost_reason")


  
[0m23:49:29.771737 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m23:49:29.772248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:49:29.772369 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:29.772470 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:49:29.772987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:29.773232 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:49:29.773443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c854950>]}
[0m23:49:29.773683 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_changes  [[32mMERGE 0[0m in 0.03s]
[0m23:49:29.773887 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:49:29.774020 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:49:29.774206 [info ] [Thread-1 (]: 3 of 11 START sql incremental model public_pipedrive_staging.stg_deal_lost_reason  [RUN]
[0m23:49:29.774356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_lost_reason)
[0m23:49:29.774473 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:49:29.775712 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.775938 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:49:29.777146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.777260 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

    
  
    

  create temporary table "stg_deal_lost_reason__dbt_tmp234929776592"
  
  
    as
  
  (
    
SELECT
  (array_elems ->> 'id')::INT     AS lost_reason_id,
  (array_elems ->> 'label')::TEXT AS actual_lost_reason
FROM public.fields,
  LATERAL JSONB_ARRAY_ELEMENTS(field_value_options) AS array_elems
WHERE field_key = 'lost_reason'
  );
  
  
[0m23:49:29.777367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.783293 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m23:49:29.784483 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.784611 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_lost_reason__dbt_tmp234929776592'
        
      order by ordinal_position

  
[0m23:49:29.787252 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:49:29.788401 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.788536 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_lost_reason'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:29.789739 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:49:29.790771 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.790920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_lost_reason__dbt_tmp234929776592'
        
      order by ordinal_position

  
[0m23:49:29.792242 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:49:29.793329 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.793465 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_lost_reason'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:29.796230 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m23:49:29.796925 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_staging"."stg_deal_lost_reason":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:49:29.797318 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.797619 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.797738 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_lost_reason" as DBT_INTERNAL_DEST
        using "stg_deal_lost_reason__dbt_tmp234929776592" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.lost_reason_id = DBT_INTERNAL_DEST.lost_reason_id
                )

    
    when matched then update set
        "lost_reason_id" = DBT_INTERNAL_SOURCE."lost_reason_id","actual_lost_reason" = DBT_INTERNAL_SOURCE."actual_lost_reason"
    

    when not matched then insert
        ("lost_reason_id", "actual_lost_reason")
    values
        ("lost_reason_id", "actual_lost_reason")


  
[0m23:49:29.798201 [debug] [Thread-1 (]: SQL status: MERGE 5 in 0.000 seconds
[0m23:49:29.798652 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: COMMIT
[0m23:49:29.798764 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:29.798862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: COMMIT
[0m23:49:29.799280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:29.799510 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: Close
[0m23:49:29.799702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8a8470>]}
[0m23:49:29.799921 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_lost_reason  [[32mMERGE 5[0m in 0.03s]
[0m23:49:29.800107 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:49:29.800230 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m23:49:29.800388 [info ] [Thread-1 (]: 4 of 11 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m23:49:29.800517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_lost_reason, now model.enpal_assessment_project.stg_deal_users)
[0m23:49:29.800623 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m23:49:29.801863 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m23:49:29.802088 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m23:49:29.803590 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:29.803715 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp234929803032"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m23:49:29.803827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.810635 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.007 seconds
[0m23:49:29.811621 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:29.811738 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp234929803032'
        
      order by ordinal_position

  
[0m23:49:29.816812 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:49:29.817735 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:29.817853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:29.819215 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:29.820386 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:29.820499 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:29.821713 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:29.823807 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m23:49:29.824108 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:29.824226 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp234929803032" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m23:49:29.827640 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.003 seconds
[0m23:49:29.828175 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:49:29.828300 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:29.828402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:49:29.829282 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:29.829531 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m23:49:29.829727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c88dc70>]}
[0m23:49:29.829950 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m23:49:29.830135 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m23:49:29.830269 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:49:29.830444 [info ] [Thread-1 (]: 5 of 11 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m23:49:29.830574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m23:49:29.830682 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:49:29.831683 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:49:29.850630 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.850801 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:49:29.850909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.858273 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:49:29.859468 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.859595 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.866781 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m23:49:29.868882 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.869064 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.870738 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:29.884060 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.884290 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp234929883487"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:49:29.886936 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:49:29.887843 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.887953 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234929883487'
        
      order by ordinal_position

  
[0m23:49:29.890145 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:49:29.892357 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.892503 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.893745 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:29.894681 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.894796 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234929883487'
        
      order by ordinal_position

  
[0m23:49:29.895831 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:29.896701 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.896811 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.898883 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:29.901305 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.901439 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234929883487'
        
      order by ordinal_position

  
[0m23:49:29.903327 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:49:29.908572 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.908765 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:29.909794 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:49:29.910792 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.910912 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:29.911420 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:29.911586 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.911880 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.911986 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp234929883487" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp234929883487" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:49:29.913038 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:29.913628 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.913730 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m23:49:29.914255 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:49:29.914526 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:49:29.914635 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:29.914724 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:49:29.915555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:29.916326 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m23:49:29.916500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6bd350>]}
[0m23:49:29.916764 [info ] [Thread-1 (]: 5 of 11 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.09s]
[0m23:49:29.916952 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:49:29.917074 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:49:29.917245 [info ] [Thread-1 (]: 6 of 11 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m23:49:29.917425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m23:49:29.917558 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:49:29.918478 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:49:29.919441 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.919548 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:49:29.919641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.926676 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:49:29.927561 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.927666 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.934216 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:49:29.935357 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.935477 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.937780 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:29.939069 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.939242 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp234929938575"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:49:29.942521 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:49:29.943228 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.943336 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234929938575'
        
      order by ordinal_position

  
[0m23:49:29.946279 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m23:49:29.947317 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.947427 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.950166 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:49:29.951019 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.951125 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234929938575'
        
      order by ordinal_position

  
[0m23:49:29.953105 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:49:29.954160 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.954269 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.956474 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:29.957357 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.957466 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234929938575'
        
      order by ordinal_position

  
[0m23:49:29.959428 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:49:29.960059 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.960238 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:29.961261 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:49:29.961544 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.961652 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:29.962069 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:29.962228 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.962499 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.962619 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp234929938575" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp234929938575" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:49:29.963561 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:29.964256 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.964362 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m23:49:29.964826 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:49:29.965080 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:49:29.965183 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:29.965276 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:49:29.966081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:29.966357 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m23:49:29.966535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c94c670>]}
[0m23:49:29.966802 [info ] [Thread-1 (]: 6 of 11 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m23:49:29.966983 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:49:29.967106 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:49:29.967269 [info ] [Thread-1 (]: 7 of 11 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m23:49:29.967448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m23:49:29.967585 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:49:29.968665 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:49:29.969670 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:29.969812 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:49:29.969930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.976583 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:49:29.977533 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:29.977647 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.984423 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:49:29.985810 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:29.985951 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:29.989520 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:49:29.993483 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:29.994358 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp234929991935"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:49:29.998117 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:49:30.000584 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.001042 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234929991935'
        
      order by ordinal_position

  
[0m23:49:30.002636 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:30.004431 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.004872 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:30.007899 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:49:30.009173 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.009309 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234929991935'
        
      order by ordinal_position

  
[0m23:49:30.011161 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:30.012261 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.012379 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:30.013647 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:49:30.014641 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.014762 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234929991935'
        
      order by ordinal_position

  
[0m23:49:30.015703 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:30.016299 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.016449 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:30.016923 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:30.017180 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.017276 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:30.017602 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:30.017792 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.018080 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.018194 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp234929991935" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp234929991935" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:49:30.018716 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:49:30.019433 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.019543 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m23:49:30.019921 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:49:30.020171 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:49:30.020271 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:30.020360 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:49:30.021590 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:30.021863 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m23:49:30.022035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c722750>]}
[0m23:49:30.022286 [info ] [Thread-1 (]: 7 of 11 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.05s]
[0m23:49:30.022466 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:49:30.022588 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:49:30.022754 [info ] [Thread-1 (]: 8 of 11 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m23:49:30.022937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m23:49:30.023060 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:49:30.023955 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:49:30.025151 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.025272 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:49:30.025382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:30.030081 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:49:30.031201 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.031329 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:30.035654 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:49:30.037066 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.037202 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:30.038631 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:30.040072 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.040249 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp234930039556"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:49:30.044765 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m23:49:30.045658 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.045770 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234930039556'
        
      order by ordinal_position

  
[0m23:49:30.047313 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:30.049469 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.049584 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:30.050660 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:30.051677 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.051803 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234930039556'
        
      order by ordinal_position

  
[0m23:49:30.053135 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:30.054224 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.054358 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:30.055562 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:30.056781 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.056900 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234930039556'
        
      order by ordinal_position

  
[0m23:49:30.057815 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:30.058456 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.058631 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:30.059179 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:30.059465 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.059579 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:30.059876 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:30.060029 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.060277 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.060392 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp234930039556" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp234930039556" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:49:30.060868 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:49:30.061666 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.061798 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m23:49:30.062156 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:49:30.062451 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:49:30.062563 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:30.062665 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:49:30.063039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:30.063327 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m23:49:30.063515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ee390>]}
[0m23:49:30.063794 [info ] [Thread-1 (]: 8 of 11 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.04s]
[0m23:49:30.063981 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:49:30.064107 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:49:30.064274 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m23:49:30.064406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m23:49:30.064513 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m23:49:30.065587 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.065820 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m23:49:30.067201 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.067314 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp234930066644"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:49:30.067416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:30.072496 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:49:30.073526 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.073647 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp234930066644'
        
      order by ordinal_position

  
[0m23:49:30.076566 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:49:30.077668 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.077784 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:30.079170 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:30.080139 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.080276 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp234930066644'
        
      order by ordinal_position

  
[0m23:49:30.081531 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:30.082376 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.082512 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:30.083515 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:30.084254 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_staging"."stg_deal_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:49:30.084628 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.084895 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.085007 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp234930066644" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m23:49:30.085868 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.001 seconds
[0m23:49:30.086298 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:49:30.086401 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:30.086494 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:49:30.087459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:30.087717 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m23:49:30.087925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83e150>]}
[0m23:49:30.088148 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.02s]
[0m23:49:30.088331 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:49:30.088453 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m23:49:30.088645 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public_pipedrive_staging.stg_deal_fields .. [RUN]
[0m23:49:30.088822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m23:49:30.088945 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m23:49:30.090079 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:30.090349 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m23:49:30.091758 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:30.091876 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp234930091018"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:49:30.091981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:30.098178 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:49:30.099202 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:30.099330 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp234930091018'
        
      order by ordinal_position

  
[0m23:49:30.102306 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:49:30.103336 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:30.103470 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:30.104821 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:30.106163 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:30.106300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:30.107290 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:30.107983 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:30.108269 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:30.108385 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp234930091018" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m23:49:30.108981 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:49:30.109439 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:49:30.109549 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:30.109654 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:49:30.110232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:30.110460 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m23:49:30.110647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ec470>]}
[0m23:49:30.110864 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.02s]
[0m23:49:30.111052 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m23:49:30.111171 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m23:49:30.111328 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m23:49:30.111458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m23:49:30.111565 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m23:49:30.113115 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:30.113335 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m23:49:30.114611 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:30.114721 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp234930114097"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE
    dbt_valid_to IS NULL
    AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m23:49:30.114831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:30.121649 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:49:30.122674 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:30.122786 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp234930114097'
        
      order by ordinal_position

  
[0m23:49:30.128322 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m23:49:30.129367 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:30.129495 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:30.131342 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:49:30.132517 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:30.132633 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:30.133744 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:49:30.134446 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:30.134746 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:30.134879 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp234930114097" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m23:49:30.135293 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m23:49:30.135756 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:49:30.135866 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:30.135968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:49:30.136432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:30.136786 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m23:49:30.137018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702c7e4-0e09-42ce-8e9c-23befe8b0bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ef0b0>]}
[0m23:49:30.137261 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m23:49:30.137453 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m23:49:30.137945 [debug] [MainThread]: On master: COMMIT
[0m23:49:30.138060 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:30.138148 [debug] [MainThread]: On master: COMMIT
[0m23:49:30.138233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:30.142460 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m23:49:30.142567 [debug] [MainThread]: On master: Close
[0m23:49:30.142693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:30.142781 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m23:49:30.142910 [info ] [MainThread]: 
[0m23:49:30.143015 [info ] [MainThread]: Finished running 7 incremental models, 4 snapshots in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m23:49:30.143744 [debug] [MainThread]: Command end result
[0m23:49:30.152389 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:49:30.153114 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:49:30.155636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m23:49:30.155749 [info ] [MainThread]: 
[0m23:49:30.155868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:30.155960 [info ] [MainThread]: 
[0m23:49:30.156061 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m23:49:30.157387 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.95023966, "process_in_blocks": "0", "process_kernel_time": 0.121909, "process_mem_max_rss": "148684800", "process_out_blocks": "0", "process_user_time": 1.058224}
[0m23:49:30.157528 [debug] [MainThread]: Command `dbt build` succeeded at 23:49:30.157499 after 0.95 seconds
[0m23:49:30.157639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b254bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9d7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9d78f0>]}
[0m23:49:30.157742 [debug] [MainThread]: Flushing usage events
[0m23:49:31.646420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:33.560644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7b57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d76f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d76fb10>]}


============================== 23:49:33.562272 | a4dec0e0-a965-4452-9bbf-31fbc21d0a39 ==============================
[0m23:49:33.562272 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:49:33.562516 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'profiles_dir': '/Users/macbook/dbt_enpal_assessment', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'log_path': '/Users/macbook/dbt_enpal_assessment/logs'}
[0m23:49:33.617510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca569e0>]}
[0m23:49:33.637099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d29c0>]}
[0m23:49:33.637391 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:49:33.668481 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:49:33.710658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:33.710814 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:49:33.710902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:33.727149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d1b50>]}
[0m23:49:33.756733 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:49:33.757452 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:49:33.766529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea0b5c0>]}
[0m23:49:33.766707 [info ] [MainThread]: Found 7 models, 4 snapshots, 6 sources, 464 macros
[0m23:49:33.767665 [info ] [MainThread]: 
[0m23:49:33.767790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:49:33.767881 [info ] [MainThread]: 
[0m23:49:33.768051 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:33.769564 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:49:33.787487 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:49:33.787666 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:49:33.787763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:33.806677 [debug] [ThreadPool]: SQL status: SELECT 195 in 0.019 seconds
[0m23:49:33.807306 [debug] [ThreadPool]: On list_postgres: Close
[0m23:49:33.808051 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:49:33.808177 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:49:33.808292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:33.816033 [debug] [ThreadPool]: SQL status: SELECT 195 in 0.008 seconds
[0m23:49:33.816521 [debug] [ThreadPool]: On list_postgres: Close
[0m23:49:33.817089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_staging)
[0m23:49:33.840846 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_staging"
[0m23:49:33.841025 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_staging'
  
[0m23:49:33.841125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:33.853174 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m23:49:33.853705 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: ROLLBACK
[0m23:49:33.854114 [debug] [ThreadPool]: On list_postgres_public_pipedrive_staging: Close
[0m23:49:33.854296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_staging, now list_postgres_pipedrive_snapshots)
[0m23:49:33.855206 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_snapshots"
[0m23:49:33.855304 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_snapshots"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_snapshots'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_snapshots'
  
[0m23:49:33.855390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:33.864986 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m23:49:33.865439 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: ROLLBACK
[0m23:49:33.865825 [debug] [ThreadPool]: On list_postgres_pipedrive_snapshots: Close
[0m23:49:33.867659 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:33.867802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:49:33.867914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:33.877431 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m23:49:33.877859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea79c50>]}
[0m23:49:33.878018 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:33.878414 [debug] [MainThread]: On master: COMMIT
[0m23:49:33.878502 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:33.878580 [debug] [MainThread]: On master: COMMIT
[0m23:49:33.879142 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:33.879237 [debug] [MainThread]: On master: Close
[0m23:49:33.880337 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activities
[0m23:49:33.880536 [info ] [Thread-1 (]: 1 of 11 START sql incremental model public_pipedrive_staging.stg_deal_activities  [RUN]
[0m23:49:33.880703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_snapshots, now model.enpal_assessment_project.stg_deal_activities)
[0m23:49:33.880834 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activities
[0m23:49:33.883730 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.884035 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activities
[0m23:49:33.903577 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.903744 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

    
  
    

  create temporary table "stg_deal_activities__dbt_tmp234933894828"
  
  
    as
  
  (
    

SELECT
  activity_id      AS deal_activity_id,
  type             AS deal_activity_type,
  assigned_to_user AS deal_activity_assigned_to_user,
  deal_id,
  done             AS is_deal_activity_done,
  due_to           AS deal_activity_due_to
FROM "postgres"."public"."activity"
  );
  
  
[0m23:49:33.903852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:33.916558 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m23:49:33.921091 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.921224 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp234933894828'
        
      order by ordinal_position

  
[0m23:49:33.927781 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m23:49:33.929491 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.929617 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:33.932522 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:49:33.937978 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.938131 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities__dbt_tmp234933894828'
        
      order by ordinal_position

  
[0m23:49:33.940459 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:33.941389 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.941526 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activities'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:33.943925 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:33.947688 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_staging"."stg_deal_activities":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:49:33.955219 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.955487 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.955614 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activities"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activities" as DBT_INTERNAL_DEST
        using "stg_deal_activities__dbt_tmp234933894828" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_id = DBT_INTERNAL_DEST.deal_activity_id
                ) and (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                )

    
    when matched then update set
        "deal_activity_id" = DBT_INTERNAL_SOURCE."deal_activity_id","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type","deal_activity_assigned_to_user" = DBT_INTERNAL_SOURCE."deal_activity_assigned_to_user","deal_id" = DBT_INTERNAL_SOURCE."deal_id","is_deal_activity_done" = DBT_INTERNAL_SOURCE."is_deal_activity_done","deal_activity_due_to" = DBT_INTERNAL_SOURCE."deal_activity_due_to"
    

    when not matched then insert
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")
    values
        ("deal_activity_id", "deal_activity_type", "deal_activity_assigned_to_user", "deal_id", "is_deal_activity_done", "deal_activity_due_to")


  
[0m23:49:33.967358 [debug] [Thread-1 (]: SQL status: MERGE 4579 in 0.012 seconds
[0m23:49:33.972534 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:49:33.972665 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activities"
[0m23:49:33.972769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: COMMIT
[0m23:49:33.974829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:33.975466 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activities: Close
[0m23:49:33.976066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeaec30>]}
[0m23:49:33.976286 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_activities  [[32mMERGE 4579[0m in 0.09s]
[0m23:49:33.976492 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activities
[0m23:49:33.976622 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:49:33.976828 [info ] [Thread-1 (]: 2 of 11 START sql incremental model public_pipedrive_staging.stg_deal_changes .. [RUN]
[0m23:49:33.977009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activities, now model.enpal_assessment_project.stg_deal_changes)
[0m23:49:33.977135 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:49:33.979685 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:33.979909 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:49:33.981317 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:33.981453 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

    
  
    

  create temporary table "stg_deal_changes__dbt_tmp234933980562"
  
  
    as
  
  (
    
WITH marked_deal_changes AS (
  SELECT
    deal_id,
    change_time,
    changed_field_key,
    new_value,
    CASE
      WHEN changed_field_key = 'stage_id' THEN new_value::INT
    END AS stage_id,
    CASE
      WHEN changed_field_key = 'user_id' THEN new_value::INT
    END AS user_id,
    CASE
      WHEN changed_field_key = 'add_time' THEN new_value::TIMESTAMP
    END AS deal_created_at,
    CASE
      WHEN changed_field_key = 'lost_reason' THEN new_value::TEXT
    END AS deal_lost_reason
  FROM
    "postgres"."public"."deal_changes"
)

SELECT
  deal_id,
  change_time,
  MAX(stage_id) OVER (
    PARTITION BY deal_id ORDER BY change_time
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  )                                                                                                                       AS deal_stage_id,
  MAX(user_id) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)          AS deal_user_id,
  MAX(deal_created_at) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  AS deal_created_at,
  MAX(deal_lost_reason) OVER (PARTITION BY deal_id ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS deal_lost_reason
FROM
  marked_deal_changes

WHERE
  change_time > (SELECT MAX(change_time) FROM "postgres"."public_pipedrive_staging"."stg_deal_changes")

ORDER BY change_time DESC
  );
  
  
[0m23:49:33.981584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:33.993413 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m23:49:33.994539 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:33.994689 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp234933980562'
        
      order by ordinal_position

  
[0m23:49:34.001419 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m23:49:34.002416 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:34.002539 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.005016 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:34.006267 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:34.006421 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes__dbt_tmp234933980562'
        
      order by ordinal_position

  
[0m23:49:34.008380 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:34.009310 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:34.009455 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_changes'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.011731 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:34.012358 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_staging"."stg_deal_changes":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:49:34.012772 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:34.013045 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:34.013169 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_changes" as DBT_INTERNAL_DEST
        using "stg_deal_changes__dbt_tmp234933980562" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_id = DBT_INTERNAL_DEST.deal_id
                ) and (
                    DBT_INTERNAL_SOURCE.change_time = DBT_INTERNAL_DEST.change_time
                )

    
    when matched then update set
        "deal_id" = DBT_INTERNAL_SOURCE."deal_id","change_time" = DBT_INTERNAL_SOURCE."change_time","deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_created_at" = DBT_INTERNAL_SOURCE."deal_created_at","deal_lost_reason" = DBT_INTERNAL_SOURCE."deal_lost_reason"
    

    when not matched then insert
        ("deal_id", "change_time", "deal_stage_id", "deal_user_id", "deal_created_at", "deal_lost_reason")
    values
        ("deal_id", "change_time", "deal_stage_id", "deal_user_id", "deal_created_at", "deal_lost_reason")


  
[0m23:49:34.013976 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.001 seconds
[0m23:49:34.014419 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:49:34.014526 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:49:34.014623 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:49:34.015450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.015692 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:49:34.015885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea33dd0>]}
[0m23:49:34.016099 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_changes  [[32mMERGE 0[0m in 0.04s]
[0m23:49:34.016286 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:49:34.016409 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:49:34.016577 [info ] [Thread-1 (]: 3 of 11 START sql incremental model public_pipedrive_staging.stg_deal_lost_reason  [RUN]
[0m23:49:34.016707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_deal_lost_reason)
[0m23:49:34.016817 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:49:34.018034 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.018259 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:49:34.019538 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.019669 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

    
  
    

  create temporary table "stg_deal_lost_reason__dbt_tmp234934018936"
  
  
    as
  
  (
    
SELECT
  (array_elems ->> 'id')::INT     AS lost_reason_id,
  (array_elems ->> 'label')::TEXT AS actual_lost_reason
FROM public.fields,
  LATERAL JSONB_ARRAY_ELEMENTS(field_value_options) AS array_elems
WHERE field_key = 'lost_reason'
  );
  
  
[0m23:49:34.019783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.026995 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m23:49:34.028233 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.028393 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_lost_reason__dbt_tmp234934018936'
        
      order by ordinal_position

  
[0m23:49:34.033027 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m23:49:34.034470 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.034616 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_lost_reason'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.036230 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:49:34.038148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.038347 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_lost_reason__dbt_tmp234934018936'
        
      order by ordinal_position

  
[0m23:49:34.039696 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:49:34.040904 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.041062 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_lost_reason'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.042177 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:49:34.042776 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_staging"."stg_deal_lost_reason":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:49:34.043154 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.043431 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.043550 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_lost_reason"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_lost_reason" as DBT_INTERNAL_DEST
        using "stg_deal_lost_reason__dbt_tmp234934018936" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.lost_reason_id = DBT_INTERNAL_DEST.lost_reason_id
                )

    
    when matched then update set
        "lost_reason_id" = DBT_INTERNAL_SOURCE."lost_reason_id","actual_lost_reason" = DBT_INTERNAL_SOURCE."actual_lost_reason"
    

    when not matched then insert
        ("lost_reason_id", "actual_lost_reason")
    values
        ("lost_reason_id", "actual_lost_reason")


  
[0m23:49:34.044868 [debug] [Thread-1 (]: SQL status: MERGE 5 in 0.001 seconds
[0m23:49:34.045325 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: COMMIT
[0m23:49:34.045431 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_lost_reason"
[0m23:49:34.045538 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: COMMIT
[0m23:49:34.046537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.046780 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_lost_reason: Close
[0m23:49:34.046961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea6bc20>]}
[0m23:49:34.047173 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_lost_reason  [[32mMERGE 5[0m in 0.03s]
[0m23:49:34.047366 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_lost_reason
[0m23:49:34.047489 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_users
[0m23:49:34.047648 [info ] [Thread-1 (]: 4 of 11 START sql incremental model public_pipedrive_staging.stg_deal_users .... [RUN]
[0m23:49:34.047778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_lost_reason, now model.enpal_assessment_project.stg_deal_users)
[0m23:49:34.047887 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_users
[0m23:49:34.049083 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_users"
[0m23:49:34.049281 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_users
[0m23:49:34.050668 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:34.050781 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

    
  
    

  create temporary table "stg_deal_users__dbt_tmp234934050116"
  
  
    as
  
  (
    

SELECT
  id       AS deal_user_id,
  name     AS deal_user_name,
  email    AS deal_user_email,
  modified AS deal_user_last_modified
FROM "postgres"."public"."users"
  );
  
  
[0m23:49:34.050882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.059336 [debug] [Thread-1 (]: SQL status: SELECT 1787 in 0.008 seconds
[0m23:49:34.060415 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:34.060549 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users__dbt_tmp234934050116'
        
      order by ordinal_position

  
[0m23:49:34.064156 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:49:34.065130 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:34.065250 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.066659 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:34.069112 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:34.069255 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_users'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.070362 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:34.072581 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_users"
[0m23:49:34.072890 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:34.073016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_users"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_users" as DBT_INTERNAL_DEST
        using "stg_deal_users__dbt_tmp234934050116" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_user_id = DBT_INTERNAL_DEST.deal_user_id))

    
    when matched then update set
        "deal_user_id" = DBT_INTERNAL_SOURCE."deal_user_id","deal_user_name" = DBT_INTERNAL_SOURCE."deal_user_name","deal_user_email" = DBT_INTERNAL_SOURCE."deal_user_email","deal_user_last_modified" = DBT_INTERNAL_SOURCE."deal_user_last_modified"
    

    when not matched then insert
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")
    values
        ("deal_user_id", "deal_user_name", "deal_user_email", "deal_user_last_modified")


  
[0m23:49:34.077641 [debug] [Thread-1 (]: SQL status: MERGE 1787 in 0.004 seconds
[0m23:49:34.078112 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:49:34.078221 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_users"
[0m23:49:34.078329 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: COMMIT
[0m23:49:34.079029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.079278 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_users: Close
[0m23:49:34.079479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed8ff0>]}
[0m23:49:34.079702 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_users  [[32mMERGE 1787[0m in 0.03s]
[0m23:49:34.079896 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_users
[0m23:49:34.080025 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:49:34.080200 [info ] [Thread-1 (]: 5 of 11 START snapshot pipedrive_snapshots.deal_activity_types_snapshot ........ [RUN]
[0m23:49:34.080334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_users, now snapshot.enpal_assessment_project.deal_activity_types_snapshot)
[0m23:49:34.080445 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:49:34.081446 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:49:34.099932 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.100096 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select * from "postgres"."public"."activity_types"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:49:34.100208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.107567 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:49:34.108760 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.108884 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.115283 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:49:34.117384 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.117508 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.118940 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.131784 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.131983 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        
  
    

  create temporary table "deal_activity_types_snapshot__dbt_tmp234934131213"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:49:34.133526 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:49:34.134353 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.134470 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234934131213'
        
      order by ordinal_position

  
[0m23:49:34.135635 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:34.136708 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.136817 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.139142 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:34.139994 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.140101 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234934131213'
        
      order by ordinal_position

  
[0m23:49:34.142191 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:49:34.143144 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.143262 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.144789 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.147254 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.147386 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_activity_types_snapshot__dbt_tmp234934131213'
        
      order by ordinal_position

  
[0m23:49:34.148752 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:34.153814 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.153999 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."activity_types"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."active" != source_data."active"
        or
        (
            ((snapshotted_data."active" is null) and not (source_data."active" is null))
            or
            ((not snapshotted_data."active" is null) and (source_data."active" is null))
        ) or snapshotted_data."type" != source_data."type"
        or
        (
            ((snapshotted_data."type" is null) and not (source_data."type" is null))
            or
            ((not snapshotted_data."type" is null) and (source_data."type" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:34.154972 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:49:34.155973 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.156074 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:34.156468 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:34.156621 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.156913 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.157028 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_activity_types_snapshot__dbt_tmp234934131213" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" ("id", "name", "active", "type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."active",DBT_INTERNAL_SOURCE."type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_activity_types_snapshot__dbt_tmp234934131213" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:49:34.157909 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:34.158494 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.158594 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_activity_types_snapshot"} */

        create index if not exists snap_deal_activity_types_current_idx on "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot" (type) where dbt_valid_to is null
      
[0m23:49:34.159128 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:49:34.159390 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:49:34.159490 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_activity_types_snapshot"
[0m23:49:34.159579 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: COMMIT
[0m23:49:34.160366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.161163 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_activity_types_snapshot: Close
[0m23:49:34.161341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda46d0>]}
[0m23:49:34.161606 [info ] [Thread-1 (]: 5 of 11 OK snapshotted pipedrive_snapshots.deal_activity_types_snapshot ........ [[32mINSERT 0 0[0m in 0.08s]
[0m23:49:34.161796 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_activity_types_snapshot
[0m23:49:34.161921 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:49:34.162097 [info ] [Thread-1 (]: 6 of 11 START snapshot pipedrive_snapshots.deal_fields_snapshot ................ [RUN]
[0m23:49:34.162263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_activity_types_snapshot, now snapshot.enpal_assessment_project.deal_fields_snapshot)
[0m23:49:34.162373 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:49:34.163283 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:49:34.164118 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.164221 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select * from "postgres"."public"."fields"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:49:34.164316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.170581 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:49:34.171562 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.171672 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.175213 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:49:34.176474 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.176599 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.178396 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:34.179923 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.180122 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        
  
    

  create temporary table "deal_fields_snapshot__dbt_tmp234934179341"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:49:34.183602 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:49:34.184359 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.184470 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234934179341'
        
      order by ordinal_position

  
[0m23:49:34.185764 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:34.186782 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.186894 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.188270 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.189179 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.189300 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234934179341'
        
      order by ordinal_position

  
[0m23:49:34.190299 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:34.191441 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.191563 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.193081 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.194037 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.194152 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_fields_snapshot__dbt_tmp234934179341'
        
      order by ordinal_position

  
[0m23:49:34.195583 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:34.196289 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.196482 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."fields"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."field_key" != source_data."field_key"
        or
        (
            ((snapshotted_data."field_key" is null) and not (source_data."field_key" is null))
            or
            ((not snapshotted_data."field_key" is null) and (source_data."field_key" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."field_value_options" != source_data."field_value_options"
        or
        (
            ((snapshotted_data."field_value_options" is null) and not (source_data."field_value_options" is null))
            or
            ((not snapshotted_data."field_value_options" is null) and (source_data."field_value_options" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:34.197015 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:34.197305 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.197415 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:34.197710 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:34.197866 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.198150 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.198270 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_fields_snapshot__dbt_tmp234934179341" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_fields_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_fields_snapshot" ("id", "field_key", "name", "field_value_options", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."field_key",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."field_value_options",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_fields_snapshot__dbt_tmp234934179341" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:49:34.198750 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:49:34.199480 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.199591 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_fields_snapshot"} */

        create index if not exists snap_deal_fields_current_idx on "postgres"."pipedrive_snapshots"."deal_fields_snapshot" (id) where dbt_valid_to is null
      
[0m23:49:34.200412 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m23:49:34.200684 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:49:34.200793 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_fields_snapshot"
[0m23:49:34.200889 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: COMMIT
[0m23:49:34.201541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.201823 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_fields_snapshot: Close
[0m23:49:34.202004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef36190>]}
[0m23:49:34.202316 [info ] [Thread-1 (]: 6 of 11 OK snapshotted pipedrive_snapshots.deal_fields_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:49:34.202505 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_fields_snapshot
[0m23:49:34.202631 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:49:34.202799 [info ] [Thread-1 (]: 7 of 11 START snapshot pipedrive_snapshots.deal_stages_snapshot ................ [RUN]
[0m23:49:34.202958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_fields_snapshot, now snapshot.enpal_assessment_project.deal_stages_snapshot)
[0m23:49:34.203066 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:49:34.204091 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:49:34.204984 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.205092 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select * from "postgres"."public"."stages"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:49:34.205194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.211110 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:49:34.212088 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.212216 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.215971 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m23:49:34.217219 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.217340 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.218526 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:49:34.220040 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.220241 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        
  
    

  create temporary table "deal_stages_snapshot__dbt_tmp234934219489"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:49:34.221864 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m23:49:34.222793 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.222923 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234934219489'
        
      order by ordinal_position

  
[0m23:49:34.224646 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:34.226850 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.226972 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.228586 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.001 seconds
[0m23:49:34.229504 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.229624 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234934219489'
        
      order by ordinal_position

  
[0m23:49:34.230923 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.232009 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.232125 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.234636 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:49:34.235753 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.235884 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_stages_snapshot__dbt_tmp234934219489'
        
      order by ordinal_position

  
[0m23:49:34.237346 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.238010 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.238186 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."stages"

    ),

    snapshotted_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stage_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        stage_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."stage_id" != source_data."stage_id"
        or
        (
            ((snapshotted_data."stage_id" is null) and not (source_data."stage_id" is null))
            or
            ((not snapshotted_data."stage_id" is null) and (source_data."stage_id" is null))
        ) or snapshotted_data."stage_name" != source_data."stage_name"
        or
        (
            ((snapshotted_data."stage_name" is null) and not (source_data."stage_name" is null))
            or
            ((not snapshotted_data."stage_name" is null) and (source_data."stage_name" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:34.238635 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:34.238926 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.239035 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:34.239333 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:34.239546 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.239879 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.240015 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_stages_snapshot__dbt_tmp234934219489" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_stages_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_stages_snapshot" ("stage_id", "stage_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."stage_id",DBT_INTERNAL_SOURCE."stage_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_stages_snapshot__dbt_tmp234934219489" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:49:34.240485 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:49:34.241283 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.241409 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_stages_snapshot"} */

        create index if not exists snap_deal_stages_current_idx on "postgres"."pipedrive_snapshots"."deal_stages_snapshot" (stage_id) where dbt_valid_to is null
      
[0m23:49:34.241753 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:49:34.242058 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:49:34.242181 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_stages_snapshot"
[0m23:49:34.242291 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: COMMIT
[0m23:49:34.242705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:34.243020 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_stages_snapshot: Close
[0m23:49:34.243225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed72f0>]}
[0m23:49:34.243523 [info ] [Thread-1 (]: 7 of 11 OK snapshotted pipedrive_snapshots.deal_stages_snapshot ................ [[32mINSERT 0 0[0m in 0.04s]
[0m23:49:34.243722 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_stages_snapshot
[0m23:49:34.243853 [debug] [Thread-1 (]: Began running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:49:34.244035 [info ] [Thread-1 (]: 8 of 11 START snapshot pipedrive_snapshots.deal_users_snapshot ................. [RUN]
[0m23:49:34.244225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_stages_snapshot, now snapshot.enpal_assessment_project.deal_users_snapshot)
[0m23:49:34.244344 [debug] [Thread-1 (]: Began compiling node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:49:34.245324 [debug] [Thread-1 (]: Began executing node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:49:34.246612 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.246726 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select * from "postgres"."public"."users"
    ) as __dbt_sbq
    where false
    limit 0

    
[0m23:49:34.246830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.252904 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:49:34.254095 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.254229 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.258703 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:49:34.260159 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.260291 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.261694 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.263235 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.263435 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        
  
    

  create temporary table "deal_users_snapshot__dbt_tmp234934262630"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m23:49:34.267777 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m23:49:34.268690 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.268861 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234934262630'
        
      order by ordinal_position

  
[0m23:49:34.270102 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:34.271357 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.271485 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.272622 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.273587 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.273713 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234934262630'
        
      order by ordinal_position

  
[0m23:49:34.274732 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:34.275738 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.275866 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot'
        
        and table_schema = 'pipedrive_snapshots'
        
      order by ordinal_position

  
[0m23:49:34.277388 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m23:49:34.278483 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.278611 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'deal_users_snapshot__dbt_tmp234934262630'
        
      order by ordinal_position

  
[0m23:49:34.279585 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m23:49:34.280307 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.280516 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from "postgres"."public"."users"

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "postgres"."pipedrive_snapshots"."deal_users_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."modified" != source_data."modified"
        or
        (
            ((snapshotted_data."modified" is null) and not (source_data."modified" is null))
            or
            ((not snapshotted_data."modified" is null) and (source_data."modified" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:34.281058 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:34.281371 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.281493 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:49:34.281794 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:49:34.281967 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.282275 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.282405 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

      update "postgres"."pipedrive_snapshots"."deal_users_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "deal_users_snapshot__dbt_tmp234934262630" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "postgres"."pipedrive_snapshots"."deal_users_snapshot".dbt_valid_to is null;
      


    insert into "postgres"."pipedrive_snapshots"."deal_users_snapshot" ("id", "name", "email", "modified", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."modified",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "deal_users_snapshot__dbt_tmp234934262630" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m23:49:34.282892 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:49:34.283686 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.283811 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "snapshot.enpal_assessment_project.deal_users_snapshot"} */

        create index if not exists snap_deal_users_current_idx on "postgres"."pipedrive_snapshots"."deal_users_snapshot" (id) where dbt_valid_to is null
      
[0m23:49:34.284160 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m23:49:34.284496 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:49:34.284629 [debug] [Thread-1 (]: Using postgres connection "snapshot.enpal_assessment_project.deal_users_snapshot"
[0m23:49:34.284761 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: COMMIT
[0m23:49:34.285215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:34.285551 [debug] [Thread-1 (]: On snapshot.enpal_assessment_project.deal_users_snapshot: Close
[0m23:49:34.285761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee9ce30>]}
[0m23:49:34.286080 [info ] [Thread-1 (]: 8 of 11 OK snapshotted pipedrive_snapshots.deal_users_snapshot ................. [[32mINSERT 0 0[0m in 0.04s]
[0m23:49:34.286295 [debug] [Thread-1 (]: Finished running node snapshot.enpal_assessment_project.deal_users_snapshot
[0m23:49:34.286439 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:49:34.286623 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public_pipedrive_staging.stg_deal_activity_types  [RUN]
[0m23:49:34.286773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.enpal_assessment_project.deal_users_snapshot, now model.enpal_assessment_project.stg_deal_activity_types)
[0m23:49:34.286895 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_activity_types
[0m23:49:34.288095 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.288349 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_activity_types
[0m23:49:34.289992 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.290122 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

    
  
    

  create temporary table "stg_deal_activity_types__dbt_tmp234934289365"
  
  
    as
  
  (
    

SELECT
  id     AS deal_activity_type_id,
  name   AS deal_activity_type_name,
  active AS is_deal_activity_type_active,
  type   AS deal_activity_type
FROM "postgres"."pipedrive_snapshots"."deal_activity_types_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:49:34.290238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.295961 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:49:34.297007 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.297132 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp234934289365'
        
      order by ordinal_position

  
[0m23:49:34.300991 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:49:34.302248 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.302449 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.303685 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:34.304925 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.305098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types__dbt_tmp234934289365'
        
      order by ordinal_position

  
[0m23:49:34.306245 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:34.307476 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.307643 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_activity_types'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.308827 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:34.309556 [debug] [Thread-1 (]: 
    In "postgres"."public_pipedrive_staging"."stg_deal_activity_types":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:49:34.310014 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.310332 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.310472 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_activity_types"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_activity_types" as DBT_INTERNAL_DEST
        using "stg_deal_activity_types__dbt_tmp234934289365" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_activity_type_id = DBT_INTERNAL_DEST.deal_activity_type_id
                )

    
    when matched then update set
        "deal_activity_type_id" = DBT_INTERNAL_SOURCE."deal_activity_type_id","deal_activity_type_name" = DBT_INTERNAL_SOURCE."deal_activity_type_name","is_deal_activity_type_active" = DBT_INTERNAL_SOURCE."is_deal_activity_type_active","deal_activity_type" = DBT_INTERNAL_SOURCE."deal_activity_type"
    

    when not matched then insert
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")
    values
        ("deal_activity_type_id", "deal_activity_type_name", "is_deal_activity_type_active", "deal_activity_type")


  
[0m23:49:34.310918 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:49:34.311406 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:49:34.311527 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_activity_types"
[0m23:49:34.311637 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: COMMIT
[0m23:49:34.312129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:34.312394 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_activity_types: Close
[0m23:49:34.312612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed5370>]}
[0m23:49:34.312859 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_activity_types  [[32mMERGE 4[0m in 0.03s]
[0m23:49:34.313060 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_activity_types
[0m23:49:34.313197 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_fields
[0m23:49:34.313369 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public_pipedrive_staging.stg_deal_fields .. [RUN]
[0m23:49:34.313511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_activity_types, now model.enpal_assessment_project.stg_deal_fields)
[0m23:49:34.313629 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_fields
[0m23:49:34.314815 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:34.315056 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_fields
[0m23:49:34.316615 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:34.316749 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

    
  
    

  create temporary table "stg_deal_fields__dbt_tmp234934315757"
  
  
    as
  
  (
    

SELECT
  id                  AS deal_field_id,
  field_key           AS deal_field_key,
  name                AS deal_field_name,
  field_value_options AS deal_field_value_options
FROM "postgres"."pipedrive_snapshots"."deal_fields_snapshot"
WHERE dbt_valid_to IS NULL
  );
  
  
[0m23:49:34.316867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.322383 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:49:34.323511 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:34.323645 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields__dbt_tmp234934315757'
        
      order by ordinal_position

  
[0m23:49:34.327818 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:49:34.328918 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:34.329052 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.330848 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:49:34.332208 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:34.332346 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_fields'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.333400 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.001 seconds
[0m23:49:34.334180 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:34.334490 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:34.334618 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_fields"} */

      -- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_fields" as DBT_INTERNAL_DEST
        using "stg_deal_fields__dbt_tmp234934315757" as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.deal_field_key = DBT_INTERNAL_DEST.deal_field_key))

    
    when matched then update set
        "deal_field_id" = DBT_INTERNAL_SOURCE."deal_field_id","deal_field_key" = DBT_INTERNAL_SOURCE."deal_field_key","deal_field_name" = DBT_INTERNAL_SOURCE."deal_field_name","deal_field_value_options" = DBT_INTERNAL_SOURCE."deal_field_value_options"
    

    when not matched then insert
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")
    values
        ("deal_field_id", "deal_field_key", "deal_field_name", "deal_field_value_options")


  
[0m23:49:34.335173 [debug] [Thread-1 (]: SQL status: MERGE 4 in 0.000 seconds
[0m23:49:34.335642 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:49:34.335759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_fields"
[0m23:49:34.335862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: COMMIT
[0m23:49:34.336580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.336983 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_fields: Close
[0m23:49:34.337224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed62d0>]}
[0m23:49:34.337472 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_fields  [[32mMERGE 4[0m in 0.02s]
[0m23:49:34.337701 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_fields
[0m23:49:34.337876 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_stages
[0m23:49:34.338107 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public_pipedrive_staging.stg_deal_stages .. [RUN]
[0m23:49:34.338348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_fields, now model.enpal_assessment_project.stg_deal_stages)
[0m23:49:34.338622 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_stages
[0m23:49:34.340519 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:34.340799 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_stages
[0m23:49:34.342418 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:34.342557 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

    
  
    

  create temporary table "stg_deal_stages__dbt_tmp234934341788"
  
  
    as
  
  (
    

WITH new_deal_stages_data AS (
  SELECT
    stage_id   AS deal_stage_id,
    stage_name AS deal_stage_name
  FROM "postgres"."pipedrive_snapshots"."deal_stages_snapshot"
  WHERE
    dbt_valid_to IS NULL
    AND stage_name IS NOT NULL
)

SELECT
  new_deal_stages_data.deal_stage_id,
  new_deal_stages_data.deal_stage_name
FROM new_deal_stages_data



  LEFT JOIN "postgres"."public_pipedrive_staging"."stg_deal_stages" AS existing_deal_stages_data
    ON
      new_deal_stages_data.deal_stage_id = existing_deal_stages_data.deal_stage_id
  WHERE existing_deal_stages_data.deal_stage_name IS NULL


  );
  
  
[0m23:49:34.342679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.348562 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:49:34.349767 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:34.349911 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages__dbt_tmp234934341788'
        
      order by ordinal_position

  
[0m23:49:34.353553 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m23:49:34.354925 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:34.355065 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.356302 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:49:34.358569 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:34.358693 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_deal_stages'
        
        and table_schema = 'public_pipedrive_staging'
        
      order by ordinal_position

  
[0m23:49:34.360420 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:49:34.361088 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:34.361371 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:34.361486 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_stages"} */

      -- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into "postgres"."public_pipedrive_staging"."stg_deal_stages" as DBT_INTERNAL_DEST
        using "stg_deal_stages__dbt_tmp234934341788" as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.deal_stage_id = DBT_INTERNAL_DEST.deal_stage_id
                )

    
    when matched then update set
        "deal_stage_id" = DBT_INTERNAL_SOURCE."deal_stage_id","deal_stage_name" = DBT_INTERNAL_SOURCE."deal_stage_name"
    

    when not matched then insert
        ("deal_stage_id", "deal_stage_name")
    values
        ("deal_stage_id", "deal_stage_name")


  
[0m23:49:34.361878 [debug] [Thread-1 (]: SQL status: MERGE 0 in 0.000 seconds
[0m23:49:34.362318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:49:34.362432 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_stages"
[0m23:49:34.362540 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: COMMIT
[0m23:49:34.363017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:49:34.363255 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_stages: Close
[0m23:49:34.363450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4dec0e0-a965-4452-9bbf-31fbc21d0a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed4ad0>]}
[0m23:49:34.363689 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public_pipedrive_staging.stg_deal_stages  [[32mMERGE 0[0m in 0.03s]
[0m23:49:34.363880 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_stages
[0m23:49:34.364365 [debug] [MainThread]: On master: COMMIT
[0m23:49:34.364467 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:34.364552 [debug] [MainThread]: On master: COMMIT
[0m23:49:34.364632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:34.368879 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m23:49:34.369042 [debug] [MainThread]: On master: Close
[0m23:49:34.369197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:34.369288 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_stages' was properly closed.
[0m23:49:34.369424 [info ] [MainThread]: 
[0m23:49:34.369530 [info ] [MainThread]: Finished running 7 incremental models, 4 snapshots in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m23:49:34.370226 [debug] [MainThread]: Command end result
[0m23:49:34.379587 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/macbook/dbt_enpal_assessment/target/manifest.json
[0m23:49:34.380305 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/macbook/dbt_enpal_assessment/target/semantic_manifest.json
[0m23:49:34.382711 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/macbook/dbt_enpal_assessment/target/run_results.json
[0m23:49:34.382829 [info ] [MainThread]: 
[0m23:49:34.382956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:34.383058 [info ] [MainThread]: 
[0m23:49:34.383163 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m23:49:34.384363 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8488724, "process_in_blocks": "0", "process_kernel_time": 0.111629, "process_mem_max_rss": "145784832", "process_out_blocks": "0", "process_user_time": 0.977656}
[0m23:49:34.384517 [debug] [MainThread]: Command `dbt build` succeeded at 23:49:34.384484 after 0.85 seconds
[0m23:49:34.384636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0df410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d84f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114023fb0>]}
[0m23:49:34.384749 [debug] [MainThread]: Flushing usage events
[0m23:49:35.944996 [debug] [MainThread]: An error was encountered while trying to flush usage events
